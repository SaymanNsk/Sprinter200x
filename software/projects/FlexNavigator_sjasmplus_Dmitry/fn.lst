0001   0000             	DEVICE ZXSPECTRUM128
0002   0000             ;[]=======================================================================[]
0003   0000             ;				FLEX NAVIGATOR			      	   ;
0004   0000             ;				     v1.11			           ;
0005   0000             ;			   Last	edition: 03/02/2000		           ;
0006   0000             ;[]=======================================================================[]
0007   0000             ; flex navigator equs
0008   0000             
0009   0000             	include "fnconst.inc"
0001+  0000             ;[]----------------------------------------------------------[]
0002+  0000             BORDER	EQU	#FE
0003+  0000             YPORT	EQU	#89
0004+  0000             PAGE0	EQU	#82
0005+  0000             PAGE1	EQU	#A2
0006+  0000             PAGE2	EQU	#C2
0007+  0000             PAGE3	EQU	#E2
0008+  0000             COUNT	EQU	#00
0009+  0000             ;[]----------------------------------------------------------[]
0010+  0000             PanelCol EQU	#09
0011+  0000             FileCol	 EQU	#0A
0012+  0000             SFileCol EQU	#0B
0013+  0000             InvSCol	 EQU	#0C
0014+  0000             InvPCol	 EQU	#05
0015+  0000             InvICol	 EQU	#06
0016+  0000             ;[]----------------------------------------------------------[]
0017+  0000             PanelFlg EQU	+#00
0018+  0000             ViewFlg	 EQU	+#01
0019+  0000             SortFlg	 EQU	+#02
0020+  0000             PanelXl	 EQU	+#03
0021+  0000             PanelXh	 EQU	+#04
0022+  0000             ;[]----------------------------------------------------------[]
0023+  0000             PanBarXl EQU	+#05
0024+  0000             PanBarXh EQU	+#06
0025+  0000             PanBarYl EQU	+#07
0026+  0000             PanBarYh EQU	+#08
0027+  0000             PanBrMLl EQU	+#09
0028+  0000             PanBrMLh EQU	+#0A
0029+  0000             PanBrLFl EQU	+#0D
0030+  0000             PanBrLFh EQU	+#0E
0031+  0000             PanBrRTl EQU	+#0F
0032+  0000             PanBrRTh EQU	+#10
0033+  0000             ;[]----------------------------------------------------------[]
0034+  0000             PanelFPl EQU	+#11
0035+  0000             PanelFPh EQU	+#12
0036+  0000             PanelEFl EQU	+#13
0037+  0000             PanelEFh EQU	+#14
0038+  0000             PanelFFl EQU	+#15
0039+  0000             PanelFFh EQU	+#16
0040+  0000             PanelCFl EQU	+#17
0041+  0000             PanelCFh EQU	+#18
0042+  0000             PanelMFl EQU	+#19
0043+  0000             PanelMFh EQU	+#1A
0044+  0000             PanelMBl1 EQU	+#1B
0045+  0000             PanelMBh1 EQU	+#1C
0046+  0000             PanelMBl2 EQU	+#1D
0047+  0000             PanelMBh2 EQU	+#1E
0048+  0000             BegPBar	EQU	+#05
0049+  0000             BegMask	EQU	+#1F
0050+  0000             BegPath	EQU	+#2C
0051+  0000             ;[]----------------------------------------------------------[]
0052+  0000             BarXl	 EQU	+#00
0053+  0000             BarXh	 EQU	+#01
0054+  0000             BarYl	 EQU	+#02
0055+  0000             BarYh	 EQU	+#03
0056+  0000             BarMaxLl EQU	+#04
0057+  0000             BarMaxLh EQU	+#05
0058+  0000             BarLENl	 EQU	+#06
0059+  0000             BarLENh	 EQU	+#07
0060+  0000             BarLEFTl EQU	+#08
0061+  0000             BarLEFTh EQU	+#09
0062+  0000             BarRGHTl EQU	+#0A
0063+  0000             BarRGHTh EQU	+#0B
0064+  0000             BarPAGEl EQU	+#0C
0065+  0000             BarPAGEh EQU	+#0D
0066+  0000             BarMAXl	 EQU	+#0E
0067+  0000             BarMAXh	 EQU	+#0F
0068+  0000             BarFRSTl EQU	+#10
0069+  0000             BarFRSTh EQU	+#11
0070+  0000             ;[]----------------------------------------------------------[]
0071+  0000             ProcXl	  EQU	 +#00
0072+  0000             ProcXh	  EQU	 +#01
0073+  0000             ProcYl	  EQU	 +#02
0074+  0000             ProcYh	  EQU	 +#03
0075+  0000             ProcMaxLl EQU	 +#04
0076+  0000             ProcMaxLh EQU	 +#05
0077+  0000             ProcCOEFl EQU	 +#06
0078+  0000             ProcCOEFh EQU	 +#07
0079+  0000             ProcCORRl EQU	 +#08
0080+  0000             ProcCORRh EQU	 +#09
0081+  0000             ProcMAXl1 EQU	 +#0A
0082+  0000             ProcMAXh1 EQU	 +#0B
0083+  0000             ProcMAXl2 EQU	 +#0C
0084+  0000             ProcMAXh2 EQU	 +#0D
0085+  0000             ProcCURl1 EQU	 +#0E
0086+  0000             ProcCURh1 EQU	 +#0F
0087+  0000             ProcCURl2 EQU	 +#10
0088+  0000             ProcCURh2 EQU	 +#11
0089+  0000             ProcCOLOR EQU	 +#12
0090+  0000             
0091+  0000             
0010   0000             
0011   0000             ;[]-----------------------------------------------------------------------[]
0012   0000             	org	0x8000
0013   8000             ;	section	.bss
0014   8000             
0015   8000             WorkBuffer: 
0016   8000 00          	ds	0x400			; work buffer for func/procs
0017   8400             
0018   8400             ;[]-----------------------------------------------------------------------[]
0019   8400             	org	0x8400
0020   8400             ;	section	.bss
0021   8400             
0022   8400             PagesList: 
0023   8400 00          	ds	0x100			; buffer for memory pages
0024   8500             ;[]-----------------------------------------------------------------------[]
0025   8500             	org	0x8500
0026   8500             ;	section	.text
0027   8500             StartOfFN
0028   8500             ;UI palette & stack memory
0029   8500             PALETTE: 
0030   8500 00 00 00 00 	DB	0x00,0x00,0x00,0x00	;Black		00
0031   8504 00 00 FF 00 	DB	0x00,0x00,0xFF,0x00	;B.Red		01
0032   8508 00 80 00 00 	DB	0x00,0x80,0x00,0x00	;Green		02
0033   850C 00 FF FF 00 	DB	0x00,0xFF,0xFF,0x00	;B.Yellow	03
0034   8510 80 00 00 00 	DB	0x80,0x00,0x00,0x00	;Blue		04
0035   8514 FF FF 00 00 	DB	0xFF,0xFF,0x00,0x00	;Invert	paper	05
0036   8518 80 00 00 00 	DB	0x80,0x00,0x00,0x00	;Invert	ink	06
0037   851C 80 80 80 00 	DB	0x80,0x80,0x80,0x00	;BlackGray	07
0038   8520 F5 F6 F7 00 	DB	0xf5,0xf6,0xf7,0x00	;HighGray	08
0039   8524 80 00 00 00 	DB	0x80,0x00,0x00,0x00	;Panel		09
0040   8528 FF FF 00 00 	DB	0xFF,0xFF,0x00,0x00	;Files		0A
0041   852C 00 FF FF 00 	DB	0x00,0xFF,0xFF,0x00	;Select	Files	0B
0042   8530 00 FF FF 00 	DB	0x00,0xFF,0xFF,0x00	;InvSel	Files	0C
0043   8534 F5 F6 F7 00 	DB	0xf5,0xf6,0xf7,0x00	;Reserved	0D
0044   8538 FF FF FF 00 	DB	0xFF,0xFF,0xFF,0x00	;White		0E
0045   853C FF FF FF 00 	DB	0xFF,0xFF,0xFF,0x00	;White		0F
0046   8540             
0047   8540 00          	ds	0xC0		; stack  memory
0048   8600             
0049   8600             ;[]=======================================================================[]
0050   8600             	org	0x8600
0051   8600             ;	section	.text
0052   8600             
0053   8600             EntryPoint: 
0054   8600 C3 AA A4    	JP	StartPoint			; entry point
0055   8603             
0056   8603             ; flex navigator UI
0057   8603             
0058   8603             	include "fnjump.z80"
0001+  8603             
0002+  8603             ;[]----------------------------------------------------------[]
0003+  8603 C3 BB 86    	JP	ClearScreen
0004+  8606 C3 F0 86    	JP	MakeWindow
0005+  8609 C3 A3 8D    	JP	InvertRectan
0006+  860C C3 B3 8F    	JP	PrnTxtLnIFF
0007+  860F C3 29 90    	JP	PrnTxtLnNorm
0008+  8612 C3 A2 90    	JP	PrnTxtLnNormC
0009+  8615 C3 4B 8E    	JP	PrnRangPathL
0010+  8618 C3 B5 8E    	JP	PrnRangPathR
0011+  861B C3 39 8F    	JP	PrnRangPathC
0012+  861E C3 68 91    	JP	InputLine
0013+  8621 C3 0E 92    	JP	InpLnExtN
0014+  8624 C3 18 92    	JP	InpLnExtC
0015+  8627 C9          	DEFS	03,#C9
0016+  862A C3 F7 96    	JP	InitScrBar
0017+  862D C3 35 97    	JP	PrnHScrBar
0018+  8630 C3 8E 98    	JP	PrnVScrBar
0019+  8633 C3 E6 99    	JP	InitProcess
0020+  8636 C3 45 9A    	JP	PrnProcess
0021+  8639 C9          	DEFS	15,#C9
0022+  8648 C3 0D 9B    	JP	ResFire
0023+  864B C3 1C 9B    	JP	TestCoords
0024+  864E C3 B5 9E    	JP	SetCMOSPrint
0025+  8651 C3 FF 9E    	JP	ResCMOSPrint
0026+  8654 C3 9C A0    	JP	SetClock
0027+  8657 C3 3C A1    	JP	SetMouse
0028+  865A C9          	DEFS	15,#C9
0029+  8669 C3 44 A4    	JP	MoveBytes
0030+  866C C3 71 A4    	JP	MoveBytesUp
0031+  866F C3 D3 A1    	JP	Mult8
0032+  8672 C3 E5 A1    	JP	Mult16X8
0033+  8675 C3 FB A1    	JP	Mult16
0034+  8678 C3 0F A2    	JP	Mult16X16
0035+  867B C3 34 A2    	JP	Mult32
0036+  867E C3 56 A2    	JP	Divis16X16
0037+  8681 C3 80 A2    	JP	Divis24X16
0038+  8684 C3 A3 A2    	JP	Divis32X16
0039+  8687 C3 B8 A2    	JP	Divis32
0040+  868A C3 E2 A2    	JP	ConvNumTxt32
0041+  868D C3 4C A3    	JP	ConvNumTxt16
0042+  8690 C3 78 A3    	JP	ConvNumTxt8
0043+  8693 C3 EB A3    	JP	ConvTxtNum32
0044+  8696 C3 23 A4    	JP	ConvTxtNum16
0045+  8699 C3 9A A4    	JP	Resident
0046+  869C C9          	DEFS	12,#C9
0047+  86A8             DOSError
0048+  86A8 08          	EX	AF,AF'
0049+  86A9 DB A2       	IN	A,(PAGE1)
0050+  86AB F5          	PUSH	AF
0051+  86AC 3A E7 A7    	LD	A,(FunctPg)
0052+  86AF D3 A2       	OUT	(PAGE1),A
0053+  86B1 08          	EX	AF,AF'
0054+  86B2 CD 95 69    	CALL	DOSErrorR
0055+  86B5 08          	EX	AF,AF'
0056+  86B6 F1          	POP	AF
0057+  86B7 D3 A2       	OUT	(PAGE1),A
0058+  86B9 08          	EX	AF,AF'
0059+  86BA C9          	RET 
0060+  86BB             ;[]----------------------------------------------------------[]
0061+  86BB             ;Процедура отчиски 0 экрана
0062+  86BB             ;На вход:  A - цвет отчистки (00-0Fh)
0063+  86BB             ClearScreen
0064+  86BB E6 0F       	AND	#0F
0065+  86BD 5F          	LD	E,A
0066+  86BE 07          	RLCA 
0067+  86BF 07          	RLCA 
0068+  86C0 07          	RLCA 
0069+  86C1 07          	RLCA 
0070+  86C2 B3          	OR	E
0071+  86C3 5F          	LD	E,A
0072+  86C4 DB 89       	IN	A,(YPORT)
0073+  86C6 4F          	LD	C,A
0074+  86C7 DB A2       	IN	A,(PAGE1)
0075+  86C9 47          	LD	B,A
0076+  86CA C5          	PUSH	BC
0077+  86CB 3E 50       	LD	A,#50
0078+  86CD D3 A2       	OUT	(PAGE1),A
0079+  86CF 21 00 40    	LD	HL,#4000
0080+  86D2 01 40 01    	LD	BC,320
0081+  86D5 F3          	DI 
0082+  86D6 D9          	EXX 
0083+  86D7 0E 83       	LD	C,#83
0084+  86D9 F7          	RST	#30
0085+  86DA D9          	EXX 
0086+  86DB 52          	LD	D,D
0087+  86DC 3E 00       	LD	A,#00
0088+  86DE 5B          InScrLp	LD	E,E
0089+  86DF 73          	LD	(HL),E
0090+  86E0 40          	LD	B,B
0091+  86E1 23          	INC	HL
0092+  86E2 0B          	DEC	BC
0093+  86E3 78          	LD	A,B
0094+  86E4 B1          	OR	C
0095+  86E5 20 F7       	JR	NZ,InScrLp
0096+  86E7 FB          	EI 
0097+  86E8 C1          	POP	BC
0098+  86E9 78          	LD	A,B
0099+  86EA D3 A2       	OUT	(PAGE1),A
0100+  86EC 79          	LD	A,C
0101+  86ED D3 89       	OUT	(YPORT),A
0102+  86EF C9          	RET 
0103+  86F0             
0104+  86F0             
0105+  86F0             
0059   86F0             	include "fnwin.z80"
0001+  86F0             
0002+  86F0             ;[]----------------------------------------------------------[]
0003+  86F0             ;    Процедура вывода окон на графический экран	640x256x16    ;
0004+  86F0             ;[]----------------------------------------------------------[]
0005+  86F0             MakeWindow
0006+  86F0 FD E3       	EX	(SP),IY
0007+  86F2 DD E5       	PUSH	IX
0008+  86F4 E5          	PUSH	HL
0009+  86F5 D5          	PUSH	DE
0010+  86F6 C5          	PUSH	BC
0011+  86F7 F5          	PUSH	AF
0012+  86F8 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0013+  86FA F5          	PUSH	AF
0014+  86FB FD 7E 00    	LD	A,(IY+#00)
0015+  86FE 32 F1 87    	LD	(WinType),A
0016+  8701 CB 7F       	BIT	7,A
0017+  8703 28 13       	JR	Z,MakeWin
0018+  8705 FD 23       	INC	IY
0019+  8707 21 00 00    	LD	HL,#0000
0020+  870A 22 E6 87    	LD	(WinPositX),HL
0021+  870D 22 E8 87    	LD	(WinPositY),HL
0022+  8710 22 EA 87    	LD	(WinLenX),HL
0023+  8713 22 EC 87    	LD	(WinLenY),HL
0024+  8716 18 7C       	JR	MakeWn1
0025+  8718 FE 7F       MakeWin	CP	#7F
0026+  871A 28 78       	JR	Z,MakeWn1
0027+  871C FD 6E 01    	LD	L,(IY+#01)	;Координата X
0028+  871F FD 66 02    	LD	H,(IY+#02)
0029+  8722 CB 3C       	SRL	H
0030+  8724 CB 1D       	RR	L
0031+  8726 22 E6 87    	LD	(WinPositX),HL
0032+  8729 FD 6E 03    	LD	L,(IY+#03)	;Координата Y
0033+  872C FD 66 04    	LD	H,(IY+#04)
0034+  872F 22 E8 87    	LD	(WinPositY),HL
0035+  8732 FD 6E 05    	LD	L,(IY+#05)	;Длина окна по X
0036+  8735 FD 66 06    	LD	H,(IY+#06)
0037+  8738 CB 3C       	SRL	H
0038+  873A CB 1D       	RR	L
0039+  873C 22 EA 87    	LD	(WinLenX),HL
0040+  873F FD 6E 07    	LD	L,(IY+#07)	;Длина окна по Y
0041+  8742 FD 66 08    	LD	H,(IY+#08)
0042+  8745 22 EC 87    	LD	(WinLenY),HL
0043+  8748 3A F1 87    	LD	A,(WinType)
0044+  874B 3D          	DEC	A
0045+  874C 20 37       	JR	NZ,MakeWn0
0046+  874E 21 F2 87    	LD	HL,WinBuffer
0047+  8751 3A F0 87    	LD	A,(EquipWin)
0048+  8754 87          	ADD	A,A
0049+  8755 4F          	LD	C,A
0050+  8756 87          	ADD	A,A
0051+  8757 87          	ADD	A,A
0052+  8758 81          	ADD	A,C
0053+  8759 85          	ADD	A,L
0054+  875A 6F          	LD	L,A
0055+  875B 30 01       	JR	NC,$+3
0056+  875D 24          	INC	H
0057+  875E ED 5B E6 87 	LD	DE,(WinPositX)
0058+  8762 73          	LD	(HL),E
0059+  8763 23          	INC	HL
0060+  8764 72          	LD	(HL),D
0061+  8765 23          	INC	HL
0062+  8766 ED 5B E8 87 	LD	DE,(WinPositY)
0063+  876A 73          	LD	(HL),E
0064+  876B 23          	INC	HL
0065+  876C 72          	LD	(HL),D
0066+  876D 23          	INC	HL
0067+  876E ED 5B EA 87 	LD	DE,(WinLenX)
0068+  8772 73          	LD	(HL),E
0069+  8773 23          	INC	HL
0070+  8774 72          	LD	(HL),D
0071+  8775 23          	INC	HL
0072+  8776 ED 5B EC 87 	LD	DE,(WinLenY)
0073+  877A 73          	LD	(HL),E
0074+  877B 23          	INC	HL
0075+  877C 72          	LD	(HL),D
0076+  877D 23          	INC	HL
0077+  877E ED 5B EE 87 	LD	DE,(WinFree)
0078+  8782 73          	LD	(HL),E
0079+  8783 23          	INC	HL
0080+  8784 72          	LD	(HL),D
0081+  8785 11 09 00    MakeWn0	LD	DE,#0009
0082+  8788 FD 19       	ADD	IY,DE		;Описатель на начало подоб'ектов
0083+  878A 3A F1 87    	LD	A,(WinType)
0084+  878D B7          	OR	A
0085+  878E C4 32 88    	CALL	NZ,SaveRect
0086+  8791 CD 4E 89    	CALL	PutRectan	;Чертим	прямоугольник окна
0087+  8794 21 94 87    MakeWn1	LD	HL,MakeWn1
0088+  8797 E5          	PUSH	HL
0089+  8798 FD 7E 00    	LD	A,(IY+#00)	;текущий подоб'ект окна
0090+  879B FD 23       	INC	IY
0091+  879D FE 01       	CP	#01		;текстовая строка
0092+  879F CA AE 89    	JP	Z,PutTxtLine
0093+  87A2 FE 02       	CP	#02		;место для заголовка
0094+  87A4 CA E0 89    	JP	Z,PutHeadPlc
0095+  87A7 FE 03       	CP	#03		;углубление в окне
0096+  87A9 CA 4D 8A    	JP	Z,PutDRectan
0097+  87AC FE 04       	CP	#04
0098+  87AE CA DA 8A    	JP	Z,PutURectan
0099+  87B1 FE 05       	CP	#05
0100+  87B3 CA 67 8B    	JP	Z,PutButton
0101+  87B6 FE 06       	CP	#06
0102+  87B8 CA 9D 8B    	JP	Z,PutHorizLine
0103+  87BB FE 07       	CP	#07
0104+  87BD CA FF 8B    	JP	Z,PutVertLine
0105+  87C0 FE 08       	CP	#08
0106+  87C2 CA 4C 8C    	JP	Z,PutSBleft
0107+  87C5 FE 09       	CP	#09
0108+  87C7 CA 51 8C    	JP	Z,PutSBright
0109+  87CA FE 0A       	CP	#0A
0110+  87CC CA 56 8C    	JP	Z,PutSBup
0111+  87CF FE 0B       	CP	#0B
0112+  87D1 CA 5B 8C    	JP	Z,PutSBdown
0113+  87D4 FE 7F       	CP	#7F
0114+  87D6 CA BC 88    	JP	Z,RestRect
0115+  87D9 E1          	POP	HL
0116+  87DA F1          	POP	AF
0117+  87DB D3 89       	OUT	(YPORT),A	;восст.	Y port
0118+  87DD F1          	POP	AF
0119+  87DE C1          	POP	BC
0120+  87DF D1          	POP	DE
0121+  87E0 E1          	POP	HL
0122+  87E1 DD E1       	POP	IX
0123+  87E3 FD E3       	EX	(SP),IY
0124+  87E5 C9          	RET 
0125+  87E6             ;--------------------------------------------------------------
0126+  87E6             ;Область данных	окна
0127+  87E6             WinPositX
0128+  87E6 00 00       	DEFW	#0000		;адрес X координаты окна
0129+  87E8             WinPositY
0130+  87E8 00 00       	DEFW	#0000		;Y координата окна
0131+  87EA             WinLenX
0132+  87EA 00 00       	DEFW	#0000		;длина окна X/2
0133+  87EC             WinLenY
0134+  87EC 00 00       	DEFW	#0000		;длина окна Y
0135+  87EE             
0136+  87EE             WinFree
0137+  87EE 00 00       	DEFW	#0000
0138+  87F0             EquipWin
0139+  87F0 00          	DEFB	#00		;Кол-во	открытых окон
0140+  87F1             WinType
0141+  87F1 00          	DEFB	#00
0142+  87F2             WinBuffer
0143+  87F2 00          	DEFS	#40,0
0144+  8832             ;--------------------------------------------------------------
0145+  8832             ;Процедура сохранения прямоугольной плоскости в	буфер
0146+  8832             SaveRect
0147+  8832 F3          	DI 
0148+  8833 0E 83       	LD	C,#83
0149+  8835 FD E5       	PUSH	IY
0150+  8837 F7          	RST	#30
0151+  8838 FD E1       	POP	IY
0152+  883A DB E2       	IN	A,(PAGE3)
0153+  883C F5          	PUSH	AF
0154+  883D DB A2       	IN	A,(PAGE1)
0155+  883F F5          	PUSH	AF
0156+  8840 3E 50       	LD	A,#50
0157+  8842 D3 A2       	OUT	(PAGE1),A
0158+  8844 2A EE 87    	LD	HL,(WinFree)
0159+  8847 7C          	LD	A,H
0160+  8848 E6 C0       	AND	#C0
0161+  884A 07          	RLCA 
0162+  884B 07          	RLCA 
0163+  884C D9          	EXX 
0164+  884D 21 F0 A7    	LD	HL,BuffPg1
0165+  8850 85          	ADD	A,L
0166+  8851 6F          	LD	L,A
0167+  8852 30 01       	JR	NC,$+3
0168+  8854 24          	INC	H
0169+  8855 7E          	LD	A,(HL)
0170+  8856 D3 E2       	OUT	(PAGE3),A
0171+  8858 D9          	EXX 
0172+  8859 7C          	LD	A,H
0173+  885A F6 C0       	OR	#C0
0174+  885C 67          	LD	H,A
0175+  885D             
0176+  885D ED 5B E6 87 	LD	DE,(WinPositX)
0177+  8861 CB F2       	SET	6,D
0178+  8863 3A E8 87    	LD	A,(WinPositY)
0179+  8866 DD 67       	LD	HX,A
0180+  8868 3A EC 87    	LD	A,(WinLenY)
0181+  886B DD 6F       	LD	LX,A
0182+  886D 32 72 88    	LD	(SavLen1+1),A
0183+  8870 52          	LD	D,D
0184+  8871 3E 00       SavLen1	LD	A,#00
0185+  8873 40          	LD	B,B
0186+  8874             
0187+  8874 ED 4B EA 87 	LD	BC,(WinLenX)
0188+  8878 C5          SavRect	PUSH	BC
0189+  8879 06 00       	LD	B,#00
0190+  887B DD 4D       	LD	C,LX
0191+  887D E5          	PUSH	HL
0192+  887E ED 4A       	ADC	HL,BC
0193+  8880 E1          	POP	HL
0194+  8881 28 02       	JR	Z,$+4
0195+  8883 30 09       	JR	NC,SavRec1
0196+  8885 21 00 C0    	LD	HL,#C000
0197+  8888 D9          	EXX 
0198+  8889 23          	INC	HL
0199+  888A 7E          	LD	A,(HL)
0200+  888B D3 E2       	OUT	(PAGE3),A
0201+  888D D9          	EXX 
0202+  888E DD 7C       SavRec1	LD	A,HX
0203+  8890 D3 89       	OUT	(YPORT),A
0204+  8892 7F          	LD	A,A
0205+  8893 1A          	LD	A,(DE)
0206+  8894 40          	LD	B,B
0207+  8895 6D          	LD	L,L
0208+  8896 77          	LD	(HL),A
0209+  8897 40          	LD	B,B
0210+  8898 09          	ADD	HL,BC
0211+  8899 C1          	POP	BC
0212+  889A 13          	INC	DE
0213+  889B 0B          	DEC	BC
0214+  889C 78          	LD	A,B
0215+  889D B1          	OR	C
0216+  889E 20 D8       	JR	NZ,SavRect
0217+  88A0 FB          	EI 
0218+  88A1 F1          	POP	AF
0219+  88A2 D3 A2       	OUT	(PAGE1),A
0220+  88A4 F1          	POP	AF
0221+  88A5 D3 E2       	OUT	(PAGE3),A
0222+  88A7 7C          	LD	A,H
0223+  88A8 E6 3F       	AND	#3F
0224+  88AA 67          	LD	H,A
0225+  88AB D9          	EXX 
0226+  88AC 7D          	LD	A,L
0227+  88AD D6 F0       	SUB	low BuffPg1
0228+  88AF D9          	EXX 
0229+  88B0 0F          	RRCA 
0230+  88B1 0F          	RRCA 
0231+  88B2 B4          	OR	H
0232+  88B3 67          	LD	H,A
0233+  88B4 22 EE 87    	LD	(WinFree),HL
0234+  88B7 21 F0 87    	LD	HL,EquipWin
0235+  88BA 34          	INC	(HL)
0236+  88BB C9          	RET 
0237+  88BC             ;[]----------------------------------------------------------[]
0238+  88BC             ;Процедура восстановления прямоугольной	плоскости
0239+  88BC             RestRect
0240+  88BC 21 F0 87    	LD	HL,EquipWin
0241+  88BF 7E          	LD	A,(HL)
0242+  88C0 B7          	OR	A
0243+  88C1 C8          	RET	Z
0244+  88C2 35          	DEC	(HL)
0245+  88C3 76          	HALT 
0246+  88C4 F3          	DI 
0247+  88C5 0E 83       	LD	C,#83
0248+  88C7 FD E5       	PUSH	IY
0249+  88C9 F7          	RST	#30
0250+  88CA FD E1       	POP	IY
0251+  88CC DB E2       	IN	A,(PAGE3)
0252+  88CE F5          	PUSH	AF
0253+  88CF DB A2       	IN	A,(PAGE1)
0254+  88D1 F5          	PUSH	AF
0255+  88D2 3E 50       	LD	A,#50
0256+  88D4 D3 A2       	OUT	(PAGE1),A
0257+  88D6 21 F2 87    	LD	HL,WinBuffer
0258+  88D9 3A F0 87    	LD	A,(EquipWin)
0259+  88DC 87          	ADD	A,A
0260+  88DD 4F          	LD	C,A
0261+  88DE 87          	ADD	A,A
0262+  88DF 87          	ADD	A,A
0263+  88E0 81          	ADD	A,C
0264+  88E1 85          	ADD	A,L
0265+  88E2 6F          	LD	L,A
0266+  88E3 30 01       	JR	NC,$+3
0267+  88E5 24          	INC	H
0268+  88E6 5E          	LD	E,(HL)
0269+  88E7 23          	INC	HL
0270+  88E8 56          	LD	D,(HL)
0271+  88E9 23          	INC	HL
0272+  88EA CB F2       	SET	6,D
0273+  88EC 7E          	LD	A,(HL)
0274+  88ED 23          	INC	HL
0275+  88EE 23          	INC	HL
0276+  88EF DD 67       	LD	HX,A
0277+  88F1 4E          	LD	C,(HL)
0278+  88F2 23          	INC	HL
0279+  88F3 46          	LD	B,(HL)
0280+  88F4 23          	INC	HL
0281+  88F5 7E          	LD	A,(HL)
0282+  88F6 23          	INC	HL
0283+  88F7 23          	INC	HL
0284+  88F8 32 1C 89    	LD	(RstLen1+1),A
0285+  88FB DD 6F       	LD	LX,A
0286+  88FD 7E          	LD	A,(HL)
0287+  88FE 23          	INC	HL
0288+  88FF 66          	LD	H,(HL)
0289+  8900 6F          	LD	L,A
0290+  8901 22 EE 87    	LD	(WinFree),HL
0291+  8904 7C          	LD	A,H
0292+  8905 E6 C0       	AND	#C0
0293+  8907 07          	RLCA 
0294+  8908 07          	RLCA 
0295+  8909 D9          	EXX 
0296+  890A 21 F0 A7    	LD	HL,BuffPg1
0297+  890D 85          	ADD	A,L
0298+  890E 6F          	LD	L,A
0299+  890F 30 01       	JR	NC,$+3
0300+  8911 24          	INC	H
0301+  8912 7E          	LD	A,(HL)
0302+  8913 D3 E2       	OUT	(PAGE3),A
0303+  8915 D9          	EXX 
0304+  8916 7C          	LD	A,H
0305+  8917 F6 C0       	OR	#C0
0306+  8919 67          	LD	H,A
0307+  891A             
0308+  891A 52          	LD	D,D
0309+  891B 3E 00       RstLen1	LD	A,#00
0310+  891D 40          	LD	B,B
0311+  891E             
0312+  891E C5          RstRect	PUSH	BC
0313+  891F 06 00       	LD	B,#00
0314+  8921 DD 4D       	LD	C,LX
0315+  8923 E5          	PUSH	HL
0316+  8924 ED 4A       	ADC	HL,BC
0317+  8926 E1          	POP	HL
0318+  8927 28 02       	JR	Z,$+4
0319+  8929 30 09       	JR	NC,RstRec1
0320+  892B 21 00 C0    	LD	HL,#C000
0321+  892E D9          	EXX 
0322+  892F 23          	INC	HL
0323+  8930 7E          	LD	A,(HL)
0324+  8931 D3 E2       	OUT	(PAGE3),A
0325+  8933 D9          	EXX 
0326+  8934 6D          RstRec1	LD	L,L
0327+  8935 7E          	LD	A,(HL)
0328+  8936 40          	LD	B,B
0329+  8937 DD 7C       	LD	A,HX
0330+  8939 D3 89       	OUT	(YPORT),A
0331+  893B 7F          	LD	A,A
0332+  893C 12          	LD	(DE),A
0333+  893D 40          	LD	B,B
0334+  893E 09          	ADD	HL,BC
0335+  893F C1          	POP	BC
0336+  8940 13          	INC	DE
0337+  8941 0B          	DEC	BC
0338+  8942 78          	LD	A,B
0339+  8943 B1          	OR	C
0340+  8944 20 D8       	JR	NZ,RstRect
0341+  8946 FB          	EI 
0342+  8947 F1          	POP	AF
0343+  8948 D3 A2       	OUT	(PAGE1),A
0344+  894A F1          	POP	AF
0345+  894B D3 E2       	OUT	(PAGE3),A
0346+  894D C9          	RET 
0347+  894E             ;[]==========================================================[]
0348+  894E             ;Процедура черчения прямоугольной площади окна
0349+  894E             PutRectan
0350+  894E 76          	HALT 
0351+  894F F3          	DI 
0352+  8950 0E 83       	LD	C,#83
0353+  8952 FD E5       	PUSH	IY
0354+  8954 F7          	RST	#30
0355+  8955 FD E1       	POP	IY
0356+  8957 DB A2       	IN	A,(PAGE1)
0357+  8959 F5          	PUSH	AF
0358+  895A 3E 50       	LD	A,#50
0359+  895C D3 A2       	OUT	(PAGE1),A
0360+  895E 2A E6 87    	LD	HL,(WinPositX)	;поз. окна
0361+  8961 CB F4       	SET	6,H
0362+  8963 3A EC 87    	LD	A,(WinLenY)	;длина окна -(подсветка+тень)
0363+  8966 D6 02       	SUB	#02
0364+  8968 32 7F 89    	LD	(TmpLen1+1),A
0365+  896B 3A E8 87    	LD	A,(WinPositY)
0366+  896E 57          	LD	D,A
0367+  896F D3 89       	OUT	(YPORT),A
0368+  8971 1E FF       	LD	E,#FF
0369+  8973 73          	LD	(HL),E
0370+  8974 3C          	INC	A
0371+  8975 D3 89       	OUT	(YPORT),A
0372+  8977 ED 4B EA 87 	LD	BC,(WinLenX)
0373+  897B 0B          	DEC	BC
0374+  897C 0B          	DEC	BC
0375+  897D 52          	LD	D,D
0376+  897E 3E 00       TmpLen1	LD	A,#00
0377+  8980 5B          	LD	E,E
0378+  8981 73          	LD	(HL),E
0379+  8982 40          	LD	B,B
0380+  8983 36 F7       	LD	(HL),#F7
0381+  8985 23          	INC	HL
0382+  8986 1E 88       	LD	E,#88
0383+  8988 7A          PtRect1	LD	A,D
0384+  8989 D3 89       	OUT	(YPORT),A
0385+  898B 36 FF       	LD	(HL),#FF
0386+  898D 3C          	INC	A
0387+  898E D3 89       	OUT	(YPORT),A
0388+  8990 5B          	LD	E,E
0389+  8991 73          	LD	(HL),E
0390+  8992 40          	LD	B,B
0391+  8993 36 77       	LD	(HL),#77
0392+  8995 23          	INC	HL
0393+  8996 0B          	DEC	BC
0394+  8997 78          	LD	A,B
0395+  8998 B1          	OR	C
0396+  8999 20 ED       	JR	NZ,PtRect1
0397+  899B 7A          	LD	A,D
0398+  899C D3 89       	OUT	(YPORT),A
0399+  899E 36 F7       	LD	(HL),#F7
0400+  89A0 3C          	INC	A
0401+  89A1 D3 89       	OUT	(YPORT),A
0402+  89A3 1E 77       	LD	E,#77
0403+  89A5 5B          	LD	E,E
0404+  89A6 73          	LD	(HL),E
0405+  89A7 40          	LD	B,B
0406+  89A8 73          	LD	(HL),E
0407+  89A9 FB          	EI 
0408+  89AA F1          	POP	AF
0409+  89AB D3 A2       	OUT	(PAGE1),A
0410+  89AD C9          	RET 
0411+  89AE             ;[]===========================================================[]
0412+  89AE             PutTxtLine
0413+  89AE 2A E6 87    	LD	HL,(WinPositX)
0414+  89B1 CB 25       	SLA	L
0415+  89B3 CB 14       	RL	H
0416+  89B5 FD 5E 00    	LD	E,(IY+#00)	;Xpos
0417+  89B8 FD 23       	INC	IY
0418+  89BA FD 56 00    	LD	D,(IY+#00)
0419+  89BD FD 23       	INC	IY
0420+  89BF 19          	ADD	HL,DE
0421+  89C0 EB          	EX	DE,HL
0422+  89C1 2A E8 87    	LD	HL,(WinPositY)
0423+  89C4 FD 4E 00    	LD	C,(IY+#00)	;Ypos
0424+  89C7 FD 23       	INC	IY
0425+  89C9 FD 46 00    	LD	B,(IY+#00)
0426+  89CC FD 23       	INC	IY
0427+  89CE 09          	ADD	HL,BC
0428+  89CF 4D          	LD	C,L
0429+  89D0 44          	LD	B,H
0430+  89D1 FD 7E 00    	LD	A,(IY+#00)	;Color
0431+  89D4 FD 23       	INC	IY
0432+  89D6 FD E5       	PUSH	IY
0433+  89D8 E1          	POP	HL
0434+  89D9 CD B3 8F    	CALL	PrnTxtLnIFF
0435+  89DC E5          	PUSH	HL
0436+  89DD FD E1       	POP	IY
0437+  89DF C9          	RET 
0438+  89E0             ;[]===========================================================[]
0439+  89E0             PutHeadPlc
0440+  89E0 F3          	DI 
0441+  89E1 0E 83       	LD	C,#83
0442+  89E3 FD E5       	PUSH	IY
0443+  89E5 F7          	RST	#30
0444+  89E6 FD E1       	POP	IY
0445+  89E8 2A E6 87    	LD	HL,(WinPositX)
0446+  89EB CB F4       	SET	6,H
0447+  89ED FD 4E 00    	LD	C,(IY+#00)
0448+  89F0 FD 23       	INC	IY
0449+  89F2 FD 46 00    	LD	B,(IY+#00)
0450+  89F5 FD 23       	INC	IY
0451+  89F7 CB 38       	SRL	B
0452+  89F9 CB 19       	RR	C
0453+  89FB 09          	ADD	HL,BC
0454+  89FC FD 4E 00    	LD	C,(IY+#00)
0455+  89FF FD 23       	INC	IY
0456+  8A01 FD 23       	INC	IY
0457+  8A03 3A E8 87    	LD	A,(WinPositY)
0458+  8A06 81          	ADD	A,C
0459+  8A07 DD 6F       	LD	LX,A
0460+  8A09 FD 4E 00    	LD	C,(IY+#00)
0461+  8A0C FD 23       	INC	IY
0462+  8A0E FD 46 00    	LD	B,(IY+#00)
0463+  8A11 FD 23       	INC	IY
0464+  8A13 CB 38       	SRL	B
0465+  8A15 CB 19       	RR	C
0466+  8A17 FD 7E 00    	LD	A,(IY+#00)
0467+  8A1A FD 23       	INC	IY
0468+  8A1C FD 23       	INC	IY
0469+  8A1E 32 39 8A    	LD	(TmpLen2+1),A
0470+  8A21 FD 7E 00    	LD	A,(IY+#00)
0471+  8A24 E6 0F       	AND	#0F
0472+  8A26 07          	RLCA 
0473+  8A27 07          	RLCA 
0474+  8A28 07          	RLCA 
0475+  8A29 07          	RLCA 
0476+  8A2A FD B6 00    	OR	(IY+#00)
0477+  8A2D 57          	LD	D,A
0478+  8A2E FD 23       	INC	IY
0479+  8A30 DB A2       	IN	A,(PAGE1)
0480+  8A32 F5          	PUSH	AF
0481+  8A33 3E 50       	LD	A,#50
0482+  8A35 D3 A2       	OUT	(PAGE1),A
0483+  8A37 52          	LD	D,D
0484+  8A38 3E 00       TmpLen2	LD	A,#00
0485+  8A3A 40          	LD	B,B
0486+  8A3B DD 7D       PtHead1	LD	A,LX
0487+  8A3D D3 89       	OUT	(YPORT),A
0488+  8A3F 5B          	LD	E,E
0489+  8A40 72          	LD	(HL),D
0490+  8A41 40          	LD	B,B
0491+  8A42 23          	INC	HL
0492+  8A43 0B          	DEC	BC
0493+  8A44 78          	LD	A,B
0494+  8A45 B1          	OR	C
0495+  8A46 20 F3       	JR	NZ,PtHead1
0496+  8A48 FB          	EI 
0497+  8A49 F1          	POP	AF
0498+  8A4A D3 A2       	OUT	(PAGE1),A
0499+  8A4C C9          	RET 
0500+  8A4D             ;[]===========================================================[]
0501+  8A4D             PutDRectan
0502+  8A4D 2A E6 87    	LD	HL,(WinPositX)
0503+  8A50 CB F4       	SET	6,H
0504+  8A52 FD 4E 00    	LD	C,(IY+#00)
0505+  8A55 FD 23       	INC	IY
0506+  8A57 FD 46 00    	LD	B,(IY+#00)
0507+  8A5A FD 23       	INC	IY
0508+  8A5C CB 38       	SRL	B
0509+  8A5E CB 19       	RR	C
0510+  8A60 09          	ADD	HL,BC
0511+  8A61 FD 4E 00    	LD	C,(IY+#00)
0512+  8A64 FD 23       	INC	IY
0513+  8A66 FD 23       	INC	IY
0514+  8A68 3A E8 87    	LD	A,(WinPositY)
0515+  8A6B 81          	ADD	A,C
0516+  8A6C DD 6F       	LD	LX,A
0517+  8A6E FD 4E 00    	LD	C,(IY+#00)
0518+  8A71 FD 23       	INC	IY
0519+  8A73 FD 46 00    	LD	B,(IY+#00)
0520+  8A76 FD 23       	INC	IY
0521+  8A78 CB 38       	SRL	B
0522+  8A7A CB 19       	RR	C
0523+  8A7C 0B          	DEC	BC
0524+  8A7D 79          	LD	A,C
0525+  8A7E 3D          	DEC	A
0526+  8A7F 32 C8 8A    	LD	(TmpLen4+1),A
0527+  8A82 FD 7E 00    	LD	A,(IY+#00)
0528+  8A85 FD 23       	INC	IY
0529+  8A87 FD 23       	INC	IY
0530+  8A89 D6 02       	SUB	#02
0531+  8A8B 32 9D 8A    	LD	(TmpLen3+1),A
0532+  8A8E DD 85       	ADD	A,LX
0533+  8A90 3C          	INC	A
0534+  8A91 DD 67       	LD	HX,A
0535+  8A93 DB A2       	IN	A,(PAGE1)
0536+  8A95 F5          	PUSH	AF
0537+  8A96 3E 50       	LD	A,#50
0538+  8A98 D3 A2       	OUT	(PAGE1),A
0539+  8A9A F3          	DI 
0540+  8A9B 52          	LD	D,D
0541+  8A9C 3E 00       TmpLen3	LD	A,#00
0542+  8A9E 40          	LD	B,B
0543+  8A9F DD 7D       	LD	A,LX
0544+  8AA1 D3 89       	OUT	(YPORT),A
0545+  8AA3 1E 77       	LD	E,#77
0546+  8AA5 73          	LD	(HL),E
0547+  8AA6 3C          	INC	A
0548+  8AA7 D3 89       	OUT	(YPORT),A
0549+  8AA9 5B          	LD	E,E
0550+  8AAA 73          	LD	(HL),E
0551+  8AAB 40          	LD	B,B
0552+  8AAC 36 7F       	LD	(HL),#7F
0553+  8AAE E5          	PUSH	HL
0554+  8AAF 09          	ADD	HL,BC
0555+  8AB0 DD 7D       	LD	A,LX
0556+  8AB2 D3 89       	OUT	(YPORT),A
0557+  8AB4 1E FF       	LD	E,#FF
0558+  8AB6 73          	LD	(HL),E
0559+  8AB7 3C          	INC	A
0560+  8AB8 D3 89       	OUT	(YPORT),A
0561+  8ABA 5B          	LD	E,E
0562+  8ABB 73          	LD	(HL),E
0563+  8ABC 40          	LD	B,B
0564+  8ABD 73          	LD	(HL),E
0565+  8ABE E1          	POP	HL
0566+  8ABF 23          	INC	HL
0567+  8AC0 DD 7D       	LD	A,LX
0568+  8AC2 D3 89       	OUT	(YPORT),A
0569+  8AC4 1E 77       	LD	E,#77
0570+  8AC6 52          	LD	D,D
0571+  8AC7 3E 00       TmpLen4	LD	A,#00
0572+  8AC9 49          	LD	C,C
0573+  8ACA 73          	LD	(HL),E
0574+  8ACB 40          	LD	B,B
0575+  8ACC DD 7C       	LD	A,HX
0576+  8ACE D3 89       	OUT	(YPORT),A
0577+  8AD0 1E FF       	LD	E,#FF
0578+  8AD2 49          	LD	C,C
0579+  8AD3 73          	LD	(HL),E
0580+  8AD4 40          	LD	B,B
0581+  8AD5 FB          	EI 
0582+  8AD6 F1          	POP	AF
0583+  8AD7 D3 A2       	OUT	(PAGE1),A
0584+  8AD9 C9          	RET 
0585+  8ADA             ;[]===========================================================[]
0586+  8ADA             PutURectan
0587+  8ADA 2A E6 87    	LD	HL,(WinPositX)
0588+  8ADD CB F4       	SET	6,H
0589+  8ADF FD 4E 00    	LD	C,(IY+#00)
0590+  8AE2 FD 23       	INC	IY
0591+  8AE4 FD 46 00    	LD	B,(IY+#00)
0592+  8AE7 FD 23       	INC	IY
0593+  8AE9 CB 38       	SRL	B
0594+  8AEB CB 19       	RR	C
0595+  8AED 09          	ADD	HL,BC
0596+  8AEE FD 4E 00    	LD	C,(IY+#00)
0597+  8AF1 FD 23       	INC	IY
0598+  8AF3 FD 23       	INC	IY
0599+  8AF5 3A E8 87    	LD	A,(WinPositY)
0600+  8AF8 81          	ADD	A,C
0601+  8AF9 DD 6F       	LD	LX,A
0602+  8AFB FD 4E 00    	LD	C,(IY+#00)
0603+  8AFE FD 23       	INC	IY
0604+  8B00 FD 46 00    	LD	B,(IY+#00)
0605+  8B03 FD 23       	INC	IY
0606+  8B05 CB 38       	SRL	B
0607+  8B07 CB 19       	RR	C
0608+  8B09 0B          	DEC	BC
0609+  8B0A 79          	LD	A,C
0610+  8B0B 3D          	DEC	A
0611+  8B0C 32 55 8B    	LD	(TmpLen6+1),A
0612+  8B0F FD 7E 00    	LD	A,(IY+#00)
0613+  8B12 FD 23       	INC	IY
0614+  8B14 FD 23       	INC	IY
0615+  8B16 D6 02       	SUB	#02
0616+  8B18 32 2A 8B    	LD	(TmpLen5+1),A
0617+  8B1B DD 85       	ADD	A,LX
0618+  8B1D 3C          	INC	A
0619+  8B1E DD 67       	LD	HX,A
0620+  8B20 DB A2       	IN	A,(PAGE1)
0621+  8B22 F5          	PUSH	AF
0622+  8B23 3E 50       	LD	A,#50
0623+  8B25 D3 A2       	OUT	(PAGE1),A
0624+  8B27 F3          	DI 
0625+  8B28 52          	LD	D,D
0626+  8B29 3E 00       TmpLen5	LD	A,#00
0627+  8B2B 40          	LD	B,B
0628+  8B2C DD 7D       	LD	A,LX
0629+  8B2E D3 89       	OUT	(YPORT),A
0630+  8B30 1E FF       	LD	E,#FF
0631+  8B32 73          	LD	(HL),E
0632+  8B33 3C          	INC	A
0633+  8B34 D3 89       	OUT	(YPORT),A
0634+  8B36 5B          	LD	E,E
0635+  8B37 73          	LD	(HL),E
0636+  8B38 40          	LD	B,B
0637+  8B39 36 F7       	LD	(HL),#F7
0638+  8B3B E5          	PUSH	HL
0639+  8B3C 09          	ADD	HL,BC
0640+  8B3D DD 7D       	LD	A,LX
0641+  8B3F D3 89       	OUT	(YPORT),A
0642+  8B41 1E 77       	LD	E,#77
0643+  8B43 73          	LD	(HL),E
0644+  8B44 3C          	INC	A
0645+  8B45 D3 89       	OUT	(YPORT),A
0646+  8B47 5B          	LD	E,E
0647+  8B48 73          	LD	(HL),E
0648+  8B49 40          	LD	B,B
0649+  8B4A 73          	LD	(HL),E
0650+  8B4B E1          	POP	HL
0651+  8B4C 23          	INC	HL
0652+  8B4D DD 7D       	LD	A,LX
0653+  8B4F D3 89       	OUT	(YPORT),A
0654+  8B51 1E FF       	LD	E,#FF
0655+  8B53 52          	LD	D,D
0656+  8B54 3E 00       TmpLen6	LD	A,#00
0657+  8B56 49          	LD	C,C
0658+  8B57 73          	LD	(HL),E
0659+  8B58 40          	LD	B,B
0660+  8B59 DD 7C       	LD	A,HX
0661+  8B5B D3 89       	OUT	(YPORT),A
0662+  8B5D 1E 77       	LD	E,#77
0663+  8B5F 49          	LD	C,C
0664+  8B60 73          	LD	(HL),E
0665+  8B61 40          	LD	B,B
0666+  8B62 FB          	EI 
0667+  8B63 F1          	POP	AF
0668+  8B64 D3 A2       	OUT	(PAGE1),A
0669+  8B66 C9          	RET 
0670+  8B67             ;[]===========================================================[]
0671+  8B67             PutButton
0672+  8B67 2A E6 87    	LD	HL,(WinPositX)
0673+  8B6A CB 25       	SLA	L
0674+  8B6C CB 14       	RL	H
0675+  8B6E FD 5E 00    	LD	E,(IY+#00)	;Xpos
0676+  8B71 FD 56 01    	LD	D,(IY+#01)
0677+  8B74 19          	ADD	HL,DE
0678+  8B75 23          	INC	HL
0679+  8B76 23          	INC	HL
0680+  8B77 23          	INC	HL
0681+  8B78 23          	INC	HL
0682+  8B79 EB          	EX	DE,HL
0683+  8B7A 2A E8 87    	LD	HL,(WinPositY)
0684+  8B7D FD 4E 02    	LD	C,(IY+#02)	;Ypos
0685+  8B80 FD 46 03    	LD	B,(IY+#03)
0686+  8B83 09          	ADD	HL,BC
0687+  8B84 23          	INC	HL
0688+  8B85 4D          	LD	C,L
0689+  8B86 44          	LD	B,H
0690+  8B87 D5          	PUSH	DE
0691+  8B88 C5          	PUSH	BC
0692+  8B89 CD DA 8A    	CALL	PutURectan
0693+  8B8C C1          	POP	BC
0694+  8B8D D1          	POP	DE
0695+  8B8E FD 7E 00    	LD	A,(IY+#00)	;Color
0696+  8B91 FD 23       	INC	IY
0697+  8B93 FD E5       	PUSH	IY
0698+  8B95 E1          	POP	HL
0699+  8B96 CD B3 8F    	CALL	PrnTxtLnIFF
0700+  8B99 E5          	PUSH	HL
0701+  8B9A FD E1       	POP	IY
0702+  8B9C C9          	RET 
0703+  8B9D             ;[]===========================================================[]
0704+  8B9D             PutHorizLine
0705+  8B9D 2A E6 87    	LD	HL,(WinPositX)
0706+  8BA0 CB F4       	SET	6,H
0707+  8BA2 FD 4E 00    	LD	C,(IY+#00)
0708+  8BA5 FD 23       	INC	IY
0709+  8BA7 FD 46 00    	LD	B,(IY+#00)
0710+  8BAA FD 23       	INC	IY
0711+  8BAC CB 38       	SRL	B
0712+  8BAE CB 19       	RR	C
0713+  8BB0 09          	ADD	HL,BC
0714+  8BB1 FD 4E 00    	LD	C,(IY+#00)
0715+  8BB4 FD 23       	INC	IY
0716+  8BB6 FD 23       	INC	IY
0717+  8BB8 3A E8 87    	LD	A,(WinPositY)
0718+  8BBB 81          	ADD	A,C
0719+  8BBC DD 6F       	LD	LX,A
0720+  8BBE FD 4E 00    	LD	C,(IY+#00)
0721+  8BC1 FD 23       	INC	IY
0722+  8BC3 FD 46 00    	LD	B,(IY+#00)
0723+  8BC6 FD 23       	INC	IY
0724+  8BC8 CB 38       	SRL	B
0725+  8BCA CB 19       	RR	C
0726+  8BCC 1E 77       	LD	E,#77
0727+  8BCE E5          	PUSH	HL
0728+  8BCF CD D7 8B    	CALL	HorizLn
0729+  8BD2 E1          	POP	HL
0730+  8BD3 DD 2C       	INC	LX
0731+  8BD5 1E FF       	LD	E,#FF
0732+  8BD7 F3          HorizLn	DI 
0733+  8BD8 DB A2       	IN	A,(PAGE1)
0734+  8BDA F5          	PUSH	AF
0735+  8BDB 3E 50       	LD	A,#50
0736+  8BDD D3 A2       	OUT	(PAGE1),A
0737+  8BDF DD 7D       	LD	A,LX
0738+  8BE1 D3 89       	OUT	(YPORT),A
0739+  8BE3 78          	LD	A,B
0740+  8BE4 B7          	OR	A
0741+  8BE5 28 08       	JR	Z,HorLn1
0742+  8BE7 52          	LD	D,D
0743+  8BE8 3E 00       TmpLen7	LD	A,#00
0744+  8BEA 40          	LD	B,B
0745+  8BEB 49          	LD	C,C
0746+  8BEC 73          	LD	(HL),E
0747+  8BED 40          	LD	B,B
0748+  8BEE 24          	INC	H
0749+  8BEF 79          HorLn1	LD	A,C
0750+  8BF0 32 F5 8B    	LD	(TmpLen8+1),A
0751+  8BF3 52          	LD	D,D
0752+  8BF4 3E 00       TmpLen8	LD	A,#00
0753+  8BF6 40          	LD	B,B
0754+  8BF7 49          	LD	C,C
0755+  8BF8 73          	LD	(HL),E
0756+  8BF9 40          	LD	B,B
0757+  8BFA FB          	EI 
0758+  8BFB F1          	POP	AF
0759+  8BFC D3 A2       	OUT	(PAGE1),A
0760+  8BFE C9          	RET 
0761+  8BFF             ;[]===========================================================[]
0762+  8BFF             PutVertLine
0763+  8BFF 2A E6 87    	LD	HL,(WinPositX)
0764+  8C02 CB F4       	SET	6,H
0765+  8C04 FD 4E 00    	LD	C,(IY+#00)
0766+  8C07 FD 23       	INC	IY
0767+  8C09 FD 46 00    	LD	B,(IY+#00)
0768+  8C0C FD 23       	INC	IY
0769+  8C0E CB 38       	SRL	B
0770+  8C10 CB 19       	RR	C
0771+  8C12 09          	ADD	HL,BC
0772+  8C13 FD 4E 00    	LD	C,(IY+#00)
0773+  8C16 FD 23       	INC	IY
0774+  8C18 FD 23       	INC	IY
0775+  8C1A 3A E8 87    	LD	A,(WinPositY)
0776+  8C1D 81          	ADD	A,C
0777+  8C1E DD 6F       	LD	LX,A
0778+  8C20 FD 7E 00    	LD	A,(IY+#00)
0779+  8C23 FD 23       	INC	IY
0780+  8C25 FD 23       	INC	IY
0781+  8C27 32 3B 8C    	LD	(TmpLen9+1),A
0782+  8C2A DB A2       	IN	A,(PAGE1)
0783+  8C2C F5          	PUSH	AF
0784+  8C2D 3E 50       	LD	A,#50
0785+  8C2F D3 A2       	OUT	(PAGE1),A
0786+  8C31 F3          	DI 
0787+  8C32 11 FF 77    	LD	DE,#77FF
0788+  8C35 DD 7D       	LD	A,LX
0789+  8C37 D3 89       	OUT	(YPORT),A
0790+  8C39 52          	LD	D,D
0791+  8C3A 3E 00       TmpLen9	LD	A,#00
0792+  8C3C 5B          	LD	E,E
0793+  8C3D 72          	LD	(HL),D
0794+  8C3E 40          	LD	B,B
0795+  8C3F 23          	INC	HL
0796+  8C40 DD 7D       	LD	A,LX
0797+  8C42 D3 89       	OUT	(YPORT),A
0798+  8C44 5B          	LD	E,E
0799+  8C45 73          	LD	(HL),E
0800+  8C46 40          	LD	B,B
0801+  8C47 FB          	EI 
0802+  8C48 F1          	POP	AF
0803+  8C49 D3 A2       	OUT	(PAGE1),A
0804+  8C4B C9          	RET 
0805+  8C4C             ;[]===========================================================[]
0806+  8C4C             PutSBleft
0807+  8C4C 21 A3 8C    	LD	HL,SBleft
0808+  8C4F 18 0D       	JR	PutSButton
0809+  8C51             PutSBright
0810+  8C51 21 E3 8C    	LD	HL,SBright
0811+  8C54 18 08       	JR	PutSButton
0812+  8C56             PutSBup
0813+  8C56 21 23 8D    	LD	HL,SBup
0814+  8C59 18 03       	JR	PutSButton
0815+  8C5B             PutSBdown
0816+  8C5B 21 63 8D    	LD	HL,SBdown
0817+  8C5E             PutSButton
0818+  8C5E EB          	EX	DE,HL
0819+  8C5F 2A E6 87    	LD	HL,(WinPositX)
0820+  8C62 CB F4       	SET	6,H
0821+  8C64 FD 4E 00    	LD	C,(IY+#00)
0822+  8C67 FD 23       	INC	IY
0823+  8C69 FD 46 00    	LD	B,(IY+#00)
0824+  8C6C FD 23       	INC	IY
0825+  8C6E CB 38       	SRL	B
0826+  8C70 CB 19       	RR	C
0827+  8C72 09          	ADD	HL,BC
0828+  8C73 EB          	EX	DE,HL
0829+  8C74 FD 4E 00    	LD	C,(IY+#00)
0830+  8C77 FD 23       	INC	IY
0831+  8C79 FD 23       	INC	IY
0832+  8C7B 3A E8 87    	LD	A,(WinPositY)
0833+  8C7E 81          	ADD	A,C
0834+  8C7F 4F          	LD	C,A
0835+  8C80 DB A2       	IN	A,(PAGE1)
0836+  8C82 F5          	PUSH	AF
0837+  8C83 3E 50       	LD	A,#50
0838+  8C85 D3 A2       	OUT	(PAGE1),A
0839+  8C87 F3          	DI 
0840+  8C88 52          	LD	D,D
0841+  8C89 3E 08       	LD	A,#08
0842+  8C8B 40          	LD	B,B
0843+  8C8C 06 08       	LD	B,#08
0844+  8C8E C5          PutSBlp	PUSH	BC
0845+  8C8F 79          	LD	A,C
0846+  8C90 D3 89       	OUT	(YPORT),A
0847+  8C92 6D          	LD	L,L
0848+  8C93 7E          	LD	A,(HL)
0849+  8C94 12          	LD	(DE),A
0850+  8C95 40          	LD	B,B
0851+  8C96 01 08 00    	LD	BC,#0008
0852+  8C99 09          	ADD	HL,BC
0853+  8C9A C1          	POP	BC
0854+  8C9B 0C          	INC	C
0855+  8C9C 10 F0       	DJNZ	PutSBlp
0856+  8C9E FB          	EI 
0857+  8C9F F1          	POP	AF
0858+  8CA0 D3 A2       	OUT	(PAGE1),A
0859+  8CA2 C9          	RET 
0860+  8CA3             
0861+  8CA3             SBleft	DEFB	#FF,#FF,#FF,#FF,#FF,#FF,#FF,#77
0861+  8CA3 FFFFFFFFFFFFFF77
0862+  8CAB             	DEFB	#FF,#88,#88,#88,#08,#88,#88,#77
0862+  8CAB FF88888808888877
0863+  8CB3             	DEFB	#FF,#88,#88,#80,#08,#88,#88,#77
0863+  8CB3 FF88888008888877
0864+  8CBB             	DEFB	#FF,#88,#88,#00,#08,#88,#88,#77
0864+  8CBB FF88880008888877
0865+  8CC3             	DEFB	#FF,#88,#88,#00,#08,#88,#88,#77
0865+  8CC3 FF88880008888877
0866+  8CCB             	DEFB	#FF,#88,#88,#80,#08,#88,#88,#77
0866+  8CCB FF88888008888877
0867+  8CD3             	DEFB	#FF,#88,#88,#88,#08,#88,#88,#77
0867+  8CD3 FF88888808888877
0868+  8CDB             	DEFB	#FF,#77,#77,#77,#77,#77,#77,#77
0868+  8CDB FF77777777777777
0869+  8CE3             
0870+  8CE3             SBright	DEFB	#FF,#FF,#FF,#FF,#FF,#FF,#FF,#77
0870+  8CE3 FFFFFFFFFFFFFF77
0871+  8CEB             	DEFB	#FF,#88,#88,#08,#88,#88,#88,#77
0871+  8CEB FF88880888888877
0872+  8CF3             	DEFB	#FF,#88,#88,#00,#88,#88,#88,#77
0872+  8CF3 FF88880088888877
0873+  8CFB             	DEFB	#FF,#88,#88,#00,#08,#88,#88,#77
0873+  8CFB FF88880008888877
0874+  8D03             	DEFB	#FF,#88,#88,#00,#08,#88,#88,#77
0874+  8D03 FF88880008888877
0875+  8D0B             	DEFB	#FF,#88,#88,#00,#88,#88,#88,#77
0875+  8D0B FF88880088888877
0876+  8D13             	DEFB	#FF,#88,#88,#08,#88,#88,#88,#77
0876+  8D13 FF88880888888877
0877+  8D1B             	DEFB	#FF,#77,#77,#77,#77,#77,#77,#77
0877+  8D1B FF77777777777777
0878+  8D23             
0879+  8D23             SBup	DEFB	#FF,#FF,#FF,#FF,#FF,#FF,#FF,#77
0879+  8D23 FFFFFFFFFFFFFF77
0880+  8D2B             	DEFB	#FF,#88,#88,#88,#88,#88,#88,#77
0880+  8D2B FF88888888888877
0881+  8D33             	DEFB	#FF,#88,#88,#80,#08,#88,#88,#77
0881+  8D33 FF88888008888877
0882+  8D3B             	DEFB	#FF,#88,#88,#00,#00,#88,#88,#77
0882+  8D3B FF88880000888877
0883+  8D43             	DEFB	#FF,#88,#00,#00,#00,#00,#88,#77
0883+  8D43 FF88000000008877
0884+  8D4B             	DEFB	#FF,#88,#88,#88,#88,#88,#88,#77
0884+  8D4B FF88888888888877
0885+  8D53             	DEFB	#FF,#88,#88,#88,#88,#88,#88,#77
0885+  8D53 FF88888888888877
0886+  8D5B             	DEFB	#FF,#77,#77,#77,#77,#77,#77,#77
0886+  8D5B FF77777777777777
0887+  8D63             
0888+  8D63             SBdown	DEFB	#FF,#FF,#FF,#FF,#FF,#FF,#FF,#77
0888+  8D63 FFFFFFFFFFFFFF77
0889+  8D6B             	DEFB	#FF,#88,#88,#88,#88,#88,#88,#77
0889+  8D6B FF88888888888877
0890+  8D73             	DEFB	#FF,#88,#88,#88,#88,#88,#88,#77
0890+  8D73 FF88888888888877
0891+  8D7B             	DEFB	#FF,#88,#00,#00,#00,#00,#88,#77
0891+  8D7B FF88000000008877
0892+  8D83             	DEFB	#FF,#88,#88,#00,#00,#88,#88,#77
0892+  8D83 FF88880000888877
0893+  8D8B             	DEFB	#FF,#88,#88,#80,#08,#88,#88,#77
0893+  8D8B FF88888008888877
0894+  8D93             	DEFB	#FF,#88,#88,#88,#88,#88,#88,#77
0894+  8D93 FF88888888888877
0895+  8D9B             	DEFB	#FF,#77,#77,#77,#77,#77,#77,#77
0895+  8D9B FF77777777777777
0896+  8DA3             ;[]----------------------------------------------------------[]
0897+  8DA3             ;Процедура инвертирования прямоугольной	плоскости
0898+  8DA3             ;На вход:
0899+  8DA3             ;	 HL - X	координата
0900+  8DA3             ;	 BC - Y	координата
0901+  8DA3             ;	 HX - длина Y
0902+  8DA3             ;	 LX - длина X
0903+  8DA3             ;	 D  - текущий цвет
0904+  8DA3             ;	 E  - нужный цвет
0905+  8DA3             InvertRectan
0906+  8DA3 FD E5       	PUSH	IY
0907+  8DA5 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0908+  8DA7 F5          	PUSH	AF
0909+  8DA8 DB A2       	IN	A,(PAGE1)
0910+  8DAA F5          	PUSH	AF
0911+  8DAB 3E 50       	LD	A,#50
0912+  8DAD D3 A2       	OUT	(PAGE1),A
0913+  8DAF FD 69       	LD	LY,C
0914+  8DB1 DD 4C       	LD	C,HX
0915+  8DB3 DD 45       	LD	B,LX
0916+  8DB5 CB 3C       	SRL	H
0917+  8DB7 CB 1D       	RR	L
0918+  8DB9 CB F4       	SET	6,H
0919+  8DBB DD 6B       	LD	LX,E
0920+  8DBD DD 62       	LD	HX,D
0921+  8DBF 7A          	LD	A,D
0922+  8DC0 E6 F0       	AND	#F0
0923+  8DC2 FD 67       	LD	HY,A
0924+  8DC4 0F          	RRCA 
0925+  8DC5 0F          	RRCA 
0926+  8DC6 0F          	RRCA 
0927+  8DC7 0F          	RRCA 
0928+  8DC8 FD B4       	OR	HY
0929+  8DCA 57          	LD	D,A
0930+  8DCB E6 0F       	AND	#0F
0931+  8DCD FD 67       	LD	HY,A
0932+  8DCF DD 5C       	LD	E,HX
0933+  8DD1 7B          	LD	A,E
0934+  8DD2 E6 0F       	AND	#0F
0935+  8DD4 07          	RLCA 
0936+  8DD5 07          	RLCA 
0937+  8DD6 07          	RLCA 
0938+  8DD7 07          	RLCA 
0939+  8DD8 FD B4       	OR	HY
0940+  8DDA DD 67       	LD	HX,A
0941+  8DDC D9          	EXX 
0942+  8DDD DD 7D       	LD	A,LX
0943+  8DDF E6 F0       	AND	#F0
0944+  8DE1 FD 67       	LD	HY,A
0945+  8DE3 0F          	RRCA 
0946+  8DE4 0F          	RRCA 
0947+  8DE5 0F          	RRCA 
0948+  8DE6 0F          	RRCA 
0949+  8DE7 FD B4       	OR	HY
0950+  8DE9 57          	LD	D,A
0951+  8DEA E6 0F       	AND	#0F
0952+  8DEC FD 67       	LD	HY,A
0953+  8DEE DD 5D       	LD	E,LX
0954+  8DF0 7B          	LD	A,E
0955+  8DF1 E6 0F       	AND	#0F
0956+  8DF3 07          	RLCA 
0957+  8DF4 07          	RLCA 
0958+  8DF5 07          	RLCA 
0959+  8DF6 07          	RLCA 
0960+  8DF7 FD B4       	OR	HY
0961+  8DF9 47          	LD	B,A
0962+  8DFA E6 F0       	AND	#F0
0963+  8DFC FD 67       	LD	HY,A
0964+  8DFE 0F          	RRCA 
0965+  8DFF 0F          	RRCA 
0966+  8E00 0F          	RRCA 
0967+  8E01 0F          	RRCA 
0968+  8E02 FD B4       	OR	HY
0969+  8E04 4F          	LD	C,A
0970+  8E05 D9          	EXX 
0971+  8E06             PrnInvLp
0972+  8E06 FD 7D       	LD	A,LY
0973+  8E08 D3 89       	OUT	(YPORT),A
0974+  8E0A E5          	PUSH	HL
0975+  8E0B D9          	EXX 
0976+  8E0C E1          	POP	HL
0977+  8E0D D9          	EXX 
0978+  8E0E E5          	PUSH	HL
0979+  8E0F C5          	PUSH	BC
0980+  8E10 CD 23 8E    	CALL	InvLnLp
0981+  8E13 C1          	POP	BC
0982+  8E14 E1          	POP	HL
0983+  8E15 FD 2C       	INC	LY
0984+  8E17 0D          	DEC	C
0985+  8E18 20 EC       	JR	NZ,PrnInvLp
0986+  8E1A F1          	POP	AF
0987+  8E1B D3 A2       	OUT	(PAGE1),A
0988+  8E1D F1          	POP	AF
0989+  8E1E D3 89       	OUT	(YPORT),A
0990+  8E20 FD E1       	POP	IY
0991+  8E22 C9          	RET 
0992+  8E23             
0993+  8E23 7E          InvLnLp	LD	A,(HL)
0994+  8E24 23          	INC	HL
0995+  8E25 BA          	CP	D
0996+  8E26 20 07       	JR	NZ,CmpInv2
0997+  8E28 D9          	EXX 
0998+  8E29 72          	LD	(HL),D
0999+  8E2A 23          	INC	HL
1000+  8E2B D9          	EXX 
1001+  8E2C 10 F5       	DJNZ	InvLnLp
1002+  8E2E C9          	RET 
1003+  8E2F BB          CmpInv2	CP	E
1004+  8E30 20 07       	JR	NZ,CmpInv3
1005+  8E32 D9          	EXX 
1006+  8E33 73          	LD	(HL),E
1007+  8E34 23          	INC	HL
1008+  8E35 D9          	EXX 
1009+  8E36 10 EB       	DJNZ	InvLnLp
1010+  8E38 C9          	RET 
1011+  8E39 DD BC       CmpInv3	CP	HX
1012+  8E3B 20 07       	JR	NZ,SetInv4
1013+  8E3D D9          	EXX 
1014+  8E3E 70          	LD	(HL),B
1015+  8E3F 23          	INC	HL
1016+  8E40 D9          	EXX 
1017+  8E41 10 E0       	DJNZ	InvLnLp
1018+  8E43 C9          	RET 
1019+  8E44 D9          SetInv4	EXX 
1020+  8E45 71          	LD	(HL),C
1021+  8E46 23          	INC	HL
1022+  8E47 D9          	EXX 
1023+  8E48 10 D9       	DJNZ	InvLnLp
1024+  8E4A C9          	RET 
1025+  8E4B             
1026+  8E4B             
1027+  8E4B             
0060   8E4B             	include "fnprint.z80"
0001+  8E4B             
0002+  8E4B             ;[]----------------------------------------------------------[]
0003+  8E4B             ;Процедура вывода текстовых строк на графический экран 640x256
0004+  8E4B             ;с обрезанием левого края текста
0005+  8E4B             ;На вход:
0006+  8E4B             ;	   IX -	Кол-во пикселей	под вывод строки
0007+  8E4B             ;	   HL -	адрес текстовой	строки
0008+  8E4B             ;	   DE -	позиция	вывода по X
0009+  8E4B             ;	   BC -	позиция	вывода по Y
0010+  8E4B             ;	    A -	цвет печати  (7-4бит PAPER, 3-0бит INK)
0011+  8E4B             ;		(конец строки -	0)
0012+  8E4B             PrnRangPathL
0013+  8E4B D5          	PUSH	DE
0014+  8E4C C5          	PUSH	BC
0015+  8E4D F5          	PUSH	AF
0016+  8E4E F3          	DI 
0017+  8E4F DB 82       	IN	A,(PAGE0)
0018+  8E51 F5          	PUSH	AF
0019+  8E52 3A EB A7    	LD	A,(FONTpage)
0020+  8E55 D3 82       	OUT	(PAGE0),A
0021+  8E57 01 00 00    	LD	BC,#0000
0022+  8E5A 16 00       	LD	D,high IFFFont-#C0
0023+  8E5C E5          	PUSH	HL
0024+  8E5D 7E          	LD	A,(HL)
0025+  8E5E 23          PrRangL	INC	HL
0026+  8E5F 5F          	LD	E,A
0027+  8E60 1A          	LD	A,(DE)
0028+  8E61 87          	ADD	A,A
0029+  8E62 81          	ADD	A,C
0030+  8E63 4F          	LD	C,A
0031+  8E64 78          	LD	A,B
0032+  8E65 CE 00       	ADC	A,#00
0033+  8E67 47          	LD	B,A
0034+  8E68 7E          	LD	A,(HL)
0035+  8E69 B7          	OR	A
0036+  8E6A 20 F2       	JR	NZ,PrRangL
0037+  8E6C DD E5       	PUSH	IX
0038+  8E6E E1          	POP	HL
0039+  8E6F ED 42       	SBC	HL,BC
0040+  8E71 4D          	LD	C,L
0041+  8E72 44          	LD	B,H
0042+  8E73 E1          	POP	HL
0043+  8E74 30 35       	JR	NC,PrRngLE
0044+  8E76 79          	LD	A,C
0045+  8E77 D6 1A       	SUB	#1A
0046+  8E79 DD 6F       	LD	LX,A
0047+  8E7B 78          	LD	A,B
0048+  8E7C DE 00       	SBC	A,#00
0049+  8E7E DD 67       	LD	HX,A
0050+  8E80 7E          	LD	A,(HL)
0051+  8E81 08          	EX	AF,AF'
0052+  8E82 23          	INC	HL
0053+  8E83 23          	INC	HL
0054+  8E84 01 00 00    PrRngL0	LD	BC,#0000
0055+  8E87 23          	INC	HL
0056+  8E88 7E          	LD	A,(HL)
0057+  8E89 23          PrRngL1	INC	HL
0058+  8E8A 5F          	LD	E,A
0059+  8E8B 1A          	LD	A,(DE)
0060+  8E8C 87          	ADD	A,A
0061+  8E8D 81          	ADD	A,C
0062+  8E8E 4F          	LD	C,A
0063+  8E8F 78          	LD	A,B
0064+  8E90 CE 00       	ADC	A,#00
0065+  8E92 47          	LD	B,A
0066+  8E93 7E          	LD	A,(HL)
0067+  8E94 FE 5C       	CP	"\\"
0068+  8E96 20 F1       	JR	NZ,PrRngL1
0069+  8E98 DD 09       	ADD	IX,BC
0070+  8E9A 30 E8       	JR	NC,PrRngL0
0071+  8E9C 2B          	DEC	HL
0072+  8E9D 36 2E       	LD	(HL),"."
0073+  8E9F 2B          	DEC	HL
0074+  8EA0 36 2E       	LD	(HL),"."
0075+  8EA2 2B          	DEC	HL
0076+  8EA3 36 5C       	LD	(HL),"\\"
0077+  8EA5 2B          	DEC	HL
0078+  8EA6 36 3A       	LD	(HL),":"
0079+  8EA8 2B          	DEC	HL
0080+  8EA9 08          	EX	AF,AF'
0081+  8EAA 77          	LD	(HL),A
0082+  8EAB F1          PrRngLE	POP	AF
0083+  8EAC D3 82       	OUT	(PAGE0),A
0084+  8EAE FB          	EI 
0085+  8EAF F1          	POP	AF
0086+  8EB0 C1          	POP	BC
0087+  8EB1 D1          	POP	DE
0088+  8EB2 C3 B3 8F    	JP	PrnTxtLnIFF
0089+  8EB5             ;[]----------------------------------------------------------[]
0090+  8EB5             ;Процедура вывода текстовых строк на графический экран 640x256
0091+  8EB5             ;с обрезанием левого края текста
0092+  8EB5             ;На вход:
0093+  8EB5             ;	   IX -	Кол-во пикселей	под вывод строки
0094+  8EB5             ;	   HL -	адрес текстовой	строки
0095+  8EB5             ;	   DE -	позиция	вывода по X
0096+  8EB5             ;	   BC -	позиция	вывода по Y
0097+  8EB5             ;	    A -	цвет печати  (7-4бит PAPER, 3-0бит INK)
0098+  8EB5             ;		(конец строки -	0)
0099+  8EB5             PrnRangPathR
0100+  8EB5 F5          	PUSH	AF
0101+  8EB6 C5          	PUSH	BC
0102+  8EB7 D5          	PUSH	DE
0103+  8EB8 F3          	DI 
0104+  8EB9 DB 82       	IN	A,(PAGE0)
0105+  8EBB F5          	PUSH	AF
0106+  8EBC 3A EB A7    	LD	A,(FONTpage)
0107+  8EBF D3 82       	OUT	(PAGE0),A
0108+  8EC1 01 00 00    	LD	BC,#0000
0109+  8EC4 16 00       	LD	D,high IFFFont-#C0
0110+  8EC6 E5          	PUSH	HL
0111+  8EC7 7E          	LD	A,(HL)
0112+  8EC8 23          PrRangR	INC	HL
0113+  8EC9 5F          	LD	E,A
0114+  8ECA 1A          	LD	A,(DE)
0115+  8ECB 87          	ADD	A,A
0116+  8ECC 81          	ADD	A,C
0117+  8ECD 4F          	LD	C,A
0118+  8ECE 78          	LD	A,B
0119+  8ECF CE 00       	ADC	A,#00
0120+  8ED1 47          	LD	B,A
0121+  8ED2 7E          	LD	A,(HL)
0122+  8ED3 B7          	OR	A
0123+  8ED4 20 F2       	JR	NZ,PrRangR
0124+  8ED6 DD E5       	PUSH	IX
0125+  8ED8 E1          	POP	HL
0126+  8ED9 ED 42       	SBC	HL,BC
0127+  8EDB EB          	EX	DE,HL
0128+  8EDC E1          	POP	HL
0129+  8EDD 30 4B       	JR	NC,PrRngRE
0130+  8EDF 7B          	LD	A,E
0131+  8EE0 D6 1A       	SUB	#1A
0132+  8EE2 DD 6F       	LD	LX,A
0133+  8EE4 7A          	LD	A,D
0134+  8EE5 DE 00       	SBC	A,#00
0135+  8EE7 DD 67       	LD	HX,A
0136+  8EE9 16 00       	LD	D,high IFFFont-#C0
0137+  8EEB 7E          	LD	A,(HL)
0138+  8EEC 08          	EX	AF,AF'
0139+  8EED 23          	INC	HL
0140+  8EEE 23          	INC	HL
0141+  8EEF 01 00 00    PrRngR0	LD	BC,#0000
0142+  8EF2 23          	INC	HL
0143+  8EF3 7E          	LD	A,(HL)
0144+  8EF4 23          PrRngR1	INC	HL
0145+  8EF5 5F          	LD	E,A
0146+  8EF6 1A          	LD	A,(DE)
0147+  8EF7 87          	ADD	A,A
0148+  8EF8 81          	ADD	A,C
0149+  8EF9 4F          	LD	C,A
0150+  8EFA 78          	LD	A,B
0151+  8EFB CE 00       	ADC	A,#00
0152+  8EFD 47          	LD	B,A
0153+  8EFE 7E          	LD	A,(HL)
0154+  8EFF FE 5C       	CP	"\\"
0155+  8F01 20 F1       	JR	NZ,PrRngR1
0156+  8F03 DD 09       	ADD	IX,BC
0157+  8F05 30 E8       	JR	NC,PrRngR0
0158+  8F07 2B          	DEC	HL
0159+  8F08 36 2E       	LD	(HL),"."
0160+  8F0A 2B          	DEC	HL
0161+  8F0B 36 2E       	LD	(HL),"."
0162+  8F0D 2B          	DEC	HL
0163+  8F0E 36 5C       	LD	(HL),"\\"
0164+  8F10 2B          	DEC	HL
0165+  8F11 36 3A       	LD	(HL),":"
0166+  8F13 2B          	DEC	HL
0167+  8F14 08          	EX	AF,AF'
0168+  8F15 77          	LD	(HL),A
0169+  8F16 01 00 00    	LD	BC,#0000
0170+  8F19 E5          	PUSH	HL
0171+  8F1A 7E          	LD	A,(HL)
0172+  8F1B 23          PrRngR2	INC	HL
0173+  8F1C 5F          	LD	E,A
0174+  8F1D 1A          	LD	A,(DE)
0175+  8F1E 87          	ADD	A,A
0176+  8F1F 81          	ADD	A,C
0177+  8F20 4F          	LD	C,A
0178+  8F21 78          	LD	A,B
0179+  8F22 CE 00       	ADC	A,#00
0180+  8F24 47          	LD	B,A
0181+  8F25 7E          	LD	A,(HL)
0182+  8F26 B7          	OR	A
0183+  8F27 20 F2       	JR	NZ,PrRngR2
0184+  8F29 E1          	POP	HL
0185+  8F2A F1          PrRngRE	POP	AF
0186+  8F2B D3 82       	OUT	(PAGE0),A
0187+  8F2D FB          	EI 
0188+  8F2E D1          	POP	DE
0189+  8F2F EB          	EX	DE,HL
0190+  8F30 B7          	OR	A
0191+  8F31 ED 42       	SBC	HL,BC
0192+  8F33 EB          	EX	DE,HL
0193+  8F34 C1          	POP	BC
0194+  8F35 F1          	POP	AF
0195+  8F36 C3 B3 8F    	JP	PrnTxtLnIFF
0196+  8F39             ;[]----------------------------------------------------------[]
0197+  8F39             ;Процедура вывода текстовых строк на графический экран 640x256
0198+  8F39             ;с обрезанием левого края текста
0199+  8F39             ;На вход:
0200+  8F39             ;	   IX -	Кол-во пикселей	под вывод строки
0201+  8F39             ;	   HL -	адрес текстовой	строки
0202+  8F39             ;	   DE -	центр вывода по	X
0203+  8F39             ;	   BC -	позиция	вывода по Y
0204+  8F39             ;	    A -	цвет печати  (7-4бит PAPER, 3-0бит INK)
0205+  8F39             ;		(конец строки -	0)
0206+  8F39             PrnRangPathC
0207+  8F39 C5          	PUSH	BC
0208+  8F3A F5          	PUSH	AF
0209+  8F3B D5          	PUSH	DE
0210+  8F3C F3          	DI 
0211+  8F3D DB 82       	IN	A,(PAGE0)
0212+  8F3F F5          	PUSH	AF
0213+  8F40 3A EB A7    	LD	A,(FONTpage)
0214+  8F43 D3 82       	OUT	(PAGE0),A
0215+  8F45             PrnRangC
0216+  8F45 01 00 00    	LD	BC,#0000
0217+  8F48 16 00       	LD	D,high IFFFont-#C0
0218+  8F4A E5          	PUSH	HL
0219+  8F4B 7E          	LD	A,(HL)
0220+  8F4C 23          PrRangC	INC	HL
0221+  8F4D 5F          	LD	E,A
0222+  8F4E 1A          	LD	A,(DE)
0223+  8F4F 87          	ADD	A,A
0224+  8F50 81          	ADD	A,C
0225+  8F51 4F          	LD	C,A
0226+  8F52 78          	LD	A,B
0227+  8F53 CE 00       	ADC	A,#00
0228+  8F55 47          	LD	B,A
0229+  8F56 7E          	LD	A,(HL)
0230+  8F57 B7          	OR	A
0231+  8F58 20 F2       	JR	NZ,PrRangC
0232+  8F5A DD E5       	PUSH	IX
0233+  8F5C E1          	POP	HL
0234+  8F5D ED 42       	SBC	HL,BC
0235+  8F5F EB          	EX	DE,HL
0236+  8F60 E1          	POP	HL
0237+  8F61 30 3D       	JR	NC,PrRngCE
0238+  8F63 DD E5       	PUSH	IX
0239+  8F65 7B          	LD	A,E
0240+  8F66 D6 1A       	SUB	#1A
0241+  8F68 DD 6F       	LD	LX,A
0242+  8F6A 7A          	LD	A,D
0243+  8F6B DE 00       	SBC	A,#00
0244+  8F6D DD 67       	LD	HX,A
0245+  8F6F 7E          	LD	A,(HL)
0246+  8F70 08          	EX	AF,AF'
0247+  8F71 23          	INC	HL
0248+  8F72 23          	INC	HL
0249+  8F73 16 00       	LD	D,high IFFFont-#C0
0250+  8F75 01 00 00    PrRngC0	LD	BC,#0000
0251+  8F78 23          	INC	HL
0252+  8F79 7E          	LD	A,(HL)
0253+  8F7A 23          PrRngC1	INC	HL
0254+  8F7B 5F          	LD	E,A
0255+  8F7C 1A          	LD	A,(DE)
0256+  8F7D 87          	ADD	A,A
0257+  8F7E 81          	ADD	A,C
0258+  8F7F 4F          	LD	C,A
0259+  8F80 78          	LD	A,B
0260+  8F81 CE 00       	ADC	A,#00
0261+  8F83 47          	LD	B,A
0262+  8F84 7E          	LD	A,(HL)
0263+  8F85 FE 5C       	CP	"\\"
0264+  8F87 20 F1       	JR	NZ,PrRngC1
0265+  8F89 DD 09       	ADD	IX,BC
0266+  8F8B 30 E8       	JR	NC,PrRngC0
0267+  8F8D 2B          	DEC	HL
0268+  8F8E 36 2E       	LD	(HL),"."
0269+  8F90 2B          	DEC	HL
0270+  8F91 36 2E       	LD	(HL),"."
0271+  8F93 2B          	DEC	HL
0272+  8F94 36 5C       	LD	(HL),"\\"
0273+  8F96 2B          	DEC	HL
0274+  8F97 36 3A       	LD	(HL),":"
0275+  8F99 2B          	DEC	HL
0276+  8F9A 08          	EX	AF,AF'
0277+  8F9B 77          	LD	(HL),A
0278+  8F9C DD E1       	POP	IX
0279+  8F9E 18 A5       	JR	PrnRangC
0280+  8FA0 F1          PrRngCE	POP	AF
0281+  8FA1 D3 82       	OUT	(PAGE0),A
0282+  8FA3 FB          	EI 
0283+  8FA4 D1          	POP	DE
0284+  8FA5 EB          	EX	DE,HL
0285+  8FA6 CB 38       	SRL	B
0286+  8FA8 CB 19       	RR	C
0287+  8FAA B7          	OR	A
0288+  8FAB ED 42       	SBC	HL,BC
0289+  8FAD EB          	EX	DE,HL
0290+  8FAE F1          	POP	AF
0291+  8FAF C1          	POP	BC
0292+  8FB0 C3 B3 8F    	JP	PrnTxtLnIFF
0293+  8FB3             ;[]----------------------------------------------------------[]
0294+  8FB3             ;Процедура вывода текстовых строк на графический экран 640x256;
0295+  8FB3             ;в режиме IFF шрифта
0296+  8FB3             ;На вход:
0297+  8FB3             ;	   HL -	адрес текстовой	строки
0298+  8FB3             ;	   DE -	позиция	вывода по X
0299+  8FB3             ;	   BC -	позиция	вывода по Y
0300+  8FB3             ;	    A -	цвет печати  (7-4бит PAPER, 3-0бит INK)
0301+  8FB3             ;		(конец строки -	0)
0302+  8FB3             PrnTxtLnIFF
0303+  8FB3 FD E5       	PUSH	IY
0304+  8FB5 FD 69       	LD	LY,C		;Y координата
0305+  8FB7 47          	LD	B,A
0306+  8FB8 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0307+  8FBA F5          	PUSH	AF
0308+  8FBB DB A2       	IN	A,(PAGE1)
0309+  8FBD FD 67       	LD	HY,A
0310+  8FBF F3          	DI 
0311+  8FC0 D9          	EXX 
0312+  8FC1 0E 83       	LD	C,#83
0313+  8FC3 F7          	RST	#30
0314+  8FC4 D9          	EXX 
0315+  8FC5 CD 15 91    	CALL	InsPrintColor
0316+  8FC8 D5          	PUSH	DE		;X координата
0317+  8FC9 D9          	EXX 
0318+  8FCA C1          	POP	BC
0319+  8FCB CB 38       	SRL	B
0320+  8FCD CB 19       	RR	C
0321+  8FCF CB F0       	SET	6,B
0322+  8FD1 21 60 91    	LD	HL,PrnPAPp	;PAPER буфер
0323+  8FD4 11 58 91    	LD	DE,PrnINKp	;INK буфер
0324+  8FD7 D9          	EXX 
0325+  8FD8 4D          	LD	C,L		;Адрес строки
0326+  8FD9 44          	LD	B,H
0327+  8FDA             ;Итак:
0328+  8FDA             ;	BC - Aдрес строки
0329+  8FDA             ;      'HL - буфер PAPER
0330+  8FDA             ;      'DE - буфер INK
0331+  8FDA             ;      'BC - X координата печати в видео ОЗУ
0332+  8FDA             ;	LY - Y координата печати
0333+  8FDA             
0334+  8FDA DB 82       	IN	A,(PAGE0)
0335+  8FDC F5          	PUSH	AF
0336+  8FDD 3A EB A7    	LD	A,(FONTpage)
0337+  8FE0 D3 82       	OUT	(PAGE0),A
0338+  8FE2 52          	LD	D,D
0339+  8FE3 3E 08       	LD	A,#08
0340+  8FE5 40          	LD	B,B
0341+  8FE6 0A          	LD	A,(BC)
0342+  8FE7 03          	INC	BC
0343+  8FE8 B7          	OR	A
0344+  8FE9 28 32       	JR	Z,PrnIFFe
0345+  8FEB             PrnIFFloop
0346+  8FEB 6F          	LD	L,A
0347+  8FEC 26 00       	LD	H,high IFFFont-#C0
0348+  8FEE C5          	PUSH	BC
0349+  8FEF 46          	LD	B,(HL)		;длина символа
0350+  8FF0 24          	INC	H
0351+  8FF1 5E          	LD	E,(HL)
0352+  8FF2 24          	INC	H
0353+  8FF3 56          	LD	D,(HL)
0354+  8FF4 21 08 00    	LD	HL,#0008
0355+  8FF7 EB          	EX	DE,HL
0356+  8FF8 3E 50       	LD	A,#50
0357+  8FFA D3 A2       	OUT	(PAGE1),A
0358+  8FFC             PrnIFFlp1
0359+  8FFC 6D          	LD	L,L
0360+  8FFD 7E          	LD	A,(HL)
0361+  8FFE 40          	LD	B,B
0362+  8FFF D9          	EXX 
0363+  9000 FD 7D       	LD	A,LY
0364+  9002 D3 89       	OUT	(YPORT),A
0365+  9004 6D          	LD	L,L
0366+  9005 B6          	OR	(HL)
0367+  9006 40          	LD	B,B
0368+  9007 EB          	EX	DE,HL
0369+  9008 6D          	LD	L,L
0370+  9009 AE          	XOR	(HL)
0371+  900A 7F          	LD	A,A
0372+  900B 02          	LD	(BC),A
0373+  900C 40          	LD	B,B
0374+  900D EB          	EX	DE,HL
0375+  900E 03          	INC	BC
0376+  900F D9          	EXX 
0377+  9010 19          	ADD	HL,DE
0378+  9011 10 E9       	DJNZ	PrnIFFlp1
0379+  9013 C1          	POP	BC
0380+  9014 FD 7C       	LD	A,HY
0381+  9016 D3 A2       	OUT	(PAGE1),A
0382+  9018 0A          	LD	A,(BC)
0383+  9019 03          	INC	BC
0384+  901A B7          	OR	A
0385+  901B 20 CE       	JR	NZ,PrnIFFloop
0386+  901D 69          PrnIFFe	LD	L,C		;Адрес строки
0387+  901E 60          	LD	H,B
0388+  901F F1          	POP	AF
0389+  9020 D3 82       	OUT	(PAGE0),A
0390+  9022 FB          	EI 
0391+  9023 F1          	POP	AF
0392+  9024 D3 89       	OUT	(YPORT),A
0393+  9026 FD E1       	POP	IY
0394+  9028 C9          	RET 
0395+  9029             ;[]----------------------------------------------------------[]
0396+  9029             ;Процедура вывода текстовых строк на графический экран 640x256;
0397+  9029             ;На вход:
0398+  9029             ;	   HL -	адрес текстовой	строки
0399+  9029             ;	   DE -	позиция	вывода по X
0400+  9029             ;	   BC -	позиция	вывода по Y
0401+  9029             ;	    A -	цвет печати  (7-4бит PAPER, 3-0бит INK)
0402+  9029             ;		(конец строки -	0)
0403+  9029             PrnTxtLnNorm
0404+  9029 FD E5       	PUSH	IY
0405+  902B FD 69       	LD	LY,C		;Y координата
0406+  902D 47          	LD	B,A
0407+  902E DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0408+  9030 F5          	PUSH	AF
0409+  9031 DB A2       	IN	A,(PAGE1)
0410+  9033 FD 67       	LD	HY,A
0411+  9035 F3          	DI 
0412+  9036 D9          	EXX 
0413+  9037 0E 83       	LD	C,#83
0414+  9039 F7          	RST	#30
0415+  903A D9          	EXX 
0416+  903B CD 15 91    	CALL	InsPrintColor
0417+  903E D5          	PUSH	DE		;X координата
0418+  903F D9          	EXX 
0419+  9040 C1          	POP	BC
0420+  9041 CB 38       	SRL	B
0421+  9043 CB 19       	RR	C
0422+  9045 CB F0       	SET	6,B
0423+  9047 21 60 91    	LD	HL,PrnPAPp	;PAPER буфер
0424+  904A 11 58 91    	LD	DE,PrnINKp	;INK буфер
0425+  904D D9          	EXX 
0426+  904E 4D          	LD	C,L		;Адрес строки
0427+  904F 44          	LD	B,H
0428+  9050             ;Итак:
0429+  9050             ;	BC - Aдрес строки
0430+  9050             ;      'HL - буфер PAPER
0431+  9050             ;      'DE - буфер INK
0432+  9050             ;      'BC - X координата печати в видео ОЗУ
0433+  9050             ;	LY - Y координата печати
0434+  9050             
0435+  9050 DB 82       	IN	A,(PAGE0)
0436+  9052 F5          	PUSH	AF
0437+  9053 3A EB A7    	LD	A,(FONTpage)
0438+  9056 D3 82       	OUT	(PAGE0),A
0439+  9058 52          	LD	D,D
0440+  9059 3E 08       	LD	A,#08
0441+  905B 40          	LD	B,B
0442+  905C 0A          	LD	A,(BC)
0443+  905D 03          	INC	BC
0444+  905E B7          	OR	A
0445+  905F 28 35       	JR	Z,PrnNORe
0446+  9061             PrnNORloop
0447+  9061 6F          	LD	L,A
0448+  9062 26 1B       	LD	H,high Font-#C0
0449+  9064 C5          	PUSH	BC
0450+  9065 5E          	LD	E,(HL)
0451+  9066 24          	INC	H
0452+  9067 7E          	LD	A,(HL)
0453+  9068 C6 1B       	ADD	A,high Font-#C0
0454+  906A 57          	LD	D,A
0455+  906B 21 08 00    	LD	HL,#0008
0456+  906E EB          	EX	DE,HL
0457+  906F 3E 50       	LD	A,#50
0458+  9071 D3 A2       	OUT	(PAGE1),A
0459+  9073 06 04       	LD	B,#04
0460+  9075             PrnNORlp1
0461+  9075 6D          	LD	L,L
0462+  9076 7E          	LD	A,(HL)
0463+  9077 40          	LD	B,B
0464+  9078 D9          	EXX 
0465+  9079 FD 7D       	LD	A,LY
0466+  907B D3 89       	OUT	(YPORT),A
0467+  907D 6D          	LD	L,L
0468+  907E B6          	OR	(HL)
0469+  907F 40          	LD	B,B
0470+  9080 EB          	EX	DE,HL
0471+  9081 6D          	LD	L,L
0472+  9082 AE          	XOR	(HL)
0473+  9083 7F          	LD	A,A
0474+  9084 02          	LD	(BC),A
0475+  9085 40          	LD	B,B
0476+  9086 EB          	EX	DE,HL
0477+  9087 03          	INC	BC
0478+  9088 D9          	EXX 
0479+  9089 19          	ADD	HL,DE
0480+  908A 10 E9       	DJNZ	PrnNORlp1
0481+  908C C1          	POP	BC
0482+  908D FD 7C       	LD	A,HY
0483+  908F D3 A2       	OUT	(PAGE1),A
0484+  9091 0A          	LD	A,(BC)
0485+  9092 03          	INC	BC
0486+  9093 B7          	OR	A
0487+  9094 20 CB       	JR	NZ,PrnNORloop
0488+  9096 69          PrnNORe	LD	L,C		;Адрес строки
0489+  9097 60          	LD	H,B
0490+  9098 F1          	POP	AF
0491+  9099 D3 82       	OUT	(PAGE0),A
0492+  909B FB          	EI 
0493+  909C F1          	POP	AF
0494+  909D D3 89       	OUT	(YPORT),A
0495+  909F FD E1       	POP	IY
0496+  90A1 C9          	RET 
0497+  90A2             ;[]----------------------------------------------------------[]
0498+  90A2             ;Процедура вывода текстовых строк на графический экран 640x256;
0499+  90A2             ;На вход:
0500+  90A2             ;	   HL -	адрес текстовой	строки
0501+  90A2             ;	   DE -	позиция	вывода по X
0502+  90A2             ;	    C -	позиция	вывода по Y
0503+  90A2             ;	    B -	кол-во печатаемых символов
0504+  90A2             ;	    A -	цвет печати  (7-4бит PAPER, 3-0бит INK)
0505+  90A2             ;		(конец строки -	0)
0506+  90A2             PrnTxtLnNormC
0507+  90A2 FD E5       	PUSH	IY
0508+  90A4 FD 69       	LD	LY,C		;Y координата
0509+  90A6 FD 60       	LD	HY,B		;кол-во	симв
0510+  90A8 47          	LD	B,A
0511+  90A9 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0512+  90AB F5          	PUSH	AF
0513+  90AC DB A2       	IN	A,(PAGE1)
0514+  90AE F5          	PUSH	AF
0515+  90AF 3E 50       	LD	A,#50
0516+  90B1 D3 A2       	OUT	(PAGE1),A
0517+  90B3 F3          	DI 
0518+  90B4 D9          	EXX 
0519+  90B5 0E 83       	LD	C,#83
0520+  90B7 F7          	RST	#30
0521+  90B8 D9          	EXX 
0522+  90B9 CD 15 91    	CALL	InsPrintColor
0523+  90BC D5          	PUSH	DE		;X координата
0524+  90BD D9          	EXX 
0525+  90BE C1          	POP	BC
0526+  90BF CB 38       	SRL	B
0527+  90C1 CB 19       	RR	C
0528+  90C3 CB F0       	SET	6,B
0529+  90C5 21 60 91    	LD	HL,PrnPAPp	;PAPER буфер
0530+  90C8 11 58 91    	LD	DE,PrnINKp	;INK буфер
0531+  90CB D9          	EXX 
0532+  90CC 4D          	LD	C,L		;Адрес строки
0533+  90CD 44          	LD	B,H
0534+  90CE             ;Итак:
0535+  90CE             ;	BC - Aдрес строки
0536+  90CE             ;      'HL - буфер PAPER
0537+  90CE             ;      'DE - буфер INK
0538+  90CE             ;      'BC - X координата печати в видео ОЗУ
0539+  90CE             ;	LY - Y координата печати
0540+  90CE             
0541+  90CE DB 82       	IN	A,(PAGE0)
0542+  90D0 F5          	PUSH	AF
0543+  90D1 3A EB A7    	LD	A,(FONTpage)
0544+  90D4 D3 82       	OUT	(PAGE0),A
0545+  90D6 52          	LD	D,D
0546+  90D7 3E 08       	LD	A,#08
0547+  90D9 40          	LD	B,B
0548+  90DA             PrnNORloopC
0549+  90DA 0A          	LD	A,(BC)
0550+  90DB 03          	INC	BC
0551+  90DC 6F          	LD	L,A
0552+  90DD 26 1B       	LD	H,high Font-#C0
0553+  90DF C5          	PUSH	BC
0554+  90E0 5E          	LD	E,(HL)
0555+  90E1 24          	INC	H
0556+  90E2 7E          	LD	A,(HL)
0557+  90E3 C6 1B       	ADD	A,high Font-#C0
0558+  90E5 57          	LD	D,A
0559+  90E6 21 08 00    	LD	HL,#0008
0560+  90E9 EB          	EX	DE,HL
0561+  90EA 06 04       	LD	B,#04
0562+  90EC             PrnNORlp1c
0563+  90EC 6D          	LD	L,L
0564+  90ED 7E          	LD	A,(HL)
0565+  90EE 40          	LD	B,B
0566+  90EF D9          	EXX 
0567+  90F0 FD 7D       	LD	A,LY
0568+  90F2 D3 89       	OUT	(YPORT),A
0569+  90F4 6D          	LD	L,L
0570+  90F5 B6          	OR	(HL)
0571+  90F6 40          	LD	B,B
0572+  90F7 EB          	EX	DE,HL
0573+  90F8 6D          	LD	L,L
0574+  90F9 AE          	XOR	(HL)
0575+  90FA 7F          	LD	A,A
0576+  90FB 02          	LD	(BC),A
0577+  90FC 40          	LD	B,B
0578+  90FD EB          	EX	DE,HL
0579+  90FE 03          	INC	BC
0580+  90FF D9          	EXX 
0581+  9100 19          	ADD	HL,DE
0582+  9101 10 E9       	DJNZ	PrnNORlp1c
0583+  9103 C1          	POP	BC
0584+  9104 FD 25       	DEC	HY
0585+  9106 20 D2       	JR	NZ,PrnNORloopC
0586+  9108 F1          	POP	AF
0587+  9109 D3 82       	OUT	(PAGE0),A
0588+  910B FB          	EI 
0589+  910C F1          	POP	AF
0590+  910D D3 A2       	OUT	(PAGE1),A
0591+  910F F1          	POP	AF
0592+  9110 D3 89       	OUT	(YPORT),A
0593+  9112 FD E1       	POP	IY
0594+  9114 C9          	RET 
0595+  9115             
0596+  9115             InsPrintColor
0597+  9115 78          	LD	A,B
0598+  9116 FE 00       PrvCOLp	CP	#00
0599+  9118 C8          	RET	Z
0600+  9119 32 17 91    	LD	(PrvCOLp+1),A
0601+  911C E6 0F       	AND	#0F		;INK
0602+  911E 4F          	LD	C,A
0603+  911F 07          	RLCA 
0604+  9120 07          	RLCA 
0605+  9121 07          	RLCA 
0606+  9122 07          	RLCA 
0607+  9123 B1          	OR	C
0608+  9124 D9          	EXX 
0609+  9125 21 58 91    	LD	HL,PrnINKp	;INK буфер
0610+  9128 2F          	CPL 
0611+  9129                    DUP     #07
0612+  9129 77          >	LD	(HL),A
0613+  912A 23          >	INC	HL
0612+  912B 77          >	LD	(HL),A
0613+  912C 23          >	INC	HL
0612+  912D 77          >	LD	(HL),A
0613+  912E 23          >	INC	HL
0612+  912F 77          >	LD	(HL),A
0613+  9130 23          >	INC	HL
0612+  9131 77          >	LD	(HL),A
0613+  9132 23          >	INC	HL
0612+  9133 77          >	LD	(HL),A
0613+  9134 23          >	INC	HL
0612+  9135 77          >	LD	(HL),A
0613+  9136 23          >	INC	HL
0615+  9137 77          	LD	(HL),A
0616+  9138 D9          	EXX 
0617+  9139 78          	LD	A,B
0618+  913A E6 F0       	AND	#F0		;PAPER
0619+  913C 47          	LD	B,A
0620+  913D 0F          	RRCA 
0621+  913E 0F          	RRCA 
0622+  913F 0F          	RRCA 
0623+  9140 0F          	RRCA 
0624+  9141 B0          	OR	B
0625+  9142 D9          	EXX 
0626+  9143 11 60 91    	LD	DE,PrnPAPp	;PAPER буфер
0627+  9146 AE          	XOR	(HL)		;XOR с INK
0628+  9147                    DUP     #07
0629+  9147 12          >	LD	(DE),A
0630+  9148 13          >	INC	DE
0629+  9149 12          >	LD	(DE),A
0630+  914A 13          >	INC	DE
0629+  914B 12          >	LD	(DE),A
0630+  914C 13          >	INC	DE
0629+  914D 12          >	LD	(DE),A
0630+  914E 13          >	INC	DE
0629+  914F 12          >	LD	(DE),A
0630+  9150 13          >	INC	DE
0629+  9151 12          >	LD	(DE),A
0630+  9152 13          >	INC	DE
0629+  9153 12          >	LD	(DE),A
0630+  9154 13          >	INC	DE
0632+  9155 12          	LD	(DE),A
0633+  9156 D9          	EXX 
0634+  9157 C9          	RET 
0635+  9158             
0636+  9158 00          PrnINKp	DEFS	8,0
0637+  9160 00          PrnPAPp	DEFS	8,0
0638+  9168             
0639+  9168             
0640+  9168             
0061   9168             	include "fninput.z80"
0001+  9168             
0002+  9168             ;[]----------------------------------------------------------[]
0003+  9168             LenInpData EQU	#0C
0004+  9168             CursTimer  EQU	#0E
0005+  9168             Step	   EQU	#08
0006+  9168             InputLine
0007+  9168 DD 22 44 92 	LD	(InpLnData),IX
0008+  916C 22 B1 91    	LD	(InpMous+2),HL
0009+  916F DD CB 01 FE 	SET	7,(IX+#01)
0010+  9173 97          	SUB	A
0011+  9174 DD 77 02    	LD	(IX+#02),A
0012+  9177 DD 77 03    	LD	(IX+#03),A
0013+  917A CD 97 94    	CALL	InsInpLnCol
0014+  917D DD E5       	PUSH	IX
0015+  917F E1          	POP	HL
0016+  9180 11 0C 00    	LD	DE,LenInpData
0017+  9183 19          	ADD	HL,DE
0018+  9184 E5          	PUSH	HL
0019+  9185 DD 5E 04    	LD	E,(IX+#04)
0020+  9188 19          	ADD	HL,DE
0021+  9189 72          	LD	(HL),D
0022+  918A DD 73 02    	LD	(IX+#02),E
0023+  918D E1          	POP	HL
0024+  918E 11 00 80    	LD	DE,WorkBuffer
0025+  9191 DD 7E 02    	LD	A,(IX+#02)
0026+  9194 12          	LD	(DE),A
0027+  9195 13          	INC	DE
0028+  9196 DD 7E 03    	LD	A,(IX+#03)
0029+  9199 12          	LD	(DE),A
0030+  919A 13          	INC	DE
0031+  919B DD 7E 04    	LD	A,(IX+#04)
0032+  919E 12          	LD	(DE),A
0033+  919F 13          	INC	DE
0034+  91A0 4F          	LD	C,A
0035+  91A1 06 00       	LD	B,#00
0036+  91A3 B0          	OR	B
0037+  91A4 28 02       	JR	Z,$+4
0038+  91A6 ED B0       	LDIR 
0039+  91A8 CD D2 94    	CALL	PrintInpLn+3
0040+  91AB             InpLineLp
0041+  91AB 76          	HALT 
0042+  91AC CD D2 96    	CALL	ChCursor
0043+  91AF DD 21 00 00 InpMous	LD	IX,#0000
0044+  91B3 CD 1C 9B    	CALL	TestCoords
0045+  91B6 0E 37       	LD	C,#37
0046+  91B8 D7          	RST	#10
0047+  91B9 28 F0       	JR	Z,InpLineLp
0048+  91BB CB BA       	RES	7,D
0049+  91BD CB 60       	BIT	4,B
0050+  91BF 20 EA       	JR	NZ,InpLineLp
0051+  91C1 DD 21 6B 92 	LD	IX,InpTable2
0052+  91C5 CB 68       	BIT	5,B
0053+  91C7 20 04       	JR	NZ,InpKeys
0054+  91C9 DD 21 46 92 	LD	IX,InpTable1
0055+  91CD DD 7E 00    InpKeys	LD	A,(IX+#00)
0056+  91D0 DD 23       	INC	IX
0057+  91D2 FE FF       	CP	#FF
0058+  91D4 28 26       	JR	Z,InpLineLp1
0059+  91D6 6F          	LD	L,A
0060+  91D7 DD 66 00    	LD	H,(IX+#00)
0061+  91DA DD 23       	INC	IX
0062+  91DC DD 4E 00    	LD	C,(IX+#00)
0063+  91DF DD 23       	INC	IX
0064+  91E1 DD 46 00    	LD	B,(IX+#00)
0065+  91E4 DD 23       	INC	IX
0066+  91E6 B7          	OR	A
0067+  91E7 ED 52       	SBC	HL,DE
0068+  91E9 20 E2       	JR	NZ,InpKeys
0069+  91EB DD 2A 44 92 	LD	IX,(InpLnData)
0070+  91EF 21 AB 91    	LD	HL,InpLineLp
0071+  91F2 E5          	PUSH	HL
0072+  91F3 C5          	PUSH	BC
0073+  91F4 DD E5       	PUSH	IX
0074+  91F6 0E 31       	LD	C,#31
0075+  91F8 D7          	RST	#10
0076+  91F9 DD E1       	POP	IX
0077+  91FB C9          	RET 
0078+  91FC             InpLineLp1
0079+  91FC DD 2A 44 92 	LD	IX,(InpLnData)
0080+  9200 21 AB 91    	LD	HL,InpLineLp
0081+  9203 E5          	PUSH	HL
0082+  9204 DD E5       	PUSH	IX
0083+  9206 0E 31       	LD	C,#31
0084+  9208 D7          	RST	#10
0085+  9209 DD E1       	POP	IX
0086+  920B 7B          	LD	A,E
0087+  920C 18 6A       	JR	InsertSymbol
0088+  920E             InpLnExtN
0089+  920E E1          	POP	HL
0090+  920F DD 2A 44 92 	LD	IX,(InpLnData)
0091+  9213 CD 99 96    	CALL	ResCursor
0092+  9216 AF          	XOR	A
0093+  9217 C9          	RET 
0094+  9218             InpLnExtC
0095+  9218 E1          	POP	HL
0096+  9219 DD 2A 44 92 	LD	IX,(InpLnData)
0097+  921D CD 99 96    	CALL	ResCursor
0098+  9220 DD E5       	PUSH	IX
0099+  9222 E1          	POP	HL
0100+  9223 11 0C 00    	LD	DE,LenInpData
0101+  9226 19          	ADD	HL,DE
0102+  9227 EB          	EX	DE,HL
0103+  9228 21 00 80    	LD	HL,WorkBuffer
0104+  922B 7E          	LD	A,(HL)
0105+  922C 23          	INC	HL
0106+  922D DD 77 02    	LD	(IX+#02),A
0107+  9230 7E          	LD	A,(HL)
0108+  9231 23          	INC	HL
0109+  9232 DD 77 03    	LD	(IX+#03),A
0110+  9235 7E          	LD	A,(HL)
0111+  9236 23          	INC	HL
0112+  9237 DD 77 04    	LD	(IX+#04),A
0113+  923A 4F          	LD	C,A
0114+  923B 06 00       	LD	B,#00
0115+  923D 78          	LD	A,B
0116+  923E B1          	OR	C
0117+  923F 37          	SCF 
0118+  9240 C8          	RET	Z
0119+  9241 ED B0       	LDIR 
0120+  9243 C9          	RET 
0121+  9244             InpLnData
0122+  9244 00 00       	DEFW	#0000	;Адрес описателя строки
0123+  9246             			;  +00 Максимальная длина строки
0124+  9246             			;  +01 Флаг готовности
0125+  9246             			;  +02 текущая X позиция курсора
0126+  9246             			;  +03 текущая AddX
0127+  9246             			;  +04 количество введенных символов
0128+  9246             			;  +05 X позиция строки	на экране
0129+  9246             			;  +07 Y позиция строки	на экране
0130+  9246             			;  +09 X длина строки на экране
0131+  9246             			;  +0B Цвет строки
0132+  9246             			;  +0C ...сама строка
0133+  9246             InpTable1
0134+  9246 1B 01 18 92 	DEFW	#011B,InpLnExtC
0135+  924A 0D 28 0E 92 	DEFW	#280D,InpLnExtN
0136+  924E 0D 4E 0E 92 	DEFW	#4E0D,InpLnExtN
0137+  9252 00 54 DC 92 	DEFW	#5400,ILleft
0138+  9256 00 56 EC 92 	DEFW	#5600,ILright
0139+  925A 08 0E FE 92 	DEFW	#0E08,ILdelet
0140+  925E 00 4F 31 93 	DEFW	#4F00,IL_del_
0141+  9262 00 57 5C 93 	DEFW	#5700,ILhome
0142+  9266 00 51 6D 93 	DEFW	#5100,ILend
0143+  926A FF          	DEFB	#FF
0144+  926B             InpTable2
0145+  926B 00 54 CA 93 	DEFW	#5400,ILwordL
0146+  926F 00 56 7F 93 	DEFW	#5600,ILwordR
0147+  9273 00 0E 12 94 	DEFW	#0E00,ILdelWR
0148+  9277 FF          	DEFB	#FF
0149+  9278             InsertSymbol
0150+  9278 FE 20       	CP	#20
0151+  927A D8          	RET	C
0152+  927B 08          	EX	AF,AF'
0153+  927C DD CB 01 7E 	BIT	7,(IX+#01)	;ready
0154+  9280 C4 BC 92    	CALL	NZ,ClearInpLn
0155+  9283 DD 7E 04    	LD	A,(IX+#04)	;InpytSymb
0156+  9286 DD 96 00    	SUB	(IX+#00)	;Max len
0157+  9289 D0          	RET	NC
0158+  928A DD 7E 04    	LD	A,(IX+#04)
0159+  928D DD 96 02    	SUB	(IX+#02)
0160+  9290 28 13       	JR	Z,NotInsert
0161+  9292             ;Ввод в	середину текста
0162+  9292 4F          	LD	C,A
0163+  9293 06 00       	LD	B,#00
0164+  9295 DD E5       	PUSH	IX
0165+  9297 E1          	POP	HL
0166+  9298 11 0C 00    	LD	DE,LenInpData
0167+  929B 19          	ADD	HL,DE
0168+  929C DD 5E 04    	LD	E,(IX+#04)
0169+  929F 19          	ADD	HL,DE
0170+  92A0 5D          	LD	E,L
0171+  92A1 54          	LD	D,H
0172+  92A2 2B          	DEC	HL
0173+  92A3 ED B8       	LDDR 
0174+  92A5             NotInsert
0175+  92A5 DD E5       	PUSH	IX
0176+  92A7 E1          	POP	HL
0177+  92A8 11 0C 00    	LD	DE,LenInpData
0178+  92AB 19          	ADD	HL,DE
0179+  92AC DD 5E 02    	LD	E,(IX+#02)
0180+  92AF 19          	ADD	HL,DE
0181+  92B0 08          	EX	AF,AF'
0182+  92B1 77          	LD	(HL),A
0183+  92B2 DD 34 04    	INC	(IX+#04)
0184+  92B5 DD 34 02    	INC	(IX+#02)
0185+  92B8 CD CF 94    	CALL	PrintInpLn
0186+  92BB C9          	RET 
0187+  92BC             ;Clear Buffer
0188+  92BC             ClearInpLn
0189+  92BC DD CB 01 BE 	RES	7,(IX+#01)
0190+  92C0 DD E5       	PUSH	IX
0191+  92C2 E1          	POP	HL
0192+  92C3 11 0C 00    	LD	DE,LenInpData
0193+  92C6 19          	ADD	HL,DE
0194+  92C7 DD 46 00    	LD	B,(IX+#00)
0195+  92CA 97          	SUB	A
0196+  92CB 77          	LD	(HL),A
0197+  92CC 23          	INC	HL
0198+  92CD 10 FC       	DJNZ	$-2
0199+  92CF DD 77 02    	LD	(IX+#02),A
0200+  92D2 DD 77 03    	LD	(IX+#03),A
0201+  92D5 DD 77 04    	LD	(IX+#04),A
0202+  92D8 CD CF 94    	CALL	PrintInpLn
0203+  92DB C9          	RET 
0204+  92DC             ;Курсор	влево на одно место
0205+  92DC DD CB 01 BE ILleft	RES	7,(IX+#01)
0206+  92E0 DD 7E 02    	LD	A,(IX+#02)
0207+  92E3 3D          	DEC	A
0208+  92E4 F8          	RET	M
0209+  92E5 DD 77 02    	LD	(IX+#02),A
0210+  92E8 CD CF 94    	CALL	PrintInpLn
0211+  92EB C9          	RET 
0212+  92EC             ;Курсор	вправо на одно место
0213+  92EC DD CB 01 BE ILright	RES	7,(IX+#01)
0214+  92F0 DD 7E 02    	LD	A,(IX+#02)
0215+  92F3 DD BE 04    	CP	(IX+#04)
0216+  92F6 C8          	RET	Z
0217+  92F7 DD 34 02    	INC	(IX+#02)
0218+  92FA CD CF 94    	CALL	PrintInpLn
0219+  92FD C9          	RET 
0220+  92FE             ;delete
0221+  92FE DD CB 01 7E ILdelet	BIT	7,(IX+#01)	;ready
0222+  9302 C4 BC 92    	CALL	NZ,ClearInpLn
0223+  9305 DD 7E 02    	LD	A,(IX+#02)
0224+  9308 B7          	OR	A
0225+  9309 C8          	RET	Z
0226+  930A DD E5       	PUSH	IX
0227+  930C E1          	POP	HL
0228+  930D 11 0C 00    	LD	DE,LenInpData
0229+  9310 19          	ADD	HL,DE
0230+  9311 DD 5E 02    	LD	E,(IX+#02)
0231+  9314 19          	ADD	HL,DE
0232+  9315 5D          	LD	E,L
0233+  9316 54          	LD	D,H
0234+  9317 1B          	DEC	DE
0235+  9318 DD 7E 04    	LD	A,(IX+#04)
0236+  931B DD 96 02    	SUB	(IX+#02)
0237+  931E 28 06       	JR	Z,ILDel1
0238+  9320 4F          	LD	C,A
0239+  9321 06 00       	LD	B,#00
0240+  9323 ED B0       	LDIR 
0241+  9325 97          	SUB	A
0242+  9326 12          ILDel1	LD	(DE),A
0243+  9327 DD 35 02    	DEC	(IX+#02)
0244+  932A DD 35 04    	DEC	(IX+#04)
0245+  932D CD CF 94    	CALL	PrintInpLn
0246+  9330 C9          	RET 
0247+  9331             ;Delete	Char in	Current	Position
0248+  9331 DD CB 01 7E IL_del_	BIT	7,(IX+#01)	;ready
0249+  9335 C4 BC 92    	CALL	NZ,ClearInpLn
0250+  9338 DD E5       	PUSH	IX
0251+  933A E1          	POP	HL
0252+  933B 11 0C 00    	LD	DE,LenInpData
0253+  933E 19          	ADD	HL,DE
0254+  933F DD 5E 02    	LD	E,(IX+#02)
0255+  9342 19          	ADD	HL,DE
0256+  9343 23          	INC	HL
0257+  9344 5D          	LD	E,L
0258+  9345 54          	LD	D,H
0259+  9346 1B          	DEC	DE
0260+  9347 DD 7E 04    	LD	A,(IX+#04)
0261+  934A DD 96 02    	SUB	(IX+#02)
0262+  934D C8          	RET	Z
0263+  934E 4F          	LD	C,A
0264+  934F 06 00       	LD	B,#00
0265+  9351 ED B0       	LDIR 
0266+  9353 97          	SUB	A
0267+  9354 12          	LD	(DE),A
0268+  9355 DD 35 04    	DEC	(IX+#04)
0269+  9358 CD CF 94    	CALL	PrintInpLn
0270+  935B C9          	RET 
0271+  935C             ;Home
0272+  935C DD CB 01 BE ILhome	RES	7,(IX+#01)
0273+  9360 DD 7E 02    	LD	A,(IX+#02)
0274+  9363 B7          	OR	A
0275+  9364 C8          	RET	Z
0276+  9365 97          	SUB	A
0277+  9366 DD 77 02    	LD	(IX+#02),A
0278+  9369 CD CF 94    	CALL	PrintInpLn
0279+  936C C9          	RET 
0280+  936D             ;End string
0281+  936D DD CB 01 BE ILend	RES	7,(IX+#01)
0282+  9371 DD 7E 04    	LD	A,(IX+#04)
0283+  9374 DD BE 02    	CP	(IX+#02)
0284+  9377 C8          	RET	Z
0285+  9378 DD 77 02    	LD	(IX+#02),A
0286+  937B CD CF 94    	CALL	PrintInpLn
0287+  937E C9          	RET 
0288+  937F             ;Word right
0289+  937F DD CB 01 BE ILwordR	RES	7,(IX+#01)
0290+  9383 DD 7E 04    	LD	A,(IX+#04)
0291+  9386 DD 96 02    	SUB	(IX+#02)
0292+  9389 C8          	RET	Z
0293+  938A 47          	LD	B,A
0294+  938B DD E5       	PUSH	IX
0295+  938D E1          	POP	HL
0296+  938E 11 0C 00    	LD	DE,LenInpData
0297+  9391 19          	ADD	HL,DE
0298+  9392 DD 5E 02    	LD	E,(IX+#02)
0299+  9395 19          	ADD	HL,DE
0300+  9396 4B          	LD	C,E
0301+  9397 7E          wr0	LD	A,(HL)
0302+  9398 FE 20       	CP	#20
0303+  939A 28 12       	JR	Z,WRIL1
0304+  939C FE 2C       	CP	","
0305+  939E 28 0E       	JR	Z,WRIL1
0306+  93A0 FE 2E       	CP	"."
0307+  93A2 28 0A       	JR	Z,WRIL1
0308+  93A4 FE 5C       	CP	"\\"
0309+  93A6 28 06       	JR	Z,WRIL1
0310+  93A8 23          	INC	HL
0311+  93A9 0C          	INC	C
0312+  93AA 10 EB       	DJNZ	wr0
0313+  93AC 18 15       	JR	WRIL2
0314+  93AE 7E          WRIL1	LD	A,(HL)
0315+  93AF FE 20       	CP	#20
0316+  93B1 28 0C       	JR	Z,$+14
0317+  93B3 FE 2C       	CP	","
0318+  93B5 28 08       	JR	Z,$+10
0319+  93B7 FE 2E       	CP	"."
0320+  93B9 28 04       	JR	Z,$+6
0321+  93BB FE 5C       	CP	"\\"
0322+  93BD 20 04       	JR	NZ,WRIL2
0323+  93BF 23          	INC	HL
0324+  93C0 0C          	INC	C
0325+  93C1 10 EB       	DJNZ	WRIL1
0326+  93C3 DD 71 02    WRIL2	LD	(IX+#02),C
0327+  93C6 CD CF 94    	CALL	PrintInpLn
0328+  93C9 C9          	RET 
0329+  93CA             ;Word left
0330+  93CA DD CB 01 BE ILwordL	RES	7,(IX+#01)
0331+  93CE DD 7E 02    	LD	A,(IX+#02)
0332+  93D1 B7          	OR	A
0333+  93D2 C8          	RET	Z
0334+  93D3 47          	LD	B,A
0335+  93D4 48          	LD	C,B
0336+  93D5 DD E5       	PUSH	IX
0337+  93D7 E1          	POP	HL
0338+  93D8 11 0C 00    	LD	DE,LenInpData
0339+  93DB 19          	ADD	HL,DE
0340+  93DC 59          	LD	E,C
0341+  93DD 19          	ADD	HL,DE
0342+  93DE 2B          wl0	DEC	HL
0343+  93DF 0D          	DEC	C
0344+  93E0 7E          	LD	A,(HL)
0345+  93E1 FE 20       	CP	#20
0346+  93E3 28 10       	JR	Z,WLIL1
0347+  93E5 FE 2C       	CP	","
0348+  93E7 28 0C       	JR	Z,WLIL1
0349+  93E9 FE 2E       	CP	"."
0350+  93EB 28 08       	JR	Z,WLIL1
0351+  93ED FE 5C       	CP	"\\"
0352+  93EF 28 04       	JR	Z,WLIL1
0353+  93F1 10 EB       	DJNZ	wl0
0354+  93F3 18 16       	JR	WLIL2
0355+  93F5 7E          WLIL1	LD	A,(HL)
0356+  93F6 FE 20       	CP	#20
0357+  93F8 28 0C       	JR	Z,$+14
0358+  93FA FE 2C       	CP	","
0359+  93FC 28 08       	JR	Z,$+10
0360+  93FE FE 2E       	CP	"."
0361+  9400 28 04       	JR	Z,$+6
0362+  9402 FE 5C       	CP	"\\"
0363+  9404 20 04       	JR	NZ,WLIL2-1
0364+  9406 2B          	DEC	HL
0365+  9407 0D          	DEC	C
0366+  9408 10 EB       	DJNZ	WLIL1
0367+  940A 0C          	INC	C
0368+  940B DD 71 02    WLIL2	LD	(IX+#02),C
0369+  940E CD CF 94    	CALL	PrintInpLn
0370+  9411 C9          	RET 
0371+  9412             ;Delete	word
0372+  9412 DD CB 01 BE ILdelWR	RES	7,(IX+#01)
0373+  9416 DD 7E 02    	LD	A,(IX+#02)
0374+  9419 B7          	OR	A
0375+  941A C8          	RET	Z
0376+  941B 47          	LD	B,A
0377+  941C 48          	LD	C,B
0378+  941D DD E5       	PUSH	IX
0379+  941F E1          	POP	HL
0380+  9420 11 0C 00    	LD	DE,LenInpData
0381+  9423 19          	ADD	HL,DE
0382+  9424 59          	LD	E,C
0383+  9425 19          	ADD	HL,DE
0384+  9426 DD 7E 04    	LD	A,(IX+#04)
0385+  9429 90          	SUB	B
0386+  942A 5F          	LD	E,A
0387+  942B E5          	PUSH	HL
0388+  942C 2B          	DEC	HL
0389+  942D 0D          	DEC	C
0390+  942E 7E          	LD	A,(HL)
0391+  942F FE 20       	CP	#20
0392+  9431 28 26       	JR	Z,DWIL1
0393+  9433 FE 2C       	CP	","
0394+  9435 28 22       	JR	Z,DWIL1
0395+  9437 FE 2E       	CP	"."
0396+  9439 28 1E       	JR	Z,DWIL1
0397+  943B FE 5C       	CP	"\\"
0398+  943D 28 1A       	JR	Z,DWIL1
0399+  943F 05          	DEC	B
0400+  9440 28 2E       	JR	Z,DWIL2
0401+  9442 2B          dw0	DEC	HL
0402+  9443 0D          	DEC	C
0403+  9444 7E          	LD	A,(HL)
0404+  9445 FE 20       	CP	#20
0405+  9447 28 25       	JR	Z,DWIL2-2
0406+  9449 FE 2C       	CP	","
0407+  944B 28 21       	JR	Z,DWIL2-2
0408+  944D FE 2E       	CP	"."
0409+  944F 28 1D       	JR	Z,DWIL2-2
0410+  9451 FE 5C       	CP	"\\"
0411+  9453 28 19       	JR	Z,DWIL2-2
0412+  9455 10 EB       	DJNZ	dw0
0413+  9457 18 17       	JR	DWIL2
0414+  9459 7E          DWIL1	LD	A,(HL)
0415+  945A FE 20       	CP	#20
0416+  945C 28 0C       	JR	Z,$+14
0417+  945E FE 2C       	CP	","
0418+  9460 28 08       	JR	Z,$+10
0419+  9462 FE 2E       	CP	"."
0420+  9464 28 04       	JR	Z,$+6
0421+  9466 FE 5C       	CP	"\\"
0422+  9468 20 04       	JR	NZ,DWIL2-2
0423+  946A 2B          	DEC	HL
0424+  946B 0D          	DEC	C
0425+  946C 10 EB       	DJNZ	DWIL1
0426+  946E 23          	INC	HL
0427+  946F 0C          	INC	C
0428+  9470 DD 7E 02    DWIL2	LD	A,(IX+#02)
0429+  9473 DD 71 02    	LD	(IX+#02),C
0430+  9476 91          	SUB	C
0431+  9477 4F          	LD	C,A
0432+  9478 08          	EX	AF,AF'
0433+  9479 DD 7E 04    	LD	A,(IX+#04)
0434+  947C 91          	SUB	C
0435+  947D DD 77 04    	LD	(IX+#04),A
0436+  9480 4B          	LD	C,E
0437+  9481 06 00       	LD	B,#00
0438+  9483 EB          	EX	DE,HL
0439+  9484 E1          	POP	HL
0440+  9485 79          	LD	A,C
0441+  9486 B7          	OR	A
0442+  9487 28 02       	JR	Z,DWIL21
0443+  9489 ED B0       	LDIR 
0444+  948B EB          DWIL21	EX	DE,HL
0445+  948C 08          	EX	AF,AF'
0446+  948D 47          	LD	B,A
0447+  948E 97          	SUB	A
0448+  948F 77          	LD	(HL),A
0449+  9490 23          	INC	HL
0450+  9491 10 FC       	DJNZ	$-2
0451+  9493 CD CF 94    	CALL	PrintInpLn
0452+  9496 C9          	RET 
0453+  9497             ;[]----------------------------------------------------------[]
0454+  9497             InsInpLnCol
0455+  9497 DD 6E 07    	LD	L,(IX+#07)
0456+  949A DD 66 08    	LD	H,(IX+#08)
0457+  949D 22 A1 95    	LD	(FillILy),HL
0458+  94A0 DD 7E 0B    	LD	A,(IX+#0B)
0459+  94A3 E6 0F       	AND	#0F		;INK
0460+  94A5 4F          	LD	C,A
0461+  94A6 07          	RLCA 
0462+  94A7 07          	RLCA 
0463+  94A8 07          	RLCA 
0464+  94A9 07          	RLCA 
0465+  94AA B1          	OR	C
0466+  94AB 21 B1 95    	LD	HL,PrnINKl	;INK буфер
0467+  94AE 06 08       	LD	B,#08
0468+  94B0 2F          	CPL 
0469+  94B1 77          	LD	(HL),A
0470+  94B2 23          	INC	HL
0471+  94B3 10 FC       	DJNZ	$-2
0472+  94B5 47          	LD	B,A
0473+  94B6 DD 7E 0B    	LD	A,(IX+#0B)
0474+  94B9 E6 F0       	AND	#F0		;PAPER
0475+  94BB 4F          	LD	C,A
0476+  94BC 0F          	RRCA 
0477+  94BD 0F          	RRCA 
0478+  94BE 0F          	RRCA 
0479+  94BF 0F          	RRCA 
0480+  94C0 32 A7 95    	LD	(FillILc),A
0481+  94C3 B1          	OR	C
0482+  94C4 A8          	XOR	B
0483+  94C5 21 B9 95    	LD	HL,PrnPAPl	;PAPER буфер
0484+  94C8 06 08       	LD	B,#08
0485+  94CA 77          	LD	(HL),A
0486+  94CB 23          	INC	HL
0487+  94CC 10 FC       	DJNZ	$-2
0488+  94CE C9          	RET 
0489+  94CF             ;
0490+  94CF             PrintInpLn
0491+  94CF CD 99 96    	CALL	ResCursor
0492+  94D2 DD 7E 02    	LD	A,(IX+#02)
0493+  94D5 DD 96 03    	SUB	(IX+#03)
0494+  94D8 30 0A       	JR	NC,PrnInpLn1
0495+  94DA DD 7E 03    	LD	A,(IX+#03)
0496+  94DD D6 08       	SUB	Step
0497+  94DF DD 77 03    	LD	(IX+#03),A
0498+  94E2 18 EE       	JR	PrintInpLn+3
0499+  94E4             PrnInpLn1
0500+  94E4 DD E5       	PUSH	IX
0501+  94E6 E1          	POP	HL
0502+  94E7 11 0C 00    	LD	DE,LenInpData
0503+  94EA 19          	ADD	HL,DE
0504+  94EB DD 5E 03    	LD	E,(IX+#03)
0505+  94EE 19          	ADD	HL,DE
0506+  94EF B7          	OR	A
0507+  94F0 C4 C1 95    	CALL	NZ,TstInpLnLen	;На вход: HL-начало вывода
0508+  94F3             				;	  А -кол.симв.до курсора
0509+  94F3 FD E5       	PUSH	IY
0510+  94F5 DD E5       	PUSH	IX
0511+  94F7 DD 7E 07    	LD	A,(IX+#07)
0512+  94FA FD 6F       	LD	LY,A		;Y координата
0513+  94FC DD 7E 04    	LD	A,(IX+#04)
0514+  94FF FD 67       	LD	HY,A
0515+  9501 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0516+  9503 F5          	PUSH	AF
0517+  9504 D9          	EXX 
0518+  9505 21 B9 95    	LD	HL,PrnPAPl
0519+  9508 11 B1 95    	LD	DE,PrnINKl
0520+  950B DD 4E 05    	LD	C,(IX+#05)
0521+  950E DD 46 06    	LD	B,(IX+#06)
0522+  9511 CB 38       	SRL	B
0523+  9513 CB 19       	RR	C
0524+  9515 CB F0       	SET	6,B
0525+  9517 D9          	EXX 
0526+  9518 DD 4E 09    	LD	C,(IX+#09)
0527+  951B DD 46 0A    	LD	B,(IX+#0A)
0528+  951E CB 38       	SRL	B
0529+  9520 CB 19       	RR	C
0530+  9522 DD 69       	LD	LX,C
0531+  9524 4D          	LD	C,L		;Адрес строки
0532+  9525 44          	LD	B,H
0533+  9526 DB A2       	IN	A,(PAGE1)
0534+  9528 DD 67       	LD	HX,A
0535+  952A F3          	DI 
0536+  952B DB 82       	IN	A,(PAGE0)
0537+  952D F5          	PUSH	AF
0538+  952E 3A EB A7    	LD	A,(FONTpage)
0539+  9531 D3 82       	OUT	(PAGE0),A
0540+  9533 52          	LD	D,D
0541+  9534 3E 08       	LD	A,#08
0542+  9536 40          	LD	B,B
0543+  9537 FD 7C       	LD	A,HY
0544+  9539 B7          	OR	A
0545+  953A 28 41       	JR	Z,PrnInpE
0546+  953C 0A          	LD	A,(BC)
0547+  953D 03          	INC	BC
0548+  953E 6F          PInpLnP	LD	L,A
0549+  953F 26 00       	LD	H,high IFFFont-#C0
0550+  9541 C5          	PUSH	BC
0551+  9542 46          	LD	B,(HL)		;длина символа
0552+  9543 24          	INC	H
0553+  9544 5E          	LD	E,(HL)
0554+  9545 24          	INC	H
0555+  9546 56          	LD	D,(HL)
0556+  9547 21 08 00    	LD	HL,#0008
0557+  954A EB          	EX	DE,HL
0558+  954B 3E 50       	LD	A,#50
0559+  954D D3 A2       	OUT	(PAGE1),A
0560+  954F             PrnLoopInp
0561+  954F 6D          	LD	L,L
0562+  9550 7E          	LD	A,(HL)
0563+  9551 40          	LD	B,B
0564+  9552 D9          	EXX 
0565+  9553 FD 7D       	LD	A,LY
0566+  9555 D3 89       	OUT	(YPORT),A
0567+  9557 6D          	LD	L,L
0568+  9558 B6          	OR	(HL)
0569+  9559 40          	LD	B,B
0570+  955A EB          	EX	DE,HL
0571+  955B 6D          	LD	L,L
0572+  955C AE          	XOR	(HL)
0573+  955D 7F          	LD	A,A
0574+  955E 02          	LD	(BC),A
0575+  955F 40          	LD	B,B
0576+  9560 EB          	EX	DE,HL
0577+  9561 03          	INC	BC
0578+  9562 D9          	EXX 
0579+  9563 19          	ADD	HL,DE
0580+  9564 DD 2D       	DEC	LX
0581+  9566 28 02       	JR	Z,$+4
0582+  9568 10 E5       	DJNZ	PrnLoopInp
0583+  956A C1          	POP	BC
0584+  956B DD 7C       	LD	A,HX
0585+  956D D3 A2       	OUT	(PAGE1),A
0586+  956F DD 7D       	LD	A,LX
0587+  9571 B7          	OR	A
0588+  9572 28 09       	JR	Z,PrnInpE
0589+  9574 FD 25       	DEC	HY
0590+  9576 28 05       	JR	Z,PrnInpE
0591+  9578 0A          	LD	A,(BC)
0592+  9579 03          	INC	BC
0593+  957A B7          	OR	A
0594+  957B 20 C1       	JR	NZ,PInpLnP
0595+  957D F1          PrnInpE	POP	AF
0596+  957E D3 82       	OUT	(PAGE0),A
0597+  9580 FB          	EI 
0598+  9581 F1          	POP	AF
0599+  9582 D3 89       	OUT	(YPORT),A
0600+  9584 DD 7D       	LD	A,LX
0601+  9586 B7          	OR	A
0602+  9587 28 20       	JR	Z,PrnInE1
0603+  9589 6F          	LD	L,A
0604+  958A 26 00       	LD	H,#00
0605+  958C 29          	ADD	HL,HL
0606+  958D 22 A3 95    	LD	(FillILl),HL
0607+  9590 D9          	EXX 
0608+  9591 C5          	PUSH	BC
0609+  9592 D9          	EXX 
0610+  9593 E1          	POP	HL
0611+  9594 CB B4       	RES	6,H
0612+  9596 29          	ADD	HL,HL
0613+  9597 22 9F 95    	LD	(FillILx),HL
0614+  959A CD F0 86    	CALL	MakeWindow
0615+  959D 80          	DEFB	#80
0616+  959E 02          	DEFB	#02
0617+  959F 00 00       FillILx	DEFW	#0000
0618+  95A1 00 00       FillILy	DEFW	#0000
0619+  95A3 00 00 08 00 FillILl	DEFW	#0000,#0008
0620+  95A7 00          FillILc	DEFB	#00
0621+  95A8 00          	DEFB	#00
0622+  95A9 DD E1       PrnInE1	POP	IX
0623+  95AB FD E1       	POP	IY
0624+  95AD CD 0C 96    	CALL	SetCursor
0625+  95B0 C9          	RET 
0626+  95B1             
0627+  95B1 00          PrnINKl	DEFS	8,0
0628+  95B9 00          PrnPAPl	DEFS	8,0
0629+  95C1             
0630+  95C1             TstInpLnLen
0631+  95C1 FD E5       	PUSH	IY
0632+  95C3 FD 6F       	LD	LY,A
0633+  95C5 FD 67       	LD	HY,A
0634+  95C7 F3          	DI 
0635+  95C8 DB 82       	IN	A,(PAGE0)
0636+  95CA F5          	PUSH	AF
0637+  95CB 3A EB A7    	LD	A,(FONTpage)
0638+  95CE D3 82       	OUT	(PAGE0),A
0639+  95D0 16 00       	LD	D,high IFFFont-#C0
0640+  95D2             TstInpLn
0641+  95D2 E5          	PUSH	HL
0642+  95D3 01 00 00    	LD	BC,#0000
0643+  95D6 5E          TstInpL	LD	E,(HL)
0644+  95D7 23          	INC	HL
0645+  95D8 1A          	LD	A,(DE)
0646+  95D9 87          	ADD	A,A
0647+  95DA 81          	ADD	A,C
0648+  95DB 4F          	LD	C,A
0649+  95DC 78          	LD	A,B
0650+  95DD CE 00       	ADC	A,#00
0651+  95DF 47          	LD	B,A
0652+  95E0 FD 2D       	DEC	LY
0653+  95E2 20 F2       	JR	NZ,TstInpL
0654+  95E4 DD 6E 09    	LD	L,(IX+#09)
0655+  95E7 DD 66 0A    	LD	H,(IX+#0A)
0656+  95EA B7          	OR	A
0657+  95EB ED 42       	SBC	HL,BC
0658+  95ED 30 15       	JR	NC,TstInpE
0659+  95EF E1          	POP	HL
0660+  95F0 01 08 00    	LD	BC,Step
0661+  95F3 09          	ADD	HL,BC
0662+  95F4 DD 7E 03    	LD	A,(IX+#03)
0663+  95F7 81          	ADD	A,C
0664+  95F8 DD 77 03    	LD	(IX+#03),A
0665+  95FB FD 7C       	LD	A,HY
0666+  95FD 91          	SUB	C
0667+  95FE FD 67       	LD	HY,A
0668+  9600 FD 6F       	LD	LY,A
0669+  9602 18 CE       	JR	TstInpLn
0670+  9604 E1          TstInpE	POP	HL
0671+  9605 F1          	POP	AF
0672+  9606 D3 82       	OUT	(PAGE0),A
0673+  9608 FB          	EI 
0674+  9609 FD E1       	POP	IY
0675+  960B C9          	RET 
0676+  960C             SetCursor
0677+  960C DD E5       	PUSH	IX
0678+  960E E1          	POP	HL
0679+  960F 11 0C 00    	LD	DE,LenInpData
0680+  9612 19          	ADD	HL,DE
0681+  9613 DD 5E 03    	LD	E,(IX+#03)
0682+  9616 19          	ADD	HL,DE
0683+  9617 01 00 00    	LD	BC,#0000
0684+  961A DD 7E 02    	LD	A,(IX+#02)
0685+  961D 93          	SUB	E
0686+  961E 28 20       	JR	Z,StCurs1
0687+  9620 08          	EX	AF,AF'
0688+  9621 F3          	DI 
0689+  9622 DB 82       	IN	A,(PAGE0)
0690+  9624 F5          	PUSH	AF
0691+  9625 3A EB A7    	LD	A,(FONTpage)
0692+  9628 D3 82       	OUT	(PAGE0),A
0693+  962A 16 00       	LD	D,high IFFFont-#C0
0694+  962C 08          	EX	AF,AF'
0695+  962D 08          StCurs0	EX	AF,AF'
0696+  962E 5E          	LD	E,(HL)
0697+  962F 23          	INC	HL
0698+  9630 1A          	LD	A,(DE)
0699+  9631 87          	ADD	A,A
0700+  9632 81          	ADD	A,C
0701+  9633 4F          	LD	C,A
0702+  9634 78          	LD	A,B
0703+  9635 CE 00       	ADC	A,#00
0704+  9637 47          	LD	B,A
0705+  9638 08          	EX	AF,AF'
0706+  9639 3D          	DEC	A
0707+  963A 20 F1       	JR	NZ,StCurs0
0708+  963C F1          	POP	AF
0709+  963D D3 82       	OUT	(PAGE0),A
0710+  963F FB          	EI 
0711+  9640 ED 43 EA 96 StCurs1	LD	(CurShiftX),BC
0712+  9644 3E 01       	LD	A,#01
0713+  9646 32 ED 96    	LD	(CurCursor),A
0714+  9649 3E 0E       	LD	A,CursTimer
0715+  964B 32 EC 96    	LD	(CrTimer),A
0716+  964E DD 6E 05    SetCr	LD	L,(IX+#05)
0717+  9651 DD 66 06    	LD	H,(IX+#06)
0718+  9654 ED 4B EA 96 	LD	BC,(CurShiftX)
0719+  9658 09          	ADD	HL,BC
0720+  9659 CB 3C       	SRL	H
0721+  965B CB 1D       	RR	L
0722+  965D CB F4       	SET	6,H
0723+  965F DB A2       	IN	A,(PAGE1)
0724+  9661 4F          	LD	C,A
0725+  9662 DB 89       	IN	A,(YPORT)
0726+  9664 47          	LD	B,A
0727+  9665 C5          	PUSH	BC
0728+  9666 11 EE 96    	LD	DE,CursBuffer
0729+  9669 DD 4E 07    	LD	C,(IX+#07)
0730+  966C 0D          	DEC	C
0731+  966D DD 7E 0B    	LD	A,(IX+#0B)
0732+  9670 E6 0F       	AND	#0F
0733+  9672 47          	LD	B,A
0734+  9673 07          	RLCA 
0735+  9674 07          	RLCA 
0736+  9675 07          	RLCA 
0737+  9676 07          	RLCA 
0738+  9677 B0          	OR	B
0739+  9678 47          	LD	B,A
0740+  9679 3E 50       	LD	A,#50
0741+  967B D3 A2       	OUT	(PAGE1),A
0742+  967D F3          	DI 
0743+  967E 79          	LD	A,C
0744+  967F D3 89       	OUT	(YPORT),A
0745+  9681 52          	LD	D,D
0746+  9682 3E 09       	LD	A,#09
0747+  9684 7F          	LD	A,A
0748+  9685 7E          	LD	A,(HL)
0749+  9686 40          	LD	B,B
0750+  9687 6D          	LD	L,L
0751+  9688 12          	LD	(DE),A
0752+  9689 40          	LD	B,B
0753+  968A 79          	LD	A,C
0754+  968B D3 89       	OUT	(YPORT),A
0755+  968D 5B          	LD	E,E
0756+  968E 70          	LD	(HL),B
0757+  968F 40          	LD	B,B
0758+  9690 FB          	EI 
0759+  9691 C1          	POP	BC
0760+  9692 78          	LD	A,B
0761+  9693 D3 89       	OUT	(YPORT),A
0762+  9695 79          	LD	A,C
0763+  9696 D3 A2       	OUT	(PAGE1),A
0764+  9698 C9          	RET 
0765+  9699             ResCursor
0766+  9699 DD 6E 05    	LD	L,(IX+#05)
0767+  969C DD 66 06    	LD	H,(IX+#06)
0768+  969F ED 4B EA 96 	LD	BC,(CurShiftX)
0769+  96A3 09          	ADD	HL,BC
0770+  96A4 CB 3C       	SRL	H
0771+  96A6 CB 1D       	RR	L
0772+  96A8 CB F4       	SET	6,H
0773+  96AA DB A2       	IN	A,(PAGE1)
0774+  96AC 4F          	LD	C,A
0775+  96AD DB 89       	IN	A,(YPORT)
0776+  96AF 47          	LD	B,A
0777+  96B0 C5          	PUSH	BC
0778+  96B1 11 EE 96    	LD	DE,CursBuffer
0779+  96B4 DD 4E 07    	LD	C,(IX+#07)
0780+  96B7 0D          	DEC	C
0781+  96B8 3E 50       	LD	A,#50
0782+  96BA D3 A2       	OUT	(PAGE1),A
0783+  96BC F3          	DI 
0784+  96BD 52          	LD	D,D
0785+  96BE 3E 09       	LD	A,#09
0786+  96C0 6D          	LD	L,L
0787+  96C1 1A          	LD	A,(DE)
0788+  96C2 40          	LD	B,B
0789+  96C3 79          	LD	A,C
0790+  96C4 D3 89       	OUT	(YPORT),A
0791+  96C6 7F          	LD	A,A
0792+  96C7 77          	LD	(HL),A
0793+  96C8 40          	LD	B,B
0794+  96C9 FB          	EI 
0795+  96CA C1          	POP	BC
0796+  96CB 78          	LD	A,B
0797+  96CC D3 89       	OUT	(YPORT),A
0798+  96CE 79          	LD	A,C
0799+  96CF D3 A2       	OUT	(PAGE1),A
0800+  96D1 C9          	RET 
0801+  96D2             ChCursor
0802+  96D2 21 EC 96    	LD	HL,CrTimer
0803+  96D5 35          	DEC	(HL)
0804+  96D6 C0          	RET	NZ
0805+  96D7 36 0E       	LD	(HL),CursTimer
0806+  96D9 DD 2A 44 92 	LD	IX,(InpLnData)
0807+  96DD 3A ED 96    	LD	A,(CurCursor)
0808+  96E0 EE 01       	XOR	#01
0809+  96E2 32 ED 96    	LD	(CurCursor),A
0810+  96E5 28 B2       	JR	Z,ResCursor
0811+  96E7 C3 4E 96    	JP	SetCr
0812+  96EA             CurShiftX
0813+  96EA 00 00       	DEFW	#00
0814+  96EC             CrTimer
0815+  96EC 00          	DEFB	#00
0816+  96ED             CurCursor
0817+  96ED 00          	DEFB	#00
0818+  96EE             CursBuffer
0819+  96EE 00          	DEFS	9,0
0820+  96F7             
0821+  96F7             
0822+  96F7             
0062   96F7             	include "fnbar.z80"
0001+  96F7             
0002+  96F7             ;[]-----------------------------------------------------------[]
0003+  96F7             InitScrBar
0004+  96F7 DD 4E 0C    	LD	C,(IX+BarPAGEl)
0005+  96FA DD 46 0D    	LD	B,(IX+BarPAGEh)	;Кол-во	элем.на	стр.
0006+  96FD 69          	LD	L,C
0007+  96FE 60          	LD	H,B
0008+  96FF DD 5E 0E    	LD	E,(IX+BarMAXl)
0009+  9702 DD 56 0F    	LD	D,(IX+BarMAXh)	;макс.элементов
0010+  9705 7A          	LD	A,D
0011+  9706 B3          	OR	E
0012+  9707 20 01       	JR	NZ,$+3
0013+  9709 13          	INC	DE
0014+  970A B7          	OR	A
0015+  970B ED 52       	SBC	HL,DE
0016+  970D 38 02       	JR	C,$+4
0017+  970F 19          	ADD	HL,DE
0018+  9710 EB          	EX	DE,HL
0019+  9711 D5          	PUSH	DE
0020+  9712 DD 5E 04    	LD	E,(IX+BarMaxLl)
0021+  9715 DD 56 05    	LD	D,(IX+BarMaxLh)	;Кол-во	вид.элем.*размер бара
0022+  9718 CD 0F A2    	CALL	Mult16X16	;DE*BC=HL+DE
0023+  971B C1          	POP	BC		;/макс.элементов
0024+  971C CD A3 A2    	CALL	Divis32X16	;HL+DE/BC=DE (HL-ост)
0025+  971F 7C          	LD	A,H
0026+  9720 B5          	OR	L
0027+  9721 28 01       	JR	Z,$+3
0028+  9723 13          	INC	DE
0029+  9724 21 03 00    	LD	HL,#0003
0030+  9727 ED 52       	SBC	HL,DE
0031+  9729 38 03       	JR	C,$+5
0032+  972B 11 03 00    	LD	DE,#0003
0033+  972E DD 73 06    	LD	(IX+BarLENl),E	;=длина	бара
0034+  9731 DD 72 07    	LD	(IX+BarLENh),D	;=длина	бара
0035+  9734 C9          	RET 
0036+  9735             PrnHScrBar
0037+  9735 FD E5       	PUSH	IY
0038+  9737 DB 89       	IN	A,(YPORT)
0039+  9739 F5          	PUSH	AF
0040+  973A DB A2       	IN	A,(PAGE1)
0041+  973C FD 6F       	LD	LY,A
0042+  973E DD 6E 10    	LD	L,(IX+BarFRSTl)	;FirstFile
0043+  9741 DD 66 11    	LD	H,(IX+BarFRSTh)
0044+  9744 DD 5E 0C    	LD	E,(IX+BarPAGEl)
0045+  9747 DD 56 0D    	LD	D,(IX+BarPAGEh)
0046+  974A DD 4E 0E    	LD	C,(IX+BarMAXl)	;EquipFiles
0047+  974D DD 46 0F    	LD	B,(IX+BarMAXh)
0048+  9750 78          	LD	A,B
0049+  9751 B1          	OR	C
0050+  9752 20 01       	JR	NZ,$+3
0051+  9754 03          	INC	BC
0052+  9755 C5          	PUSH	BC
0053+  9756 E5          	PUSH	HL
0054+  9757 19          	ADD	HL,DE
0055+  9758 ED 42       	SBC	HL,BC
0056+  975A E1          	POP	HL
0057+  975B 38 0B       	JR	C,PrHScr1
0058+  975D 28 09       	JR	Z,PrHScr1
0059+  975F 69          	LD	L,C
0060+  9760 60          	LD	H,B
0061+  9761 ED 52       	SBC	HL,DE
0062+  9763 30 03       	JR	NC,PrHScr1
0063+  9765 21 00 00    	LD	HL,#0000
0064+  9768 EB          PrHScr1	EX	DE,HL
0065+  9769 DD 4E 04    	LD	C,(IX+BarMaxLl)
0066+  976C DD 46 05    	LD	B,(IX+BarMaxLh)
0067+  976F CD 0F A2    	CALL	Mult16X16
0068+  9772 C1          	POP	BC
0069+  9773 CD A3 A2    	CALL	Divis32X16
0070+  9776 7A          	LD	A,D
0071+  9777 B3          	OR	E
0072+  9778 28 35       	JR	Z,PrHBar1
0073+  977A D5          	PUSH	DE
0074+  977B CB 3A       	SRL	D
0075+  977D CB 1B       	RR	E
0076+  977F 30 01       	JR	NC,$+3
0077+  9781 13          	INC	DE
0078+  9782 DD 6E 00    	LD	L,(IX+BarXl)
0079+  9785 DD 66 01    	LD	H,(IX+BarXh)
0080+  9788 CB 3C       	SRL	H
0081+  978A CB 1D       	RR	L
0082+  978C CB F4       	SET	6,H
0083+  978E DD 7E 02    	LD	A,(IX+BarYl)
0084+  9791 4F          	LD	C,A
0085+  9792 06 88       	LD	B,#88
0086+  9794 3E 50       	LD	A,#50
0087+  9796 D3 A2       	OUT	(PAGE1),A
0088+  9798 F3          	DI 
0089+  9799 52          	LD	D,D
0090+  979A 3E 08       	LD	A,#08
0091+  979C 40          	LD	B,B
0092+  979D 79          FillHl1	LD	A,C
0093+  979E D3 89       	OUT	(YPORT),A
0094+  97A0 5B          	LD	E,E
0095+  97A1 70          	LD	(HL),B
0096+  97A2 40          	LD	B,B
0097+  97A3 23          	INC	HL
0098+  97A4 1B          	DEC	DE
0099+  97A5 7A          	LD	A,D
0100+  97A6 B3          	OR	E
0101+  97A7 20 F4       	JR	NZ,FillHl1
0102+  97A9 FD 7D       	LD	A,LY
0103+  97AB D3 A2       	OUT	(PAGE1),A
0104+  97AD FB          	EI 
0105+  97AE D1          FillHle	POP	DE
0106+  97AF D5          PrHBar1	PUSH	DE
0107+  97B0 DD 6E 00    	LD	L,(IX+BarXl)
0108+  97B3 DD 66 01    	LD	H,(IX+BarXh)
0109+  97B6 19          	ADD	HL,DE
0110+  97B7 DD 5E 08    	LD	E,(IX+BarLEFTl)
0111+  97BA DD 56 09    	LD	D,(IX+BarLEFTh)
0112+  97BD 7A          	LD	A,D
0113+  97BE B3          	OR	E
0114+  97BF 28 09       	JR	Z,PrHBar2
0115+  97C1 EB          	EX	DE,HL
0116+  97C2 3E C0       	LD	A,#C0
0117+  97C4 D3 89       	OUT	(YPORT),A
0118+  97C6 73          	LD	(HL),E
0119+  97C7 23          	INC	HL
0120+  97C8 72          	LD	(HL),D
0121+  97C9 EB          	EX	DE,HL
0122+  97CA E5          PrHBar2	PUSH	HL
0123+  97CB CB 3C       	SRL	H
0124+  97CD CB 1D       	RR	L
0125+  97CF CB F4       	SET	6,H
0126+  97D1 DD 7E 02    	LD	A,(IX+BarYl)
0127+  97D4 4F          	LD	C,A
0128+  97D5 DD 5E 06    	LD	E,(IX+BarLENl)
0129+  97D8 DD 56 07    	LD	D,(IX+BarLENh)
0130+  97DB 7A          	LD	A,D
0131+  97DC B7          	OR	A
0132+  97DD 20 07       	JR	NZ,PrHBr21
0133+  97DF 7B          	LD	A,E
0134+  97E0 FE 06       	CP	#06
0135+  97E2 30 02       	JR	NC,PrHBr21
0136+  97E4 1E 06       	LD	E,#06
0137+  97E6 CB 3A       PrHBr21	SRL	D
0138+  97E8 CB 1B       	RR	E
0139+  97EA 38 01       	JR	C,$+3
0140+  97EC 1B          	DEC	DE
0141+  97ED 1B          	DEC	DE
0142+  97EE 3E 50       	LD	A,#50
0143+  97F0 D3 A2       	OUT	(PAGE1),A
0144+  97F2 F3          	DI 
0145+  97F3 52          	LD	D,D
0146+  97F4 3E 06       	LD	A,#06
0147+  97F6 40          	LD	B,B
0148+  97F7 06 FF       	LD	B,#FF
0149+  97F9 79          	LD	A,C
0150+  97FA D3 89       	OUT	(YPORT),A
0151+  97FC 70          	LD	(HL),B
0152+  97FD 3C          	INC	A
0153+  97FE D3 89       	OUT	(YPORT),A
0154+  9800 5B          	LD	E,E
0155+  9801 70          	LD	(HL),B
0156+  9802 40          	LD	B,B
0157+  9803 36 F7       	LD	(HL),#F7
0158+  9805 23          	INC	HL
0159+  9806 79          HBarLp1	LD	A,C
0160+  9807 D3 89       	OUT	(YPORT),A
0161+  9809 70          	LD	(HL),B
0162+  980A 3C          	INC	A
0163+  980B D3 89       	OUT	(YPORT),A
0164+  980D 3E 88       	LD	A,#88
0165+  980F 5B          	LD	E,E
0166+  9810 77          	LD	(HL),A
0167+  9811 40          	LD	B,B
0168+  9812 36 77       	LD	(HL),#77
0169+  9814 23          	INC	HL
0170+  9815 1B          	DEC	DE
0171+  9816 7A          	LD	A,D
0172+  9817 B3          	OR	E
0173+  9818 20 EC       	JR	NZ,HBarLp1
0174+  981A 79          	LD	A,C
0175+  981B D3 89       	OUT	(YPORT),A
0176+  981D 36 F7       	LD	(HL),#F7
0177+  981F 3C          	INC	A
0178+  9820 D3 89       	OUT	(YPORT),A
0179+  9822 3E 77       	LD	A,#77
0180+  9824 5B          	LD	E,E
0181+  9825 77          	LD	(HL),A
0182+  9826 40          	LD	B,B
0183+  9827 77          	LD	(HL),A
0184+  9828 23          	INC	HL
0185+  9829 EB          	EX	DE,HL
0186+  982A FD 7D       	LD	A,LY
0187+  982C D3 A2       	OUT	(PAGE1),A
0188+  982E FB          	EI 
0189+  982F E1          	POP	HL
0190+  9830 DD 4E 06    	LD	C,(IX+BarLENl)
0191+  9833 DD 46 07    	LD	B,(IX+BarLENh)
0192+  9836 C5          	PUSH	BC
0193+  9837 09          	ADD	HL,BC
0194+  9838 DD 4E 0A    	LD	C,(IX+BarRGHTl)
0195+  983B DD 46 0B    	LD	B,(IX+BarRGHTh)
0196+  983E 78          	LD	A,B
0197+  983F B1          	OR	C
0198+  9840 28 09       	JR	Z,PrHBar3
0199+  9842 3E C0       	LD	A,#C0
0200+  9844 D3 89       	OUT	(YPORT),A
0201+  9846 7D          	LD	A,L
0202+  9847 02          	LD	(BC),A
0203+  9848 03          	INC	BC
0204+  9849 7C          	LD	A,H
0205+  984A 02          	LD	(BC),A
0206+  984B C1          PrHBar3	POP	BC
0207+  984C DD 6E 04    	LD	L,(IX+BarMaxLl)
0208+  984F DD 66 05    	LD	H,(IX+BarMaxLh)
0209+  9852 B7          	OR	A
0210+  9853 ED 42       	SBC	HL,BC
0211+  9855 C1          	POP	BC
0212+  9856 28 30       	JR	Z,HBarExt
0213+  9858 38 2E       	JR	C,HBarExt
0214+  985A B7          	OR	A
0215+  985B ED 42       	SBC	HL,BC
0216+  985D 28 29       	JR	Z,HBarExt
0217+  985F 38 27       	JR	C,HBarExt
0218+  9861 EB          	EX	DE,HL
0219+  9862 CB 3A       	SRL	D
0220+  9864 CB 1B       	RR	E
0221+  9866 28 20       	JR	Z,HBarExt
0222+  9868 DD 7E 02    	LD	A,(IX+BarYl)
0223+  986B 4F          	LD	C,A
0224+  986C 06 88       	LD	B,#88
0225+  986E 3E 50       	LD	A,#50
0226+  9870 D3 A2       	OUT	(PAGE1),A
0227+  9872 F3          	DI 
0228+  9873 52          	LD	D,D
0229+  9874 3E 08       	LD	A,#08
0230+  9876 40          	LD	B,B
0231+  9877 79          FillHl2	LD	A,C
0232+  9878 D3 89       	OUT	(YPORT),A
0233+  987A 5B          	LD	E,E
0234+  987B 70          	LD	(HL),B
0235+  987C 40          	LD	B,B
0236+  987D 23          	INC	HL
0237+  987E 1B          	DEC	DE
0238+  987F 7A          	LD	A,D
0239+  9880 B3          	OR	E
0240+  9881 20 F4       	JR	NZ,FillHl2
0241+  9883 FD 7D       	LD	A,LY
0242+  9885 D3 A2       	OUT	(PAGE1),A
0243+  9887 FB          	EI 
0244+  9888 F1          HBarExt	POP	AF
0245+  9889 D3 89       	OUT	(YPORT),A
0246+  988B FD E1       	POP	IY
0247+  988D C9          	RET 
0248+  988E             PrnVScrBar
0249+  988E FD E5       	PUSH	IY
0250+  9890 DB 89       	IN	A,(YPORT)
0251+  9892 F5          	PUSH	AF
0252+  9893 DB A2       	IN	A,(PAGE1)
0253+  9895 FD 67       	LD	HY,A
0254+  9897 DD 6E 10    	LD	L,(IX+BarFRSTl)	;FirstFile
0255+  989A DD 66 11    	LD	H,(IX+BarFRSTh)
0256+  989D DD 5E 0C    	LD	E,(IX+BarPAGEl)
0257+  98A0 DD 56 0D    	LD	D,(IX+BarPAGEh)
0258+  98A3 DD 4E 0E    	LD	C,(IX+BarMAXl)	;EquipFiles
0259+  98A6 DD 46 0F    	LD	B,(IX+BarMAXh)
0260+  98A9 78          	LD	A,B
0261+  98AA B1          	OR	C
0262+  98AB 20 01       	JR	NZ,$+3
0263+  98AD 03          	INC	BC
0264+  98AE C5          	PUSH	BC
0265+  98AF E5          	PUSH	HL
0266+  98B0 19          	ADD	HL,DE
0267+  98B1 ED 42       	SBC	HL,BC
0268+  98B3 E1          	POP	HL
0269+  98B4 38 0B       	JR	C,PrVScr1
0270+  98B6 28 09       	JR	Z,PrVScr1
0271+  98B8 69          	LD	L,C
0272+  98B9 60          	LD	H,B
0273+  98BA ED 52       	SBC	HL,DE
0274+  98BC 30 03       	JR	NC,PrVScr1
0275+  98BE 21 00 00    	LD	HL,#0000
0276+  98C1 EB          PrVScr1	EX	DE,HL
0277+  98C2 DD 4E 04    	LD	C,(IX+BarMaxLl)
0278+  98C5 DD 46 05    	LD	B,(IX+BarMaxLh)
0279+  98C8 CD 0F A2    	CALL	Mult16X16
0280+  98CB C1          	POP	BC
0281+  98CC CD A3 A2    	CALL	Divis32X16
0282+  98CF DD 7E 02    	LD	A,(IX+BarYl)
0283+  98D2 FD 6F       	LD	LY,A
0284+  98D4 7A          	LD	A,D
0285+  98D5 B3          	OR	E
0286+  98D6 28 33       	JR	Z,PrVBar1
0287+  98D8 D5          	PUSH	DE
0288+  98D9 7B          	LD	A,E
0289+  98DA 32 F2 98    	LD	(VBFill1+1),A
0290+  98DD DD 6E 00    	LD	L,(IX+BarXl)
0291+  98E0 DD 66 01    	LD	H,(IX+BarXh)
0292+  98E3 CB 3C       	SRL	H
0293+  98E5 CB 1D       	RR	L
0294+  98E7 CB F4       	SET	6,H
0295+  98E9 16 88       	LD	D,#88
0296+  98EB 3E 50       	LD	A,#50
0297+  98ED D3 A2       	OUT	(PAGE1),A
0298+  98EF F3          	DI 
0299+  98F0 52          	LD	D,D
0300+  98F1 3E 00       VBFill1	LD	A,#00
0301+  98F3 40          	LD	B,B
0302+  98F4 06 08       	LD	B,#08
0303+  98F6 FD 7D       FillVl1	LD	A,LY
0304+  98F8 D3 89       	OUT	(YPORT),A
0305+  98FA 5B          	LD	E,E
0306+  98FB 72          	LD	(HL),D
0307+  98FC 40          	LD	B,B
0308+  98FD 23          	INC	HL
0309+  98FE 10 F6       	DJNZ	FillVl1
0310+  9900 FD 7D       	LD	A,LY
0311+  9902 83          	ADD	A,E
0312+  9903 FD 6F       	LD	LY,A
0313+  9905 FD 7C       	LD	A,HY
0314+  9907 D3 A2       	OUT	(PAGE1),A
0315+  9909 FB          	EI 
0316+  990A D1          	POP	DE
0317+  990B D5          PrVBar1	PUSH	DE
0318+  990C DD 6E 02    	LD	L,(IX+BarYl)
0319+  990F DD 66 03    	LD	H,(IX+BarYh)
0320+  9912 19          	ADD	HL,DE
0321+  9913 DD 5E 08    	LD	E,(IX+BarLEFTl)
0322+  9916 DD 56 09    	LD	D,(IX+BarLEFTh)
0323+  9919 7A          	LD	A,D
0324+  991A B3          	OR	E
0325+  991B 28 09       	JR	Z,PrVBar2
0326+  991D EB          	EX	DE,HL
0327+  991E 3E C0       	LD	A,#C0
0328+  9920 D3 89       	OUT	(YPORT),A
0329+  9922 73          	LD	(HL),E
0330+  9923 23          	INC	HL
0331+  9924 72          	LD	(HL),D
0332+  9925 EB          	EX	DE,HL
0333+  9926 E5          PrVBar2	PUSH	HL
0334+  9927 DD 6E 00    	LD	L,(IX+BarXl)
0335+  992A DD 66 01    	LD	H,(IX+BarXh)
0336+  992D CB 3C       	SRL	H
0337+  992F CB 1D       	RR	L
0338+  9931 CB F4       	SET	6,H
0339+  9933 DD 7E 06    	LD	A,(IX+BarLENl)
0340+  9936 4F          	LD	C,A
0341+  9937 D6 02       	SUB	#02
0342+  9939 32 43 99    	LD	(VBarLen+1),A
0343+  993C 3E 50       	LD	A,#50
0344+  993E D3 A2       	OUT	(PAGE1),A
0345+  9940 F3          	DI 
0346+  9941 52          	LD	D,D
0347+  9942 3E 00       VBarLen	LD	A,#00
0348+  9944 40          	LD	B,B
0349+  9945 11 88 FF    	LD	DE,#FF88
0350+  9948 FD 7D       	LD	A,LY
0351+  994A D3 89       	OUT	(YPORT),A
0352+  994C 72          	LD	(HL),D
0353+  994D 3C          	INC	A
0354+  994E D3 89       	OUT	(YPORT),A
0355+  9950 5B          	LD	E,E
0356+  9951 72          	LD	(HL),D
0357+  9952 40          	LD	B,B
0358+  9953 36 F7       	LD	(HL),#F7
0359+  9955 23          	INC	HL
0360+  9956 06 06       	LD	B,#06
0361+  9958 FD 7D       VBarLp1	LD	A,LY
0362+  995A D3 89       	OUT	(YPORT),A
0363+  995C 72          	LD	(HL),D
0364+  995D 3C          	INC	A
0365+  995E D3 89       	OUT	(YPORT),A
0366+  9960 5B          	LD	E,E
0367+  9961 73          	LD	(HL),E
0368+  9962 40          	LD	B,B
0369+  9963 36 77       	LD	(HL),#77
0370+  9965 23          	INC	HL
0371+  9966 10 F0       	DJNZ	VBarLp1
0372+  9968 FD 7D       	LD	A,LY
0373+  996A D3 89       	OUT	(YPORT),A
0374+  996C 36 F7       	LD	(HL),#F7
0375+  996E 3C          	INC	A
0376+  996F D3 89       	OUT	(YPORT),A
0377+  9971 3E 77       	LD	A,#77
0378+  9973 5B          	LD	E,E
0379+  9974 77          	LD	(HL),A
0380+  9975 40          	LD	B,B
0381+  9976 77          	LD	(HL),A
0382+  9977 23          	INC	HL
0383+  9978 FD 7D       	LD	A,LY
0384+  997A 81          	ADD	A,C
0385+  997B FD 6F       	LD	LY,A
0386+  997D FD 7C       	LD	A,HY
0387+  997F D3 A2       	OUT	(PAGE1),A
0388+  9981 FB          	EI 
0389+  9982 E1          	POP	HL
0390+  9983 DD 4E 06    	LD	C,(IX+BarLENl)
0391+  9986 DD 46 07    	LD	B,(IX+BarLENh)
0392+  9989 C5          	PUSH	BC
0393+  998A 09          	ADD	HL,BC
0394+  998B DD 4E 0A    	LD	C,(IX+BarRGHTl)
0395+  998E DD 46 0B    	LD	B,(IX+BarRGHTh)
0396+  9991 78          	LD	A,B
0397+  9992 B1          	OR	C
0398+  9993 28 09       	JR	Z,PrVBar3
0399+  9995 3E C0       	LD	A,#C0
0400+  9997 D3 89       	OUT	(YPORT),A
0401+  9999 7D          	LD	A,L
0402+  999A 02          	LD	(BC),A
0403+  999B 03          	INC	BC
0404+  999C 7C          	LD	A,H
0405+  999D 02          	LD	(BC),A
0406+  999E C1          PrVBar3	POP	BC
0407+  999F DD 6E 04    	LD	L,(IX+BarMaxLl)
0408+  99A2 DD 66 05    	LD	H,(IX+BarMaxLh)
0409+  99A5 B7          	OR	A
0410+  99A6 ED 42       	SBC	HL,BC
0411+  99A8 C1          	POP	BC
0412+  99A9 28 35       	JR	Z,VBarExt
0413+  99AB 38 33       	JR	C,VBarExt
0414+  99AD B7          	OR	A
0415+  99AE ED 42       	SBC	HL,BC
0416+  99B0 28 2E       	JR	Z,VBarExt
0417+  99B2 38 2C       	JR	C,VBarExt
0418+  99B4 7D          	LD	A,L
0419+  99B5 32 CD 99    	LD	(VBFill2+1),A
0420+  99B8 DD 6E 00    	LD	L,(IX+BarXl)
0421+  99BB DD 66 01    	LD	H,(IX+BarXh)
0422+  99BE CB 3C       	SRL	H
0423+  99C0 CB 1D       	RR	L
0424+  99C2 CB F4       	SET	6,H
0425+  99C4 16 88       	LD	D,#88
0426+  99C6 3E 50       	LD	A,#50
0427+  99C8 D3 A2       	OUT	(PAGE1),A
0428+  99CA F3          	DI 
0429+  99CB 52          	LD	D,D
0430+  99CC 3E 00       VBFill2	LD	A,#00
0431+  99CE 40          	LD	B,B
0432+  99CF 06 08       	LD	B,#08
0433+  99D1 FD 7D       FillVl2	LD	A,LY
0434+  99D3 D3 89       	OUT	(YPORT),A
0435+  99D5 5B          	LD	E,E
0436+  99D6 72          	LD	(HL),D
0437+  99D7 40          	LD	B,B
0438+  99D8 23          	INC	HL
0439+  99D9 10 F6       	DJNZ	FillVl2
0440+  99DB FD 7C       	LD	A,HY
0441+  99DD D3 A2       	OUT	(PAGE1),A
0442+  99DF FB          	EI 
0443+  99E0 F1          VBarExt	POP	AF
0444+  99E1 D3 89       	OUT	(YPORT),A
0445+  99E3 FD E1       	POP	IY
0446+  99E5 C9          	RET 
0447+  99E6             ;[]-----------------------------------------------------------[]
0448+  99E6             InitProcess
0449+  99E6 97          	SUB	A
0450+  99E7 DD 77 0E    	LD	(IX+ProcCURl1),A
0451+  99EA DD 77 0F    	LD	(IX+ProcCURh1),A
0452+  99ED DD 77 10    	LD	(IX+ProcCURl2),A
0453+  99F0 DD 77 11    	LD	(IX+ProcCURh2),A
0454+  99F3 DD 77 08    	LD	(IX+ProcCORRl),A
0455+  99F6 DD 77 09    	LD	(IX+ProcCORRh),A
0456+  99F9 DD 4E 04    	LD	C,(IX+ProcMaxLl)	;Макс/макс.длину процеса
0457+  99FC DD 46 05    	LD	B,(IX+ProcMaxLh)
0458+  99FF DD 5E 0A    	LD	E,(IX+ProcMAXl1)
0459+  9A02 DD 56 0B    	LD	D,(IX+ProcMAXh1)
0460+  9A05 DD 6E 0C    	LD	L,(IX+ProcMAXl2)
0461+  9A08 DD 66 0D    	LD	H,(IX+ProcMAXh2)
0462+  9A0B CD A3 A2    	CALL	Divis32X16		;HL+DE/BC=DE (HL-ост)
0463+  9A0E 7C          	LD	A,H
0464+  9A0F B5          	OR	L
0465+  9A10 28 01       	JR	Z,$+3
0466+  9A12 13          	INC	DE			;= коэффициент
0467+  9A13 21 09 00    	LD	HL,9
0468+  9A16 B7          	OR	A
0469+  9A17 ED 52       	SBC	HL,DE
0470+  9A19 38 23       	JR	C,InitPrE
0471+  9A1B DD 7E 0C    	LD	A,(IX+ProcMAXl2)
0472+  9A1E DD B6 0D    	OR	(IX+ProcMAXh2)
0473+  9A21 20 1B       	JR	NZ,InitPrE
0474+  9A23 DD 5E 0A    	LD	E,(IX+ProcMAXl1)
0475+  9A26 DD 56 0B    	LD	D,(IX+ProcMAXh1)
0476+  9A29 01 E8 03    	LD	BC,1000
0477+  9A2C DD 71 08    	LD	(IX+ProcCORRl),C
0478+  9A2F DD 70 09    	LD	(IX+ProcCORRh),B
0479+  9A32 CD 0F A2    	CALL	Mult16X16
0480+  9A35 DD 4E 04    	LD	C,(IX+ProcMaxLl)	;Макс/макс.длину процеса
0481+  9A38 DD 46 05    	LD	B,(IX+ProcMaxLh)
0482+  9A3B CD A3 A2    	CALL	Divis32X16		;HL+DE/BC=DE (HL-ост)
0483+  9A3E DD 73 06    InitPrE	LD	(IX+ProcCOEFl),E
0484+  9A41 DD 72 07    	LD	(IX+ProcCOEFh),D
0485+  9A44 C9          	RET 
0486+  9A45             PrnProcess
0487+  9A45 FD E5       	PUSH	IY
0488+  9A47 DB 89       	IN	A,(YPORT)
0489+  9A49 F5          	PUSH	AF
0490+  9A4A DB A2       	IN	A,(PAGE1)
0491+  9A4C FD 6F       	LD	LY,A
0492+  9A4E DD 5E 0E    	LD	E,(IX+ProcCURl1)
0493+  9A51 DD 56 0F    	LD	D,(IX+ProcCURh1)
0494+  9A54 DD 6E 10    	LD	L,(IX+ProcCURl2)
0495+  9A57 DD 66 11    	LD	H,(IX+ProcCURh2)
0496+  9A5A DD 7E 08    	LD	A,(IX+ProcCORRl)
0497+  9A5D DD B6 09    	OR	(IX+ProcCORRh)
0498+  9A60 28 09       	JR	Z,PrProc0
0499+  9A62 DD 4E 08    	LD	C,(IX+ProcCORRl)
0500+  9A65 DD 46 09    	LD	B,(IX+ProcCORRh)
0501+  9A68 CD 0F A2    	CALL	Mult16X16
0502+  9A6B DD 4E 06    PrProc0	LD	C,(IX+ProcCOEFl)
0503+  9A6E DD 46 07    	LD	B,(IX+ProcCOEFh)
0504+  9A71 CD A3 A2    	CALL	Divis32X16
0505+  9A74 DD 6E 00    	LD	L,(IX+ProcXl)
0506+  9A77 DD 66 01    	LD	H,(IX+ProcXh)
0507+  9A7A CB 3C       	SRL	H
0508+  9A7C CB 1D       	RR	L
0509+  9A7E CB F4       	SET	6,H
0510+  9A80 7A          	LD	A,D
0511+  9A81 B3          	OR	E
0512+  9A82 28 42       	JR	Z,PrProc1
0513+  9A84 D5          	PUSH	DE
0514+  9A85 E5          	PUSH	HL
0515+  9A86 DD 6E 04    	LD	L,(IX+ProcMaxLl)
0516+  9A89 DD 66 05    	LD	H,(IX+ProcMaxLh)
0517+  9A8C B7          	OR	A
0518+  9A8D ED 52       	SBC	HL,DE
0519+  9A8F 30 02       	JR	NC,$+4
0520+  9A91 19          	ADD	HL,DE
0521+  9A92 EB          	EX	DE,HL
0522+  9A93 E1          	POP	HL
0523+  9A94 CB 3A       	SRL	D
0524+  9A96 CB 1B       	RR	E
0525+  9A98 30 01       	JR	NC,$+3
0526+  9A9A 13          	INC	DE
0527+  9A9B DD 7E 02    	LD	A,(IX+ProcYl)
0528+  9A9E 4F          	LD	C,A
0529+  9A9F DD 7E 12    	LD	A,(IX+ProcCOLOR)
0530+  9AA2 E6 F0       	AND	#F0
0531+  9AA4 47          	LD	B,A
0532+  9AA5 0F          	RRCA 
0533+  9AA6 0F          	RRCA 
0534+  9AA7 0F          	RRCA 
0535+  9AA8 0F          	RRCA 
0536+  9AA9 B0          	OR	B
0537+  9AAA 47          	LD	B,A
0538+  9AAB 3E 50       	LD	A,#50
0539+  9AAD D3 A2       	OUT	(PAGE1),A
0540+  9AAF F3          	DI 
0541+  9AB0 52          	LD	D,D
0542+  9AB1 3E 0A       	LD	A,#0A
0543+  9AB3 40          	LD	B,B
0544+  9AB4 79          FillPr1	LD	A,C
0545+  9AB5 D3 89       	OUT	(YPORT),A
0546+  9AB7 5B          	LD	E,E
0547+  9AB8 70          	LD	(HL),B
0548+  9AB9 40          	LD	B,B
0549+  9ABA 23          	INC	HL
0550+  9ABB 1B          	DEC	DE
0551+  9ABC 7A          	LD	A,D
0552+  9ABD B3          	OR	E
0553+  9ABE 20 F4       	JR	NZ,FillPr1
0554+  9AC0 FD 7D       	LD	A,LY
0555+  9AC2 D3 A2       	OUT	(PAGE1),A
0556+  9AC4 FB          	EI 
0557+  9AC5 D1          	POP	DE
0558+  9AC6 E5          PrProc1	PUSH	HL
0559+  9AC7 DD 6E 04    	LD	L,(IX+ProcMaxLl)
0560+  9ACA DD 66 05    	LD	H,(IX+ProcMaxLh)
0561+  9ACD B7          	OR	A
0562+  9ACE ED 52       	SBC	HL,DE
0563+  9AD0 EB          	EX	DE,HL
0564+  9AD1 E1          	POP	HL
0565+  9AD2 28 33       	JR	Z,PrProcE
0566+  9AD4 38 31       	JR	C,PrProcE
0567+  9AD6 CB 3A       	SRL	D
0568+  9AD8 CB 1B       	RR	E
0569+  9ADA 30 01       	JR	NC,$+3
0570+  9ADC 13          	INC	DE
0571+  9ADD DD 7E 02    	LD	A,(IX+ProcYl)
0572+  9AE0 4F          	LD	C,A
0573+  9AE1 DD 7E 12    	LD	A,(IX+ProcCOLOR)
0574+  9AE4 E6 0F       	AND	#0F
0575+  9AE6 47          	LD	B,A
0576+  9AE7 07          	RLCA 
0577+  9AE8 07          	RLCA 
0578+  9AE9 07          	RLCA 
0579+  9AEA 07          	RLCA 
0580+  9AEB B0          	OR	B
0581+  9AEC 47          	LD	B,A
0582+  9AED 3E 50       	LD	A,#50
0583+  9AEF D3 A2       	OUT	(PAGE1),A
0584+  9AF1 F3          	DI 
0585+  9AF2 52          	LD	D,D
0586+  9AF3 3E 0A       	LD	A,#0A
0587+  9AF5 40          	LD	B,B
0588+  9AF6 79          FillPr2	LD	A,C
0589+  9AF7 D3 89       	OUT	(YPORT),A
0590+  9AF9 5B          	LD	E,E
0591+  9AFA 70          	LD	(HL),B
0592+  9AFB 40          	LD	B,B
0593+  9AFC 23          	INC	HL
0594+  9AFD 1B          	DEC	DE
0595+  9AFE 7A          	LD	A,D
0596+  9AFF B3          	OR	E
0597+  9B00 20 F4       	JR	NZ,FillPr2
0598+  9B02 FD 7D       	LD	A,LY
0599+  9B04 D3 A2       	OUT	(PAGE1),A
0600+  9B06 FB          	EI 
0601+  9B07 F1          PrProcE	POP	AF
0602+  9B08 D3 89       	OUT	(YPORT),A
0603+  9B0A FD E1       	POP	IY
0604+  9B0C C9          	RET 
0605+  9B0D             
0606+  9B0D             
0607+  9B0D             
0063   9B0D             	include "fnmouse.z80"
0001+  9B0D             
0002+  9B0D             ;[]----------------------------------------------------------[]
0003+  9B0D 3A E5 A7    ResFire	LD	A,(MouseFlag)
0004+  9B10 B7          	OR	A
0005+  9B11 C8          	RET	Z
0006+  9B12 CD 05 9F    RsFire1	CALL	TestCMOS
0007+  9B15 0E 03       	LD	C,#03
0008+  9B17 F7          	RST	#30
0009+  9B18 B7          	OR	A
0010+  9B19 C8          	RET	Z
0011+  9B1A 18 F6       	JR	RsFire1
0012+  9B1C             ;[]----------------------------------------------------------[]
0013+  9B1C             ;Проверка координат мыши по таблице
0014+  9B1C             ;На вход:
0015+  9B1C             ;	  IX - Адрес таблицы
0016+  9B1C             TestCoords
0017+  9B1C CD 05 9F    	CALL	TestCMOS
0018+  9B1F 0E 03       	LD	C,#03
0019+  9B21 F7          	RST	#30
0020+  9B22 08          	EX	AF,AF'
0021+  9B23 01 00 00    PrvTabl	LD	BC,#0000
0022+  9B26 DD 7D       	LD	A,LX
0023+  9B28 B9          	CP	C
0024+  9B29 20 05       	JR	NZ,TCoord0
0025+  9B2B DD 7C       	LD	A,HX
0026+  9B2D B8          	CP	B
0027+  9B2E 28 11       	JR	Z,TCoord1
0028+  9B30 DD 22 24 9B TCoord0	LD	(PrvTabl+1),IX
0029+  9B34 CD 72 9C    	CALL	ResMInvert
0030+  9B37 01 0D 9B    	LD	BC,ResFire
0031+  9B3A C5          	PUSH	BC
0032+  9B3B 97          	SUB	A
0033+  9B3C 32 B3 9B    	LD	(RunFlag+1),A
0034+  9B3F 18 1E       	JR	TCoords
0035+  9B41             TCoord1
0036+  9B41 3E 01       	LD	A,#01
0037+  9B43 32 B3 9B    	LD	(RunFlag+1),A
0038+  9B46 08          	EX	AF,AF'
0039+  9B47 B7          	OR	A
0040+  9B48 20 15       	JR	NZ,TCoords
0041+  9B4A E5          	PUSH	HL
0042+  9B4B 01 00 00    PrMousX	LD	BC,#0000
0043+  9B4E B7          	OR	A
0044+  9B4F ED 42       	SBC	HL,BC
0045+  9B51 E1          	POP	HL
0046+  9B52 20 0B       	JR	NZ,TCoords
0047+  9B54 EB          	EX	DE,HL
0048+  9B55 E5          	PUSH	HL
0049+  9B56 01 00 00    PrMousY	LD	BC,#0000
0050+  9B59 B7          	OR	A
0051+  9B5A ED 42       	SBC	HL,BC
0052+  9B5C E1          	POP	HL
0053+  9B5D EB          	EX	DE,HL
0054+  9B5E C8          	RET	Z
0055+  9B5F 22 4C 9B    TCoords	LD	(PrMousX+1),HL
0056+  9B62 ED 53 57 9B 	LD	(PrMousY+1),DE
0057+  9B66 DD 4E 00    CoordLp	LD	C,(IX+#00)
0058+  9B69 DD 46 01    	LD	B,(IX+#01)
0059+  9B6C B7          	OR	A
0060+  9B6D ED 42       	SBC	HL,BC
0061+  9B6F 09          	ADD	HL,BC
0062+  9B70 DA 4E 9C    	JP	C,NxtCrds
0063+  9B73 DD 4E 02    	LD	C,(IX+#02)
0064+  9B76 DD 46 03    	LD	B,(IX+#03)
0065+  9B79 ED 42       	SBC	HL,BC
0066+  9B7B 09          	ADD	HL,BC
0067+  9B7C D2 4E 9C    	JP	NC,NxtCrds
0068+  9B7F DD 4E 04    	LD	C,(IX+#04)
0069+  9B82 DD 46 05    	LD	B,(IX+#05)
0070+  9B85 B7          	OR	A
0071+  9B86 EB          	EX	DE,HL
0072+  9B87 ED 42       	SBC	HL,BC
0073+  9B89 09          	ADD	HL,BC
0074+  9B8A EB          	EX	DE,HL
0075+  9B8B DA 4E 9C    	JP	C,NxtCrds
0076+  9B8E DD 4E 06    	LD	C,(IX+#06)
0077+  9B91 DD 46 07    	LD	B,(IX+#07)
0078+  9B94 EB          	EX	DE,HL
0079+  9B95 ED 42       	SBC	HL,BC
0080+  9B97 09          	ADD	HL,BC
0081+  9B98 EB          	EX	DE,HL
0082+  9B99 D2 4E 9C    	JP	NC,NxtCrds
0083+  9B9C 4F          	LD	C,A
0084+  9B9D 3A E5 A7    	LD	A,(MouseFlag)
0085+  9BA0 B7          	OR	A
0086+  9BA1 79          	LD	A,C
0087+  9BA2 28 07       	JR	Z,CoordL1
0088+  9BA4 DD CB 08 56 	BIT	2,(IX+#08)
0089+  9BA8 C4 90 9C    	CALL	NZ,SetSelect1
0090+  9BAB DD CB 08 5E CoordL1	BIT	3,(IX+#08)
0091+  9BAF C4 1A 9D    	CALL	NZ,SetSelect2
0092+  9BB2 0E 00       RunFlag	LD	C,#00
0093+  9BB4 0D          	DEC	C
0094+  9BB5 C2 64 9C    	JP	NZ,NxtCrds1
0095+  9BB8 4F          	LD	C,A
0096+  9BB9 3A E5 A7    	LD	A,(MouseFlag)
0097+  9BBC B7          	OR	A
0098+  9BBD C8          	RET	Z
0099+  9BBE 79          	LD	A,C
0100+  9BBF B7          	OR	A		;нет огня
0101+  9BC0 28 3C       	JR	Z,Execute1
0102+  9BC2 CB 47       	BIT	0,A
0103+  9BC4 28 60       	JR	Z,Execute2
0104+  9BC6 DD CB 08 46 	BIT	0,(IX+#08)
0105+  9BCA C4 A4 9D    	CALL	NZ,PushButton
0106+  9BCD 3F          	CCF 
0107+  9BCE D0          	RET	NC
0108+  9BCF B7          	OR	A
0109+  9BD0 DD CB 08 4E 	BIT	1,(IX+#08)	;рабочая кнопка
0110+  9BD4 C0          	RET	NZ
0111+  9BD5 DD 4E 0C    	LD	C,(IX+#0C)	;запуск	по левой кнопке
0112+  9BD8 DD 46 0D    	LD	B,(IX+#0D)
0113+  9BDB 78          	LD	A,B
0114+  9BDC B1          	OR	C
0115+  9BDD CA 64 9C    	JP	Z,NxtCrds1
0116+  9BE0 DD CB 08 6E 	BIT	5,(IX+#08)	;запуск	без возврата
0117+  9BE4 28 01       	JR	Z,$+3
0118+  9BE6 F1          	POP	AF
0119+  9BE7 C5          	PUSH	BC
0120+  9BE8 DD CB 08 56 	BIT	2,(IX+#08)
0121+  9BEC C4 E2 9C    	CALL	NZ,ResSelect1
0122+  9BEF CD 54 9D    	CALL	ResSelect2
0123+  9BF2 B7          	OR	A
0124+  9BF3 DD CB 09 46 	BIT	0,(IX+#09)
0125+  9BF7 C8          	RET	Z
0126+  9BF8 CD F0 86    	CALL	MakeWindow
0127+  9BFB 7F          	DEFB	#7F
0128+  9BFC 00          	DEFB	#00
0129+  9BFD C9          	RET 
0130+  9BFE             Execute1
0131+  9BFE DD 4E 0A    	LD	C,(IX+#0A)	;запуск	без огня
0132+  9C01 DD 46 0B    	LD	B,(IX+#0B)
0133+  9C04 78          	LD	A,B
0134+  9C05 B1          	OR	C
0135+  9C06 28 5C       	JR	Z,NxtCrds1
0136+  9C08 DD CB 08 66 	BIT	4,(IX+#08)	;запуск	без возврата
0137+  9C0C 28 01       	JR	Z,$+3
0138+  9C0E F1          	POP	AF
0139+  9C0F C5          	PUSH	BC
0140+  9C10 DD CB 08 56 	BIT	2,(IX+#08)
0141+  9C14 C4 E2 9C    	CALL	NZ,ResSelect1
0142+  9C17 CD 54 9D    	CALL	ResSelect2
0143+  9C1A B7          	OR	A
0144+  9C1B DD CB 08 7E 	BIT	7,(IX+#08)
0145+  9C1F C8          	RET	Z
0146+  9C20 CD F0 86    	CALL	MakeWindow
0147+  9C23 7F          	DEFB	#7F
0148+  9C24 00          	DEFB	#00
0149+  9C25 C9          	RET 
0150+  9C26             Execute2
0151+  9C26 DD 4E 0E    	LD	C,(IX+#0E)	;запуск	по правой кнопке
0152+  9C29 DD 46 0F    	LD	B,(IX+#0F)
0153+  9C2C 78          	LD	A,B
0154+  9C2D B1          	OR	C
0155+  9C2E 28 34       	JR	Z,NxtCrds1
0156+  9C30 DD CB 08 76 	BIT	6,(IX+#08)	;запуск	без возврата
0157+  9C34 28 01       	JR	Z,$+3
0158+  9C36 F1          	POP	AF
0159+  9C37 C5          	PUSH	BC
0160+  9C38 DD CB 08 56 	BIT	2,(IX+#08)
0161+  9C3C C4 E2 9C    	CALL	NZ,ResSelect1
0162+  9C3F CD 54 9D    	CALL	ResSelect2
0163+  9C42 B7          	OR	A
0164+  9C43 DD CB 09 4E 	BIT	1,(IX+#09)
0165+  9C47 C8          	RET	Z
0166+  9C48 CD F0 86    	CALL	MakeWindow
0167+  9C4B 7F          	DEFB	#7F
0168+  9C4C 00          	DEFB	#00
0169+  9C4D C9          	RET 
0170+  9C4E             
0171+  9C4E 4F          NxtCrds	LD	C,A
0172+  9C4F 3A E5 A7    	LD	A,(MouseFlag)
0173+  9C52 B7          	OR	A
0174+  9C53 79          	LD	A,C
0175+  9C54 28 07       	JR	Z,NxtCrds0
0176+  9C56 DD CB 08 56 	BIT	2,(IX+#08)
0177+  9C5A C4 E2 9C    	CALL	NZ,ResSelect1
0178+  9C5D             NxtCrds0
0179+  9C5D DD CB 08 5E 	BIT	3,(IX+#08)
0180+  9C61 C4 1A 9D    	CALL	NZ,SetSelect2
0181+  9C64             NxtCrds1
0182+  9C64 01 10 00    	LD	BC,#0010
0183+  9C67 DD 09       	ADD	IX,BC
0184+  9C69 DD CB 01 7E 	BIT	7,(IX+#01)	;конец таблицы
0185+  9C6D CA 66 9B    	JP	Z,CoordLp
0186+  9C70 B7          	OR	A
0187+  9C71 C9          	RET 
0188+  9C72             ResMInvert
0189+  9C72 DD E5       	PUSH	IX
0190+  9C74 E5          	PUSH	HL
0191+  9C75 D5          	PUSH	DE
0192+  9C76 F5          	PUSH	AF
0193+  9C77 01 10 00    	LD	BC,#0010
0194+  9C7A DD CB 09 BE ResCrds	RES	7,(IX+#09)
0195+  9C7E DD CB 09 B6 	RES	6,(IX+#09)
0196+  9C82 DD 09       	ADD	IX,BC
0197+  9C84 DD CB 01 7E 	BIT	7,(IX+#01)
0198+  9C88 28 F0       	JR	Z,ResCrds
0199+  9C8A F1          	POP	AF
0200+  9C8B D1          	POP	DE
0201+  9C8C E1          	POP	HL
0202+  9C8D DD E1       	POP	IX
0203+  9C8F C9          	RET 
0204+  9C90             SetSelect1
0205+  9C90 DD CB 09 7E 	BIT	7,(IX+#09)
0206+  9C94 C0          	RET	NZ
0207+  9C95 DD CB 09 FE 	SET	7,(IX+#09)
0208+  9C99 F5          	PUSH	AF
0209+  9C9A E5          	PUSH	HL
0210+  9C9B D5          	PUSH	DE
0211+  9C9C DD E5       	PUSH	IX
0212+  9C9E DD 6E 00    	LD	L,(IX+#00)
0213+  9CA1 DD 66 01    	LD	H,(IX+#01)
0214+  9CA4 DD 4E 04    	LD	C,(IX+#04)
0215+  9CA7 DD 46 05    	LD	B,(IX+#05)
0216+  9CAA DD 7E 02    	LD	A,(IX+#02)
0217+  9CAD DD 96 00    	SUB	(IX+#00)
0218+  9CB0 08          	EX	AF,AF'
0219+  9CB1 DD 7E 06    	LD	A,(IX+#06)
0220+  9CB4 DD 96 04    	SUB	(IX+#04)
0221+  9CB7 DD 67       	LD	HX,A
0222+  9CB9 08          	EX	AF,AF'
0223+  9CBA CB 3F       	SRL	A
0224+  9CBC DD 6F       	LD	LX,A
0225+  9CBE 11 4F 80    	LD	DE,#804F
0226+  9CC1 CD A3 8D    	CALL	InvertRectan
0227+  9CC4 DD E1       	POP	IX
0228+  9CC6 DD E5       	PUSH	IX
0229+  9CC8 01 10 00    NxCrds1	LD	BC,#0010
0230+  9CCB DD 09       	ADD	IX,BC
0231+  9CCD DD CB 01 7E 	BIT	7,(IX+#01)
0232+  9CD1 20 09       	JR	NZ,NxCrds2
0233+  9CD3 DD CB 08 56 	BIT	2,(IX+#08)
0234+  9CD7 C4 E2 9C    	CALL	NZ,ResSelect1
0235+  9CDA 18 EC       	JR	NxCrds1
0236+  9CDC DD E1       NxCrds2	POP	IX
0237+  9CDE D1          	POP	DE
0238+  9CDF E1          	POP	HL
0239+  9CE0 F1          	POP	AF
0240+  9CE1 C9          	RET 
0241+  9CE2             ResSelect1
0242+  9CE2 DD CB 09 7E 	BIT	7,(IX+#09)
0243+  9CE6 C8          	RET	Z
0244+  9CE7 DD CB 09 BE 	RES	7,(IX+#09)
0245+  9CEB DD E5       	PUSH	IX
0246+  9CED E5          	PUSH	HL
0247+  9CEE D5          	PUSH	DE
0248+  9CEF DD 6E 00    	LD	L,(IX+#00)
0249+  9CF2 DD 66 01    	LD	H,(IX+#01)
0250+  9CF5 DD 4E 04    	LD	C,(IX+#04)
0251+  9CF8 DD 46 05    	LD	B,(IX+#05)
0252+  9CFB DD 7E 02    	LD	A,(IX+#02)
0253+  9CFE DD 96 00    	SUB	(IX+#00)
0254+  9D01 08          	EX	AF,AF'
0255+  9D02 DD 7E 06    	LD	A,(IX+#06)
0256+  9D05 DD 96 04    	SUB	(IX+#04)
0257+  9D08 DD 67       	LD	HX,A
0258+  9D0A 08          	EX	AF,AF'
0259+  9D0B CB 3F       	SRL	A
0260+  9D0D DD 6F       	LD	LX,A
0261+  9D0F 11 80 4F    	LD	DE,#4F80
0262+  9D12 CD A3 8D    	CALL	InvertRectan
0263+  9D15 D1          	POP	DE
0264+  9D16 E1          	POP	HL
0265+  9D17 DD E1       	POP	IX
0266+  9D19 C9          	RET 
0267+  9D1A             SetSelect2
0268+  9D1A DD CB 09 76 	BIT	6,(IX+#09)
0269+  9D1E C0          	RET	NZ
0270+  9D1F DD CB 09 F6 	SET	6,(IX+#09)
0271+  9D23 DD E5       	PUSH	IX
0272+  9D25 E5          	PUSH	HL
0273+  9D26 D5          	PUSH	DE
0274+  9D27 F5          	PUSH	AF
0275+  9D28 DD 6E 00    	LD	L,(IX+#00)
0276+  9D2B DD 66 01    	LD	H,(IX+#01)
0277+  9D2E DD 4E 04    	LD	C,(IX+#04)
0278+  9D31 DD 46 05    	LD	B,(IX+#05)
0279+  9D34 DD 7E 02    	LD	A,(IX+#02)
0280+  9D37 DD 96 00    	SUB	(IX+#00)
0281+  9D3A 08          	EX	AF,AF'
0282+  9D3B DD 7E 06    	LD	A,(IX+#06)
0283+  9D3E DD 96 04    	SUB	(IX+#04)
0284+  9D41 DD 67       	LD	HX,A
0285+  9D43 08          	EX	AF,AF'
0286+  9D44 CB 3F       	SRL	A
0287+  9D46 DD 6F       	LD	LX,A
0288+  9D48 11 4F 80    	LD	DE,#804F
0289+  9D4B CD A3 8D    	CALL	InvertRectan
0290+  9D4E F1          	POP	AF
0291+  9D4F D1          	POP	DE
0292+  9D50 E1          	POP	HL
0293+  9D51 DD E1       	POP	IX
0294+  9D53 C9          	RET 
0295+  9D54             ResSelect2
0296+  9D54 E5          	PUSH	HL
0297+  9D55 D5          	PUSH	DE
0298+  9D56 DD E5       	PUSH	IX
0299+  9D58 DD 2A 24 9B 	LD	IX,(PrvTabl+1)
0300+  9D5C 01 10 00    	LD	BC,#0010
0301+  9D5F DD CB 08 5E NxCrds3	BIT	3,(IX+#08)
0302+  9D63 20 0A       	JR	NZ,ResSel22
0303+  9D65 DD 09       	ADD	IX,BC
0304+  9D67 DD CB 01 7E 	BIT	7,(IX+#01)
0305+  9D6B 20 32       	JR	NZ,ResSel2E
0306+  9D6D 18 F0       	JR	NxCrds3
0307+  9D6F             ResSel22
0308+  9D6F DD CB 09 76 	BIT	6,(IX+#09)
0309+  9D73 28 2A       	JR	Z,ResSel2E
0310+  9D75 DD CB 09 B6 	RES	6,(IX+#09)
0311+  9D79 DD 6E 00    	LD	L,(IX+#00)
0312+  9D7C DD 66 01    	LD	H,(IX+#01)
0313+  9D7F DD 4E 04    	LD	C,(IX+#04)
0314+  9D82 DD 46 05    	LD	B,(IX+#05)
0315+  9D85 DD 7E 02    	LD	A,(IX+#02)
0316+  9D88 DD 96 00    	SUB	(IX+#00)
0317+  9D8B 08          	EX	AF,AF'
0318+  9D8C DD 7E 06    	LD	A,(IX+#06)
0319+  9D8F DD 96 04    	SUB	(IX+#04)
0320+  9D92 DD 67       	LD	HX,A
0321+  9D94 08          	EX	AF,AF'
0322+  9D95 CB 3F       	SRL	A
0323+  9D97 DD 6F       	LD	LX,A
0324+  9D99 11 80 4F    	LD	DE,#4F80
0325+  9D9C CD A3 8D    	CALL	InvertRectan
0326+  9D9F             ResSel2E
0327+  9D9F DD E1       	POP	IX
0328+  9DA1 D1          	POP	DE
0329+  9DA2 E1          	POP	HL
0330+  9DA3 C9          	RET 
0331+  9DA4             
0332+  9DA4             PushButton
0333+  9DA4 E5          	PUSH	HL
0334+  9DA5 D5          	PUSH	DE
0335+  9DA6 DD 6E 00    	LD	L,(IX+#00)
0336+  9DA9 DD 66 01    	LD	H,(IX+#01)
0337+  9DAC DD 5E 04    	LD	E,(IX+#04)
0338+  9DAF DD 56 05    	LD	D,(IX+#05)
0339+  9DB2 DD 7E 02    	LD	A,(IX+#02)
0340+  9DB5 DD 96 00    	SUB	(IX+#00)
0341+  9DB8 4F          	LD	C,A
0342+  9DB9 DD 7E 06    	LD	A,(IX+#06)
0343+  9DBC DD 96 04    	SUB	(IX+#04)
0344+  9DBF 47          	LD	B,A
0345+  9DC0 E5          	PUSH	HL
0346+  9DC1 D5          	PUSH	DE
0347+  9DC2 C5          	PUSH	BC
0348+  9DC3 CD 30 9E    	CALL	PutPushBut
0349+  9DC6 3E 0A       	LD	A,#0A
0350+  9DC8 32 0D 9E    	LD	(PausePh+1),A
0351+  9DCB DD E5       PushLp	PUSH	IX
0352+  9DCD CD 23 9E    	CALL	TestRun
0353+  9DD0 DD E1       	POP	IX
0354+  9DD2 0E 03       PushLp1	LD	C,#03
0355+  9DD4 F7          	RST	#30
0356+  9DD5 B7          	OR	A
0357+  9DD6 28 40       	JR	Z,PushButtEx
0358+  9DD8 CB 47       	BIT	0,A
0359+  9DDA 28 3C       	JR	Z,PushButtEx
0360+  9DDC DD 4E 00    	LD	C,(IX+#00)
0361+  9DDF DD 46 01    	LD	B,(IX+#01)
0362+  9DE2 B7          	OR	A
0363+  9DE3 ED 42       	SBC	HL,BC
0364+  9DE5 09          	ADD	HL,BC
0365+  9DE6 38 30       	JR	C,PushButtEx
0366+  9DE8 DD 4E 02    	LD	C,(IX+#02)
0367+  9DEB DD 46 03    	LD	B,(IX+#03)
0368+  9DEE ED 42       	SBC	HL,BC
0369+  9DF0 09          	ADD	HL,BC
0370+  9DF1 3F          	CCF 
0371+  9DF2 38 24       	JR	C,PushButtEx
0372+  9DF4 EB          	EX	DE,HL
0373+  9DF5 DD 4E 04    	LD	C,(IX+#04)
0374+  9DF8 DD 46 05    	LD	B,(IX+#05)
0375+  9DFB B7          	OR	A
0376+  9DFC ED 42       	SBC	HL,BC
0377+  9DFE 09          	ADD	HL,BC
0378+  9DFF 38 17       	JR	C,PushButtEx
0379+  9E01 DD 4E 06    	LD	C,(IX+#06)
0380+  9E04 DD 46 07    	LD	B,(IX+#07)
0381+  9E07 ED 42       	SBC	HL,BC
0382+  9E09 3F          	CCF 
0383+  9E0A 38 0C       	JR	C,PushButtEx
0384+  9E0C 3E 00       PausePh	LD	A,#00
0385+  9E0E B7          	OR	A
0386+  9E0F 28 BA       	JR	Z,PushLp
0387+  9E11 3D          	DEC	A
0388+  9E12 32 0D 9E    	LD	(PausePh+1),A
0389+  9E15 76          	HALT 
0390+  9E16 18 BA       	JR	PushLp1
0391+  9E18             PushButtEx
0392+  9E18 C1          	POP	BC
0393+  9E19 D1          	POP	DE
0394+  9E1A E1          	POP	HL
0395+  9E1B F5          	PUSH	AF
0396+  9E1C CD 34 9E    	CALL	PutPopBut
0397+  9E1F F1          	POP	AF
0398+  9E20 D1          	POP	DE
0399+  9E21 E1          	POP	HL
0400+  9E22 C9          	RET 
0401+  9E23             TestRun
0402+  9E23 DD CB 08 4E 	BIT	1,(IX+#08)
0403+  9E27 C8          	RET	Z
0404+  9E28 DD 4E 0C    	LD	C,(IX+#0C)
0405+  9E2B DD 46 0D    	LD	B,(IX+#0D)
0406+  9E2E C5          	PUSH	BC
0407+  9E2F C9          	RET 
0408+  9E30             PutPushBut
0409+  9E30 3E F7       	LD	A,#F7
0410+  9E32 18 02       	JR	PutButt
0411+  9E34             PutPopBut
0412+  9E34 3E 7F       	LD	A,#7F
0413+  9E36 FD E5       PutButt	PUSH	IY
0414+  9E38 08          	EX	AF,AF'
0415+  9E39 DB A2       	IN	A,(PAGE1)
0416+  9E3B F5          	PUSH	AF
0417+  9E3C 3E 50       	LD	A,#50
0418+  9E3E D3 A2       	OUT	(PAGE1),A
0419+  9E40 DB 89       	IN	A,(YPORT)
0420+  9E42 F5          	PUSH	AF
0421+  9E43 CB 3C       	SRL	H
0422+  9E45 CB 1D       	RR	L
0423+  9E47 CB F4       	SET	6,H
0424+  9E49 FD 6B       	LD	LY,E
0425+  9E4B CB 39       	SRL	C
0426+  9E4D 0D          	DEC	C
0427+  9E4E 0D          	DEC	C
0428+  9E4F 79          	LD	A,C
0429+  9E50 32 89 9E    	LD	(ButLen3+1),A
0430+  9E53 78          	LD	A,B
0431+  9E54 D6 02       	SUB	#02
0432+  9E56 32 81 9E    	LD	(ButLen1+1),A
0433+  9E59 32 A6 9E    	LD	(ButLen2+1),A
0434+  9E5C FD 85       	ADD	A,LY
0435+  9E5E 3C          	INC	A
0436+  9E5F FD 67       	LD	HY,A
0437+  9E61 08          	EX	AF,AF'
0438+  9E62 F5          	PUSH	AF
0439+  9E63 E6 F0       	AND	#F0
0440+  9E65 5F          	LD	E,A
0441+  9E66 0F          	RRCA 
0442+  9E67 0F          	RRCA 
0443+  9E68 0F          	RRCA 
0444+  9E69 0F          	RRCA 
0445+  9E6A B3          	OR	E
0446+  9E6B 57          	LD	D,A
0447+  9E6C F1          	POP	AF
0448+  9E6D E6 0F       	AND	#0F
0449+  9E6F 5F          	LD	E,A
0450+  9E70 07          	RLCA 
0451+  9E71 07          	RLCA 
0452+  9E72 07          	RLCA 
0453+  9E73 07          	RLCA 
0454+  9E74 B3          	OR	E
0455+  9E75 5F          	LD	E,A
0456+  9E76 F3          	DI 
0457+  9E77 FD 7D       	LD	A,LY
0458+  9E79 D3 89       	OUT	(YPORT),A
0459+  9E7B 73          	LD	(HL),E
0460+  9E7C 3C          	INC	A
0461+  9E7D D3 89       	OUT	(YPORT),A
0462+  9E7F 52          	LD	D,D
0463+  9E80 3E 00       ButLen1	LD	A,#00
0464+  9E82 5B          	LD	E,E
0465+  9E83 73          	LD	(HL),E
0466+  9E84 40          	LD	B,B
0467+  9E85 73          	LD	(HL),E
0468+  9E86 23          	INC	HL
0469+  9E87 52          	LD	D,D
0470+  9E88 3E 00       ButLen3	LD	A,#00
0471+  9E8A 40          	LD	B,B
0472+  9E8B FD 7D       	LD	A,LY
0473+  9E8D D3 89       	OUT	(YPORT),A
0474+  9E8F 49          	LD	C,C
0475+  9E90 73          	LD	(HL),E
0476+  9E91 40          	LD	B,B
0477+  9E92 FD 7C       	LD	A,HY
0478+  9E94 D3 89       	OUT	(YPORT),A
0479+  9E96 49          	LD	C,C
0480+  9E97 72          	LD	(HL),D
0481+  9E98 40          	LD	B,B
0482+  9E99 06 00       	LD	B,#00
0483+  9E9B 09          	ADD	HL,BC
0484+  9E9C FD 7D       	LD	A,LY
0485+  9E9E D3 89       	OUT	(YPORT),A
0486+  9EA0 72          	LD	(HL),D
0487+  9EA1 3C          	INC	A
0488+  9EA2 D3 89       	OUT	(YPORT),A
0489+  9EA4 52          	LD	D,D
0490+  9EA5 3E 00       ButLen2	LD	A,#00
0491+  9EA7 5B          	LD	E,E
0492+  9EA8 72          	LD	(HL),D
0493+  9EA9 40          	LD	B,B
0494+  9EAA 72          	LD	(HL),D
0495+  9EAB FB          	EI 
0496+  9EAC F1          	POP	AF
0497+  9EAD D3 89       	OUT	(YPORT),A
0498+  9EAF F1          	POP	AF
0499+  9EB0 D3 A2       	OUT	(PAGE1),A
0500+  9EB2 FD E1       	POP	IY
0501+  9EB4 C9          	RET 
0502+  9EB5             ;[]----------------------------------------------------------[]
0503+  9EB5             SetCMOSPrint
0504+  9EB5 08          	EX	AF,AF'
0505+  9EB6 22 13 A0    	LD	(CMOSposXT),HL
0506+  9EB9 ED 53 15 A0 	LD	(CMOSposYT),DE
0507+  9EBD 78          	LD	A,B
0508+  9EBE 32 17 A0    	LD	(CMOSColorT),A
0509+  9EC1 97          	SUB	A
0510+  9EC2 6F          	LD	L,A
0511+  9EC3 67          	LD	H,A
0512+  9EC4 32 11 A0    	LD	(CMOSPrint),A
0513+  9EC7 22 18 A0    	LD	(CMOSTime),HL
0514+  9ECA 32 1A A0    	LD	(CMOSTime+2),A
0515+  9ECD 22 29 A0    	LD	(CMOSData),HL
0516+  9ED0 32 2B A0    	LD	(CMOSData+2),A
0517+  9ED3 21 1B A0    	LD	HL,CMOSTimeT
0518+  9ED6 11 2C A0    	LD	DE,CMOSDataT
0519+  9ED9 3E 30       	LD	A,"0"
0520+  9EDB 06 03       	LD	B,#03
0521+  9EDD 77          	LD	(HL),A
0522+  9EDE 23          	INC	HL
0523+  9EDF 77          	LD	(HL),A
0524+  9EE0 23          	INC	HL
0525+  9EE1 23          	INC	HL
0526+  9EE2 12          	LD	(DE),A
0527+  9EE3 13          	INC	DE
0528+  9EE4 12          	LD	(DE),A
0529+  9EE5 13          	INC	DE
0530+  9EE6 13          	INC	DE
0531+  9EE7 10 F4       	DJNZ	$-10
0532+  9EE9 08          	EX	AF,AF'
0533+  9EEA 32 12 A0    	LD	(CMOSOut),A
0534+  9EED B7          	OR	A
0535+  9EEE 28 15       	JR	Z,TestCMOS
0536+  9EF0 D9          	EXX 
0537+  9EF1 22 24 A0    	LD	(CMOSposXD),HL
0538+  9EF4 ED 53 26 A0 	LD	(CMOSposYD),DE
0539+  9EF8 78          	LD	A,B
0540+  9EF9 32 28 A0    	LD	(CMOSColorD),A
0541+  9EFC D9          	EXX 
0542+  9EFD 18 06       	JR	TestCMOS
0543+  9EFF             ResCMOSPrint
0544+  9EFF 3E 01       	LD	A,#01
0545+  9F01 32 11 A0    	LD	(CMOSPrint),A
0546+  9F04 C9          	RET 
0547+  9F05             TestCMOS
0548+  9F05 3A E4 A7    	LD	A,(CMOSFlag)
0549+  9F08 B7          	OR	A
0550+  9F09 C8          	RET	Z
0551+  9F0A 3A 11 A0    	LD	A,(CMOSPrint)
0552+  9F0D B7          	OR	A
0553+  9F0E C0          	RET	NZ
0554+  9F0F DD E5       	PUSH	IX
0555+  9F11 76          	HALT 
0556+  9F12 F3          	DI 
0557+  9F13 0E 21       	LD	C,#21
0558+  9F15 D7          	RST	#10
0559+  9F16 FB          	EI 
0560+  9F17 D5          	PUSH	DE
0561+  9F18 DD E5       	PUSH	IX
0562+  9F1A EB          	EX	DE,HL
0563+  9F1B 2A 18 A0    	LD	HL,(CMOSTime)
0564+  9F1E B7          	OR	A
0565+  9F1F ED 52       	SBC	HL,DE
0566+  9F21 20 06       	JR	NZ,PrnCMOSTime
0567+  9F23 3A 1A A0    	LD	A,(CMOSTime+2)
0568+  9F26 B8          	CP	B
0569+  9F27 28 2C       	JR	Z,TCMOS1
0570+  9F29             PrnCMOSTime
0571+  9F29 EB          	EX	DE,HL
0572+  9F2A 22 18 A0    	LD	(CMOSTime),HL
0573+  9F2D 78          	LD	A,B
0574+  9F2E 32 1A A0    	LD	(CMOSTime+2),A
0575+  9F31 11 1B A0    	LD	DE,CMOSTimeT
0576+  9F34 7C          	LD	A,H
0577+  9F35 CD 43 A0    	CALL	GetCMOS
0578+  9F38 13          	INC	DE
0579+  9F39 7D          	LD	A,L
0580+  9F3A CD 43 A0    	CALL	GetCMOS
0581+  9F3D 13          	INC	DE
0582+  9F3E 3A 1A A0    	LD	A,(CMOSTime+2)
0583+  9F41 CD 43 A0    	CALL	GetCMOS
0584+  9F44 21 1B A0    	LD	HL,CMOSTimeT
0585+  9F47 ED 5B 13 A0 	LD	DE,(CMOSposXT)
0586+  9F4B ED 4B 15 A0 	LD	BC,(CMOSposYT)
0587+  9F4F 3A 17 A0    	LD	A,(CMOSColorT)
0588+  9F52 CD B3 8F    	CALL	PrnTxtLnIFF
0589+  9F55 DD E1       TCMOS1	POP	IX
0590+  9F57 D1          	POP	DE
0591+  9F58 3A 12 A0    	LD	A,(CMOSOut)
0592+  9F5B B7          	OR	A
0593+  9F5C CA 0E A0    	JP	Z,TCMOSex
0594+  9F5F DD E5       	PUSH	IX
0595+  9F61 E1          	POP	HL
0596+  9F62 01 6C 07    	LD	BC,1900
0597+  9F65 B7          	OR	A
0598+  9F66 ED 42       	SBC	HL,BC
0599+  9F68 45          	LD	B,L
0600+  9F69 2A 29 A0    	LD	HL,(CMOSData)
0601+  9F6C B7          	OR	A
0602+  9F6D ED 52       	SBC	HL,DE
0603+  9F6F 20 07       	JR	NZ,PrnCMOSData
0604+  9F71 3A 2B A0    	LD	A,(CMOSData+2)
0605+  9F74 B8          	CP	B
0606+  9F75 CA 0E A0    	JP	Z,TCMOSex
0607+  9F78             PrnCMOSData
0608+  9F78 EB          	EX	DE,HL
0609+  9F79 22 29 A0    	LD	(CMOSData),HL
0610+  9F7C 78          	LD	A,B
0611+  9F7D 32 2B A0    	LD	(CMOSData+2),A
0612+  9F80 11 2C A0    	LD	DE,CMOSDataT
0613+  9F83 7C          	LD	A,H
0614+  9F84 CD 43 A0    	CALL	GetCMOS
0615+  9F87 13          	INC	DE
0616+  9F88 7D          	LD	A,L
0617+  9F89 CD 43 A0    	CALL	GetCMOS
0618+  9F8C 13          	INC	DE
0619+  9F8D 3A 2B A0    	LD	A,(CMOSData+2)
0620+  9F90 CD 43 A0    	CALL	GetCMOS
0621+  9F93 3A 12 A0    	LD	A,(CMOSOut)
0622+  9F96 3D          	DEC	A
0623+  9F97 20 13       	JR	NZ,TCMOS2
0624+  9F99 21 2C A0    	LD	HL,CMOSDataT
0625+  9F9C ED 5B 24 A0 	LD	DE,(CMOSposXD)
0626+  9FA0 ED 4B 26 A0 	LD	BC,(CMOSposYD)
0627+  9FA4 3A 28 A0    	LD	A,(CMOSColorD)
0628+  9FA7 CD B3 8F    	CALL	PrnTxtLnIFF
0629+  9FAA 18 62       	JR	TCMOSex
0630+  9FAC 11 35 A0    TCMOS2	LD	DE,CMOSDataT1
0631+  9FAF 7C          	LD	A,H
0632+  9FB0 CD 78 A3    	CALL	ConvNumTxt8
0633+  9FB3 3E 20       	LD	A,#20
0634+  9FB5 12          	LD	(DE),A
0635+  9FB6 13          	INC	DE
0636+  9FB7 7D          	LD	A,L
0637+  9FB8 3D          	DEC	A
0638+  9FB9 87          	ADD	A,A
0639+  9FBA 6F          	LD	L,A
0640+  9FBB 87          	ADD	A,A
0641+  9FBC 85          	ADD	A,L
0642+  9FBD 21 54 A0    	LD	HL,Month
0643+  9FC0 85          	ADD	A,L
0644+  9FC1 6F          	LD	L,A
0645+  9FC2 30 01       	JR	NC,$+3
0646+  9FC4 24          	INC	H
0647+  9FC5 3E 20       	LD	A,#20
0648+  9FC7 ED A0       	LDI 
0649+  9FC9 BE          	CP	(HL)
0650+  9FCA 20 FB       	JR	NZ,$-3
0651+  9FCC 12          	LD	(DE),A
0652+  9FCD 13          	INC	DE
0653+  9FCE DD E5       	PUSH	IX
0654+  9FD0 E1          	POP	HL
0655+  9FD1 CD 4C A3    	CALL	ConvNumTxt16
0656+  9FD4 97          	SUB	A
0657+  9FD5 12          	LD	(DE),A
0658+  9FD6 2A 24 A0    	LD	HL,(CMOSposXD)
0659+  9FD9 22 F3 9F    	LD	(CMOSclX),HL
0660+  9FDC 2A 26 A0    	LD	HL,(CMOSposYD)
0661+  9FDF 22 F5 9F    	LD	(CMOSclY),HL
0662+  9FE2 3A 28 A0    	LD	A,(CMOSColorD)
0663+  9FE5 E6 F0       	AND	#F0
0664+  9FE7 0F          	RRCA 
0665+  9FE8 0F          	RRCA 
0666+  9FE9 0F          	RRCA 
0667+  9FEA 0F          	RRCA 
0668+  9FEB 32 FB 9F    	LD	(CMOScol),A
0669+  9FEE CD F0 86    	CALL	MakeWindow
0670+  9FF1 80          	DEFB	#80
0671+  9FF2 02          	DEFB	#02
0672+  9FF3 00 00       CMOSclX	DEFW	#0000
0673+  9FF5 00 00       CMOSclY	DEFW	#0000
0674+  9FF7 4C 00       	DEFW	#004C
0675+  9FF9 08 00       	DEFW	#0008
0676+  9FFB 00          CMOScol	DEFB	#00
0677+  9FFC 00          	DEFB	#00
0678+  9FFD 21 35 A0    	LD	HL,CMOSDataT1
0679+  A000 ED 5B 24 A0 	LD	DE,(CMOSposXD)
0680+  A004 ED 4B 26 A0 	LD	BC,(CMOSposYD)
0681+  A008 3A 28 A0    	LD	A,(CMOSColorD)
0682+  A00B CD B3 8F    	CALL	PrnTxtLnIFF
0683+  A00E DD E1       TCMOSex	POP	IX
0684+  A010 C9          	RET 
0685+  A011             CMOSPrint
0686+  A011 01          	DEFB	#01
0687+  A012             CMOSOut
0688+  A012 00          	DEFB	#00
0689+  A013             CMOSposXT
0690+  A013 00 00       	DEFW	#0000
0691+  A015             CMOSposYT
0692+  A015 00 00       	DEFW	#0000
0693+  A017             CMOSColorT
0694+  A017 00          	DEFB	#00
0695+  A018             CMOSTime
0696+  A018 00          	DEFS	3,0
0697+  A01B             CMOSTimeT
0698+  A01B             	DEFB	"00:00:00",0
0698+  A01B 30303A30303A303000
0699+  A024             CMOSposXD
0700+  A024 00 00       	DEFW	#0000
0701+  A026             CMOSposYD
0702+  A026 00 00       	DEFW	#0000
0703+  A028             CMOSColorD
0704+  A028 00          	DEFB	#00
0705+  A029             CMOSData
0706+  A029 00          	DEFS	3,0
0707+  A02C             CMOSDataT
0708+  A02C             	DEFB	"00/00/00",0
0708+  A02C 30302F30302F303000
0709+  A035             CMOSDataT1
0710+  A035 20          	DEFS	14," "
0711+  A043             GetCMOS
0712+  A043 EB          	EX	DE,HL
0713+  A044 01 0A 2F    	LD	BC,#2F0A
0714+  A047 04          	INC	B
0715+  A048 91          	SUB	C
0716+  A049 30 FC       	JR	NC,$-2
0717+  A04B 81          	ADD	A,C
0718+  A04C 70          	LD	(HL),B
0719+  A04D 23          	INC	HL
0720+  A04E C6 30       	ADD	A,"0"
0721+  A050 77          	LD	(HL),A
0722+  A051 23          	INC	HL
0723+  A052 EB          	EX	DE,HL
0724+  A053 C9          	RET 
0725+  A054             Month
0726+  A054             	DEFB	"Jan   "
0726+  A054 4A616E202020
0727+  A05A             	DEFB	"Febr  "
0727+  A05A 466562722020
0728+  A060             	DEFB	"March "
0728+  A060 4D6172636820
0729+  A066             	DEFB	"Apr   "
0729+  A066 417072202020
0730+  A06C             	DEFB	"May   "
0730+  A06C 4D6179202020
0731+  A072             	DEFB	"June  "
0731+  A072 4A756E652020
0732+  A078             	DEFB	"July  "
0732+  A078 4A756C792020
0733+  A07E             	DEFB	"Aug   "
0733+  A07E 417567202020
0734+  A084             	DEFB	"Sept  "
0734+  A084 536570742020
0735+  A08A             	DEFB	"Oct   "
0735+  A08A 4F6374202020
0736+  A090             	DEFB	"Nov   "
0736+  A090 4E6F76202020
0737+  A096             	DEFB	"Dec   "
0737+  A096 446563202020
0738+  A09C             ;[]----------------------------------------------------------[]
0739+  A09C             SetClock
0740+  A09C 3A E5 A7    	LD	A,(MouseFlag)
0741+  A09F B7          	OR	A
0742+  A0A0 C8          	RET	Z
0743+  A0A1 FD E5       	PUSH	IY
0744+  A0A3 DD E5       	PUSH	IX
0745+  A0A5 E5          	PUSH	HL
0746+  A0A6 D5          	PUSH	DE
0747+  A0A7 C5          	PUSH	BC
0748+  A0A8 DD 21 BE A0 	LD	IX,ClockBMP
0749+  A0AC 21 09 0E    	LD	HL,#0E09
0750+  A0AF 11 04 07    	LD	DE,#0704
0751+  A0B2 0E 09       	LD	C,#09
0752+  A0B4 F7          	RST	#30
0753+  A0B5 C1          	POP	BC
0754+  A0B6 D1          	POP	DE
0755+  A0B7 E1          	POP	HL
0756+  A0B8 DD E1       	POP	IX
0757+  A0BA FD E1       	POP	IY
0758+  A0BC 76          	HALT 
0759+  A0BD C9          	RET 
0760+  A0BE             ClockBMP
0761+  A0BE             	DEFB	#00,#00,#00,#00,#00,#00,#00,#00,#00
0761+  A0BE 000000000000000000
0762+  A0C7             	DEFB	#00,#FE,#FE,#FE,#FE,#FE,#FE,#FE,#00
0762+  A0C7 00FEFEFEFEFEFEFE00
0763+  A0D0             	DEFB	#00,#00,#00,#00,#00,#00,#00,#00,#00
0763+  A0D0 000000000000000000
0764+  A0D9             	DEFB	#FF,#00,#FE,#FE,#FE,#FE,#FE,#00,#FF
0764+  A0D9 FF00FEFEFEFEFE00FF
0765+  A0E2             	DEFB	#FF,#00,#FE,#FE,#FE,#00,#FE,#00,#FF
0765+  A0E2 FF00FEFEFE00FE00FF
0766+  A0EB             	DEFB	#FF,#FF,#00,#FE,#F0,#FE,#00,#FF,#FF
0766+  A0EB FFFF00FEF0FE00FFFF
0767+  A0F4             	DEFB	#FF,#FF,#FF,#00,#FE,#00,#FF,#FF,#FF
0767+  A0F4 FFFFFF00FE00FFFFFF
0768+  A0FD             	DEFB	#FF,#FF,#FF,#00,#FE,#00,#FF,#FF,#FF
0768+  A0FD FFFFFF00FE00FFFFFF
0769+  A106             	DEFB	#FF,#FF,#00,#FE,#F0,#FE,#00,#FF,#FF
0769+  A106 FFFF00FEF0FE00FFFF
0770+  A10F             	DEFB	#FF,#00,#FE,#FE,#FE,#00,#FE,#00,#FF
0770+  A10F FF00FEFEFE00FE00FF
0771+  A118             	DEFB	#FF,#00,#FE,#FE,#FE,#FE,#FE,#00,#FF
0771+  A118 FF00FEFEFEFEFE00FF
0772+  A121             	DEFB	#00,#00,#00,#00,#00,#00,#00,#00,#00
0772+  A121 000000000000000000
0773+  A12A             	DEFB	#00,#FE,#FE,#FE,#FE,#FE,#FE,#FE,#00
0773+  A12A 00FEFEFEFEFEFEFE00
0774+  A133             	DEFB	#00,#00,#00,#00,#00,#00,#00,#00,#00
0774+  A133 000000000000000000
0775+  A13C             SetMouse
0776+  A13C 3A E5 A7    	LD	A,(MouseFlag)
0777+  A13F B7          	OR	A
0778+  A140 C8          	RET	Z
0779+  A141 FD E5       	PUSH	IY
0780+  A143 DD E5       	PUSH	IX
0781+  A145 E5          	PUSH	HL
0782+  A146 D5          	PUSH	DE
0783+  A147 C5          	PUSH	BC
0784+  A148 DD 21 5E A1 	LD	IX,MouseBMP
0785+  A14C 21 09 0D    	LD	HL,#0D09
0786+  A14F 11 00 00    	LD	DE,#0000
0787+  A152 0E 09       	LD	C,#09
0788+  A154 F7          	RST	#30
0789+  A155 C1          	POP	BC
0790+  A156 D1          	POP	DE
0791+  A157 E1          	POP	HL
0792+  A158 DD E1       	POP	IX
0793+  A15A FD E1       	POP	IY
0794+  A15C 76          	HALT 
0795+  A15D C9          	RET 
0796+  A15E             MouseBMP
0797+  A15E             	DEFB	#00,#00,#FF,#FF,#FF,#FF,#FF,#FF,#FF
0797+  A15E 0000FFFFFFFFFFFFFF
0798+  A167             	DEFB	#00,#FE,#00,#FF,#FF,#FF,#FF,#FF,#FF
0798+  A167 00FE00FFFFFFFFFFFF
0799+  A170             	DEFB	#00,#FE,#FE,#00,#FF,#FF,#FF,#FF,#FF
0799+  A170 00FEFE00FFFFFFFFFF
0800+  A179             	DEFB	#00,#FE,#FE,#FE,#00,#FF,#FF,#FF,#FF
0800+  A179 00FEFEFE00FFFFFFFF
0801+  A182             	DEFB	#00,#FE,#FE,#FE,#FE,#00,#FF,#FF,#FF
0801+  A182 00FEFEFEFE00FFFFFF
0802+  A18B             	DEFB	#00,#FE,#FE,#FE,#FE,#FE,#00,#FF,#FF
0802+  A18B 00FEFEFEFEFE00FFFF
0803+  A194             	DEFB	#00,#FE,#FE,#FE,#FE,#FE,#FE,#00,#FF
0803+  A194 00FEFEFEFEFEFE00FF
0804+  A19D             	DEFB	#00,#FE,#FE,#FE,#FE,#00,#00,#00,#00
0804+  A19D 00FEFEFEFE00000000
0805+  A1A6             	DEFB	#00,#FE,#FE,#00,#FE,#00,#FF,#FF,#FF
0805+  A1A6 00FEFE00FE00FFFFFF
0806+  A1AF             	DEFB	#00,#FE,#00,#00,#FE,#FE,#00,#FF,#FF
0806+  A1AF 00FE0000FEFE00FFFF
0807+  A1B8             	DEFB	#00,#00,#FF,#FF,#00,#FE,#00,#FF,#FF
0807+  A1B8 0000FFFF00FE00FFFF
0808+  A1C1             	DEFB	#00,#FF,#FF,#FF,#00,#FE,#FE,#00,#FF
0808+  A1C1 00FFFFFF00FEFE00FF
0809+  A1CA             	DEFB	#FF,#FF,#FF,#FF,#FF,#00,#00,#FF,#FF
0809+  A1CA FFFFFFFFFF0000FFFF
0810+  A1D3             
0811+  A1D3             
0812+  A1D3             
0064   A1D3             	include "fnsys.z80"
0001+  A1D3             
0002+  A1D3             ;[]-----------------------------------------------------------[]
0003+  A1D3             ;Процедура умножения (8*8bit)
0004+  A1D3             ;На вход: E*C
0005+  A1D3             ;На выход:HL-результат
0006+  A1D3 97          Mult8	SUB	A
0007+  A1D4 6F          	LD	L,A
0008+  A1D5 67          	LD	H,A
0009+  A1D6 57          	LD	D,A
0010+  A1D7 B9          	CP	C
0011+  A1D8 C8          	RET	Z
0012+  A1D9 BB          	CP	E
0013+  A1DA C8          	RET	Z
0014+  A1DB 61          	LD	H,C
0015+  A1DC 06 08       	LD	B,#08
0016+  A1DE 29          Mlt8x8	ADD	HL,HL
0017+  A1DF 30 01       	JR	NC,$+3
0018+  A1E1 19          	ADD	HL,DE
0019+  A1E2 10 FA       	DJNZ	Mlt8x8
0020+  A1E4 C9          	RET 
0021+  A1E5             ;Процедура умножения (16*8bit)
0022+  A1E5             ;На вход: DE*C
0023+  A1E5             ;На выход:A+HL-результат
0024+  A1E5             Mult16X8
0025+  A1E5 97          	SUB	A
0026+  A1E6 6F          	LD	L,A
0027+  A1E7 67          	LD	H,A
0028+  A1E8 B9          	CP	C
0029+  A1E9 C8          	RET	Z
0030+  A1EA B2          	OR	D
0031+  A1EB B3          	OR	E
0032+  A1EC C8          	RET	Z
0033+  A1ED 79          	LD	A,C
0034+  A1EE 0E 00       	LD	C,#00
0035+  A1F0 06 08       	LD	B,#08
0036+  A1F2 29          Mlt16x8	ADD	HL,HL
0037+  A1F3 17          	RLA 
0038+  A1F4 30 02       	JR	NC,$+4
0039+  A1F6 19          	ADD	HL,DE
0040+  A1F7 89          	ADC	A,C
0041+  A1F8 10 F8       	DJNZ	Mlt16x8
0042+  A1FA C9          	RET 
0043+  A1FB             ;Процедура умножения (16*16bit)
0044+  A1FB             ;На вход: DE*BC
0045+  A1FB             ;На выход:HL-результат
0046+  A1FB             Mult16
0047+  A1FB 21 00 00    	LD	HL,#0000
0048+  A1FE 3E 10       	LD	A,#10
0049+  A200 CB 18       mult16	RR	B
0050+  A202 CB 19       	RR	C
0051+  A204 30 01       	JR	NC,$+3
0052+  A206 19          	ADD	HL,DE
0053+  A207 CB 13       	RL	E
0054+  A209 CB 12       	RL	D
0055+  A20B 3D          	DEC	A
0056+  A20C 20 F2       	JR	NZ,mult16
0057+  A20E C9          	RET 
0058+  A20F             ;Процедура умножения (32bit)
0059+  A20F             ;На вход: DE*BC
0060+  A20F             ;На выход:HL+DE-результат
0061+  A20F             Mult16X16
0062+  A20F DD E5       	PUSH	IX
0063+  A211 EB          	EX	DE,HL
0064+  A212 1E 00       	LD	E,#00
0065+  A214 53          	LD	D,E
0066+  A215 DD 6B       	LD	LX,E
0067+  A217 DD 62       	LD	HX,D
0068+  A219 3E 20       	LD	A,#20
0069+  A21B DD 29       mul16b1	ADD	IX,IX
0070+  A21D ED 6A       	ADC	HL,HL
0071+  A21F CB 13       	RL	E
0072+  A221 CB 12       	RL	D
0073+  A223 30 05       	JR	NC,noadd
0074+  A225 DD 09       	ADD	IX,BC
0075+  A227 30 01       	JR	NC,noadd
0076+  A229 23          	INC	HL
0077+  A22A 3D          noadd	DEC	A
0078+  A22B 20 EE       	JR	NZ,mul16b1
0079+  A22D DD 5D       	LD	E,LX
0080+  A22F DD 54       	LD	D,HX
0081+  A231 DD E1       	POP	IX
0082+  A233 C9          	RET 
0083+  A234             ;Процедура умножения (32bit)
0084+  A234             ;На вход: HL+DE*BC
0085+  A234             ;На выход:HL+DE-результат
0086+  A234             Mult32
0087+  A234 DD E5       	PUSH	IX
0088+  A236 DD 21 00 00 	LD	IX,#0000
0089+  A23A 3E 20       	LD	A,#20
0090+  A23C EB          	EX	DE,HL
0091+  A23D DD 29       mul32b	ADD	IX,IX
0092+  A23F ED 6A       	ADC	HL,HL
0093+  A241 CB 13       	RL	E
0094+  A243 CB 12       	RL	D
0095+  A245 30 05       	JR	NC,noadd1
0096+  A247 DD 09       	ADD	IX,BC
0097+  A249 30 01       	JR	NC,noadd1
0098+  A24B 23          	INC	HL
0099+  A24C 3D          noadd1	DEC	A
0100+  A24D 20 EE       	JR	NZ,mul32b
0101+  A24F DD 5D       	LD	E,LX
0102+  A251 DD 54       	LD	D,HX
0103+  A253 DD E1       	POP	IX
0104+  A255 C9          	RET 
0105+  A256             ;Процедура деления (16bit)
0106+  A256             ;На вход: BC/DE
0107+  A256             ;На выход:BC-результат
0108+  A256             ;	  HL-остаток
0109+  A256             Divis16X16
0110+  A256 7A          	LD	A,D
0111+  A257 B3          	OR	E
0112+  A258 C8          	RET	Z
0113+  A259 21 00 00    	LD	HL,#0000
0114+  A25C 78          	LD	A,B
0115+  A25D 06 10       	LD	B,#10
0116+  A25F CB 11       Btrial1	RL	C
0117+  A261 17          	RLA 
0118+  A262 ED 6A       	ADC	HL,HL
0119+  A264 ED 52       	SBC	HL,DE
0120+  A266 3F          	CCF 
0121+  A267 30 0F       	JR	NC,Bngv1
0122+  A269 10 F4       Bptv1	DJNZ	Btrial1
0123+  A26B CB 11       	RL	C
0124+  A26D 17          	RLA 
0125+  A26E 47          	LD	B,A
0126+  A26F C9          	RET 
0127+  A270 CB 11       Brestr1	RL	C
0128+  A272 17          	RLA 
0129+  A273 ED 6A       	ADC	HL,HL
0130+  A275 19          	ADD	HL,DE
0131+  A276 38 F1       	JR	C,Bptv1
0132+  A278 10 F6       Bngv1	DJNZ	Brestr1
0133+  A27A CB 11       	RL	C
0134+  A27C 17          	RLA 
0135+  A27D 19          	ADD	HL,DE
0136+  A27E 47          	LD	B,A
0137+  A27F C9          	RET 
0138+  A280             ;Процедура деления (24x16bit)
0139+  A280             ;На вход: H+L+C/DE
0140+  A280             ;На выход:A -результат
0141+  A280             ;	  HL-остаток
0142+  A280             Divis24X16
0143+  A280 7A          	LD	A,D
0144+  A281 2F          	CPL 
0145+  A282 57          	LD	D,A
0146+  A283 7B          	LD	A,E
0147+  A284 2F          	CPL 
0148+  A285 5F          	LD	E,A
0149+  A286 13          	INC	DE
0150+  A287 79          	LD	A,C
0151+  A288 06 08       	LD	B,#08
0152+  A28A 29          Div2416	ADD	HL,HL
0153+  A28B 38 0E       	JR	C,Dv2416n
0154+  A28D 87          	ADD	A,A
0155+  A28E 30 01       	JR	NC,$+3
0156+  A290 23          	INC	HL
0157+  A291 E5          	PUSH	HL
0158+  A292 19          	ADD	HL,DE
0159+  A293 30 02       	JR	NC,$+4
0160+  A295 E3          	EX	(SP),HL
0161+  A296 3C          	INC	A
0162+  A297 E1          	POP	HL
0163+  A298 10 F0       	DJNZ	Div2416
0164+  A29A C9          	RET 
0165+  A29B 8F          Dv2416n	ADC	A,A
0166+  A29C 30 01       	JR	NC,$+3
0167+  A29E 23          	INC	HL
0168+  A29F 19          	ADD	HL,DE
0169+  A2A0 10 E8       	DJNZ	Div2416
0170+  A2A2 C9          	RET 
0171+  A2A3             ;Процедура деления 32/16bit=16bit
0172+  A2A3             ;На вход: HL+DE/BC
0173+  A2A3             ;На выход:DE-результат
0174+  A2A3             ;	  HL-остаток
0175+  A2A3             Divis32X16
0176+  A2A3 3E 10       	LD	A,#10
0177+  A2A5 EB          d32X16l	EX	DE,HL
0178+  A2A6 29          	ADD	HL,HL
0179+  A2A7 EB          	EX	DE,HL
0180+  A2A8 ED 6A       	ADC	HL,HL
0181+  A2AA ED 42       	SBC	HL,BC
0182+  A2AC 30 05       	JR	NC,dv32X16
0183+  A2AE 09          	ADD	HL,BC
0184+  A2AF 3D          	DEC	A
0185+  A2B0 20 F3       	JR	NZ,d32X16l
0186+  A2B2 C9          	RET 
0187+  A2B3 13          dv32X16	INC	DE
0188+  A2B4 3D          	DEC	A
0189+  A2B5 20 EE       	JR	NZ,d32X16l
0190+  A2B7 C9          	RET 
0191+  A2B8             ;Процедура деления 32/16bit=32bit
0192+  A2B8             ;На вход: HL+DE/BC
0193+  A2B8             ;На выход:HL+DE-результат
0194+  A2B8             ;	  BC-остаток
0195+  A2B8             Divis32
0196+  A2B8 DD E5       	PUSH	IX
0197+  A2BA DD 6B       	LD	LX,E
0198+  A2BC DD 62       	LD	HX,D
0199+  A2BE EB          	EX	DE,HL
0200+  A2BF 21 00 00    	LD	HL,#0000
0201+  A2C2 3E 20       	LD	A,#20
0202+  A2C4 DD 29       div32_1	ADD	IX,IX
0203+  A2C6 CB 13       	RL	E
0204+  A2C8 CB 12       	RL	D
0205+  A2CA ED 6A       	ADC	HL,HL
0206+  A2CC ED 42       	SBC	HL,BC
0207+  A2CE 30 03       	JR	NC,div32_2
0208+  A2D0 DD 2B       	DEC	IX
0209+  A2D2 09          	ADD	HL,BC
0210+  A2D3 DD 23       div32_2	INC	IX
0211+  A2D5 3D          	DEC	A
0212+  A2D6 20 EC       	JR	NZ,div32_1
0213+  A2D8 4D          	LD	C,L
0214+  A2D9 44          	LD	B,H
0215+  A2DA EB          	EX	DE,HL
0216+  A2DB DD 5D       	LD	E,LX
0217+  A2DD DD 54       	LD	D,HX
0218+  A2DF DD E1       	POP	IX
0219+  A2E1 C9          	RET 
0220+  A2E2             ;[]-----------------------------------------------------------[]
0221+  A2E2             ;Конвертер числа 32бит в текст
0222+  A2E2             ;На вход:
0223+  A2E2             ;	BC+HL -	число 32 бит
0224+  A2E2             ;	   DE -	буфер
0225+  A2E2             ConvNumTxt32
0226+  A2E2 DD E5       	PUSH	IX
0227+  A2E4 DD 21 EA A3 	LD	IX,ConvertFlg
0228+  A2E8 DD CB 00 BE 	RES	7,(IX+#00)
0229+  A2EC C5          	PUSH	BC
0230+  A2ED D9          	EXX 
0231+  A2EE E1          	POP	HL
0232+  A2EF D9          	EXX 
0233+  A2F0 01 00 CA    	LD	BC,#CA00
0234+  A2F3 D9          	EXX 
0235+  A2F4 01 9A 3B    	LD	BC,#3B9A	;1'000'000'000
0236+  A2F7 D9          	EXX 
0237+  A2F8 CD 95 A3    	CALL	ConNumb32
0238+  A2FB 01 00 E1    	LD	BC,#E100
0239+  A2FE D9          	EXX 
0240+  A2FF 01 F5 05    	LD	BC,#05F5	;100'000'000
0241+  A302 D9          	EXX 
0242+  A303 CD 95 A3    	CALL	ConNumb32
0243+  A306 01 80 96    	LD	BC,#9680
0244+  A309 D9          	EXX 
0245+  A30A 01 98 00    	LD	BC,#0098	;10'000'000
0246+  A30D D9          	EXX 
0247+  A30E CD 95 A3    	CALL	ConNumb32
0248+  A311 01 40 42    	LD	BC,#4240
0249+  A314 D9          	EXX 
0250+  A315 01 0F 00    	LD	BC,#000F	;1'000'000
0251+  A318 D9          	EXX 
0252+  A319 CD 95 A3    	CALL	ConNumb32
0253+  A31C 01 A0 86    	LD	BC,#86A0
0254+  A31F D9          	EXX 
0255+  A320 01 01 00    	LD	BC,#0001	;100'000
0256+  A323 D9          	EXX 
0257+  A324 CD 95 A3    	CALL	ConNumb32
0258+  A327 01 10 27    	LD	BC,10000	;10'000
0259+  A32A D9          	EXX 
0260+  A32B 01 00 00    	LD	BC,#0000
0261+  A32E D9          	EXX 
0262+  A32F CD 95 A3    	CALL	ConNumb32
0263+  A332 01 E8 03    	LD	BC,1000		;1'000
0264+  A335 CD B6 A3    	CALL	ConNumb16
0265+  A338 01 64 00    	LD	BC,100		;100
0266+  A33B CD B6 A3    	CALL	ConNumb16
0267+  A33E 01 0A 00    	LD	BC,10		;10
0268+  A341 CD B6 A3    	CALL	ConNumb16
0269+  A344 7D          	LD	A,L
0270+  A345 C6 30       	ADD	A,"0"
0271+  A347 12          	LD	(DE),A
0272+  A348 13          	INC	DE
0273+  A349 DD E1       	POP	IX
0274+  A34B C9          	RET 
0275+  A34C             ;Конвертер числа 16бит в текст
0276+  A34C             ;На вход:
0277+  A34C             ;	HL - число 16 бит
0278+  A34C             ;	DE - буфер
0279+  A34C             ConvNumTxt16
0280+  A34C DD E5       	PUSH	IX
0281+  A34E C5          	PUSH	BC
0282+  A34F DD 21 EA A3 	LD	IX,ConvertFlg
0283+  A353 DD CB 00 BE 	RES	7,(IX+#00)
0284+  A357 01 10 27    	LD	BC,10000	;10'000
0285+  A35A CD B6 A3    	CALL	ConNumb16
0286+  A35D 01 E8 03    	LD	BC,1000		;1'000
0287+  A360 CD B6 A3    	CALL	ConNumb16
0288+  A363 01 64 00    	LD	BC,100		;100
0289+  A366 CD B6 A3    	CALL	ConNumb16
0290+  A369 01 0A 00    	LD	BC,10		;10
0291+  A36C CD B6 A3    	CALL	ConNumb16
0292+  A36F 7D          	LD	A,L
0293+  A370 C6 30       	ADD	A,"0"
0294+  A372 12          	LD	(DE),A
0295+  A373 13          	INC	DE
0296+  A374 C1          	POP	BC
0297+  A375 DD E1       	POP	IX
0298+  A377 C9          	RET 
0299+  A378             ;Конвертер числа 8бит в	текст
0300+  A378             ;На вход:
0301+  A378             ;	A - число 8 бит
0302+  A378             ;	DE - буфер
0303+  A378             ConvNumTxt8
0304+  A378 DD E5       	PUSH	IX
0305+  A37A C5          	PUSH	BC
0306+  A37B DD 21 EA A3 	LD	IX,ConvertFlg
0307+  A37F DD CB 00 BE 	RES	7,(IX+#00)
0308+  A383 0E 64       	LD	C,100
0309+  A385 CD CF A3    	CALL	ConNumb8
0310+  A388 0E 0A       	LD	C,10
0311+  A38A CD CF A3    	CALL	ConNumb8
0312+  A38D C6 30       	ADD	A,"0"
0313+  A38F 12          	LD	(DE),A
0314+  A390 13          	INC	DE
0315+  A391 C1          	POP	BC
0316+  A392 DD E1       	POP	IX
0317+  A394 C9          	RET 
0318+  A395             ConNumb32
0319+  A395 3E 2F       	LD	A,#2F
0320+  A397 B7          	OR	A
0321+  A398 3C          ConNm32	INC	A
0322+  A399 ED 42       	SBC	HL,BC
0323+  A39B D9          	EXX 
0324+  A39C ED 42       	SBC	HL,BC
0325+  A39E D9          	EXX 
0326+  A39F 30 F7       	JR	NC,ConNm32
0327+  A3A1 09          	ADD	HL,BC
0328+  A3A2 D9          	EXX 
0329+  A3A3 ED 4A       	ADC	HL,BC
0330+  A3A5 D9          	EXX 
0331+  A3A6 FE 30       	CP	#30
0332+  A3A8 28 04       	JR	Z,$+6
0333+  A3AA DD CB 00 FE 	SET	7,(IX+#00)
0334+  A3AE DD CB 00 7E 	BIT	7,(IX+#00)
0335+  A3B2 C8          	RET	Z
0336+  A3B3 12          	LD	(DE),A
0337+  A3B4 13          	INC	DE
0338+  A3B5 C9          	RET 
0339+  A3B6             ConNumb16
0340+  A3B6 3E 2F       	LD	A,#2F
0341+  A3B8 B7          	OR	A
0342+  A3B9 3C          	INC	A
0343+  A3BA ED 42       	SBC	HL,BC
0344+  A3BC 30 FB       	JR	NC,$-3
0345+  A3BE 09          	ADD	HL,BC
0346+  A3BF FE 30       	CP	#30
0347+  A3C1 28 04       	JR	Z,$+6
0348+  A3C3 DD CB 00 FE 	SET	7,(IX+#00)
0349+  A3C7 DD CB 00 7E 	BIT	7,(IX+#00)
0350+  A3CB C8          	RET	Z
0351+  A3CC 12          	LD	(DE),A
0352+  A3CD 13          	INC	DE
0353+  A3CE C9          	RET 
0354+  A3CF             ConNumb8
0355+  A3CF 06 2F       	LD	B,#2F
0356+  A3D1 04          	INC	B
0357+  A3D2 91          	SUB	C
0358+  A3D3 30 FC       	JR	NC,$-2
0359+  A3D5 81          	ADD	A,C
0360+  A3D6 08          	EX	AF,AF'
0361+  A3D7 78          	LD	A,B
0362+  A3D8 FE 30       	CP	#30
0363+  A3DA 28 04       	JR	Z,$+6
0364+  A3DC DD CB 00 FE 	SET	7,(IX+#00)
0365+  A3E0 DD CB 00 7E 	BIT	7,(IX+#00)
0366+  A3E4 28 02       	JR	Z,$+4
0367+  A3E6 12          	LD	(DE),A
0368+  A3E7 13          	INC	DE
0369+  A3E8 08          	EX	AF,AF'
0370+  A3E9 C9          	RET 
0371+  A3EA             ConvertFlg
0372+  A3EA 00          	DEFB	#00
0373+  A3EB             ;[]-----------------------------------------------------------[]
0374+  A3EB             ;Конвертер текста в число 32 бит
0375+  A3EB             ;На вход:
0376+  A3EB             ;	   DE -	текст
0377+  A3EB             ;На выход:
0378+  A3EB             ;	HL+IX -	число
0379+  A3EB             ;	   CY -	ошибка
0380+  A3EB             ConvTxtNum32
0381+  A3EB DD 21 00 00 	LD	IX,#0000
0382+  A3EF 21 00 00    	LD	HL,#0000
0383+  A3F2 1A          ConvTN1	LD	A,(DE)
0384+  A3F3 FE 21       	CP	#21
0385+  A3F5 3F          	CCF 
0386+  A3F6 D0          	RET	NC
0387+  A3F7 D6 30       	SUB	#30
0388+  A3F9 D8          	RET	C
0389+  A3FA FE 0A       	CP	#0A
0390+  A3FC 3F          	CCF 
0391+  A3FD D8          	RET	C
0392+  A3FE 13          	INC	DE
0393+  A3FF DD 29       	ADD	IX,IX
0394+  A401 ED 6A       	ADC	HL,HL
0395+  A403 D8          	RET	C
0396+  A404 E5          	PUSH	HL
0397+  A405 DD E5       	PUSH	IX
0398+  A407 DD 29       	ADD	IX,IX
0399+  A409 ED 6A       	ADC	HL,HL
0400+  A40B D8          	RET	C
0401+  A40C DD 29       	ADD	IX,IX
0402+  A40E ED 6A       	ADC	HL,HL
0403+  A410 D8          	RET	C
0404+  A411 C1          	POP	BC
0405+  A412 DD 09       	ADD	IX,BC
0406+  A414 C1          	POP	BC
0407+  A415 ED 4A       	ADC	HL,BC
0408+  A417 D8          	RET	C
0409+  A418 4F          	LD	C,A
0410+  A419 06 00       	LD	B,#00
0411+  A41B DD 09       	ADD	IX,BC
0412+  A41D 48          	LD	C,B
0413+  A41E ED 4A       	ADC	HL,BC
0414+  A420 D8          	RET	C
0415+  A421 18 CF       	JR	ConvTN1
0416+  A423             ;Конвертер текста в число 16 бит
0417+  A423             ;На вход:
0418+  A423             ;	   DE -	текст
0419+  A423             ;На выход:
0420+  A423             ;	   HL -	число
0421+  A423             ;	   CY -	ошибка
0422+  A423             ConvTxtNum16
0423+  A423 21 00 00    	LD	HL,#0000
0424+  A426 1A          ConvTN2	LD	A,(DE)
0425+  A427 FE 21       	CP	#21
0426+  A429 3F          	CCF 
0427+  A42A D0          	RET	NC
0428+  A42B D6 30       	SUB	#30
0429+  A42D D8          	RET	C
0430+  A42E FE 0A       	CP	#0A
0431+  A430 3F          	CCF 
0432+  A431 D8          	RET	C
0433+  A432 13          	INC	DE
0434+  A433 29          	ADD	HL,HL
0435+  A434 D8          	RET	C
0436+  A435 E5          	PUSH	HL
0437+  A436 29          	ADD	HL,HL
0438+  A437 D8          	RET	C
0439+  A438 29          	ADD	HL,HL
0440+  A439 D8          	RET	C
0441+  A43A C1          	POP	BC
0442+  A43B 09          	ADD	HL,BC
0443+  A43C D8          	RET	C
0444+  A43D 4F          	LD	C,A
0445+  A43E 06 00       	LD	B,#00
0446+  A440 09          	ADD	HL,BC
0447+  A441 D8          	RET	C
0448+  A442 18 E2       	JR	ConvTN2
0449+  A444             ;[]-----------------------------------------------------------[]
0450+  A444             MoveBytes
0451+  A444 78          	LD	A,B
0452+  A445 B7          	OR	A
0453+  A446 28 0E       	JR	Z,MvByte1
0454+  A448 F3          	DI 
0455+  A449 52          	LD	D,D
0456+  A44A 3E 00       	LD	A,#00
0457+  A44C 6D          MvByte0	LD	L,L
0458+  A44D 7E          	LD	A,(HL)
0459+  A44E 12          	LD	(DE),A
0460+  A44F 40          	LD	B,B
0461+  A450 24          	INC	H
0462+  A451 14          	INC	D
0463+  A452 05          	DEC	B
0464+  A453 20 F7       	JR	NZ,MvByte0
0465+  A455 FB          	EI 
0466+  A456 79          MvByte1	LD	A,C
0467+  A457 B7          	OR	A
0468+  A458 C8          	RET	Z
0469+  A459 32 5F A4    	LD	(Mvlen1+1),A
0470+  A45C F3          	DI 
0471+  A45D 52          	LD	D,D
0472+  A45E 3E 00       Mvlen1	LD	A,#00
0473+  A460 6D          	LD	L,L
0474+  A461 7E          	LD	A,(HL)
0475+  A462 12          	LD	(DE),A
0476+  A463 40          	LD	B,B
0477+  A464 FB          	EI 
0478+  A465 79          	LD	A,C
0479+  A466 83          	ADD	A,E
0480+  A467 5F          	LD	E,A
0481+  A468 30 01       	JR	NC,$+3
0482+  A46A 14          	INC	D
0483+  A46B 79          	LD	A,C
0484+  A46C 85          	ADD	A,L
0485+  A46D 6F          	LD	L,A
0486+  A46E D0          	RET	NC
0487+  A46F 24          	INC	H
0488+  A470 C9          	RET 
0489+  A471             MoveBytesUp
0490+  A471 78          	LD	A,B
0491+  A472 B7          	OR	A
0492+  A473 28 0F       	JR	Z,MovUp1
0493+  A475 F3          	DI 
0494+  A476 52          	LD	D,D
0495+  A477 3E 00       	LD	A,#00
0496+  A479 40          	LD	B,B
0497+  A47A 25          MovUp0	DEC	H
0498+  A47B 15          	DEC	D
0499+  A47C 6D          	LD	L,L
0500+  A47D 7E          	LD	A,(HL)
0501+  A47E 12          	LD	(DE),A
0502+  A47F 40          	LD	B,B
0503+  A480 05          	DEC	B
0504+  A481 20 F7       	JR	NZ,MovUp0
0505+  A483 FB          	EI 
0506+  A484 79          MovUp1	LD	A,C
0507+  A485 B7          	OR	A
0508+  A486 C8          	RET	Z
0509+  A487 32 93 A4    	LD	(LenUp+1),A
0510+  A48A ED 42       	SBC	HL,BC
0511+  A48C EB          	EX	DE,HL
0512+  A48D ED 42       	SBC	HL,BC
0513+  A48F EB          	EX	DE,HL
0514+  A490 F3          	DI 
0515+  A491 52          	LD	D,D
0516+  A492 3E 00       LenUp	LD	A,#00
0517+  A494 6D          	LD	L,L
0518+  A495 7E          	LD	A,(HL)
0519+  A496 12          	LD	(DE),A
0520+  A497 40          	LD	B,B
0521+  A498 FB          	EI 
0522+  A499 C9          	RET 
0523+  A49A             ;[]----------------------------------------------------------[]
0524+  A49A             Resident
0525+  A49A ED 53 A4 A4 	LD	(ResCall+1),DE
0526+  A49E ED 40       	IN	B,(C)
0527+  A4A0 C5          	PUSH	BC
0528+  A4A1 ED 79       	OUT	(C),A
0529+  A4A3 CD 00 00    ResCall	CALL	#0000
0530+  A4A6 C1          	POP	BC
0531+  A4A7 ED 41       	OUT	(C),B
0532+  A4A9 C9          	RET 
0533+  A4AA             
0534+  A4AA             
0535+  A4AA             
0065   A4AA             
0066   A4AA             ;[]=======================================================================[]
0067   A4AA             ;Старт
0068   A4AA             StartPoint: 
0069   A4AA F3          	DI
0070   A4AB 31 FF 85    	LD	SP,0x85FF
0071   A4AE 97          BEGCOM	SUB	A
0072   A4AF D3 FE       	OUT	(BORDER),A
0073   A4B1 3E C0       	LD	A,0xC0
0074   A4B3 D3 89       	OUT	(YPORT),A
0075   A4B5 CD 10 E4    	CALL	InitVMode
0076   A4B8 CD A4 E4    	CALL	InitDrivers
0077   A4BB CD 20 E6    BEGCOMv	CALL	InitScreen
0078   A4BE CD 88 EB    	CALL	ClrDOSline
0079   A4C1 97          	SUB	A
0080   A4C2 CD C3 E7    	CALL	InitPanels
0081   A4C5 CD 0D 9B    	CALL	ResFire
0082   A4C8             ComLoop
0083   A4C8 DD 21 F1 EF 	LD	IX,MainCoordsL
0084   A4CC FD CB 00 46 	BIT	0,(IY+PanelFlg)
0085   A4D0 28 04       	JR	Z, .next
0086   A4D2 DD 21 A3 F2 	LD	IX,MainCoordsR
0087   A4D6 CD 1C 9B    .next	CALL	TestCoords
0088   A4D9 CD E8 A4    	CALL	TestKeys
0089   A4DC DC F1 EA    	CALL	C,DOSline
0090   A4DF 3A E3 A7    ComNext	LD	A,(TreeFlag)
0091   A4E2 B7          	OR	A
0092   A4E3 C4 11 B0    	CALL	NZ,TestTree
0093   A4E6 18 E0       	JR	ComLoop
0094   A4E8             
0095   A4E8             ;[]-----------------------------------------------------------------------[]
0096   A4E8             TestKeys
0097   A4E8 0E 37       	LD	C,0x37
0098   A4EA D7          	RST	0x10
0099   A4EB 28 4D       	JR	Z,KeyExit
0100   A4ED CB BA       	RES	7,D
0101   A4EF 78          	LD	A,B
0102   A4F0 E6 30       	AND	0x30
0103   A4F2 FE 30       	CP	0x30
0104   A4F4 C8          	RET	Z
0105   A4F5 DD 21 06 FE 	LD	IX,SHIFTKeys
0106   A4F9 78          	LD	A,B
0107   A4FA E6 C0       	AND	0xC0
0108   A4FC 20 14       	JR	NZ,TstKeys
0109   A4FE DD 21 0F FE 	LD	IX,CTRLKeys
0110   A502 CB 68       	BIT	5,B
0111   A504 20 0C       	JR	NZ,TstKeys
0112   A506 DD 21 58 FE 	LD	IX,ALTKeys
0113   A50A CB 60       	BIT	4,B
0114   A50C 20 04       	JR	NZ,TstKeys
0115   A50E DD 21 AD FD 	LD	IX,ASCIIKeys
0116   A512 DD 7E 00    TstKeys	LD	A,(IX+0x00)
0117   A515 DD 23       	INC	IX
0118   A517 FE FF       	CP	0xFF
0119   A519 37          	SCF
0120   A51A C8          	RET	Z
0121   A51B 6F          	LD	L,A
0122   A51C DD 66 00    	LD	H,(IX+0x00)
0123   A51F DD 23       	INC	IX
0124   A521 DD 4E 00    	LD	C,(IX+0x00)
0125   A524 DD 23       	INC	IX
0126   A526 DD 46 00    	LD	B,(IX+0x00)
0127   A529 DD 23       	INC	IX
0128   A52B B7          	OR	A
0129   A52C ED 52       	SBC	HL,DE
0130   A52E 20 E2       	JR	NZ,TstKeys
0131   A530 ED 43 38 A5 	LD	(KeyCALL+1),BC
0132   A534 0E 31       	LD	C,0x31
0133   A536 D7          	RST	0x10
0134   A537 CD 00 00    KeyCALL	CALL	0x0000
0135   A53A AF          KeyExit	XOR	A
0136   A53B C9          	RET
0137   A53C             
0138   A53C             ;[]-----------------------------------------------------------------------[]
0139   A53C             MouseOnOff
0140   A53C 3A E5 A7    	LD	A,(MouseFlag)
0141   A53F EE 01       	XOR	0x01
0142   A541 32 E5 A7    	LD	(MouseFlag),A
0143   A544 0E 01       	LD	C,0x01
0144   A546 20 02       	JR	NZ,$+4
0145   A548 0E 02       	LD	C,0x02
0146   A54A F7          	RST	0x30
0147   A54B C9          	RET
0148   A54C             
0149   A54C             ;[]-----------------------------------------------------------------------[]
0150   A54C             ComExit
0151   A54C CD 16 E6    	CALL	ResDrivers
0152   A54F CD 98 E4    	CALL	ResVMode
0153   A552 21 62 A5    	LD	HL,.thanks
0154   A555 0E 5C       	LD	C,0x5C
0155   A557 D7          	RST	0x10
0156   A558 3A E6 A7    	LD	A,(FNIndef)
0157   A55B 0E 3E       	LD	C,0x3E
0158   A55D D7          	RST	0x10
0159   A55E 01 41 00    	LD	BC,0x0041
0160   A561 D7          	RST	0x10
0161   A562             .thanks
0162   A562             	DB	0x0D,0x0A,"Thank you for using Flex Navigator.",0x0D,0x0A
0162   A562 0D0A5468616E6B20796F7520666F72207573696E6720466C6578204E61766967
0162   A582 61746F722E0D0A
0163   A589 00          	DB	0x00
0164   A58A             
0165   A58A             ;[]=======================================================================[]
0166   A58A             ; discription of flex navigator file panels
0167   A58A             LeftPanel: 
0168   A58A 80          	DB	0x80	;Флаг панели 7бит - бит	выделенности
0169   A58B             			;	     0бит - номер панели
0170   A58B 00          	DB	0x00	;Флаг вида панели 0 - краткая панель
0171   A58C             			;	       бит0 - подробная	панель
0172   A58C             			;	       бит1 - дерево
0173   A58C             			;	       бит2 - ужатое дерево
0174   A58C 01          	DB	0x01	;Вид сортировки
0175   A58D             			;	       бит0 - по имени
0176   A58D             			;	       бит1 - по расширению
0177   A58D             			;	       бит2 - по размеру
0178   A58D             			;	       бит3 - по дате
0179   A58D             			;	       бит4 - execute file
0180   A58D             			;	       бит5 - file mask
0181   A58D 04 00       	DW	0x0004	;X позиция панели
0182   A58F 00 00       	DW	0x0000	;X позиция скролбара
0183   A591 00 00       	DW	0x0000	;Y позиция скролбара
0184   A593 00 00       	DW	0x0000	;Max длина скролбара
0185   A595 00 00       	DW	0x0000	;тек.длина скролбара
0186   A597 00 00       	DW	0x0000	;Адрес ячейки BarLeft
0187   A599 00 00       	DW	0x0000	;Адрес ячейки BarRight
0188   A59B 00 00       	DW	0x0000	;Кол-во	файлов на странице
0189   A59D 00 00       	DW	0x0000	;Общее кол-во файлов
0190   A59F 00 00       	DW	0x0000	;Первый	файл на	странице
0191   A5A1 00 00       	DW	0x0000	;Tекущий файл на странице
0192   A5A3 00 00       	DW	0x0000	;Кол-во	маркированных файлов
0193   A5A5 00 00 00 00 	DW	0x0000,0x0000	;Кол-во	маркированных байтов
0194   A5A9 2A 2E 2A    	DB	"*.*"	;Maска для файлов
0195   A5AC 00          	ds	0x0A
0196   A5B6 00          	ds	0x100	;Путь к	текущей	директории
0197   A6B6             
0198   A6B6             RightPanel: 
0199   A6B6 01          	DB	0x01	;Флаг панели 7бит - бит0выделенности
0200   A6B7             			;	     0бит - номер панели
0201   A6B7 00          	DB	0x00	;Флаг вида панели 0 - краткая панель
0202   A6B8             			;	       бит0 - подробная	панель
0203   A6B8             			;	       бит1 - дерево
0204   A6B8             			;	       бит2 - ужатое дерево
0205   A6B8 01          	DB	0x01	;Вид сортировки
0206   A6B9             			;	       бит0 - по имени
0207   A6B9             			;	       бит1 - по расширению
0208   A6B9             			;	       бит2 - по размеру
0209   A6B9             			;	       бит3 - по дате
0210   A6B9             			;	       бит4 - execute file
0211   A6B9             			;	       бит5 - file mask
0212   A6B9 44 01       	DW	0x0144	;X позиция панели
0213   A6BB 00 00       	DW	0x0000	;X позиция скролбара
0214   A6BD 00 00       	DW	0x0000	;Y позиция скролбара
0215   A6BF 00 00       	DW	0x0000	;Max длина скролбара
0216   A6C1 00 00       	DW	0x0000	;тек.длина скролбара
0217   A6C3 00 00       	DW	0x0000	;Адрес ячейки BarLeft
0218   A6C5 00 00       	DW	0x0000	;Адрес ячейки BarRight
0219   A6C7 00 00       	DW	0x0000	;Кол-во	файлов на странице
0220   A6C9 00 00       	DW	0x0000	;Общее кол-во файлов
0221   A6CB 00 00       	DW	0x0000	;Первый	файл на	странице
0222   A6CD 00 00       	DW	0x0000	;Tекущий файл на странице
0223   A6CF 00 00       	DW	0x0000	;Кол-во	маркированных файлов
0224   A6D1 00 00 00 00 	DW	0x0000,0x0000	;Кол-во	маркированных байтов
0225   A6D5 2A 2E 2A    	DB	"*.*"	;Maска для файлов
0226   A6D8 00          	ds	0x0A
0227   A6E2 00          	ds	0x100	;Путь к	текущей	директории
0228   A7E2             
0229   A7E2             ;[]-----------------------------------------------------------------------[]
0230   A7E2             ; flex navigator settings
0231   A7E2             EquipDisks		;Кол-во	устройств
0232   A7E2 00          	DB	0x00
0233   A7E3             TreeFlag		;Флаг дерева
0234   A7E3 00          	DB	0x00
0235   A7E4             CMOSFlag		;Флаг CMOS 0 - нет
0236   A7E4 00          	DB	0x00	;	   1 - есть
0237   A7E5             MouseFlag		;Флаг мыши 0 - нет
0238   A7E5 01          	DB	0x01	;	   1 - есть
0239   A7E6             FNIndef			;Индеф.памяти где FN
0240   A7E6 00          	DB	0x00
0241   A7E7             FunctPg			;Страница с функциями FN
0242   A7E7 00          	DB	0
0243   A7E8             ViewPg			;Страница с FileViewer
0244   A7E8 00          	DB	0
0245   A7E9             EditPg			;Страница с FileEditor
0246   A7E9 00          	DB	0
0247   A7EA             HelpPg			;Страница FN HELP
0248   A7EA 00          	DB	0
0249   A7EB             FONTpage		;Страница шрифтов
0250   A7EB 00          	DB	0
0251   A7EC             BuffInd			;Индефикатор памяти под	буфера
0252   A7EC 00          	DB	0x00
0253   A7ED             WorkPage		;Страница для подгрузки	FLX просмотр.
0254   A7ED 00          	DB	0x00	;			FLX утилит
0255   A7EE             DIRpage1		;Страница каталога Левой панели
0256   A7EE 00          	DB	0x00
0257   A7EF             DIRpage2		;Страница каталога Правой панели
0258   A7EF 00          	DB	0x00
0259   A7F0             
0260   A7F0 00          BuffPg1	DB	0x00	;Буферные страницы под интерфейс
0261   A7F1 00          BuffPg2	DB	0x00
0262   A7F2 00          BuffPg3	DB	0x00
0263   A7F3 00          BuffPg4	DB	0x00
0264   A7F4 00          	DB	0x00
0265   A7F5             
0266   A7F5             ;[]=======================================================================[]
0267   A7F5             
0268   A7F5             	include "fnsort.z80"
0001+  A7F5             
0002+  A7F5             ;[]----------------------------------------------------------[]
0003+  A7F5             ReadDIR
0004+  A7F5 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0005+  A7F9 C2 40 AC    	JP	NZ,ReadTree
0006+  A7FC DB E2       	IN	A,(PAGE3)
0007+  A7FE F5          	PUSH	AF
0008+  A7FF FD CB 00 46 	BIT	0,(IY+PanelFlg)
0009+  A803 3A EE A7    	LD	A,(DIRpage1)
0010+  A806 28 03       	JR	Z,$+5
0011+  A808 3A EF A7    	LD	A,(DIRpage2)
0012+  A80B D3 E2       	OUT	(PAGE3),A
0013+  A80D 97          	SUB	A
0014+  A80E FD 77 15    	LD	(IY+PanelFFl),A	     ;First pag
0015+  A811 FD 77 16    	LD	(IY+PanelFFh),A
0016+  A814 FD 77 17    	LD	(IY+PanelCFl),A	     ;Current f
0017+  A817 FD 77 18    	LD	(IY+PanelCFh),A
0018+  A81A FD 77 13    	LD	(IY+PanelEFl),A	     ;Equip fil
0019+  A81D FD 77 14    	LD	(IY+PanelEFh),A
0020+  A820 FD 77 19    	LD	(IY+PanelMFl),A	     ;Equip mark files
0021+  A823 FD 77 1A    	LD	(IY+PanelMFh),A
0022+  A826 FD 77 1B    	LD	(IY+PanelMBl1),A      ;Equip mark bytes
0023+  A829 FD 77 1C    	LD	(IY+PanelMBh1),A
0024+  A82C FD 77 1D    	LD	(IY+PanelMBl2),A      ;Equip mark bytes
0025+  A82F FD 77 1E    	LD	(IY+PanelMBh2),A
0026+  A832 FD E5       	PUSH	IY
0027+  A834 E1          	POP	HL
0028+  A835 01 1F 00    	LD	BC,BegMask
0029+  A838 09          	ADD	HL,BC
0030+  A839 FD CB 02 6E 	BIT	5,(IY+SortFlg)
0031+  A83D 20 03       	JR	NZ,$+5
0032+  A83F 21 80 A8    	LD	HL,NORMmask
0033+  A842 11 8D A8    	LD	DE,FILEmask
0034+  A845 0E 0D       	LD	C,#0D
0035+  A847 ED B0       	LDIR 
0036+  A849 DD 21 00 00 	LD	IX,#0000
0037+  A84D 21 00 C0    	LD	HL,#C000
0038+  A850 22 7D A8    	LD	(AdrNxtFile),HL
0039+  A853 06 08       	LD	B,#08
0040+  A855 97          	SUB	A
0041+  A856 77          	LD	(HL),A
0042+  A857 23          	INC	HL
0043+  A858 10 FC       	DJNZ	$-2
0044+  A85A CD 9A A8    	CALL	FindFILES
0045+  A85D DD 5D       	LD	E,LX
0046+  A85F DD 54       	LD	D,HX
0047+  A861 2A 7D A8    	LD	HL,(AdrNxtFile)
0048+  A864 06 08       	LD	B,#08
0049+  A866 97          	SUB	A
0050+  A867 77          	LD	(HL),A
0051+  A868 23          	INC	HL
0052+  A869 10 FC       	DJNZ	$-2
0053+  A86B F1          	POP	AF
0054+  A86C D3 E2       	OUT	(#E2),A
0055+  A86E FD 73 13    	LD	(IY+PanelEFl),E	     ;Equip fil
0056+  A871 FD 72 14    	LD	(IY+PanelEFh),D
0057+  A874 FD 7E 02    	LD	A,(IY+SortFlg)
0058+  A877 E6 0F       	AND	#0F
0059+  A879 C4 89 AA    	CALL	NZ,SortDIR
0060+  A87C C9          	RET 
0061+  A87D             AdrNxtFile
0062+  A87D 00 00       	DEFW	#0000
0063+  A87F             FileAtribut
0064+  A87F 37          	DEFB	#37
0065+  A880             NORMmask
0066+  A880 2A 2E 2A    	DEFB	"*.*"
0067+  A883 00          	DEFS	10,0
0068+  A88D             FILEmask
0069+  A88D 00          	DEFS	#0D,0
0070+  A89A             FindFILES
0071+  A89A FD CB 02 6E 	BIT	5,(IY+SortFlg)
0072+  A89E 20 30       	JR	NZ,FindFILESm
0073+  A8A0 21 8D A8    	LD	HL,FILEmask
0074+  A8A3 11 00 80    	LD	DE,WorkBuffer
0075+  A8A6 01 19 00    	LD	BC,#0019
0076+  A8A9 3A 7F A8    	LD	A,(FileAtribut)
0077+  A8AC FD E5       	PUSH	IY
0078+  A8AE DD E5       	PUSH	IX
0079+  A8B0 D5          	PUSH	DE
0080+  A8B1 D7          	RST	#10
0081+  A8B2 E1          	POP	HL
0082+  A8B3 DD E1       	POP	IX
0083+  A8B5 FD E1       	POP	IY
0084+  A8B7 D8          	RET	C
0085+  A8B8 CD 38 A9    FndFILE	CALL	InsFileInfo
0086+  A8BB D8          	RET	C
0087+  A8BC 11 00 80    	LD	DE,WorkBuffer
0088+  A8BF 01 1A 00    	LD	BC,#001A
0089+  A8C2 FD E5       	PUSH	IY
0090+  A8C4 DD E5       	PUSH	IX
0091+  A8C6 D5          	PUSH	DE
0092+  A8C7 D7          	RST	#10
0093+  A8C8 E1          	POP	HL
0094+  A8C9 DD E1       	POP	IX
0095+  A8CB FD E1       	POP	IY
0096+  A8CD 30 E9       	JR	NC,FndFILE
0097+  A8CF C9          	RET 
0098+  A8D0             FindFILESm
0099+  A8D0 21 80 A8    	LD	HL,NORMmask
0100+  A8D3 11 00 80    	LD	DE,WorkBuffer
0101+  A8D6 01 19 00    	LD	BC,#0019
0102+  A8D9 3A 7F A8    	LD	A,(FileAtribut)
0103+  A8DC E6 17       	AND	%00010111
0104+  A8DE FD E5       	PUSH	IY
0105+  A8E0 DD E5       	PUSH	IX
0106+  A8E2 D5          	PUSH	DE
0107+  A8E3 D7          	RST	#10
0108+  A8E4 E1          	POP	HL
0109+  A8E5 DD E1       	POP	IX
0110+  A8E7 FD E1       	POP	IY
0111+  A8E9 D8          	RET	C
0112+  A8EA 3A 20 80    FFILEm1	LD	A,(WorkBuffer+32)
0113+  A8ED CB 67       	BIT	4,A
0114+  A8EF C4 38 A9    	CALL	NZ,InsFileInfo
0115+  A8F2 D8          	RET	C
0116+  A8F3 11 00 80    	LD	DE,WorkBuffer
0117+  A8F6 01 1A 00    	LD	BC,#001A
0118+  A8F9 FD E5       	PUSH	IY
0119+  A8FB DD E5       	PUSH	IX
0120+  A8FD D5          	PUSH	DE
0121+  A8FE D7          	RST	#10
0122+  A8FF E1          	POP	HL
0123+  A900 DD E1       	POP	IX
0124+  A902 FD E1       	POP	IY
0125+  A904 30 E4       	JR	NC,FFILEm1
0126+  A906 21 8D A8    	LD	HL,FILEmask
0127+  A909 11 00 80    	LD	DE,WorkBuffer
0128+  A90C 01 19 00    	LD	BC,#0019
0129+  A90F 3A 7F A8    	LD	A,(FileAtribut)
0130+  A912 E6 E7       	AND	%11100111
0131+  A914 FD E5       	PUSH	IY
0132+  A916 DD E5       	PUSH	IX
0133+  A918 D5          	PUSH	DE
0134+  A919 D7          	RST	#10
0135+  A91A E1          	POP	HL
0136+  A91B DD E1       	POP	IX
0137+  A91D FD E1       	POP	IY
0138+  A91F D8          	RET	C
0139+  A920 CD 38 A9    FFILEm2	CALL	InsFileInfo
0140+  A923 D8          	RET	C
0141+  A924 11 00 80    	LD	DE,WorkBuffer
0142+  A927 01 1A 00    	LD	BC,#001A
0143+  A92A FD E5       	PUSH	IY
0144+  A92C DD E5       	PUSH	IX
0145+  A92E D5          	PUSH	DE
0146+  A92F D7          	RST	#10
0147+  A930 E1          	POP	HL
0148+  A931 DD E1       	POP	IX
0149+  A933 FD E1       	POP	IY
0150+  A935 30 E9       	JR	NC,FFILEm2
0151+  A937 C9          	RET 
0152+  A938             InsFileInfo
0153+  A938 EB          	EX	DE,HL
0154+  A939 2A 7D A8    	LD	HL,(AdrNxtFile)
0155+  A93C 01 18 00    	LD	BC,#0018
0156+  A93F 09          	ADD	HL,BC
0157+  A940 ED 42       	SBC	HL,BC
0158+  A942 EB          	EX	DE,HL
0159+  A943 D8          	RET	C
0160+  A944 97          	SUB	A
0161+  A945 12          	LD	(DE),A
0162+  A946 13          	INC	DE
0163+  A947 E5          	PUSH	HL
0164+  A948 01 20 00    	LD	BC,32
0165+  A94B 09          	ADD	HL,BC
0166+  A94C 46          	LD	B,(HL)
0167+  A94D 23          	INC	HL
0168+  A94E 78          	LD	A,B
0169+  A94F 08          	EX	AF,AF'
0170+  A950 7E          	LD	A,(HL)
0171+  A951 23          	INC	HL
0172+  A952 4E          	LD	C,(HL)
0173+  A953 2B          	DEC	HL
0174+  A954 FE 2E       	CP	"."
0175+  A956 20 08       	JR	NZ,InsF1
0176+  A958 3E 20       	LD	A,#20
0177+  A95A 91          	SUB	C
0178+  A95B 20 03       	JR	NZ,InsF1
0179+  A95D E1          InsFext	POP	HL
0180+  A95E B7          	OR	A
0181+  A95F C9          	RET 
0182+  A960 CB 60       InsF1	BIT	4,B
0183+  A962 20 26       	JR	NZ,InsF2
0184+  A964 B7          	OR	A
0185+  A965 FD CB 02 66 	BIT	4,(IY+SortFlg)
0186+  A969 C4 1B AA    	CALL	NZ,TestExe
0187+  A96C 38 EF       	JR	C,InsFext
0188+  A96E 06 08       	LD	B,#08
0189+  A970 7E          	LD	A,(HL)
0190+  A971 CD 57 AA    	CALL	CorrBigChar
0191+  A974 12          	LD	(DE),A
0192+  A975 23          	INC	HL
0193+  A976 13          	INC	DE
0194+  A977 10 F7       	DJNZ	$-7
0195+  A979 3E 01       	LD	A,#01
0196+  A97B 12          	LD	(DE),A
0197+  A97C 13          	INC	DE
0198+  A97D 06 03       	LD	B,#03
0199+  A97F 7E          	LD	A,(HL)
0200+  A980 CD 57 AA    	CALL	CorrBigChar
0201+  A983 12          	LD	(DE),A
0202+  A984 23          	INC	HL
0203+  A985 13          	INC	DE
0204+  A986 10 F7       	DJNZ	$-7
0205+  A988 18 1A       	JR	InsF3
0206+  A98A ED A0       InsF2	LDI 
0207+  A98C ED A0       	LDI 
0208+  A98E ED A0       	LDI 
0209+  A990 ED A0       	LDI 
0210+  A992 ED A0       	LDI 
0211+  A994 ED A0       	LDI 
0212+  A996 ED A0       	LDI 
0213+  A998 ED A0       	LDI 
0214+  A99A 3E 01       	LD	A,#01
0215+  A99C 12          	LD	(DE),A
0216+  A99D 13          	INC	DE
0217+  A99E ED A0       	LDI 
0218+  A9A0 ED A0       	LDI 
0219+  A9A2 ED A0       	LDI 
0220+  A9A4 97          InsF3	SUB	A
0221+  A9A5 12          	LD	(DE),A
0222+  A9A6 13          	INC	DE
0223+  A9A7 08          	EX	AF,AF'
0224+  A9A8 12          	LD	(DE),A
0225+  A9A9 13          	INC	DE
0226+  A9AA E1          	POP	HL
0227+  A9AB E5          	PUSH	HL
0228+  A9AC 01 1C 00    	LD	BC,28
0229+  A9AF 09          	ADD	HL,BC
0230+  A9B0 ED A0       	LDI 
0231+  A9B2 ED A0       	LDI 
0232+  A9B4 ED A0       	LDI 
0233+  A9B6 ED A0       	LDI 
0234+  A9B8 E1          	POP	HL
0235+  A9B9 E5          	PUSH	HL
0236+  A9BA 0E 18       	LD	C,24
0237+  A9BC 09          	ADD	HL,BC
0238+  A9BD 7E          	LD	A,(HL)
0239+  A9BE E6 1F       	AND	#1F		;Число
0240+  A9C0 12          	LD	(DE),A
0241+  A9C1 13          	INC	DE
0242+  A9C2 4E          	LD	C,(HL)
0243+  A9C3 23          	INC	HL
0244+  A9C4 46          	LD	B,(HL)
0245+  A9C5                    DUP     #05
0246+  A9C5 CB 38       >	SRL	B
0247+  A9C7 CB 19       >	RR	C
0246+  A9C9 CB 38       >	SRL	B
0247+  A9CB CB 19       >	RR	C
0246+  A9CD CB 38       >	SRL	B
0247+  A9CF CB 19       >	RR	C
0246+  A9D1 CB 38       >	SRL	B
0247+  A9D3 CB 19       >	RR	C
0246+  A9D5 CB 38       >	SRL	B
0247+  A9D7 CB 19       >	RR	C
0249+  A9D9 79          	LD	A,C
0250+  A9DA E6 0F       	AND	#0F		;Месяц
0251+  A9DC 12          	LD	(DE),A
0252+  A9DD 13          	INC	DE
0253+  A9DE 7E          	LD	A,(HL)
0254+  A9DF CB 3F       	SRL	A
0255+  A9E1 C6 50       	ADD	A,80
0256+  A9E3 D6 64       	SUB	100
0257+  A9E5 30 FC       	JR	NC,$-2
0258+  A9E7 C6 64       	ADD	A,100		;Год
0259+  A9E9 12          	LD	(DE),A
0260+  A9EA 13          	INC	DE
0261+  A9EB E1          	POP	HL
0262+  A9EC 01 16 00    	LD	BC,22
0263+  A9EF 09          	ADD	HL,BC
0264+  A9F0 4E          	LD	C,(HL)
0265+  A9F1 23          	INC	HL
0266+  A9F2 46          	LD	B,(HL)
0267+  A9F3 78          	LD	A,B
0268+  A9F4 E6 F8       	AND	#F8
0269+  A9F6 1F          	RRA 
0270+  A9F7 1F          	RRA 
0271+  A9F8 1F          	RRA 
0272+  A9F9 12          	LD	(DE),A		;Часы
0273+  A9FA 13          	INC	DE
0274+  A9FB                    DUP     #05
0275+  A9FB CB 38       >	SRL	B
0276+  A9FD CB 19       >	RR	C
0275+  A9FF CB 38       >	SRL	B
0276+  AA01 CB 19       >	RR	C
0275+  AA03 CB 38       >	SRL	B
0276+  AA05 CB 19       >	RR	C
0275+  AA07 CB 38       >	SRL	B
0276+  AA09 CB 19       >	RR	C
0275+  AA0B CB 38       >	SRL	B
0276+  AA0D CB 19       >	RR	C
0278+  AA0F 79          	LD	A,C
0279+  AA10 E6 3F       	AND	#3F
0280+  AA12 12          	LD	(DE),A		;Минуты
0281+  AA13 13          	INC	DE
0282+  AA14 ED 53 7D A8 	LD	(AdrNxtFile),DE
0283+  AA18 DD 23       	INC	IX
0284+  AA1A C9          	RET 
0285+  AA1B             
0286+  AA1B E5          TestExe	PUSH	HL
0287+  AA1C 7D          	LD	A,L
0288+  AA1D C6 08       	ADD	A,8
0289+  AA1F 6F          	LD	L,A
0290+  AA20 30 01       	JR	NC,$+3
0291+  AA22 24          	INC	H
0292+  AA23 7E          	LD	A,(HL)
0293+  AA24 23          	INC	HL
0294+  AA25 FE 45       	CP	"E"
0295+  AA27 20 0E       	JR	NZ,TestExe1
0296+  AA29 7E          	LD	A,(HL)
0297+  AA2A 23          	INC	HL
0298+  AA2B FE 58       	CP	"X"
0299+  AA2D 20 08       	JR	NZ,TestExe1
0300+  AA2F 7E          	LD	A,(HL)
0301+  AA30 FE 45       	CP	"E"
0302+  AA32 20 03       	JR	NZ,TestExe1
0303+  AA34 E1          	POP	HL
0304+  AA35 B7          	OR	A
0305+  AA36 C9          	RET 
0306+  AA37             TestExe1
0307+  AA37 E1          	POP	HL
0308+  AA38 E5          	PUSH	HL
0309+  AA39 7D          	LD	A,L
0310+  AA3A C6 08       	ADD	A,8
0311+  AA3C 6F          	LD	L,A
0312+  AA3D 30 01       	JR	NC,$+3
0313+  AA3F 24          	INC	H
0314+  AA40 7E          	LD	A,(HL)
0315+  AA41 23          	INC	HL
0316+  AA42 FE 54       	CP	"T"
0317+  AA44 20 0E       	JR	NZ,TestExeC
0318+  AA46 7E          	LD	A,(HL)
0319+  AA47 23          	INC	HL
0320+  AA48 FE 52       	CP	"R"
0321+  AA4A 20 08       	JR	NZ,TestExeC
0322+  AA4C 7E          	LD	A,(HL)
0323+  AA4D FE 44       	CP	"D"
0324+  AA4F 20 03       	JR	NZ,TestExeC
0325+  AA51 E1          	POP	HL
0326+  AA52 B7          	OR	A
0327+  AA53 C9          	RET 
0328+  AA54             TestExeC
0329+  AA54 E1          	POP	HL
0330+  AA55 37          	SCF 
0331+  AA56 C9          	RET 
0332+  AA57             ;Процедура коррекции буквы к маленькой букве
0333+  AA57             CorrBigChar
0334+  AA57 FE 41       	CP	#41
0335+  AA59 D8          	RET	C
0336+  AA5A FE 5B       	CP	#5B
0337+  AA5C 30 03       	JR	NC,CorrCh1
0338+  AA5E CB EF       	SET	5,A
0339+  AA60 C9          	RET 
0340+  AA61 FE 80       CorrCh1	CP	#80
0341+  AA63 D8          	RET	C
0342+  AA64 FE A0       	CP	#A0
0343+  AA66 D0          	RET	NC
0344+  AA67 C6 20       	ADD	A,#20
0345+  AA69 FE B0       	CP	#B0
0346+  AA6B D8          	RET	C
0347+  AA6C C6 30       	ADD	A,#30
0348+  AA6E C9          	RET 
0349+  AA6F             ;Процедура коррекции буквы к большой букве
0350+  AA6F             CorrSmallChar
0351+  AA6F FE 61       	CP	#61
0352+  AA71 D8          	RET	C
0353+  AA72 FE 7B       	CP	#7B
0354+  AA74 30 03       	JR	NC,CorrCh2
0355+  AA76 CB AF       	RES	5,A
0356+  AA78 C9          	RET 
0357+  AA79 FE A0       CorrCh2	CP	#A0
0358+  AA7B D8          	RET	C
0359+  AA7C FE B0       	CP	#B0
0360+  AA7E 30 03       	JR	NC,CorrCh3
0361+  AA80 D6 20       	SUB	#20
0362+  AA82 C9          	RET 
0363+  AA83 FE E0       CorrCh3	CP	#E0
0364+  AA85 D8          	RET	C
0365+  AA86 D6 50       	SUB	#50
0366+  AA88 C9          	RET 
0367+  AA89             ;[]----------------------------------------------------------[]
0368+  AA89             SortDIR
0369+  AA89 DB A2       	IN	A,(PAGE1)
0370+  AA8B 4F          	LD	C,A
0371+  AA8C DB E2       	IN	A,(PAGE3)
0372+  AA8E 47          	LD	B,A
0373+  AA8F C5          	PUSH	BC
0374+  AA90 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0375+  AA94 3A EE A7    	LD	A,(DIRpage1)
0376+  AA97 28 03       	JR	Z,$+5
0377+  AA99 3A EF A7    	LD	A,(DIRpage2)
0378+  AA9C D3 A2       	OUT	(PAGE1),A
0379+  AA9E 3A F2 A7    	LD	A,(BuffPg3)
0380+  AAA1 D3 E2       	OUT	(PAGE3),A
0381+  AAA3 21 00 C0    	LD	HL,#C000
0382+  AAA6 22 37 AB    	LD	(EndSort),HL
0383+  AAA9 97          	SUB	A
0384+  AAAA 77          	LD	(HL),A
0385+  AAAB 23          	INC	HL
0386+  AAAC 77          	LD	(HL),A
0387+  AAAD 22 35 AB    	LD	(BegSort),HL
0388+  AAB0 FD 7E 02    	LD	A,(IY+SortFlg)
0389+  AAB3 1F          	RRA 
0390+  AAB4 21 39 AB    	LD	HL,SortABC
0391+  AAB7 38 0F       	JR	C,SortBeg
0392+  AAB9 1F          	RRA 
0393+  AABA 21 59 AB    	LD	HL,SortExt
0394+  AABD 38 09       	JR	C,SortBeg
0395+  AABF 1F          	RRA 
0396+  AAC0 21 8E AB    	LD	HL,SortData
0397+  AAC3 38 03       	JR	C,SortBeg
0398+  AAC5 21 D8 AB    	LD	HL,SortSize
0399+  AAC8 22 E2 AA    SortBeg	LD	(Scall1+1),HL
0400+  AACB 22 04 AB    	LD	(Scall2+1),HL
0401+  AACE DD 21 01 40 	LD	IX,#4001
0402+  AAD2 21 01 40    	LD	HL,#4001
0403+  AAD5 DD E5       	PUSH	IX
0404+  AAD7 E5          	PUSH	HL
0405+  AAD8             SortDIRlp1
0406+  AAD8 7E          	LD	A,(HL)
0407+  AAD9 B7          	OR	A
0408+  AADA 28 11       	JR	Z,SortDIRnxt
0409+  AADC DD CB 0D 66 	BIT	4,(IX+#0D)
0410+  AAE0 E5          	PUSH	HL
0411+  AAE1 C4 00 00    Scall1	CALL	NZ,#0000
0412+  AAE4 E1          	POP	HL
0413+  AAE5 01 18 00    	LD	BC,#0018
0414+  AAE8 DD 09       	ADD	IX,BC
0415+  AAEA 09          	ADD	HL,BC
0416+  AAEB 18 EB       	JR	SortDIRlp1
0417+  AAED             SortDIRnxt
0418+  AAED 2A 37 AB    	LD	HL,(EndSort)
0419+  AAF0 97          	SUB	A
0420+  AAF1 77          	LD	(HL),A
0421+  AAF2 23          	INC	HL
0422+  AAF3 77          	LD	(HL),A
0423+  AAF4 22 35 AB    	LD	(BegSort),HL
0424+  AAF7 E1          	POP	HL
0425+  AAF8 DD E1       	POP	IX
0426+  AAFA             SortDIRlp2
0427+  AAFA 7E          	LD	A,(HL)
0428+  AAFB B7          	OR	A
0429+  AAFC 28 11       	JR	Z,SortDIRext
0430+  AAFE DD CB 0D 66 	BIT	4,(IX+#0D)
0431+  AB02 E5          	PUSH	HL
0432+  AB03 CC 00 00    Scall2	CALL	Z,#0000
0433+  AB06 E1          	POP	HL
0434+  AB07 01 18 00    	LD	BC,#0018
0435+  AB0A DD 09       	ADD	IX,BC
0436+  AB0C 09          	ADD	HL,BC
0437+  AB0D 18 EB       	JR	SortDIRlp2
0438+  AB0F             SortDIRext
0439+  AB0F 2A 37 AB    	LD	HL,(EndSort)
0440+  AB12 06 08       	LD	B,#08
0441+  AB14 97          	SUB	A
0442+  AB15 77          	LD	(HL),A
0443+  AB16 23          	INC	HL
0444+  AB17 10 FC       	DJNZ	$-2
0445+  AB19 DB A2       	IN	A,(PAGE1)
0446+  AB1B 32 F2 A7    	LD	(BuffPg3),A
0447+  AB1E DB E2       	IN	A,(PAGE3)
0448+  AB20 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0449+  AB24 21 EE A7    	LD	HL,DIRpage1
0450+  AB27 28 03       	JR	Z,$+5
0451+  AB29 21 EF A7    	LD	HL,DIRpage2
0452+  AB2C 77          	LD	(HL),A
0453+  AB2D C1          	POP	BC
0454+  AB2E 78          	LD	A,B
0455+  AB2F D3 E2       	OUT	(PAGE3),A
0456+  AB31 79          	LD	A,C
0457+  AB32 D3 A2       	OUT	(PAGE1),A
0458+  AB34 C9          	RET 
0459+  AB35             BegSort
0460+  AB35 00 00       	DEFW	#0000
0461+  AB37             EndSort
0462+  AB37 00 00       	DEFW	#0000
0463+  AB39             SortABC
0464+  AB39 EB          	EX	DE,HL
0465+  AB3A 2A 35 AB    	LD	HL,(BegSort)
0466+  AB3D 7E          Sabc1	LD	A,(HL)
0467+  AB3E B7          	OR	A
0468+  AB3F CA 17 AC    	JP	Z,SortDIRins
0469+  AB42 D5          	PUSH	DE
0470+  AB43 E5          	PUSH	HL
0471+  AB44 06 0C       	LD	B,12
0472+  AB46 1A          Sabc2	LD	A,(DE)	;(DE) <	(HL)  "C"
0473+  AB47 BE          	CP	(HL)	;(DE) >= (HL) "NC"
0474+  AB48 20 04       	JR	NZ,Sabc3
0475+  AB4A 13          	INC	DE
0476+  AB4B 23          	INC	HL
0477+  AB4C 10 F8       	DJNZ	Sabc2
0478+  AB4E E1          Sabc3	POP	HL
0479+  AB4F D1          	POP	DE
0480+  AB50 DA 17 AC    	JP	C,SortDIRins
0481+  AB53 01 18 00    	LD	BC,#0018
0482+  AB56 09          	ADD	HL,BC
0483+  AB57 18 E4       	JR	Sabc1
0484+  AB59             SortExt
0485+  AB59 EB          	EX	DE,HL
0486+  AB5A 2A 35 AB    	LD	HL,(BegSort)
0487+  AB5D 7E          Sext1	LD	A,(HL)
0488+  AB5E B7          	OR	A
0489+  AB5F CA 17 AC    	JP	Z,SortDIRins
0490+  AB62 D5          	PUSH	DE
0491+  AB63 E5          	PUSH	HL
0492+  AB64 01 09 00    	LD	BC,#0009
0493+  AB67 09          	ADD	HL,BC
0494+  AB68 EB          	EX	DE,HL
0495+  AB69 09          	ADD	HL,BC
0496+  AB6A EB          	EX	DE,HL
0497+  AB6B 06 03       	LD	B,03
0498+  AB6D 1A          Sext2	LD	A,(DE)	;(DE) <	(HL)  "C"
0499+  AB6E BE          	CP	(HL)	;(DE) >= (HL) "NC"
0500+  AB6F 20 12       	JR	NZ,Sext4
0501+  AB71 13          	INC	DE
0502+  AB72 23          	INC	HL
0503+  AB73 10 F8       	DJNZ	Sext2
0504+  AB75 E1          	POP	HL
0505+  AB76 D1          	POP	DE
0506+  AB77 D5          	PUSH	DE
0507+  AB78 E5          	PUSH	HL
0508+  AB79 06 08       	LD	B,08
0509+  AB7B 1A          Sext3	LD	A,(DE)	;(DE) <	(HL)  "C"
0510+  AB7C BE          	CP	(HL)	;(DE) >= (HL) "NC"
0511+  AB7D 20 04       	JR	NZ,Sext4
0512+  AB7F 13          	INC	DE
0513+  AB80 23          	INC	HL
0514+  AB81 10 F8       	DJNZ	Sext3
0515+  AB83 E1          Sext4	POP	HL
0516+  AB84 D1          	POP	DE
0517+  AB85 DA 17 AC    	JP	C,SortDIRins
0518+  AB88 01 18 00    	LD	BC,#0018
0519+  AB8B 09          	ADD	HL,BC
0520+  AB8C 18 CF       	JR	Sext1
0521+  AB8E             SortData
0522+  AB8E EB          	EX	DE,HL
0523+  AB8F 2A 35 AB    	LD	HL,(BegSort)
0524+  AB92 7E          Sdata1	LD	A,(HL)
0525+  AB93 B7          	OR	A
0526+  AB94 CA 17 AC    	JP	Z,SortDIRins
0527+  AB97 D5          	PUSH	DE
0528+  AB98 E5          	PUSH	HL
0529+  AB99 01 14 00    	LD	BC,#0014
0530+  AB9C 09          	ADD	HL,BC
0531+  AB9D EB          	EX	DE,HL
0532+  AB9E 09          	ADD	HL,BC
0533+  AB9F EB          	EX	DE,HL
0534+  ABA0 1A          	LD	A,(DE)	;(DE) <	(HL)  "C"
0535+  ABA1 BE          	CP	(HL)	;(DE) >= (HL) "NC"
0536+  ABA2 20 2A       	JR	NZ,SdataE
0537+  ABA4 1B          	DEC	DE
0538+  ABA5 2B          	DEC	HL
0539+  ABA6 1A          	LD	A,(DE)	;(DE) <	(HL)  "C"
0540+  ABA7 BE          	CP	(HL)	;(DE) >= (HL) "NC"
0541+  ABA8 20 24       	JR	NZ,SdataE
0542+  ABAA 1B          	DEC	DE
0543+  ABAB 2B          	DEC	HL
0544+  ABAC 1A          	LD	A,(DE)	;(DE) <	(HL)  "C"
0545+  ABAD BE          	CP	(HL)	;(DE) >= (HL) "NC"
0546+  ABAE 20 1E       	JR	NZ,SdataE
0547+  ABB0 23          	INC	HL
0548+  ABB1 23          	INC	HL
0549+  ABB2 23          	INC	HL
0550+  ABB3 13          	INC	DE
0551+  ABB4 13          	INC	DE
0552+  ABB5 13          	INC	DE
0553+  ABB6 1A          	LD	A,(DE)	;(DE) <	(HL)  "C"
0554+  ABB7 BE          	CP	(HL)	;(DE) >= (HL) "NC"
0555+  ABB8 20 14       	JR	NZ,SdataE
0556+  ABBA 13          	INC	DE
0557+  ABBB 23          	INC	HL
0558+  ABBC 1A          	LD	A,(DE)	;(DE) <	(HL)  "C"
0559+  ABBD BE          	CP	(HL)	;(DE) >= (HL) "NC"
0560+  ABBE 20 0E       	JR	NZ,SdataE
0561+  ABC0 E1          	POP	HL
0562+  ABC1 D1          	POP	DE
0563+  ABC2 D5          	PUSH	DE
0564+  ABC3 E5          	PUSH	HL
0565+  ABC4 06 0C       	LD	B,12
0566+  ABC6 1A          Sdata2	LD	A,(DE)	;(DE) <	(HL)  "C"
0567+  ABC7 BE          	CP	(HL)	;(DE) >= (HL) "NC"
0568+  ABC8 20 04       	JR	NZ,SdataE
0569+  ABCA 13          	INC	DE
0570+  ABCB 23          	INC	HL
0571+  ABCC 10 F8       	DJNZ	Sdata2
0572+  ABCE E1          SdataE	POP	HL
0573+  ABCF D1          	POP	DE
0574+  ABD0 38 45       	JR	C,SortDIRins
0575+  ABD2 01 18 00    	LD	BC,#0018
0576+  ABD5 09          	ADD	HL,BC
0577+  ABD6 18 BA       	JR	Sdata1
0578+  ABD8             SortSize
0579+  ABD8 EB          	EX	DE,HL
0580+  ABD9 2A 35 AB    	LD	HL,(BegSort)
0581+  ABDC 7E          Ssize1	LD	A,(HL)
0582+  ABDD B7          	OR	A
0583+  ABDE 28 37       	JR	Z,SortDIRins
0584+  ABE0 D5          	PUSH	DE
0585+  ABE1 E5          	PUSH	HL
0586+  ABE2 01 11 00    	LD	BC,#0011
0587+  ABE5 09          	ADD	HL,BC
0588+  ABE6 EB          	EX	DE,HL
0589+  ABE7 09          	ADD	HL,BC
0590+  ABE8 EB          	EX	DE,HL
0591+  ABE9 1A          	LD	A,(DE)	;(DE) <	(HL)  "C"
0592+  ABEA BE          	CP	(HL)	;(DE) >= (HL) "NC"
0593+  ABEB 20 20       	JR	NZ,SsizeE
0594+  ABED 1B          	DEC	DE
0595+  ABEE 2B          	DEC	HL
0596+  ABEF 1A          	LD	A,(DE)	;(DE) <	(HL)  "C"
0597+  ABF0 BE          	CP	(HL)	;(DE) >= (HL) "NC"
0598+  ABF1 20 1A       	JR	NZ,SsizeE
0599+  ABF3 1B          	DEC	DE
0600+  ABF4 2B          	DEC	HL
0601+  ABF5 1A          	LD	A,(DE)	;(DE) <	(HL)  "C"
0602+  ABF6 BE          	CP	(HL)	;(DE) >= (HL) "NC"
0603+  ABF7 20 14       	JR	NZ,SsizeE
0604+  ABF9 1B          	DEC	DE
0605+  ABFA 2B          	DEC	HL
0606+  ABFB 1A          	LD	A,(DE)	;(DE) <	(HL)  "C"
0607+  ABFC BE          	CP	(HL)	;(DE) >= (HL) "NC"
0608+  ABFD 20 0E       	JR	NZ,SsizeE
0609+  ABFF E1          	POP	HL
0610+  AC00 D1          	POP	DE
0611+  AC01 D5          	PUSH	DE
0612+  AC02 E5          	PUSH	HL
0613+  AC03 06 0C       	LD	B,12
0614+  AC05 1A          Ssize2	LD	A,(DE)	;(DE) <	(HL)  "C"
0615+  AC06 BE          	CP	(HL)	;(DE) >= (HL) "NC"
0616+  AC07 20 04       	JR	NZ,SsizeE
0617+  AC09 13          	INC	DE
0618+  AC0A 23          	INC	HL
0619+  AC0B 10 F8       	DJNZ	Ssize2
0620+  AC0D E1          SsizeE	POP	HL
0621+  AC0E D1          	POP	DE
0622+  AC0F 38 06       	JR	C,SortDIRins
0623+  AC11 01 18 00    	LD	BC,#0018
0624+  AC14 09          	ADD	HL,BC
0625+  AC15 18 C5       	JR	Ssize1
0626+  AC17             SortDIRins
0627+  AC17 2B          	DEC	HL
0628+  AC18 1B          	DEC	DE
0629+  AC19 D5          	PUSH	DE
0630+  AC1A E5          	PUSH	HL
0631+  AC1B EB          	EX	DE,HL
0632+  AC1C 2A 37 AB    	LD	HL,(EndSort)
0633+  AC1F E5          	PUSH	HL
0634+  AC20 B7          	OR	A
0635+  AC21 ED 52       	SBC	HL,DE
0636+  AC23 44          	LD	B,H
0637+  AC24 4D          	LD	C,L
0638+  AC25 D1          	POP	DE
0639+  AC26 21 18 00    	LD	HL,#0018
0640+  AC29 19          	ADD	HL,DE
0641+  AC2A 22 37 AB    	LD	(EndSort),HL
0642+  AC2D 97          	SUB	A
0643+  AC2E 77          	LD	(HL),A
0644+  AC2F 23          	INC	HL
0645+  AC30 77          	LD	(HL),A
0646+  AC31 2B          	DEC	HL
0647+  AC32 EB          	EX	DE,HL
0648+  AC33 78          	LD	A,B
0649+  AC34 B1          	OR	C
0650+  AC35 C4 71 A4    	CALL	NZ,MoveBytesUp
0651+  AC38 D1          	POP	DE
0652+  AC39 E1          	POP	HL
0653+  AC3A 01 18 00    	LD	BC,#0018
0654+  AC3D ED B0       	LDIR 
0655+  AC3F C9          	RET 
0656+  AC40             
0657+  AC40             
0658+  AC40             
0269   AC40             	include "fntree.z80"
0001+  AC40             
0002+  AC40             ;[]----------------------------------------------------------[]
0003+  AC40             ReadTree
0004+  AC40 97          	SUB	A
0005+  AC41 FD 77 15    	LD	(IY+PanelFFl),A	     ;First pag
0006+  AC44 FD 77 16    	LD	(IY+PanelFFh),A
0007+  AC47 FD 77 17    	LD	(IY+PanelCFl),A	     ;Current f
0008+  AC4A FD 77 18    	LD	(IY+PanelCFh),A
0009+  AC4D FD 77 13    	LD	(IY+PanelEFl),A	     ;Equip fil
0010+  AC50 FD 77 14    	LD	(IY+PanelEFh),A
0011+  AC53 FD 77 19    	LD	(IY+PanelMFl),A	     ;Equip mark files
0012+  AC56 FD 77 1A    	LD	(IY+PanelMFh),A
0013+  AC59 FD 77 1B    	LD	(IY+PanelMBl1),A      ;Equip mark bytes
0014+  AC5C FD 77 1C    	LD	(IY+PanelMBh1),A
0015+  AC5F FD 77 1D    	LD	(IY+PanelMBl2),A      ;Equip mark bytes
0016+  AC62 FD 77 1E    	LD	(IY+PanelMBh2),A
0017+  AC65 21 21 AF    	LD	HL,BegDIR
0018+  AC68 0E 1D       	LD	C,#1D
0019+  AC6A FD E5       	PUSH	IY
0020+  AC6C D7          	RST	#10
0021+  AC6D FD E1       	POP	IY
0022+  AC6F 21 04 AF    	LD	HL,TreeName
0023+  AC72 97          	SUB	A
0024+  AC73 0E 11       	LD	C,#11
0025+  AC75 FD E5       	PUSH	IY
0026+  AC77 D7          	RST	#10
0027+  AC78 FD E1       	POP	IY
0028+  AC7A D2 3A AE    	JP	NC,LoadTree
0029+  AC7D             ScanTree
0030+  AC7D DB A2       	IN	A,(PAGE1)
0031+  AC7F 4F          	LD	C,A
0032+  AC80 DB E2       	IN	A,(PAGE3)
0033+  AC82 47          	LD	B,A
0034+  AC83 C5          	PUSH	BC
0035+  AC84 3A F2 A7    	LD	A,(BuffPg3)
0036+  AC87 D3 A2       	OUT	(PAGE1),A
0037+  AC89 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0038+  AC8D 3A EE A7    	LD	A,(DIRpage1)
0039+  AC90 28 03       	JR	Z,$+5
0040+  AC92 3A EF A7    	LD	A,(DIRpage2)
0041+  AC95 D3 E2       	OUT	(PAGE3),A
0042+  AC97 FD E5       	PUSH	IY
0043+  AC99 CD F0 86    	CALL	MakeWindow
0044+  AC9C 01          	DEFB	#01
0045+  AC9D F0 00 60 00 	DEFW	#00F0,#0060
0046+  ACA1 A0 00 28 00 	DEFW	#00A0,#0028
0047+  ACA5 02          	DEFB	#02	;Head place
0048+  ACA6 04 00 02 00 	DEFW	#0004,#0002
0049+  ACAA 98 00 0A 00 	DEFW	#0098,#000A
0050+  ACAE 00          	DEFB	#00
0051+  ACAF 01          	DEFB	#01	;Text Line
0052+  ACB0 2C 00 03 00 	DEFW	#002C,#0003
0053+  ACB4 0F          	DEFB	#0F
0054+  ACB5             	DEFB	"Scanning tree",0
0054+  ACB5 5363616E6E696E67207472656500
0055+  ACC3 01          	DEFB	#01	;Text Line
0056+  ACC4 20 00 14 00 	DEFW	#0020,#0014
0057+  ACC8 80          	DEFB	#80
0058+  ACC9             	DEFB	"Directories:",0
0058+  ACC9 4469726563746F726965733A00
0059+  ACD6 00          	DEFB	#00
0060+  ACD7 ED 73 BF AD 	LD	(TreeSP1+1),SP
0061+  ACDB 97          	SUB	A
0062+  ACDC 32 26 AF    	LD	(CurTree),A
0063+  ACDF 31 00 85    	LD	SP,WorkBuffer+#500
0064+  ACE2 21 00 00    	LD	HL,#0000
0065+  ACE5 E5          	PUSH	HL
0066+  ACE6 22 7F AF    	LD	(CurTAdr+1),HL
0067+  ACE9 21 10 C0    	LD	HL,#C010
0068+  ACEC 22 29 AF    	LD	(EndTree),HL
0069+  ACEF 06 10       	LD	B,#10
0070+  ACF1 97          	SUB	A
0071+  ACF2 77          	LD	(HL),A
0072+  ACF3 23          	INC	HL
0073+  ACF4 10 FC       	DJNZ	$-2
0074+  ACF6 21 01 00    	LD	HL,#0001
0075+  ACF9 22 27 AF    	LD	(TreeDIRS),HL
0076+  ACFC CD 2B AF    	CALL	LoadDIR
0077+  ACFF 30 53       	JR	NC,TreeExit	;NC - нет директорий
0078+  AD01             TreeLoop
0079+  AD01 E5          	PUSH	HL
0080+  AD02 0E 31       	LD	C,#31
0081+  AD04 D7          	RST	#10
0082+  AD05 7B          	LD	A,E
0083+  AD06 D6 1B       	SUB	#1B
0084+  AD08 E1          	POP	HL
0085+  AD09 CA E4 AE    	JP	Z,AbortTree
0086+  AD0C 3A 26 AF    	LD	A,(CurTree)
0087+  AD0F 3C          	INC	A
0088+  AD10 FE 15       	CP	#15
0089+  AD12 28 1B       	JR	Z,DIRSend
0090+  AD14 32 26 AF    	LD	(CurTree),A
0091+  AD17 ED 5B 27 AF 	LD	DE,(TreeDIRS)
0092+  AD1B CB 52       	BIT	2,D		;>=1024
0093+  AD1D 20 35       	JR	NZ,TreeExit
0094+  AD1F E5          	PUSH	HL
0095+  AD20 7E          	LD	A,(HL)
0096+  AD21 B7          	OR	A
0097+  AD22 28 0B       	JR	Z,DIRSend
0098+  AD24 22 7F AF    	LD	(CurTAdr+1),HL
0099+  AD27 0E 1D       	LD	C,#1D
0100+  AD29 D7          	RST	#10
0101+  AD2A CD 2B AF    	CALL	LoadDIR
0102+  AD2D 38 D2       	JR	C,TreeLoop	;C - есть директории
0103+  AD2F             DIRSend
0104+  AD2F 0E 31       	LD	C,#31
0105+  AD31 D7          	RST	#10
0106+  AD32 7B          	LD	A,E
0107+  AD33 D6 1B       	SUB	#1B
0108+  AD35 CA E4 AE    	JP	Z,AbortTree
0109+  AD38 E1          	POP	HL
0110+  AD39 7C          	LD	A,H
0111+  AD3A B5          	OR	L
0112+  AD3B 28 17       	JR	Z,TreeExit
0113+  AD3D E5          	PUSH	HL
0114+  AD3E 21 26 AF    	LD	HL,CurTree
0115+  AD41 35          	DEC	(HL)
0116+  AD42 21 23 AF    	LD	HL,UpDIR
0117+  AD45 0E 1D       	LD	C,#1D
0118+  AD47 D7          	RST	#10
0119+  AD48 E1          	POP	HL
0120+  AD49 11 0F 00    	LD	DE,#000F
0121+  AD4C 19          	ADD	HL,DE
0122+  AD4D 7E          	LD	A,(HL)
0123+  AD4E 23          	INC	HL
0124+  AD4F 3C          	INC	A
0125+  AD50 20 AF       	JR	NZ,TreeLoop
0126+  AD52 18 DB       	JR	DIRSend
0127+  AD54             TreeExit
0128+  AD54 3E C0       	LD	A,#C0
0129+  AD56 D3 89       	OUT	(YPORT),A
0130+  AD58 31 00 85    	LD	SP,WorkBuffer+#500
0131+  AD5B DD 21 00 00 	LD	IX,#0000
0132+  AD5F DD E5       	PUSH	IX
0133+  AD61 21 00 40    	LD	HL,#4000
0134+  AD64 11 11 AF    	LD	DE,TreeHead
0135+  AD67 01 10 00    	LD	BC,#0010
0136+  AD6A EB          	EX	DE,HL
0137+  AD6B ED B0       	LDIR 
0138+  AD6D 2A 27 AF    	LD	HL,(TreeDIRS)
0139+  AD70 2B          	DEC	HL
0140+  AD71 7C          	LD	A,H
0141+  AD72 B5          	OR	L
0142+  AD73 28 41       	JR	Z,TreeExit1
0143+  AD75 21 10 C0    	LD	HL,#C010
0144+  AD78             TreeEndLp
0145+  AD78 DD 2C       	INC	LX
0146+  AD7A E5          	PUSH	HL
0147+  AD7B D5          	PUSH	DE
0148+  AD7C DD 7D       	LD	A,LX
0149+  AD7E DD BC       	CP	HX
0150+  AD80 38 02       	JR	C,$+4
0151+  AD82 DD 67       	LD	HX,A
0152+  AD84 12          	LD	(DE),A
0153+  AD85 13          	INC	DE
0154+  AD86 97          	SUB	A
0155+  AD87 12          	LD	(DE),A
0156+  AD88 13          	INC	DE
0157+  AD89 01 0C 00    	LD	BC,#000C
0158+  AD8C ED B0       	LDIR 
0159+  AD8E 97          	SUB	A
0160+  AD8F 12          	LD	(DE),A
0161+  AD90 13          	INC	DE
0162+  AD91 12          	LD	(DE),A
0163+  AD92 13          	INC	DE
0164+  AD93 23          	INC	HL
0165+  AD94 4E          	LD	C,(HL)
0166+  AD95 23          	INC	HL
0167+  AD96 46          	LD	B,(HL)
0168+  AD97 23          	INC	HL
0169+  AD98 7E          	LD	A,(HL)
0170+  AD99 E6 80       	AND	#80
0171+  AD9B E1          	POP	HL
0172+  AD9C B6          	OR	(HL)
0173+  AD9D 77          	LD	(HL),A
0174+  AD9E 69          	LD	L,C
0175+  AD9F 60          	LD	H,B
0176+  ADA0 7C          	LD	A,H
0177+  ADA1 B5          	OR	L
0178+  ADA2 20 D4       	JR	NZ,TreeEndLp
0179+  ADA4             TreeEndLp1
0180+  ADA4 DD 2D       	DEC	LX
0181+  ADA6 E1          	POP	HL
0182+  ADA7 7C          	LD	A,H
0183+  ADA8 B5          	OR	L
0184+  ADA9 28 0B       	JR	Z,TreeExit1
0185+  ADAB 01 0F 00    	LD	BC,#000F
0186+  ADAE 09          	ADD	HL,BC
0187+  ADAF 7E          	LD	A,(HL)
0188+  ADB0 23          	INC	HL
0189+  ADB1 3C          	INC	A
0190+  ADB2 20 C4       	JR	NZ,TreeEndLp
0191+  ADB4 18 EE       	JR	TreeEndLp1
0192+  ADB6             TreeExit1
0193+  ADB6 ED 53 29 AF 	LD	(EndTree),DE
0194+  ADBA 1B          	DEC	DE
0195+  ADBB 3E FF       	LD	A,#FF
0196+  ADBD 12          	LD	(DE),A
0197+  ADBE 31 00 00    TreeSP1	LD	SP,#0000
0198+  ADC1 FD E1       	POP	IY
0199+  ADC3 FD CB 01 96 	RES	2,(IY+ViewFlg)
0200+  ADC7 DD 7C       	LD	A,HX
0201+  ADC9 FE 0B       	CP	#0B
0202+  ADCB 38 04       	JR	C,$+6
0203+  ADCD FD CB 01 D6 	SET	2,(IY+ViewFlg)
0204+  ADD1 DB E2       	IN	A,(PAGE3)
0205+  ADD3 32 F2 A7    	LD	(BuffPg3),A
0206+  ADD6 DB A2       	IN	A,(PAGE1)
0207+  ADD8 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0208+  ADDC 21 EE A7    	LD	HL,DIRpage1
0209+  ADDF 28 03       	JR	Z,$+5
0210+  ADE1 21 EF A7    	LD	HL,DIRpage2
0211+  ADE4 77          	LD	(HL),A
0212+  ADE5 CD F0 86    	CALL	MakeWindow
0213+  ADE8 7F          	DEFB	#7F
0214+  ADE9 00          	DEFB	#00
0215+  ADEA C1          	POP	BC
0216+  ADEB 78          	LD	A,B
0217+  ADEC D3 E2       	OUT	(PAGE3),A
0218+  ADEE 79          	LD	A,C
0219+  ADEF D3 A2       	OUT	(PAGE1),A
0220+  ADF1 2A 27 AF    	LD	HL,(TreeDIRS)
0221+  ADF4 FD 75 13    	LD	(IY+PanelEFl),L	     ;Equip fil
0222+  ADF7 FD 74 14    	LD	(IY+PanelEFh),H
0223+  ADFA FD E5       	PUSH	IY
0224+  ADFC DB E2       	IN	A,(PAGE3)
0225+  ADFE F5          	PUSH	AF
0226+  ADFF FD CB 00 46 	BIT	0,(IY+PanelFlg)
0227+  AE03 3A EE A7    	LD	A,(DIRpage1)
0228+  AE06 28 03       	JR	Z,$+5
0229+  AE08 3A EF A7    	LD	A,(DIRpage2)
0230+  AE0B D3 E2       	OUT	(PAGE3),A
0231+  AE0D 21 21 AF    	LD	HL,BegDIR
0232+  AE10 0E 1D       	LD	C,#1D
0233+  AE12 D7          	RST	#10
0234+  AE13 21 04 AF    	LD	HL,TreeName
0235+  AE16 97          	SUB	A
0236+  AE17 0E 0A       	LD	C,#0A
0237+  AE19 D7          	RST	#10
0238+  AE1A 38 11       	JR	C,TreeErr
0239+  AE1C F5          	PUSH	AF
0240+  AE1D 21 00 C0    	LD	HL,#C000
0241+  AE20 ED 5B 29 AF 	LD	DE,(EndTree)
0242+  AE24 CB B2       	RES	6,D
0243+  AE26 0E 14       	LD	C,#14
0244+  AE28 D7          	RST	#10
0245+  AE29 F1          	POP	AF
0246+  AE2A 0E 12       	LD	C,#12
0247+  AE2C D7          	RST	#10
0248+  AE2D 3E 01       TreeErr	LD	A,#01
0249+  AE2F 32 01 C0    	LD	(#C001),A
0250+  AE32 F1          	POP	AF
0251+  AE33 D3 E2       	OUT	(PAGE3),A
0252+  AE35 FD E1       	POP	IY
0253+  AE37 C3 D7 AE    	JP	TreeOkey
0254+  AE3A             LoadTree
0255+  AE3A 08          	EX	AF,AF'
0256+  AE3B FD E5       	PUSH	IY
0257+  AE3D DB E2       	IN	A,(PAGE3)
0258+  AE3F F5          	PUSH	AF
0259+  AE40 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0260+  AE44 3A EE A7    	LD	A,(DIRpage1)
0261+  AE47 28 03       	JR	Z,$+5
0262+  AE49 3A EF A7    	LD	A,(DIRpage2)
0263+  AE4C D3 E2       	OUT	(PAGE3),A
0264+  AE4E 08          	EX	AF,AF'
0265+  AE4F F5          	PUSH	AF
0266+  AE50 21 00 C0    	LD	HL,#C000
0267+  AE53 11 00 40    	LD	DE,#4000
0268+  AE56 0E 13       	LD	C,#13
0269+  AE58 D7          	RST	#10
0270+  AE59 08          	EX	AF,AF'
0271+  AE5A 21 00 C0    	LD	HL,#C000
0272+  AE5D 11 00 80    	LD	DE,WorkBuffer
0273+  AE60 01 10 00    	LD	BC,#0010
0274+  AE63 ED B0       	LDIR 
0275+  AE65 F1          	POP	AF
0276+  AE66 0E 12       	LD	C,#12
0277+  AE68 D7          	RST	#10
0278+  AE69 F1          	POP	AF
0279+  AE6A D3 E2       	OUT	(PAGE3),A
0280+  AE6C FD E1       	POP	IY
0281+  AE6E 08          	EX	AF,AF'
0282+  AE6F DA 7D AC    	JP	C,ScanTree	;Error
0283+  AE72 21 02 80    	LD	HL,WorkBuffer+2
0284+  AE75 11 13 AF    	LD	DE,TreeHead+2
0285+  AE78 06 0D       	LD	B,#0D
0286+  AE7A 1A          	LD	A,(DE)
0287+  AE7B BE          	CP	(HL)
0288+  AE7C C2 7D AC    	JP	NZ,ScanTree	 ;Error
0289+  AE7F 23          	INC	HL
0290+  AE80 13          	INC	DE
0291+  AE81 10 F7       	DJNZ	$-7
0292+  AE83 DB E2       	IN	A,(PAGE3)
0293+  AE85 F5          	PUSH	AF
0294+  AE86 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0295+  AE8A 3A EE A7    	LD	A,(DIRpage1)
0296+  AE8D 28 03       	JR	Z,$+5
0297+  AE8F 3A EF A7    	LD	A,(DIRpage2)
0298+  AE92 D3 E2       	OUT	(PAGE3),A
0299+  AE94 21 00 C0    	LD	HL,#C000
0300+  AE97 11 0E 00    	LD	DE,#000E
0301+  AE9A 01 00 00    	LD	BC,#0000
0302+  AE9D DD 26 00    	LD	HX,#00
0303+  AEA0 7E          LoadTr1	LD	A,(HL)
0304+  AEA1 E6 7F       	AND	#7F
0305+  AEA3 DD BC       	CP	HX
0306+  AEA5 38 02       	JR	C,$+4
0307+  AEA7 DD 67       	LD	HX,A
0308+  AEA9 23          	INC	HL
0309+  AEAA 36 00       	LD	(HL),#00
0310+  AEAC 03          	INC	BC
0311+  AEAD 19          	ADD	HL,DE
0312+  AEAE 7E          	LD	A,(HL)
0313+  AEAF 23          	INC	HL
0314+  AEB0 3C          	INC	A
0315+  AEB1 20 ED       	JR	NZ,LoadTr1
0316+  AEB3 FD CB 01 96 	RES	2,(IY+ViewFlg)
0317+  AEB7 DD 7C       	LD	A,HX
0318+  AEB9 FE 0B       	CP	#0B
0319+  AEBB 38 04       	JR	C,$+6
0320+  AEBD FD CB 01 D6 	SET	2,(IY+ViewFlg)
0321+  AEC1 FD 71 13    	LD	(IY+PanelEFl),C	     ;Equip files
0322+  AEC4 FD 70 14    	LD	(IY+PanelEFh),B
0323+  AEC7 FD CB 00 7E 	BIT	7,(IY+PanelFlg)
0324+  AECB 3E 01       	LD	A,#01
0325+  AECD 20 02       	JR	NZ,$+4
0326+  AECF 3E 03       	LD	A,#03
0327+  AED1 32 01 C0    	LD	(#C001),A
0328+  AED4 F1          	POP	AF
0329+  AED5 D3 E2       	OUT	(PAGE3),A
0330+  AED7             TreeOkey
0331+  AED7 FD E5       	PUSH	IY
0332+  AED9 E1          	POP	HL
0333+  AEDA 11 2C 00    	LD	DE,BegPath
0334+  AEDD 19          	ADD	HL,DE
0335+  AEDE 23          	INC	HL
0336+  AEDF 23          	INC	HL
0337+  AEE0 CD F0 B0    	CALL	FindTreeDIR
0338+  AEE3 C9          	RET 
0339+  AEE4             AbortTree
0340+  AEE4 ED 7B BF AD 	LD	SP,(TreeSP1+1)
0341+  AEE8 FD E1       	POP	IY
0342+  AEEA C1          	POP	BC
0343+  AEEB 78          	LD	A,B
0344+  AEEC D3 E2       	OUT	(PAGE3),A
0345+  AEEE 79          	LD	A,C
0346+  AEEF D3 A2       	OUT	(PAGE1),A
0347+  AEF1 FD CB 01 96 	RES	2,(IY+ViewFlg)
0348+  AEF5 FD CB 01 8E 	RES	1,(IY+ViewFlg)
0349+  AEF9 CD F0 86    	CALL	MakeWindow
0350+  AEFC 7F          	DEFB	#7F
0351+  AEFD 00          	DEFB	#00
0352+  AEFE 21 C3 E7    	LD	HL,InitPanels
0353+  AF01 E3          	EX	(SP),HL
0354+  AF02 97          	SUB	A
0355+  AF03 C9          	RET 
0356+  AF04             TreeName
0357+  AF04             	DEFB	"treeinfo.fln",0
0357+  AF04 74726565696E666F2E666C6E00
0358+  AF11             TreeHead
0359+  AF11             	DEFB	#00,#00,"\\",#00,#00,#00,#AE,"F"
0359+  AF11 00005C000000AE46
0360+  AF19             	DEFB	"l","e","x","T","r","e","e",#00
0360+  AF19 6C65785472656500
0361+  AF21             
0362+  AF21             BegDIR
0363+  AF21 5C 00       	DEFB	"\\",0
0364+  AF23             UpDIR
0365+  AF23 2E 2E 00    	DEFB	"..",0
0366+  AF26             CurTree
0367+  AF26 00          	DEFB	#00
0368+  AF27             TreeDIRS
0369+  AF27 00 00       	DEFW	#0000
0370+  AF29             EndTree
0371+  AF29 00 00       	DEFW	#0000
0372+  AF2B             LoadDIR
0373+  AF2B ED 5B 29 AF 	LD	DE,(EndTree)
0374+  AF2F D5          	PUSH	DE
0375+  AF30 DD 21 00 00 	LD	IX,#0000
0376+  AF34 21 80 A8    	LD	HL,NORMmask
0377+  AF37 11 00 80    	LD	DE,WorkBuffer
0378+  AF3A 01 19 01    	LD	BC,#0119
0379+  AF3D 3A 7F A8    	LD	A,(FileAtribut)
0380+  AF40 E6 17       	AND	%00010111
0381+  AF42 DD E5       	PUSH	IX
0382+  AF44 D5          	PUSH	DE
0383+  AF45 D7          	RST	#10
0384+  AF46 E1          	POP	HL
0385+  AF47 DD E1       	POP	IX
0386+  AF49 38 19       	JR	C,FndFLtrE
0387+  AF4B 3A 20 80    FndFLtr	LD	A,(WorkBuffer+32)
0388+  AF4E CB 67       	BIT	4,A
0389+  AF50 C4 90 AF    	CALL	NZ,InsFileTree
0390+  AF53 38 0F       	JR	C,FndFLtrE
0391+  AF55 11 00 80    	LD	DE,WorkBuffer
0392+  AF58 01 1A 00    	LD	BC,#001A
0393+  AF5B DD E5       	PUSH	IX
0394+  AF5D D5          	PUSH	DE
0395+  AF5E D7          	RST	#10
0396+  AF5F E1          	POP	HL
0397+  AF60 DD E1       	POP	IX
0398+  AF62 30 E7       	JR	NC,FndFLtr
0399+  AF64             FndFLtrE
0400+  AF64 2A 29 AF    	LD	HL,(EndTree)
0401+  AF67 2B          	DEC	HL
0402+  AF68 36 FF       	LD	(HL),#FF
0403+  AF6A DD 4D       	LD	C,LX
0404+  AF6C DD 44       	LD	B,HX
0405+  AF6E 2A 27 AF    	LD	HL,(TreeDIRS)
0406+  AF71 09          	ADD	HL,BC
0407+  AF72 22 27 AF    	LD	(TreeDIRS),HL
0408+  AF75 E1          	POP	HL
0409+  AF76 78          	LD	A,B
0410+  AF77 B1          	OR	C
0411+  AF78 C8          	RET	Z
0412+  AF79 E5          	PUSH	HL
0413+  AF7A CD B9 AF    	CALL	PrnMTDIR
0414+  AF7D E1          	POP	HL
0415+  AF7E 11 00 00    CurTAdr	LD	DE,#0000
0416+  AF81 7A          	LD	A,D
0417+  AF82 B3          	OR	E
0418+  AF83 37          	SCF 
0419+  AF84 C8          	RET	Z
0420+  AF85 EB          	EX	DE,HL
0421+  AF86 01 0D 00    	LD	BC,#000D
0422+  AF89 09          	ADD	HL,BC
0423+  AF8A 73          	LD	(HL),E
0424+  AF8B 23          	INC	HL
0425+  AF8C 72          	LD	(HL),D
0426+  AF8D EB          	EX	DE,HL
0427+  AF8E 37          	SCF 
0428+  AF8F C9          	RET 
0429+  AF90             InsFileTree
0430+  AF90 EB          	EX	DE,HL
0431+  AF91 2A 29 AF    	LD	HL,(EndTree)
0432+  AF94 01 10 00    	LD	BC,#0010
0433+  AF97 09          	ADD	HL,BC
0434+  AF98 ED 42       	SBC	HL,BC
0435+  AF9A EB          	EX	DE,HL
0436+  AF9B D8          	RET	C
0437+  AF9C 01 21 00    	LD	BC,33
0438+  AF9F 09          	ADD	HL,BC
0439+  AFA0 7E          	LD	A,(HL)
0440+  AFA1 FE 2E       	CP	"."
0441+  AFA3 C8          	RET	Z
0442+  AFA4 0E 10       	LD	C,#10
0443+  AFA6 97          	SUB	A
0444+  AFA7 ED A0       	LDI 
0445+  AFA9 BE          	CP	(HL)
0446+  AFAA 20 FB       	JR	NZ,$-3
0447+  AFAC 41          	LD	B,C
0448+  AFAD 97          	SUB	A
0449+  AFAE 12          	LD	(DE),A
0450+  AFAF 13          	INC	DE
0451+  AFB0 10 FC       	DJNZ	$-2
0452+  AFB2 ED 53 29 AF 	LD	(EndTree),DE
0453+  AFB6 DD 23       	INC	IX
0454+  AFB8 C9          	RET 
0455+  AFB9             PrnMTDIR
0456+  AFB9 2A 27 AF    	LD	HL,(TreeDIRS)
0457+  AFBC 2B          	DEC	HL
0458+  AFBD 11 0C B0    	LD	DE,CurDNumb
0459+  AFC0 D5          	PUSH	DE
0460+  AFC1 06 04       	LD	B,#04
0461+  AFC3 3E 20       	LD	A,#20
0462+  AFC5 12          	LD	(DE),A
0463+  AFC6 13          	INC	DE
0464+  AFC7 10 FC       	DJNZ	$-2
0465+  AFC9 D1          	POP	DE
0466+  AFCA D9          	EXX 
0467+  AFCB 0E 00       	LD	C,#00
0468+  AFCD D9          	EXX 
0469+  AFCE 01 E8 03    	LD	BC,1000		;1'000
0470+  AFD1 CD F3 AF    	CALL	GetN16
0471+  AFD4 01 64 00    	LD	BC,100		;100
0472+  AFD7 CD F3 AF    	CALL	GetN16
0473+  AFDA 01 0A 00    	LD	BC,10		;10
0474+  AFDD CD F3 AF    	CALL	GetN16
0475+  AFE0 7D          	LD	A,L
0476+  AFE1 C6 30       	ADD	A,"0"
0477+  AFE3 12          	LD	(DE),A
0478+  AFE4 21 0C B0    	LD	HL,CurDNumb
0479+  AFE7 11 50 01    	LD	DE,#0150
0480+  AFEA 01 74 00    	LD	BC,#0074
0481+  AFED 3E 80       	LD	A,#80
0482+  AFEF CD B3 8F    	CALL	PrnTxtLnIFF
0483+  AFF2 C9          	RET 
0484+  AFF3             GetN16
0485+  AFF3 3E 2F       	LD	A,#2F
0486+  AFF5 B7          	OR	A
0487+  AFF6 3C          	INC	A
0488+  AFF7 ED 42       	SBC	HL,BC
0489+  AFF9 30 FB       	JR	NC,$-3
0490+  AFFB 09          	ADD	HL,BC
0491+  AFFC FE 30       	CP	#30
0492+  AFFE 28 04       	JR	Z,$+6
0493+  B000 D9          	EXX 
0494+  B001 CB C1       	SET	0,C
0495+  B003 D9          	EXX 
0496+  B004 D9          	EXX 
0497+  B005 CB 41       	BIT	0,C
0498+  B007 D9          	EXX 
0499+  B008 C8          	RET	Z
0500+  B009 12          	LD	(DE),A
0501+  B00A 13          	INC	DE
0502+  B00B C9          	RET 
0503+  B00C             CurDNumb
0504+  B00C 2020202000  	DEFB	"    ",0
0505+  B011             ;[]=========================================================[]
0506+  B011             TestTree
0507+  B011 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0508+  B015 C8          	RET	Z
0509+  B016 06 28       	LD	B,#28
0510+  B018 C5          TstTree	PUSH	BC
0511+  B019 0E 03       	LD	C,#03
0512+  B01B F7          	RST	#30
0513+  B01C C1          	POP	BC
0514+  B01D B7          	OR	A
0515+  B01E C0          	RET	NZ
0516+  B01F C5          	PUSH	BC
0517+  B020 0E 37       	LD	C,#37
0518+  B022 D7          	RST	#10
0519+  B023 C1          	POP	BC
0520+  B024 C0          	RET	NZ
0521+  B025 76          	HALT 
0522+  B026 10 F0       	DJNZ	TstTree
0523+  B028             TestTreeBeg
0524+  B028 DB A2       	IN	A,(PAGE1)
0525+  B02A F5          	PUSH	AF
0526+  B02B FD CB 00 46 	BIT	0,(IY+PanelFlg)
0527+  B02F 3A EE A7    	LD	A,(DIRpage1)
0528+  B032 28 03       	JR	Z,$+5
0529+  B034 3A EF A7    	LD	A,(DIRpage2)
0530+  B037 D3 A2       	OUT	(PAGE1),A
0531+  B039 3E C0       	LD	A,#C0
0532+  B03B D3 89       	OUT	(YPORT),A
0533+  B03D FD 6E 15    	LD	L,(IY+PanelFFl)
0534+  B040 FD 66 16    	LD	H,(IY+PanelFFh)
0535+  B043 FD 5E 17    	LD	E,(IY+PanelCFl)
0536+  B046 FD 56 18    	LD	D,(IY+PanelCFh)
0537+  B049 19          	ADD	HL,DE
0538+  B04A 29          	ADD	HL,HL
0539+  B04B 29          	ADD	HL,HL
0540+  B04C 29          	ADD	HL,HL
0541+  B04D 29          	ADD	HL,HL
0542+  B04E CB F4       	SET	6,H
0543+  B050 23          	INC	HL
0544+  B051 CB 46       	BIT	0,(HL)
0545+  B053 20 31       	JR	NZ,TTreeEx
0546+  B055 EB          	EX	DE,HL
0547+  B056 21 00 40    	LD	HL,#4000
0548+  B059 01 0E 00    	LD	BC,#000E
0549+  B05C 23          TTreeL1	INC	HL
0550+  B05D CB 86       	RES	0,(HL)
0551+  B05F 09          	ADD	HL,BC
0552+  B060 7E          	LD	A,(HL)
0553+  B061 23          	INC	HL
0554+  B062 3C          	INC	A
0555+  B063 20 F7       	JR	NZ,TTreeL1
0556+  B065 EB          	EX	DE,HL
0557+  B066 CB C6       	SET	0,(HL)
0558+  B068 CD 45 B5    	CALL	PrintDIR
0559+  B06B CD EA BA    	CALL	SetInvert
0560+  B06E CD 8A B0    	CALL	MakeTreePath
0561+  B071 FD E5       	PUSH	IY
0562+  B073 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0563+  B077 FD 21 B6 A6 	LD	IY,RightPanel
0564+  B07B 28 04       	JR	Z,$+6
0565+  B07D FD 21 8A A5 	LD	IY,LeftPanel
0566+  B081 CD 3F BC    	CALL	NewDIRECTORY
0567+  B084 FD E1       	POP	IY
0568+  B086 F1          TTreeEx	POP	AF
0569+  B087 D3 A2       	OUT	(PAGE1),A
0570+  B089 C9          	RET 
0571+  B08A             ;[]==========================================================[]
0572+  B08A             MakeTreePath
0573+  B08A DB A2       	IN	A,(PAGE1)
0574+  B08C F5          	PUSH	AF
0575+  B08D FD CB 00 46 	BIT	0,(IY+PanelFlg)
0576+  B091 3A EE A7    	LD	A,(DIRpage1)
0577+  B094 28 03       	JR	Z,$+5
0578+  B096 3A EF A7    	LD	A,(DIRpage2)
0579+  B099 D3 A2       	OUT	(PAGE1),A
0580+  B09B FD 6E 15    	LD	L,(IY+PanelFFl)
0581+  B09E FD 66 16    	LD	H,(IY+PanelFFh)
0582+  B0A1 FD 5E 17    	LD	E,(IY+PanelCFl)
0583+  B0A4 FD 56 18    	LD	D,(IY+PanelCFh)
0584+  B0A7 19          	ADD	HL,DE
0585+  B0A8 29          	ADD	HL,HL
0586+  B0A9 29          	ADD	HL,HL
0587+  B0AA 29          	ADD	HL,HL
0588+  B0AB 29          	ADD	HL,HL
0589+  B0AC CB F4       	SET	6,H
0590+  B0AE 11 FF 80    	LD	DE,WorkBuffer+#FF
0591+  B0B1 01 10 00    	LD	BC,#0010
0592+  B0B4 97          	SUB	A
0593+  B0B5 12          	LD	(DE),A
0594+  B0B6 1B          	DEC	DE
0595+  B0B7 7E          	LD	A,(HL)
0596+  B0B8 B7          	OR	A
0597+  B0B9 28 2E       	JR	Z,TTreeL5
0598+  B0BB E6 7F       	AND	#7F
0599+  B0BD 3C          	INC	A
0600+  B0BE DD 6F       	LD	LX,A
0601+  B0C0 09          	ADD	HL,BC
0602+  B0C1 13          	INC	DE
0603+  B0C2 ED 42       TTreeL2	SBC	HL,BC
0604+  B0C4 E5          	PUSH	HL
0605+  B0C5 7E          	LD	A,(HL)
0606+  B0C6 23          	INC	HL
0607+  B0C7 E6 7F       	AND	#7F
0608+  B0C9 DD BD       	CP	LX
0609+  B0CB 30 14       	JR	NC,TTreeL4
0610+  B0CD DD 6F       	LD	LX,A
0611+  B0CF 06 FF       	LD	B,#FF
0612+  B0D1 97          	SUB	A
0613+  B0D2 04          	INC	B
0614+  B0D3 23          	INC	HL
0615+  B0D4 BE          	CP	(HL)
0616+  B0D5 20 FB       	JR	NZ,$-3
0617+  B0D7 2B          TTreeL3	DEC	HL
0618+  B0D8 1B          	DEC	DE
0619+  B0D9 7E          	LD	A,(HL)
0620+  B0DA 12          	LD	(DE),A
0621+  B0DB 10 FA       	DJNZ	TTreeL3
0622+  B0DD 1B          	DEC	DE
0623+  B0DE 3E 5C       	LD	A,"\\"
0624+  B0E0 12          	LD	(DE),A
0625+  B0E1 E1          TTreeL4	POP	HL
0626+  B0E2 7E          	LD	A,(HL)
0627+  B0E3 E6 7F       	AND	#7F
0628+  B0E5 FE 02       	CP	#02
0629+  B0E7 30 D9       	JR	NC,TTreeL2
0630+  B0E9 EB          TTreeL5	EX	DE,HL
0631+  B0EA 36 5C       	LD	(HL),"\\"
0632+  B0EC F1          	POP	AF
0633+  B0ED D3 A2       	OUT	(PAGE1),A
0634+  B0EF C9          	RET 
0635+  B0F0             ;[]==========================================================[]
0636+  B0F0             FindTreeDIR
0637+  B0F0 DB A2       	IN	A,(PAGE1)
0638+  B0F2 F5          	PUSH	AF
0639+  B0F3 3E C0       	LD	A,#C0
0640+  B0F5 D3 89       	OUT	(YPORT),A
0641+  B0F7 DD 21 8A A5 	LD	IX,LeftPanel
0642+  B0FB DD CB 01 4E 	BIT	1,(IX+ViewFlg)
0643+  B0FF 3A EE A7    	LD	A,(DIRpage1)
0644+  B102 20 03       	JR	NZ,$+5
0645+  B104 3A EF A7    	LD	A,(DIRpage2)
0646+  B107 D3 A2       	OUT	(PAGE1),A
0647+  B109 11 00 40    	LD	DE,#4000
0648+  B10C 01 00 00    	LD	BC,#0000
0649+  B10F 1A          NwTree0	LD	A,(DE)
0650+  B110 E6 7F       	AND	#7F
0651+  B112 DD 6F       	LD	LX,A
0652+  B114 E5          NwTree1	PUSH	HL
0653+  B115 D5          	PUSH	DE
0654+  B116 1A          	LD	A,(DE)
0655+  B117 E6 7F       	AND	#7F
0656+  B119 DD BD       	CP	LX
0657+  B11B 20 11       	JR	NZ,NwTree3
0658+  B11D 13          	INC	DE
0659+  B11E 13          	INC	DE
0660+  B11F 1A          NwTree2	LD	A,(DE)
0661+  B120 BE          	CP	(HL)
0662+  B121 20 0B       	JR	NZ,NwTree3
0663+  B123 23          	INC	HL
0664+  B124 13          	INC	DE
0665+  B125 1A          	LD	A,(DE)
0666+  B126 B7          	OR	A
0667+  B127 28 17       	JR	Z,NwTree4
0668+  B129 7E          	LD	A,(HL)
0669+  B12A FE 5C       	CP	"\\"
0670+  B12C 20 F1       	JR	NZ,NwTree2
0671+  B12E E1          NwTree3	POP	HL
0672+  B12F 11 0F 00    	LD	DE,#000F
0673+  B132 19          	ADD	HL,DE
0674+  B133 EB          	EX	DE,HL
0675+  B134 E1          	POP	HL
0676+  B135 03          	INC	BC
0677+  B136 1A          	LD	A,(DE)
0678+  B137 13          	INC	DE
0679+  B138 3C          	INC	A
0680+  B139 20 D9       	JR	NZ,NwTree1
0681+  B13B F1          NwTreeE	POP	AF
0682+  B13C D3 A2       	OUT	(PAGE1),A
0683+  B13E 37          	SCF 
0684+  B13F C9          	RET 
0685+  B140 DD 7D       NwTree4	LD	A,LX
0686+  B142 B7          	OR	A
0687+  B143 28 0A       	JR	Z,NwTree5
0688+  B145 7E          	LD	A,(HL)
0689+  B146 23          	INC	HL
0690+  B147 FE 5C       	CP	"\\"
0691+  B149 28 04       	JR	Z,NwTree5
0692+  B14B 2B          	DEC	HL
0693+  B14C B7          	OR	A
0694+  B14D 20 DF       	JR	NZ,NwTree3
0695+  B14F D1          NwTree5	POP	DE
0696+  B150 33          	INC	SP
0697+  B151 33          	INC	SP
0698+  B152 7B          	LD	A,E
0699+  B153 C6 0F       	ADD	A,#0F
0700+  B155 5F          	LD	E,A
0701+  B156 30 01       	JR	NC,$+3
0702+  B158 14          	INC	D
0703+  B159 03          	INC	BC
0704+  B15A 7E          	LD	A,(HL)
0705+  B15B B7          	OR	A
0706+  B15C 28 07       	JR	Z,NwTree6
0707+  B15E 1A          	LD	A,(DE)
0708+  B15F 13          	INC	DE
0709+  B160 3C          	INC	A
0710+  B161 28 D8       	JR	Z,NwTreeE
0711+  B163 18 AA       	JR	NwTree0
0712+  B165 0B          NwTree6	DEC	BC
0713+  B166 C5          	PUSH	BC
0714+  B167 21 00 40    	LD	HL,#4000
0715+  B16A 01 0E 00    	LD	BC,#000E
0716+  B16D 23          NwTree7	INC	HL
0717+  B16E 70          	LD	(HL),B
0718+  B16F 09          	ADD	HL,BC
0719+  B170 7E          	LD	A,(HL)
0720+  B171 23          	INC	HL
0721+  B172 3C          	INC	A
0722+  B173 20 F8       	JR	NZ,NwTree7
0723+  B175 E1          	POP	HL
0724+  B176 7B          	LD	A,E
0725+  B177 D6 0E       	SUB	#0E
0726+  B179 5F          	LD	E,A
0727+  B17A 30 01       	JR	NC,$+3
0728+  B17C 15          	DEC	D
0729+  B17D DD 21 8A A5 	LD	IX,LeftPanel
0730+  B181 DD CB 01 4E 	BIT	1,(IX+ViewFlg)
0731+  B185 20 04       	JR	NZ,$+6
0732+  B187 DD 21 B6 A6 	LD	IX,RightPanel
0733+  B18B DD CB 00 7E 	BIT	7,(IX+PanelFlg)
0734+  B18F 3E 01       	LD	A,#01
0735+  B191 20 02       	JR	NZ,$+4
0736+  B193 3E 03       	LD	A,#03
0737+  B195 12          	LD	(DE),A
0738+  B196 F1          	POP	AF
0739+  B197 D3 A2       	OUT	(PAGE1),A
0740+  B199 5D          	LD	E,L
0741+  B19A 54          	LD	D,H
0742+  B19B 01 04 00    	LD	BC,#0004
0743+  B19E B7          	OR	A
0744+  B19F ED 42       	SBC	HL,BC
0745+  B1A1 30 03       	JR	NC,$+5
0746+  B1A3 21 00 00    	LD	HL,#0000
0747+  B1A6 DD 75 15    	LD	(IX+PanelFFl),L
0748+  B1A9 DD 74 16    	LD	(IX+PanelFFh),H
0749+  B1AC EB          	EX	DE,HL
0750+  B1AD B7          	OR	A
0751+  B1AE ED 52       	SBC	HL,DE
0752+  B1B0 DD 75 17    	LD	(IX+PanelCFl),L
0753+  B1B3 DD 74 18    	LD	(IX+PanelCFh),H
0754+  B1B6 B7          	OR	A
0755+  B1B7 C9          	RET 
0756+  B1B8             
0757+  B1B8             
0758+  B1B8             
0270   B1B8             	include "fnpanel.z80"
0001+  B1B8             
0002+  B1B8             ;[]----------------------------------------------------------[]
0003+  B1B8             PrintDisks
0004+  B1B8 FD 6E 03    	LD	L,(IY+PanelXl)
0005+  B1BB FD 66 04    	LD	H,(IY+PanelXh)
0006+  B1BE 23          	INC	HL
0007+  B1BF 23          	INC	HL
0008+  B1C0 22 FC B1    	LD	(DiskX1),HL
0009+  B1C3 11 04 00    	LD	DE,#0004
0010+  B1C6 19          	ADD	HL,DE
0011+  B1C7 22 05 B2    	LD	(DiskX2),HL
0012+  B1CA 11 06 00    	LD	DE,#0006
0013+  B1CD 19          	ADD	HL,DE
0014+  B1CE 22 0F B2    	LD	(NameX),HL
0015+  B1D1 3E 41       	LD	A,"A"
0016+  B1D3 32 14 B2    	LD	(DISK),A
0017+  B1D6 FD E5       	PUSH	IY
0018+  B1D8 E1          	POP	HL
0019+  B1D9 11 2C 00    	LD	DE,BegPath
0020+  B1DC 19          	ADD	HL,DE
0021+  B1DD 7E          	LD	A,(HL)
0022+  B1DE D6 41       	SUB	"A"
0023+  B1E0 4F          	LD	C,A
0024+  B1E1 3A E2 A7    	LD	A,(EquipDisks)
0025+  B1E4 47          	LD	B,A
0026+  B1E5 79          PutDsLp	LD	A,C
0027+  B1E6 B7          	OR	A
0028+  B1E7 11 73 07    	LD	DE,#0773
0029+  B1EA 28 03       	JR	Z,$+5
0030+  B1EC 11 80 08    	LD	DE,#0880
0031+  B1EF 7A          	LD	A,D
0032+  B1F0 32 0D B2    	LD	(ColRect),A
0033+  B1F3 7B          	LD	A,E
0034+  B1F4 32 13 B2    	LD	(ColName),A
0035+  B1F7 CD F0 86    	CALL	MakeWindow
0036+  B1FA 80          	DEFB	#80
0037+  B1FB 04          	DEFB	#04
0038+  B1FC 00 00       DiskX1	DEFW	#0000	;Xpos
0039+  B1FE 1E 00       	DEFW	#001E	;Ypos
0040+  B200 1C 00       LnDiskX	DEFW	#001C	;lenX
0041+  B202 0C 00       	DEFW	#000C	;lenY
0042+  B204 02          	DEFB	#02
0043+  B205 00 00       DiskX2	DEFW	#0000	;Xpos
0044+  B207 20 00       	DEFW	#0020	;Ypos
0045+  B209 14 00       	DEFW	#0014	;lenX
0046+  B20B 08 00       	DEFW	#0008	;lenY
0047+  B20D 00          ColRect	DEFB	#00
0048+  B20E 01          	DEFB	#01
0049+  B20F 00 00       NameX	DEFW	#0000
0050+  B211 20 00       	DEFW	#0020
0051+  B213 00          ColName	DEFB	#00
0052+  B214 20 00       DISK	DEFB	" ",0
0053+  B216 00          	DEFB	#00
0054+  B217 2A FC B1    	LD	HL,(DiskX1)
0055+  B21A ED 5B 00 B2 	LD	DE,(LnDiskX)
0056+  B21E 19          	ADD	HL,DE
0057+  B21F 22 FC B1    	LD	(DiskX1),HL
0058+  B222 2A 05 B2    	LD	HL,(DiskX2)
0059+  B225 19          	ADD	HL,DE
0060+  B226 22 05 B2    	LD	(DiskX2),HL
0061+  B229 2A 0F B2    	LD	HL,(NameX)
0062+  B22C 19          	ADD	HL,DE
0063+  B22D 22 0F B2    	LD	(NameX),HL
0064+  B230 21 14 B2    	LD	HL,DISK
0065+  B233 34          	INC	(HL)
0066+  B234 0D          	DEC	C
0067+  B235 10 AE       	DJNZ	PutDsLp
0068+  B237 C9          	RET 
0069+  B238             ;[]----------------------------------------------------------[]
0070+  B238             PrintPath
0071+  B238 FD CB 00 7E 	BIT	7,(IY+PanelFlg)
0072+  B23C 3E 00       	LD	A,#00
0073+  B23E 0E 0F       	LD	C,#0F
0074+  B240 20 04       	JR	NZ,$+6
0075+  B242 3E 07       	LD	A,#07
0076+  B244 0E 7F       	LD	C,#7F
0077+  B246 32 63 B2    	LD	(HeadCol),A
0078+  B249 79          	LD	A,C
0079+  B24A 32 A9 B2    	LD	(PathCol+1),A
0080+  B24D FD 6E 03    	LD	L,(IY+PanelXl)
0081+  B250 FD 66 04    	LD	H,(IY+PanelXh)
0082+  B253 22 5B B2    	LD	(PanelHX),HL
0083+  B256 CD F0 86    	CALL	MakeWindow
0084+  B259 80          	DEFB	#80
0085+  B25A 02          	DEFB	#02
0086+  B25B 00 00 2E 00 PanelHX	DEFW	#0000,#002E
0087+  B25F 36 01 0C 00 	DEFW	#0136,#000C
0088+  B263 00          HeadCol	DEFB	#00
0089+  B264 00          	DEFB	#00
0090+  B265 FD E5       	PUSH	IY
0091+  B267 E1          	POP	HL
0092+  B268 01 2C 00    	LD	BC,BegPath
0093+  B26B 09          	ADD	HL,BC
0094+  B26C E5          	PUSH	HL
0095+  B26D 11 00 80    	LD	DE,WorkBuffer
0096+  B270 97          	SUB	A
0097+  B271 ED A0       	LDI 
0098+  B273 BE          	CP	(HL)
0099+  B274 20 FB       	JR	NZ,$-3
0100+  B276 2B          	DEC	HL
0101+  B277 3E 5C       	LD	A,"\\"
0102+  B279 BE          	CP	(HL)
0103+  B27A 28 02       	JR	Z,$+4
0104+  B27C 12          	LD	(DE),A
0105+  B27D 13          	INC	DE
0106+  B27E E1          	POP	HL
0107+  B27F 97          	SUB	A
0108+  B280 12          	LD	(DE),A
0109+  B281 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0110+  B285 20 10       	JR	NZ,PrPath1
0111+  B287 01 0D 00    	LD	BC,#000D
0112+  B28A ED 42       	SBC	HL,BC
0113+  B28C FD CB 02 6E 	BIT	5,(IY+SortFlg)
0114+  B290 20 03       	JR	NZ,$+5
0115+  B292 21 80 A8    	LD	HL,NORMmask
0116+  B295 ED B0       	LDIR 
0117+  B297 DD 21 2C 01 PrPath1	LD	IX,#012C
0118+  B29B 2A 5B B2    	LD	HL,(PanelHX)
0119+  B29E 11 00 80    	LD	DE,WorkBuffer
0120+  B2A1 01 06 00    	LD	BC,#0006
0121+  B2A4 09          	ADD	HL,BC
0122+  B2A5 EB          	EX	DE,HL
0123+  B2A6 0E 30       	LD	C,#30
0124+  B2A8 3E 00       PathCol	LD	A,#00
0125+  B2AA CD 4B 8E    	CALL	PrnRangPathL
0126+  B2AD C9          	RET 
0127+  B2AE             ;[]----------------------------------------------------------[]
0128+  B2AE             PrintDOSPath
0129+  B2AE FD E5       	PUSH	IY
0130+  B2B0 E1          	POP	HL
0131+  B2B1 01 2C 00    	LD	BC,BegPath
0132+  B2B4 09          	ADD	HL,BC
0133+  B2B5 11 00 80    	LD	DE,WorkBuffer
0134+  B2B8 97          	SUB	A
0135+  B2B9 ED A0       	LDI 
0136+  B2BB BE          	CP	(HL)
0137+  B2BC 20 FB       	JR	NZ,$-3
0138+  B2BE 2B          	DEC	HL
0139+  B2BF 3E 5C       	LD	A,"\\"
0140+  B2C1 BE          	CP	(HL)
0141+  B2C2 28 02       	JR	Z,$+4
0142+  B2C4 12          	LD	(DE),A
0143+  B2C5 13          	INC	DE
0144+  B2C6 3E 3E       	LD	A,">"
0145+  B2C8 12          	LD	(DE),A
0146+  B2C9 13          	INC	DE
0147+  B2CA 97          	SUB	A
0148+  B2CB 12          	LD	(DE),A
0149+  B2CC CD F0 86    	CALL	MakeWindow
0150+  B2CF 80          	DEFB	#80
0151+  B2D0 02          	DEFB	#02
0152+  B2D1 04 00 E7 00 	DEFW	#0004,#00E7
0153+  B2D5 F6 00 08 00 	DEFW	#00F6,#0008
0154+  B2D9 08          	DEFB	#08
0155+  B2DA 00          	DEFB	#00
0156+  B2DB DD 21 F6 00 	LD	IX,#00F6
0157+  B2DF 21 00 80    	LD	HL,WorkBuffer
0158+  B2E2 11 FA 00    	LD	DE,#00FA
0159+  B2E5 01 E7 00    	LD	BC,#00E7
0160+  B2E8 3E 80       	LD	A,#80
0161+  B2EA CD B5 8E    	CALL	PrnRangPathR
0162+  B2ED C9          	RET 
0163+  B2EE             ;[]----------------------------------------------------------[]
0164+  B2EE             PrnFileInfo
0165+  B2EE FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0166+  B2F2 C2 A4 B4    	JP	NZ,PrnTreeInfo		;Tree
0167+  B2F5 FD 7E 19    	LD	A,(IY+PanelMFl)
0168+  B2F8 FD B6 1A    	OR	(IY+PanelMFh)
0169+  B2FB C2 C4 B4    	JP	NZ,PrnSelInfo
0170+  B2FE DB A2       	IN	A,(PAGE1)
0171+  B300 F5          	PUSH	AF
0172+  B301 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0173+  B305 3A EE A7    	LD	A,(DIRpage1)
0174+  B308 28 03       	JR	Z,$+5
0175+  B30A 3A EF A7    	LD	A,(DIRpage2)
0176+  B30D D3 A2       	OUT	(PAGE1),A
0177+  B30F FD 6E 15    	LD	L,(IY+PanelFFl)
0178+  B312 FD 66 16    	LD	H,(IY+PanelFFh)
0179+  B315 FD 5E 17    	LD	E,(IY+PanelCFl)
0180+  B318 FD 56 18    	LD	D,(IY+PanelCFh)
0181+  B31B 19          	ADD	HL,DE
0182+  B31C 29          	ADD	HL,HL
0183+  B31D 29          	ADD	HL,HL
0184+  B31E 29          	ADD	HL,HL
0185+  B31F 5D          	LD	E,L
0186+  B320 54          	LD	D,H
0187+  B321 29          	ADD	HL,HL
0188+  B322 19          	ADD	HL,DE
0189+  B323 CB F4       	SET	6,H
0190+  B325 11 00 80    	LD	DE,WorkBuffer
0191+  B328 01 18 00    	LD	BC,#0018
0192+  B32B CD 44 A4    	CALL	MoveBytes
0193+  B32E F1          	POP	AF
0194+  B32F D3 A2       	OUT	(PAGE1),A
0195+  B331 21 18 80    	LD	HL,WorkBuffer+#18
0196+  B334 06 26       	LD	B,38
0197+  B336 3E 20       	LD	A," "
0198+  B338 77          	LD	(HL),A
0199+  B339 23          	INC	HL
0200+  B33A 10 FC       	DJNZ	$-2
0201+  B33C 36 00       	LD	(HL),#00
0202+  B33E DD 21 00 80 	LD	IX,WorkBuffer
0203+  B342 21 01 80    	LD	HL,WorkBuffer+1
0204+  B345 7E          	LD	A,(HL)
0205+  B346 B7          	OR	A
0206+  B347 28 42       	JR	Z,PrntFI
0207+  B349 11 18 80    	LD	DE,WorkBuffer+#18
0208+  B34C 06 08       	LD	B,#08
0209+  B34E 7E          EFI0	LD	A,(HL)
0210+  B34F FE 20       	CP	#20
0211+  B351 28 05       	JR	Z,EFI1
0212+  B353 23          	INC	HL
0213+  B354 12          	LD	(DE),A
0214+  B355 13          	INC	DE
0215+  B356 10 F6       	DJNZ	EFI0
0216+  B358 78          EFI1	LD	A,B
0217+  B359 B7          	OR	A
0218+  B35A 28 03       	JR	Z,$+5
0219+  B35C 23          	INC	HL
0220+  B35D 10 FD       	DJNZ	$-1
0221+  B35F 06 03       	LD	B,#03
0222+  B361 23          	INC	HL
0223+  B362 7E          	LD	A,(HL)
0224+  B363 FE 20       	CP	#20
0225+  B365 20 06       	JR	NZ,EFI3
0226+  B367 7E          EFI2	LD	A,(HL)
0227+  B368 23          	INC	HL
0228+  B369 12          	LD	(DE),A
0229+  B36A 13          	INC	DE
0230+  B36B 10 FA       	DJNZ	EFI2
0231+  B36D 78          EFI3	LD	A,B
0232+  B36E B7          	OR	A
0233+  B36F 28 0A       	JR	Z,EndFI
0234+  B371 3E 2E       	LD	A,"."
0235+  B373 12          	LD	(DE),A
0236+  B374 13          	INC	DE
0237+  B375 7E          EFI4	LD	A,(HL)
0238+  B376 23          	INC	HL
0239+  B377 12          	LD	(DE),A
0240+  B378 13          	INC	DE
0241+  B379 10 FA       	DJNZ	EFI4
0242+  B37B 11 25 80    EndFI	LD	DE,WorkBuffer+#18+#0D
0243+  B37E CD A1 B3    	CALL	GetFileLen
0244+  B381 11 30 80    	LD	DE,WorkBuffer+#18+#18
0245+  B384 CD 67 B4    	CALL	GetData
0246+  B387 13          	INC	DE
0247+  B388 CD 82 B4    	CALL	GetTime
0248+  B38B 21 18 80    PrntFI	LD	HL,WorkBuffer+#18
0249+  B38E FD 5E 03    	LD	E,(IY+PanelXl)
0250+  B391 FD 56 04    	LD	D,(IY+PanelXh)
0251+  B394 13          	INC	DE
0252+  B395 13          	INC	DE
0253+  B396 13          	INC	DE
0254+  B397 13          	INC	DE
0255+  B398 01 D7 00    	LD	BC,#00D7
0256+  B39B 3E 80       	LD	A,#80
0257+  B39D CD 29 90    	CALL	PrnTxtLnNorm
0258+  B3A0 C9          	RET 
0259+  B3A1             GetFileLen
0260+  B3A1 DD CB 0E 66 	BIT	4,(IX+#0E)
0261+  B3A5 C2 54 B4    	JP	NZ,PDirectory
0262+  B3A8 DD CB 0E BE 	RES	7,(IX+#0E)
0263+  B3AC DD 6E 0F    	LD	L,(IX+#0F)
0264+  B3AF DD 66 10    	LD	H,(IX+#10)
0265+  B3B2 D9          	EXX 
0266+  B3B3 DD 6E 11    	LD	L,(IX+#11)
0267+  B3B6 DD 66 12    	LD	H,(IX+#12)
0268+  B3B9 D9          	EXX 
0269+  B3BA 01 00 CA    	LD	BC,#CA00
0270+  B3BD D9          	EXX 
0271+  B3BE 01 9A 3B    	LD	BC,#3B9A	;1'000'000'000
0272+  B3C1 D9          	EXX 
0273+  B3C2 CD 14 B4    	CALL	GetLenN32
0274+  B3C5 01 00 E1    	LD	BC,#E100
0275+  B3C8 D9          	EXX 
0276+  B3C9 01 F5 05    	LD	BC,#05F5	;100'000'000
0277+  B3CC D9          	EXX 
0278+  B3CD CD 14 B4    	CALL	GetLenN32
0279+  B3D0 01 80 96    	LD	BC,#9680
0280+  B3D3 D9          	EXX 
0281+  B3D4 01 98 00    	LD	BC,#0098	;10'000'000
0282+  B3D7 D9          	EXX 
0283+  B3D8 CD 14 B4    	CALL	GetLenN32
0284+  B3DB 01 40 42    	LD	BC,#4240
0285+  B3DE D9          	EXX 
0286+  B3DF 01 0F 00    	LD	BC,#000F	;1'000'000
0287+  B3E2 D9          	EXX 
0288+  B3E3 CD 14 B4    	CALL	GetLenN32
0289+  B3E6 01 A0 86    	LD	BC,#86A0
0290+  B3E9 D9          	EXX 
0291+  B3EA 01 01 00    	LD	BC,#0001	;100'000
0292+  B3ED D9          	EXX 
0293+  B3EE CD 14 B4    	CALL	GetLenN32
0294+  B3F1 01 10 27    	LD	BC,10000	;10'000
0295+  B3F4 D9          	EXX 
0296+  B3F5 01 00 00    	LD	BC,#0000	;100'000
0297+  B3F8 D9          	EXX 
0298+  B3F9 CD 14 B4    	CALL	GetLenN32
0299+  B3FC 01 E8 03    	LD	BC,1000		;1'000
0300+  B3FF CD 38 B4    	CALL	GetLenN16
0301+  B402 01 64 00    	LD	BC,100		;100
0302+  B405 CD 38 B4    	CALL	GetLenN16
0303+  B408 01 0A 00    	LD	BC,10		;10
0304+  B40B CD 38 B4    	CALL	GetLenN16
0305+  B40E 7D          	LD	A,L
0306+  B40F C6 30       	ADD	A,"0"
0307+  B411 12          	LD	(DE),A
0308+  B412 13          	INC	DE
0309+  B413 C9          	RET 
0310+  B414             GetLenN32
0311+  B414 3E 2F       	LD	A,#2F
0312+  B416 B7          	OR	A
0313+  B417 3C          GetLn32	INC	A
0314+  B418 ED 42       	SBC	HL,BC
0315+  B41A D9          	EXX 
0316+  B41B ED 42       	SBC	HL,BC
0317+  B41D D9          	EXX 
0318+  B41E 30 F7       	JR	NC,GetLn32
0319+  B420 09          	ADD	HL,BC
0320+  B421 D9          	EXX 
0321+  B422 ED 4A       	ADC	HL,BC
0322+  B424 D9          	EXX 
0323+  B425 FE 30       	CP	#30
0324+  B427 28 04       	JR	Z,$+6
0325+  B429 DD CB 0E FE 	SET	7,(IX+#0E)
0326+  B42D DD CB 0E 7E 	BIT	7,(IX+#0E)
0327+  B431 20 02       	JR	NZ,$+4
0328+  B433 3E 20       	LD	A,#20
0329+  B435 12          	LD	(DE),A
0330+  B436 13          	INC	DE
0331+  B437 C9          	RET 
0332+  B438             GetLenN16
0333+  B438 3E 2F       	LD	A,#2F
0334+  B43A B7          	OR	A
0335+  B43B 3C          	INC	A
0336+  B43C ED 42       	SBC	HL,BC
0337+  B43E 30 FB       	JR	NC,$-3
0338+  B440 09          	ADD	HL,BC
0339+  B441 FE 30       	CP	#30
0340+  B443 28 04       	JR	Z,$+6
0341+  B445 DD CB 0E FE 	SET	7,(IX+#0E)
0342+  B449 DD CB 0E 7E 	BIT	7,(IX+#0E)
0343+  B44D 20 02       	JR	NZ,$+4
0344+  B44F 3E 20       	LD	A,#20
0345+  B451 12          	LD	(DE),A
0346+  B452 13          	INC	DE
0347+  B453 C9          	RET 
0348+  B454             PDirectory
0349+  B454 21 5D B4    	LD	HL,DirText
0350+  B457 01 0A 00    	LD	BC,#000A
0351+  B45A ED B0       	LDIR 
0352+  B45C C9          	RET 
0353+  B45D             DirText
0354+  B45D             	DEFB	"   <DIR>  "
0354+  B45D 2020203C4449523E2020
0355+  B467             GetData
0356+  B467             ;Дата
0357+  B467 EB          	EX	DE,HL
0358+  B468 DD 7E 13    	LD	A,(IX+#13)
0359+  B46B CD 94 B4    	CALL	Get8Bit
0360+  B46E 36 2E       	LD	(HL),"."
0361+  B470 23          	INC	HL
0362+  B471 DD 7E 14    	LD	A,(IX+#14)
0363+  B474 CD 94 B4    	CALL	Get8Bit
0364+  B477 36 2E       	LD	(HL),"."
0365+  B479 23          	INC	HL
0366+  B47A DD 7E 15    	LD	A,(IX+#15)	;Год
0367+  B47D CD 94 B4    	CALL	Get8Bit
0368+  B480 EB          	EX	DE,HL
0369+  B481 C9          	RET 
0370+  B482             GetTime
0371+  B482             ;Время
0372+  B482 EB          	EX	DE,HL
0373+  B483 DD 7E 16    	LD	A,(IX+#16)	;Часы
0374+  B486 CD 94 B4    	CALL	Get8Bit
0375+  B489 36 3A       	LD	(HL),":"
0376+  B48B 23          	INC	HL
0377+  B48C DD 7E 17    	LD	A,(IX+#17)
0378+  B48F CD 94 B4    	CALL	Get8Bit
0379+  B492 EB          	EX	DE,HL
0380+  B493 C9          	RET 
0381+  B494             Get8Bit
0382+  B494 06 2F       	LD	B,#2F
0383+  B496 04          	INC	B
0384+  B497 D6 0A       	SUB	10
0385+  B499 30 FB       	JR	NC,$-3
0386+  B49B C6 0A       	ADD	A,10
0387+  B49D 70          	LD	(HL),B
0388+  B49E 23          	INC	HL
0389+  B49F C6 30       	ADD	A,"0"
0390+  B4A1 77          	LD	(HL),A
0391+  B4A2 23          	INC	HL
0392+  B4A3 C9          	RET 
0393+  B4A4             ;
0394+  B4A4             PrnTreeInfo
0395+  B4A4 CD 8A B0    	CALL	MakeTreePath
0396+  B4A7 EB          	EX	DE,HL
0397+  B4A8 FD E5       	PUSH	IY
0398+  B4AA E1          	POP	HL
0399+  B4AB 01 2C 00    	LD	BC,BegPath
0400+  B4AE 09          	ADD	HL,BC
0401+  B4AF 23          	INC	HL
0402+  B4B0 23          	INC	HL
0403+  B4B1 EB          	EX	DE,HL
0404+  B4B2 97          	SUB	A
0405+  B4B3 ED A0       	LDI 
0406+  B4B5 BE          	CP	(HL)
0407+  B4B6 20 FB       	JR	NZ,$-3
0408+  B4B8 12          	LD	(DE),A
0409+  B4B9 CD 38 B2    	CALL	PrintPath
0410+  B4BC FD CB 00 7E 	BIT	7,(IY+PanelFlg)
0411+  B4C0 C4 AE B2    	CALL	NZ,PrintDOSPath
0412+  B4C3 C9          	RET 
0413+  B4C4             PrnSelInfo
0414+  B4C4 FD 6E 1B    	LD	L,(IY+PanelMBl1)
0415+  B4C7 FD 66 1C    	LD	H,(IY+PanelMBh1)
0416+  B4CA FD 4E 1D    	LD	C,(IY+PanelMBl2)
0417+  B4CD FD 46 1E    	LD	B,(IY+PanelMBh2)
0418+  B4D0 11 00 80    	LD	DE,WorkBuffer
0419+  B4D3 CD E2 A2    	CALL	ConvNumTxt32
0420+  B4D6 21 2C B5    	LD	HL,CrSizeT
0421+  B4D9 01 0A 00    	LD	BC,#000A
0422+  B4DC ED B0       	LDIR 
0423+  B4DE FD 6E 19    	LD	L,(IY+PanelMFl)
0424+  B4E1 FD 66 1A    	LD	H,(IY+PanelMFh)
0425+  B4E4 CD 4C A3    	CALL	ConvNumTxt16
0426+  B4E7 21 36 B5    	LD	HL,CrSelT
0427+  B4EA 01 0F 00    	LD	BC,#000F
0428+  B4ED ED B0       	LDIR 
0429+  B4EF 7B          	LD	A,E
0430+  B4F0 11 00 81    	LD	DE,WorkBuffer+#100
0431+  B4F3 4F          	LD	C,A
0432+  B4F4 D6 26       	SUB	38
0433+  B4F6 ED 44       	NEG 
0434+  B4F8 CB 3F       	SRL	A
0435+  B4FA 47          	LD	B,A
0436+  B4FB 28 06       	JR	Z,PrSelI1
0437+  B4FD 3E 20       	LD	A,#20
0438+  B4FF 12          	LD	(DE),A
0439+  B500 1C          	INC	E
0440+  B501 10 FC       	DJNZ	$-2
0441+  B503 21 00 80    PrSelI1	LD	HL,WorkBuffer
0442+  B506 ED B0       	LDIR 
0443+  B508 3E 26       	LD	A,38
0444+  B50A 93          	SUB	E
0445+  B50B 28 07       	JR	Z,PrSelI2
0446+  B50D 47          	LD	B,A
0447+  B50E 3E 20       	LD	A,#20
0448+  B510 12          	LD	(DE),A
0449+  B511 1C          	INC	E
0450+  B512 10 FC       	DJNZ	$-2
0451+  B514 97          PrSelI2	SUB	A
0452+  B515 12          	LD	(DE),A
0453+  B516 21 00 81    	LD	HL,WorkBuffer+#100
0454+  B519 FD 5E 03    	LD	E,(IY+PanelXl)
0455+  B51C FD 56 04    	LD	D,(IY+PanelXh)
0456+  B51F 13          	INC	DE
0457+  B520 13          	INC	DE
0458+  B521 13          	INC	DE
0459+  B522 13          	INC	DE
0460+  B523 01 D7 00    	LD	BC,#00D7
0461+  B526 3E 80       	LD	A,#80
0462+  B528 CD 29 90    	CALL	PrnTxtLnNorm
0463+  B52B C9          	RET 
0464+  B52C             CrSizeT
0465+  B52C             	DEFB	" bytes in "
0465+  B52C 20627974657320696E20
0466+  B536             CrSelT
0467+  B536             	DEFB	" selected files"
0467+  B536 2073656C65637465642066696C6573
0468+  B545             ;[]----------------------------------------------------------[]
0469+  B545             PrintDIR
0470+  B545 FD 7E 13    	LD	A,(IY+PanelEFl)
0471+  B548 FD B6 14    	OR	(IY+PanelEFh)
0472+  B54B 20 35       	JR	NZ,PrnDIRECT
0473+  B54D FD 6E 03    	LD	L,(IY+PanelXl)
0474+  B550 FD 66 04    	LD	H,(IY+PanelXh)
0475+  B553 23          	INC	HL
0476+  B554 23          	INC	HL
0477+  B555 22 77 B5    	LD	(ClrDIR1),HL
0478+  B558 21 34 01    	LD	HL,#0134
0479+  B55B 11 8D 00    	LD	DE,#008D
0480+  B55E FD 7E 01    	LD	A,(IY+ViewFlg)
0481+  B561 E6 03       	AND	#03
0482+  B563 28 06       	JR	Z,$+8
0483+  B565 21 24 01    	LD	HL,#0124
0484+  B568 11 95 00    	LD	DE,#0095
0485+  B56B 22 7B B5    	LD	(ClrDIRx),HL
0486+  B56E ED 53 7D B5 	LD	(ClrDIRy),DE
0487+  B572 CD F0 86    	CALL	MakeWindow
0488+  B575 80          	DEFB	#80
0489+  B576 02          	DEFB	#02
0490+  B577 00 00 3C 00 ClrDIR1	DEFW	#0000,#003C
0491+  B57B 00 00       ClrDIRx	DEFW	#0000
0492+  B57D 00 00       ClrDIRy	DEFW	#0000
0493+  B57F 09          	DEFB	PanelCol
0494+  B580 00          	DEFB	#00
0495+  B581 C9          	RET 
0496+  B582             PrnDIRECT
0497+  B582 FD CB 01 46 	BIT	0,(IY+ViewFlg)
0498+  B586 C2 33 B6    	JP	NZ,PrintDIR1
0499+  B589 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0500+  B58D C2 42 B7    	JP	NZ,PrintDIR2
0501+  B590             ;Краткий список
0502+  B590 FD E5       	PUSH	IY
0503+  B592 DB A2       	IN	A,(PAGE1)
0504+  B594 F5          	PUSH	AF
0505+  B595 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0506+  B599 3A EE A7    	LD	A,(DIRpage1)
0507+  B59C 28 03       	JR	Z,$+5
0508+  B59E 3A EF A7    	LD	A,(DIRpage2)
0509+  B5A1 D3 A2       	OUT	(PAGE1),A
0510+  B5A3 FD 6E 15    	LD	L,(IY+PanelFFl)
0511+  B5A6 FD 66 16    	LD	H,(IY+PanelFFh)
0512+  B5A9 29          	ADD	HL,HL
0513+  B5AA 29          	ADD	HL,HL
0514+  B5AB 29          	ADD	HL,HL
0515+  B5AC 5D          	LD	E,L
0516+  B5AD 54          	LD	D,H
0517+  B5AE 29          	ADD	HL,HL
0518+  B5AF 19          	ADD	HL,DE
0519+  B5B0 CB F4       	SET	6,H
0520+  B5B2 11 00 80    	LD	DE,WorkBuffer
0521+  B5B5 01 C8 04    	LD	BC,#33*#18
0522+  B5B8 CD 44 A4    	CALL	MoveBytes
0523+  B5BB F1          	POP	AF
0524+  B5BC D3 A2       	OUT	(PAGE1),A
0525+  B5BE 06 9A       	LD	B,PanelCol*#10+FileCol
0526+  B5C0 0E 9B       	LD	C,PanelCol*#10+SFileCol
0527+  B5C2 CD C0 B8    	CALL	InsPrnColor
0528+  B5C5 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0529+  B5C7 4F          	LD	C,A
0530+  B5C8 DB A2       	IN	A,(PAGE1)
0531+  B5CA 47          	LD	B,A
0532+  B5CB C5          	PUSH	BC
0533+  B5CC 3E 50       	LD	A,#50
0534+  B5CE D3 A2       	OUT	(PAGE1),A
0535+  B5D0 21 00 80    	LD	HL,WorkBuffer
0536+  B5D3 E5          	PUSH	HL
0537+  B5D4 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0538+  B5D8 21 B8 B9    	LD	HL,PositTAB1
0539+  B5DB 28 03       	JR	Z,$+5
0540+  B5DD 21 51 BA    	LD	HL,PositTAB2
0541+  B5E0 06 33       	LD	B,#33
0542+  B5E2 5E          PrnDIR1	LD	E,(HL)
0543+  B5E3 23          	INC	HL
0544+  B5E4 56          	LD	D,(HL)
0545+  B5E5 23          	INC	HL
0546+  B5E6 4E          	LD	C,(HL)
0547+  B5E7 23          	INC	HL
0548+  B5E8 E3          	EX	(SP),HL
0549+  B5E9 E5          	PUSH	HL
0550+  B5EA C5          	PUSH	BC
0551+  B5EB 06 0C       	LD	B,#0C
0552+  B5ED CD 33 B9    	CALL	PrintName
0553+  B5F0 C1          	POP	BC
0554+  B5F1 E1          	POP	HL
0555+  B5F2 11 19 00    	LD	DE,#0019
0556+  B5F5 19          	ADD	HL,DE
0557+  B5F6 7E          	LD	A,(HL)
0558+  B5F7 2B          	DEC	HL
0559+  B5F8 B7          	OR	A
0560+  B5F9 28 05       	JR	Z,PrnDIR2
0561+  B5FB E3          	EX	(SP),HL
0562+  B5FC 10 E4       	DJNZ	PrnDIR1
0563+  B5FE 18 1A       	JR	PrnDIRe
0564+  B600 05          PrnDIR2	DEC	B
0565+  B601 28 17       	JR	Z,PrnDIRe
0566+  B603 21 25 B6    	LD	HL,EmptyFile
0567+  B606 E3          	EX	(SP),HL
0568+  B607 5E          PrnDIR3	LD	E,(HL)
0569+  B608 23          	INC	HL
0570+  B609 56          	LD	D,(HL)
0571+  B60A 23          	INC	HL
0572+  B60B 4E          	LD	C,(HL)
0573+  B60C 23          	INC	HL
0574+  B60D E3          	EX	(SP),HL
0575+  B60E E5          	PUSH	HL
0576+  B60F C5          	PUSH	BC
0577+  B610 06 0C       	LD	B,#0C
0578+  B612 CD 33 B9    	CALL	PrintName
0579+  B615 C1          	POP	BC
0580+  B616 E1          	POP	HL
0581+  B617 E3          	EX	(SP),HL
0582+  B618 10 ED       	DJNZ	PrnDIR3
0583+  B61A E1          PrnDIRe	POP	HL
0584+  B61B C1          	POP	BC
0585+  B61C 78          	LD	A,B
0586+  B61D D3 A2       	OUT	(PAGE1),A
0587+  B61F 79          	LD	A,C
0588+  B620 D3 89       	OUT	(YPORT),A
0589+  B622 FD E1       	POP	IY
0590+  B624 C9          	RET 
0591+  B625             EmptyFile		
0592+  B625             	DEFB	#00,"        ",#01,"   ",#00
0592+  B625 0020202020202020200120202000
0593+  B633             ;Подробный список
0594+  B633             PrintDIR1
0595+  B633 FD E5       	PUSH	IY
0596+  B635 DB A2       	IN	A,(PAGE1)
0597+  B637 F5          	PUSH	AF
0598+  B638 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0599+  B63C 3A EE A7    	LD	A,(DIRpage1)
0600+  B63F 28 03       	JR	Z,$+5
0601+  B641 3A EF A7    	LD	A,(DIRpage2)
0602+  B644 D3 A2       	OUT	(PAGE1),A
0603+  B646 FD 6E 15    	LD	L,(IY+PanelFFl)
0604+  B649 FD 66 16    	LD	H,(IY+PanelFFh)
0605+  B64C 29          	ADD	HL,HL
0606+  B64D 29          	ADD	HL,HL
0607+  B64E 29          	ADD	HL,HL
0608+  B64F 5D          	LD	E,L
0609+  B650 54          	LD	D,H
0610+  B651 29          	ADD	HL,HL
0611+  B652 19          	ADD	HL,DE
0612+  B653 CB F4       	SET	6,H
0613+  B655 11 00 80    	LD	DE,WorkBuffer
0614+  B658 01 B0 01    	LD	BC,#12*#18
0615+  B65B CD 44 A4    	CALL	MoveBytes
0616+  B65E F1          	POP	AF
0617+  B65F D3 A2       	OUT	(PAGE1),A
0618+  B661 06 9A       	LD	B,PanelCol*#10+FileCol
0619+  B663 0E 9B       	LD	C,PanelCol*#10+SFileCol
0620+  B665 CD C0 B8    	CALL	InsPrnColor
0621+  B668 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0622+  B66A 4F          	LD	C,A
0623+  B66B DB A2       	IN	A,(PAGE1)
0624+  B66D 47          	LD	B,A
0625+  B66E C5          	PUSH	BC
0626+  B66F 3E 50       	LD	A,#50
0627+  B671 D3 A2       	OUT	(PAGE1),A
0628+  B673 21 00 80    	LD	HL,WorkBuffer
0629+  B676 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0630+  B67A 11 08 00    	LD	DE,#0008
0631+  B67D 28 03       	JR	Z,$+5
0632+  B67F 11 48 01    	LD	DE,#0148
0633+  B682 01 3F 12    	LD	BC,#123F
0634+  B685 E5          PrnDIRp	PUSH	HL
0635+  B686 D5          	PUSH	DE
0636+  B687 C5          	PUSH	BC
0637+  B688 E5          	PUSH	HL
0638+  B689 11 00 82    	LD	DE,WorkBuffer+#200
0639+  B68C 01 0D 00    	LD	BC,#000D
0640+  B68F ED B0       	LDIR 
0641+  B691 3E 01       	LD	A,#01
0642+  B693 12          	LD	(DE),A
0643+  B694 13          	INC	DE
0644+  B695 DD E1       	POP	IX
0645+  B697 DD CB 0E 66 	BIT	4,(IX+#0E)
0646+  B69B C4 F2 B6    	CALL	NZ,PutDIRTxt
0647+  B69E CC A1 B3    	CALL	Z,GetFileLen
0648+  B6A1 3E 01       	LD	A,#01
0649+  B6A3 12          	LD	(DE),A
0650+  B6A4 13          	INC	DE
0651+  B6A5 CD 67 B4    	CALL	GetData
0652+  B6A8 3E 01       	LD	A,#01
0653+  B6AA 12          	LD	(DE),A
0654+  B6AB 13          	INC	DE
0655+  B6AC CD 82 B4    	CALL	GetTime
0656+  B6AF C1          	POP	BC
0657+  B6B0 D1          	POP	DE
0658+  B6B1 E1          	POP	HL
0659+  B6B2 D5          	PUSH	DE
0660+  B6B3 C5          	PUSH	BC
0661+  B6B4 E5          	PUSH	HL
0662+  B6B5 21 00 82    	LD	HL,WorkBuffer+#200
0663+  B6B8 06 26       	LD	B,#26
0664+  B6BA CD 33 B9    	CALL	PrintName
0665+  B6BD E1          	POP	HL
0666+  B6BE 01 19 00    	LD	BC,#0019
0667+  B6C1 09          	ADD	HL,BC
0668+  B6C2 C1          	POP	BC
0669+  B6C3 79          	LD	A,C
0670+  B6C4 C6 08       	ADD	A,#08
0671+  B6C6 4F          	LD	C,A
0672+  B6C7 D1          	POP	DE
0673+  B6C8 7E          	LD	A,(HL)
0674+  B6C9 2B          	DEC	HL
0675+  B6CA B7          	OR	A
0676+  B6CB 28 04       	JR	Z,PrnDIRp2
0677+  B6CD 10 B6       	DJNZ	PrnDIRp
0678+  B6CF 18 17       	JR	PrnDIRpE
0679+  B6D1             PrnDIRp2
0680+  B6D1 05          	DEC	B
0681+  B6D2 28 14       	JR	Z,PrnDIRpE
0682+  B6D4 21 1B B7    	LD	HL,EmptyFile1
0683+  B6D7             PrnDIRp3
0684+  B6D7 E5          	PUSH	HL
0685+  B6D8 D5          	PUSH	DE
0686+  B6D9 C5          	PUSH	BC
0687+  B6DA 06 26       	LD	B,#26
0688+  B6DC CD 33 B9    	CALL	PrintName
0689+  B6DF C1          	POP	BC
0690+  B6E0 79          	LD	A,C
0691+  B6E1 C6 08       	ADD	A,#08
0692+  B6E3 4F          	LD	C,A
0693+  B6E4 D1          	POP	DE
0694+  B6E5 E1          	POP	HL
0695+  B6E6 10 EF       	DJNZ	PrnDIRp3
0696+  B6E8             PrnDIRpE
0697+  B6E8 C1          	POP	BC
0698+  B6E9 78          	LD	A,B
0699+  B6EA D3 A2       	OUT	(PAGE1),A
0700+  B6EC 79          	LD	A,C
0701+  B6ED D3 89       	OUT	(YPORT),A
0702+  B6EF FD E1       	POP	IY
0703+  B6F1 C9          	RET 
0704+  B6F2             PutDIRTxt
0705+  B6F2 08          	EX	AF,AF'
0706+  B6F3 21 07 B7    	LD	HL,DIRt1
0707+  B6F6 DD 7E 01    	LD	A,(IX+#01)
0708+  B6F9 FE 2E       	CP	"."
0709+  B6FB 28 03       	JR	Z,$+5
0710+  B6FD 21 11 B7    	LD	HL,DIRt2
0711+  B700 01 0A 00    	LD	BC,#000A
0712+  B703 ED B0       	LDIR 
0713+  B705 08          	EX	AF,AF'
0714+  B706 C9          	RET 
0715+  B707             DIRt1	DEFB	#20,#10,"UP--DIR",#11
0715+  B707 201055502D2D44495211
0716+  B711             DIRt2	DEFB	#20,#10,"SUB-DIR",#11
0716+  B711 20105355422D44495211
0717+  B71B             
0718+  B71B             EmptyFile1
0719+  B71B             	DEFB	#00,"        "
0719+  B71B 002020202020202020
0720+  B724 01 20 20 20 	DEFB	#01,"   "
0721+  B728             	DEFB	#01,"          "
0721+  B728 0120202020202020202020
0722+  B733             	DEFB	#01,"        "
0722+  B733 012020202020202020
0723+  B73C             	DEFB	#01,"     "
0723+  B73C 012020202020
0724+  B742             PrintDIR2
0725+  B742             ;Делево	каталогов
0726+  B742 DB A2       	IN	A,(PAGE1)
0727+  B744 F5          	PUSH	AF
0728+  B745 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0729+  B749 3A EE A7    	LD	A,(DIRpage1)
0730+  B74C 28 03       	JR	Z,$+5
0731+  B74E 3A EF A7    	LD	A,(DIRpage2)
0732+  B751 D3 A2       	OUT	(PAGE1),A
0733+  B753 21 00 80    	LD	HL,WorkBuffer
0734+  B756 06 18       	LD	B,#18
0735+  B758 3E 80       	LD	A,#80
0736+  B75A E5          	PUSH	HL
0737+  B75B 77          	LD	(HL),A
0738+  B75C 2C          	INC	L
0739+  B75D 10 FC       	DJNZ	$-2
0740+  B75F D1          	POP	DE
0741+  B760 21 00 40    	LD	HL,#4000
0742+  B763 FD 4E 15    	LD	C,(IY+PanelFFl)
0743+  B766 FD 46 16    	LD	B,(IY+PanelFFh)
0744+  B769 78          	LD	A,B
0745+  B76A B1          	OR	C
0746+  B76B 28 11       	JR	Z,PrDIRb2
0747+  B76D C5          PrDIRb1	PUSH	BC
0748+  B76E 7E          	LD	A,(HL)
0749+  B76F E6 7F       	AND	#7F
0750+  B771 5F          	LD	E,A
0751+  B772 7E          	LD	A,(HL)
0752+  B773 12          	LD	(DE),A
0753+  B774 01 10 00    	LD	BC,#0010
0754+  B777 09          	ADD	HL,BC
0755+  B778 C1          	POP	BC
0756+  B779 0B          	DEC	BC
0757+  B77A 78          	LD	A,B
0758+  B77B B1          	OR	C
0759+  B77C 20 EF       	JR	NZ,PrDIRb1
0760+  B77E 11 00 81    PrDIRb2	LD	DE,WorkBuffer+#100
0761+  B781 01 20 01    	LD	BC,#12*#10
0762+  B784 CD 44 A4    	CALL	MoveBytes
0763+  B787 F1          	POP	AF
0764+  B788 D3 A2       	OUT	(PAGE1),A
0765+  B78A 06 9A       	LD	B,PanelCol*#10+FileCol
0766+  B78C 0E 9B       	LD	C,PanelCol*#10+SFileCol
0767+  B78E CD C0 B8    	CALL	InsPrnColor
0768+  B791 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0769+  B793 4F          	LD	C,A
0770+  B794 DB A2       	IN	A,(PAGE1)
0771+  B796 47          	LD	B,A
0772+  B797 C5          	PUSH	BC
0773+  B798 3E 50       	LD	A,#50
0774+  B79A D3 A2       	OUT	(PAGE1),A
0775+  B79C FD CB 00 46 	BIT	0,(IY+PanelFlg)
0776+  B7A0 21 00 81    	LD	HL,WorkBuffer+#100
0777+  B7A3 11 0A 00    	LD	DE,#000A
0778+  B7A6 28 03       	JR	Z,$+5
0779+  B7A8 11 4A 01    	LD	DE,#014A
0780+  B7AB 01 3F 12    	LD	BC,#123F
0781+  B7AE E5          PrnDIRt	PUSH	HL
0782+  B7AF D5          	PUSH	DE
0783+  B7B0 C5          	PUSH	BC
0784+  B7B1 11 00 83    	LD	DE,WorkBuffer+#300
0785+  B7B4 CD 02 B8    	CALL	MakeTreeLine
0786+  B7B7 C1          	POP	BC
0787+  B7B8 D1          	POP	DE
0788+  B7B9 E1          	POP	HL
0789+  B7BA D5          	PUSH	DE
0790+  B7BB C5          	PUSH	BC
0791+  B7BC E5          	PUSH	HL
0792+  B7BD 21 00 83    	LD	HL,WorkBuffer+#300
0793+  B7C0 06 24       	LD	B,#24
0794+  B7C2 FD E5       	PUSH	IY
0795+  B7C4 CD 33 B9    	CALL	PrintName
0796+  B7C7 FD E1       	POP	IY
0797+  B7C9 E1          	POP	HL
0798+  B7CA 01 0F 00    	LD	BC,#000F
0799+  B7CD 09          	ADD	HL,BC
0800+  B7CE C1          	POP	BC
0801+  B7CF 79          	LD	A,C
0802+  B7D0 C6 08       	ADD	A,#08
0803+  B7D2 4F          	LD	C,A
0804+  B7D3 D1          	POP	DE
0805+  B7D4 7E          	LD	A,(HL)
0806+  B7D5 23          	INC	HL
0807+  B7D6 3C          	INC	A
0808+  B7D7 28 06       	JR	Z,PrnDIRt2
0809+  B7D9 05          	DEC	B
0810+  B7DA C2 AE B7    	JP	NZ,PrnDIRt
0811+  B7DD 18 1B       	JR	PrnDIRtE
0812+  B7DF             PrnDIRt2
0813+  B7DF 05          	DEC	B
0814+  B7E0 28 18       	JR	Z,PrnDIRtE
0815+  B7E2 21 9B B8    	LD	HL,EmptyFile2
0816+  B7E5 FD E5       	PUSH	IY
0817+  B7E7             PrnDIRt3
0818+  B7E7 E5          	PUSH	HL
0819+  B7E8 D5          	PUSH	DE
0820+  B7E9 C5          	PUSH	BC
0821+  B7EA 06 24       	LD	B,#24
0822+  B7EC CD 33 B9    	CALL	PrintName
0823+  B7EF C1          	POP	BC
0824+  B7F0 79          	LD	A,C
0825+  B7F1 C6 08       	ADD	A,#08
0826+  B7F3 4F          	LD	C,A
0827+  B7F4 D1          	POP	DE
0828+  B7F5 E1          	POP	HL
0829+  B7F6 10 EF       	DJNZ	PrnDIRt3
0830+  B7F8 FD E1       	POP	IY
0831+  B7FA             PrnDIRtE
0832+  B7FA C1          	POP	BC
0833+  B7FB 78          	LD	A,B
0834+  B7FC D3 A2       	OUT	(PAGE1),A
0835+  B7FE 79          	LD	A,C
0836+  B7FF D3 89       	OUT	(YPORT),A
0837+  B801 C9          	RET 
0838+  B802             MakeTreeLine
0839+  B802 97          	SUB	A
0840+  B803 12          	LD	(DE),A
0841+  B804 1C          	INC	E
0842+  B805 4E          	LD	C,(HL)
0843+  B806 23          	INC	HL
0844+  B807 7E          	LD	A,(HL)
0845+  B808 23          	INC	HL
0846+  B809 DD 6F       	LD	LX,A
0847+  B80B 3E 20       	LD	A," "
0848+  B80D 12          	LD	(DE),A
0849+  B80E 1C          	INC	E
0850+  B80F 0C          	INC	C
0851+  B810 0D          	DEC	C		;r.C=0 "\"
0852+  B811 28 3B       	JR	Z,MTreeL2
0853+  B813             
0854+  B813 E5          	PUSH	HL
0855+  B814 79          	LD	A,C
0856+  B815 E6 7F       	AND	#7F
0857+  B817 47          	LD	B,A
0858+  B818 21 00 80    	LD	HL,WorkBuffer
0859+  B81B E5          	PUSH	HL
0860+  B81C 6F          	LD	L,A
0861+  B81D 71          	LD	(HL),C
0862+  B81E E1          	POP	HL
0863+  B81F 05          	DEC	B
0864+  B820 28 17       	JR	Z,MTreeL1
0865+  B822             
0866+  B822 23          MTreeL0	INC	HL
0867+  B823 CB 7E       	BIT	7,(HL)
0868+  B825 3E B3       	LD	A,0xb3	;"ѓ"
0869+  B827 28 02       	JR	Z,$+4
0870+  B829 3E 20       	LD	A," "
0871+  B82B 12          	LD	(DE),A
0872+  B82C 1C          	INC	E
0873+  B82D FD CB 01 56 	BIT	2,(IY+ViewFlg)
0874+  B831 20 04       	JR	NZ,$+6
0875+  B833 3E 20       	LD	A," "
0876+  B835 12          	LD	(DE),A
0877+  B836 1C          	INC	E
0878+  B837 10 E9       	DJNZ	MTreeL0
0879+  B839             
0880+  B839 CB 79       MTreeL1	BIT	7,C
0881+  B83B 3E C3       	LD	A,0xc3;"“"
0882+  B83D 28 02       	JR	Z,$+4
0883+  B83F 3E C0       	LD	A,0xc0;"ђ"
0884+  B841 12          	LD	(DE),A
0885+  B842 1C          	INC	E
0886+  B843 FD CB 01 56 	BIT	2,(IY+ViewFlg)
0887+  B847 20 04       	JR	NZ,$+6
0888+  B849 3E C4       	LD	A,0xc4;"”"
0889+  B84B 12          	LD	(DE),A
0890+  B84C 1C          	INC	E
0891+  B84D E1          	POP	HL
0892+  B84E             
0893+  B84E DD 7D       MTreeL2	LD	A,LX
0894+  B850 CB 4F       	BIT	1,A
0895+  B852 28 0D       	JR	Z,MTreeL3
0896+  B854 FD CB 01 56 	BIT	2,(IY+ViewFlg)
0897+  B858 20 01       	JR	NZ,$+3
0898+  B85A 1D          	DEC	E
0899+  B85B 3E DD       	LD	A,0xdd;"­"
0900+  B85D 12          	LD	(DE),A
0901+  B85E 1C          	INC	E
0902+  B85F DD 7D       	LD	A,LX
0903+  B861 CB 47       MTreeL3	BIT	0,A
0904+  B863 3E 02       	LD	A,#02
0905+  B865 20 01       	JR	NZ,$+3
0906+  B867 3C          	INC	A
0907+  B868 12          	LD	(DE),A
0908+  B869 1C          	INC	E
0909+  B86A 97          	SUB	A
0910+  B86B ED A0       	LDI 
0911+  B86D BE          	CP	(HL)
0912+  B86E 20 FB       	JR	NZ,$-3
0913+  B870 3E 03       	LD	A,#03
0914+  B872 12          	LD	(DE),A
0915+  B873 1C          	INC	E
0916+  B874 DD 7D       	LD	A,LX
0917+  B876 CB 4F       	BIT	1,A
0918+  B878 28 04       	JR	Z,MTreeL5
0919+  B87A 3E DE       	LD	A,0xde;"®"
0920+  B87C 12          	LD	(DE),A
0921+  B87D 1C          	INC	E
0922+  B87E 3E 28       MTreeL5	LD	A,#28
0923+  B880 93          	SUB	E
0924+  B881 28 09       	JR	Z,MTreeL6
0925+  B883 38 07       	JR	C,MTreeL6
0926+  B885 47          	LD	B,A
0927+  B886 3E 20       	LD	A,#20
0928+  B888 12          	LD	(DE),A
0929+  B889 1C          	INC	E
0930+  B88A 10 FC       	DJNZ	$-2
0931+  B88C DD 7D       MTreeL6	LD	A,LX
0932+  B88E CB 47       	BIT	0,A
0933+  B890 C8          	RET	Z
0934+  B891 1E 26       	LD	E,#26
0935+  B893 3E 02       	LD	A,#02
0936+  B895 12          	LD	(DE),A
0937+  B896 1C          	INC	E
0938+  B897 3E 11       	LD	A,#11
0939+  B899 12          	LD	(DE),A
0940+  B89A C9          	RET 
0941+  B89B             EmptyFile2
0942+  B89B 00          	DEFB	#00
0943+  B89C 20          	DEFS	#24," "
0944+  B8C0             
0945+  B8C0             InsPrnColor
0946+  B8C0 21 13 B9    	LD	HL,PrnINKd1	;INK буфер
0947+  B8C3 11 1B B9    	LD	DE,PrnPAPd1	;PAPER буфер
0948+  B8C6 C5          	PUSH	BC
0949+  B8C7 78          	LD	A,B
0950+  B8C8 F5          	PUSH	AF
0951+  B8C9 E6 0F       	AND	#0F		;INK
0952+  B8CB 4F          	LD	C,A
0953+  B8CC 07          	RLCA 
0954+  B8CD 07          	RLCA 
0955+  B8CE 07          	RLCA 
0956+  B8CF 07          	RLCA 
0957+  B8D0 B1          	OR	C
0958+  B8D1 2F          	CPL 
0959+  B8D2 06 08       	LD	B,#08
0960+  B8D4 77          	LD	(HL),A
0961+  B8D5 23          	INC	HL
0962+  B8D6 10 FC       	DJNZ	$-2
0963+  B8D8 47          	LD	B,A
0964+  B8D9 F1          	POP	AF
0965+  B8DA E6 F0       	AND	#F0		;PAPER
0966+  B8DC 4F          	LD	C,A
0967+  B8DD 0F          	RRCA 
0968+  B8DE 0F          	RRCA 
0969+  B8DF 0F          	RRCA 
0970+  B8E0 0F          	RRCA 
0971+  B8E1 B1          	OR	C
0972+  B8E2 A8          	XOR	B		;XOR с INK
0973+  B8E3 06 08       	LD	B,#08
0974+  B8E5 12          	LD	(DE),A
0975+  B8E6 13          	INC	DE
0976+  B8E7 10 FC       	DJNZ	$-2
0977+  B8E9 C1          	POP	BC
0978+  B8EA 21 23 B9    	LD	HL,PrnINKd2	;INK буфер
0979+  B8ED 11 2B B9    	LD	DE,PrnPAPd2	;PAPER буфер
0980+  B8F0 79          	LD	A,C
0981+  B8F1 F5          	PUSH	AF
0982+  B8F2 E6 0F       	AND	#0F		;INK
0983+  B8F4 4F          	LD	C,A
0984+  B8F5 07          	RLCA 
0985+  B8F6 07          	RLCA 
0986+  B8F7 07          	RLCA 
0987+  B8F8 07          	RLCA 
0988+  B8F9 B1          	OR	C
0989+  B8FA 2F          	CPL 
0990+  B8FB 06 08       	LD	B,#08
0991+  B8FD 77          	LD	(HL),A
0992+  B8FE 23          	INC	HL
0993+  B8FF 10 FC       	DJNZ	$-2
0994+  B901 47          	LD	B,A
0995+  B902 F1          	POP	AF
0996+  B903 E6 F0       	AND	#F0		;PAPER
0997+  B905 4F          	LD	C,A
0998+  B906 0F          	RRCA 
0999+  B907 0F          	RRCA 
1000+  B908 0F          	RRCA 
1001+  B909 0F          	RRCA 
1002+  B90A B1          	OR	C
1003+  B90B A8          	XOR	B		;XOR с INK
1004+  B90C 06 08       	LD	B,#08
1005+  B90E 12          	LD	(DE),A
1006+  B90F 13          	INC	DE
1007+  B910 10 FC       	DJNZ	$-2
1008+  B912 C9          	RET 
1009+  B913             
1010+  B913 00          PrnINKd1 DEFS	 8,0
1011+  B91B 00          PrnPAPd1 DEFS	 8,0
1012+  B923 00          PrnINKd2 DEFS	 8,0
1013+  B92B 00          PrnPAPd2 DEFS	 8,0
1014+  B933             
1015+  B933             PrintName
1016+  B933 FD 69       	LD	LY,C		;Y координата
1017+  B935 7E          	LD	A,(HL)
1018+  B936 23          	INC	HL
1019+  B937 D5          	PUSH	DE
1020+  B938 D9          	EXX 
1021+  B939 21 1B B9    	LD	HL,PrnPAPd1	;INK буфер
1022+  B93C 11 13 B9    	LD	DE,PrnINKd1	;PAPER буфер
1023+  B93F B7          	OR	A
1024+  B940 28 06       	JR	Z,$+8
1025+  B942 21 2B B9    	LD	HL,PrnPAPd2	;INK буфер
1026+  B945 11 23 B9    	LD	DE,PrnINKd2	;PAPER буфер
1027+  B948 C1          	POP	BC
1028+  B949 CB 38       	SRL	B
1029+  B94B CB 19       	RR	C
1030+  B94D CB F0       	SET	6,B
1031+  B94F D9          	EXX 
1032+  B950 F3          	DI 
1033+  B951 DB 82       	IN	A,(PAGE0)
1034+  B953 F5          	PUSH	AF
1035+  B954 3A EB A7    	LD	A,(FONTpage)
1036+  B957 D3 82       	OUT	(PAGE0),A
1037+  B959 78          	LD	A,B
1038+  B95A 4D          	LD	C,L		;Адрес строки
1039+  B95B 44          	LD	B,H
1040+  B95C 52          	LD	D,D
1041+  B95D 26 08       	LD	H,#08
1042+  B95F 40          	LD	B,B
1043+  B960 08          PTxtLnD	EX	AF,AF'
1044+  B961 0A          	LD	A,(BC)
1045+  B962 03          	INC	BC
1046+  B963 FE 03       	CP	#03
1047+  B965 20 0A       	JR	NZ,PTxtLD0
1048+  B967 D9          	EXX 
1049+  B968 21 1B B9    	LD	HL,PrnPAPd1	;INK буфер
1050+  B96B 11 13 B9    	LD	DE,PrnINKd1	;PAPER буфер
1051+  B96E D9          	EXX 
1052+  B96F 18 0C       	JR	PTxtLD1-2
1053+  B971 FE 02       PTxtLD0	CP	#02
1054+  B973 20 0A       	JR	NZ,PTxtLD1
1055+  B975 D9          	EXX 
1056+  B976 21 2B B9    	LD	HL,PrnPAPd2	;INK буфер
1057+  B979 11 23 B9    	LD	DE,PrnINKd2	;PAPER буфер
1058+  B97C D9          	EXX 
1059+  B97D 0A          	LD	A,(BC)
1060+  B97E 03          	INC	BC
1061+  B97F C5          PTxtLD1	PUSH	BC
1062+  B980 FE 01       	CP	#01
1063+  B982 06 04       	LD	B,#04
1064+  B984 20 04       	JR	NZ,PTxtLD2
1065+  B986 06 02       	LD	B,#02
1066+  B988 3E 20       	LD	A,#20
1067+  B98A 6F          PTxtLD2	LD	L,A
1068+  B98B 26 1B       	LD	H,high Font-#C0
1069+  B98D 5E          	LD	E,(HL)
1070+  B98E 24          	INC	H
1071+  B98F 7E          	LD	A,(HL)
1072+  B990 C6 1B       	ADD	A,high Font-#C0
1073+  B992 57          	LD	D,A
1074+  B993 21 08 00    	LD	HL,#0008
1075+  B996 EB          	EX	DE,HL
1076+  B997             PrnName1
1077+  B997 6D          	LD	L,L
1078+  B998 7E          	LD	A,(HL)
1079+  B999 40          	LD	B,B
1080+  B99A D9          	EXX 
1081+  B99B FD 7D       	LD	A,LY
1082+  B99D D3 89       	OUT	(YPORT),A
1083+  B99F 6D          	LD	L,L
1084+  B9A0 B6          	OR	(HL)
1085+  B9A1 40          	LD	B,B
1086+  B9A2 EB          	EX	DE,HL
1087+  B9A3 6D          	LD	L,L
1088+  B9A4 AE          	XOR	(HL)
1089+  B9A5 7F          	LD	A,A
1090+  B9A6 02          	LD	(BC),A
1091+  B9A7 40          	LD	B,B
1092+  B9A8 EB          	EX	DE,HL
1093+  B9A9 03          	INC	BC
1094+  B9AA D9          	EXX 
1095+  B9AB 19          	ADD	HL,DE
1096+  B9AC 10 E9       	DJNZ	PrnName1
1097+  B9AE C1          	POP	BC
1098+  B9AF 08          	EX	AF,AF'
1099+  B9B0 3D          	DEC	A
1100+  B9B1 20 AD       	JR	NZ,PTxtLnD
1101+  B9B3 F1          	POP	AF
1102+  B9B4 D3 82       	OUT	(PAGE0),A
1103+  B9B6 FB          	EI 
1104+  B9B7 C9          	RET 
1105+  B9B8             PositTAB1
1106+  B9B8             CNT=#3F
1107+  B9B8             	DUP     #11
1108+  B9B8 0A 00       >	DEFW	#000A
1109+  B9BA 3F          >	DEFB	CNT
1108+  B9BB 0A 00       >	DEFW	#000A
1109+  B9BD 47          >	DEFB	CNT
1108+  B9BE 0A 00       >	DEFW	#000A
1109+  B9C0 4F          >	DEFB	CNT
1108+  B9C1 0A 00       >	DEFW	#000A
1109+  B9C3 57          >	DEFB	CNT
1108+  B9C4 0A 00       >	DEFW	#000A
1109+  B9C6 5F          >	DEFB	CNT
1108+  B9C7 0A 00       >	DEFW	#000A
1109+  B9C9 67          >	DEFB	CNT
1108+  B9CA 0A 00       >	DEFW	#000A
1109+  B9CC 6F          >	DEFB	CNT
1108+  B9CD 0A 00       >	DEFW	#000A
1109+  B9CF 77          >	DEFB	CNT
1108+  B9D0 0A 00       >	DEFW	#000A
1109+  B9D2 7F          >	DEFB	CNT
1108+  B9D3 0A 00       >	DEFW	#000A
1109+  B9D5 87          >	DEFB	CNT
1108+  B9D6 0A 00       >	DEFW	#000A
1109+  B9D8 8F          >	DEFB	CNT
1108+  B9D9 0A 00       >	DEFW	#000A
1109+  B9DB 97          >	DEFB	CNT
1108+  B9DC 0A 00       >	DEFW	#000A
1109+  B9DE 9F          >	DEFB	CNT
1108+  B9DF 0A 00       >	DEFW	#000A
1109+  B9E1 A7          >	DEFB	CNT
1108+  B9E2 0A 00       >	DEFW	#000A
1109+  B9E4 AF          >	DEFB	CNT
1108+  B9E5 0A 00       >	DEFW	#000A
1109+  B9E7 B7          >	DEFB	CNT
1108+  B9E8 0A 00       >	DEFW	#000A
1109+  B9EA BF          >	DEFB	CNT
1112+  B9EB             CNT=#3F
1113+  B9EB              	DUP     #11
1114+  B9EB 72 00       >	DEFW	#0072
1115+  B9ED 3F          >	DEFB	CNT
1114+  B9EE 72 00       >	DEFW	#0072
1115+  B9F0 47          >	DEFB	CNT
1114+  B9F1 72 00       >	DEFW	#0072
1115+  B9F3 4F          >	DEFB	CNT
1114+  B9F4 72 00       >	DEFW	#0072
1115+  B9F6 57          >	DEFB	CNT
1114+  B9F7 72 00       >	DEFW	#0072
1115+  B9F9 5F          >	DEFB	CNT
1114+  B9FA 72 00       >	DEFW	#0072
1115+  B9FC 67          >	DEFB	CNT
1114+  B9FD 72 00       >	DEFW	#0072
1115+  B9FF 6F          >	DEFB	CNT
1114+  BA00 72 00       >	DEFW	#0072
1115+  BA02 77          >	DEFB	CNT
1114+  BA03 72 00       >	DEFW	#0072
1115+  BA05 7F          >	DEFB	CNT
1114+  BA06 72 00       >	DEFW	#0072
1115+  BA08 87          >	DEFB	CNT
1114+  BA09 72 00       >	DEFW	#0072
1115+  BA0B 8F          >	DEFB	CNT
1114+  BA0C 72 00       >	DEFW	#0072
1115+  BA0E 97          >	DEFB	CNT
1114+  BA0F 72 00       >	DEFW	#0072
1115+  BA11 9F          >	DEFB	CNT
1114+  BA12 72 00       >	DEFW	#0072
1115+  BA14 A7          >	DEFB	CNT
1114+  BA15 72 00       >	DEFW	#0072
1115+  BA17 AF          >	DEFB	CNT
1114+  BA18 72 00       >	DEFW	#0072
1115+  BA1A B7          >	DEFB	CNT
1114+  BA1B 72 00       >	DEFW	#0072
1115+  BA1D BF          >	DEFB	CNT
1118+  BA1E             CNT=#3F
1119+  BA1E             	DUP     #11
1120+  BA1E DA 00       >	DEFW	#00DA
1121+  BA20 3F          >	DEFB	CNT
1120+  BA21 DA 00       >	DEFW	#00DA
1121+  BA23 47          >	DEFB	CNT
1120+  BA24 DA 00       >	DEFW	#00DA
1121+  BA26 4F          >	DEFB	CNT
1120+  BA27 DA 00       >	DEFW	#00DA
1121+  BA29 57          >	DEFB	CNT
1120+  BA2A DA 00       >	DEFW	#00DA
1121+  BA2C 5F          >	DEFB	CNT
1120+  BA2D DA 00       >	DEFW	#00DA
1121+  BA2F 67          >	DEFB	CNT
1120+  BA30 DA 00       >	DEFW	#00DA
1121+  BA32 6F          >	DEFB	CNT
1120+  BA33 DA 00       >	DEFW	#00DA
1121+  BA35 77          >	DEFB	CNT
1120+  BA36 DA 00       >	DEFW	#00DA
1121+  BA38 7F          >	DEFB	CNT
1120+  BA39 DA 00       >	DEFW	#00DA
1121+  BA3B 87          >	DEFB	CNT
1120+  BA3C DA 00       >	DEFW	#00DA
1121+  BA3E 8F          >	DEFB	CNT
1120+  BA3F DA 00       >	DEFW	#00DA
1121+  BA41 97          >	DEFB	CNT
1120+  BA42 DA 00       >	DEFW	#00DA
1121+  BA44 9F          >	DEFB	CNT
1120+  BA45 DA 00       >	DEFW	#00DA
1121+  BA47 A7          >	DEFB	CNT
1120+  BA48 DA 00       >	DEFW	#00DA
1121+  BA4A AF          >	DEFB	CNT
1120+  BA4B DA 00       >	DEFW	#00DA
1121+  BA4D B7          >	DEFB	CNT
1120+  BA4E DA 00       >	DEFW	#00DA
1121+  BA50 BF          >	DEFB	CNT
1124+  BA51             PositTAB2
1125+  BA51             CNT=#3F
1126+  BA51             	DUP     #11
1127+  BA51 4A 01       >	DEFW	#014A
1128+  BA53 3F          >	DEFB	CNT
1127+  BA54 4A 01       >	DEFW	#014A
1128+  BA56 47          >	DEFB	CNT
1127+  BA57 4A 01       >	DEFW	#014A
1128+  BA59 4F          >	DEFB	CNT
1127+  BA5A 4A 01       >	DEFW	#014A
1128+  BA5C 57          >	DEFB	CNT
1127+  BA5D 4A 01       >	DEFW	#014A
1128+  BA5F 5F          >	DEFB	CNT
1127+  BA60 4A 01       >	DEFW	#014A
1128+  BA62 67          >	DEFB	CNT
1127+  BA63 4A 01       >	DEFW	#014A
1128+  BA65 6F          >	DEFB	CNT
1127+  BA66 4A 01       >	DEFW	#014A
1128+  BA68 77          >	DEFB	CNT
1127+  BA69 4A 01       >	DEFW	#014A
1128+  BA6B 7F          >	DEFB	CNT
1127+  BA6C 4A 01       >	DEFW	#014A
1128+  BA6E 87          >	DEFB	CNT
1127+  BA6F 4A 01       >	DEFW	#014A
1128+  BA71 8F          >	DEFB	CNT
1127+  BA72 4A 01       >	DEFW	#014A
1128+  BA74 97          >	DEFB	CNT
1127+  BA75 4A 01       >	DEFW	#014A
1128+  BA77 9F          >	DEFB	CNT
1127+  BA78 4A 01       >	DEFW	#014A
1128+  BA7A A7          >	DEFB	CNT
1127+  BA7B 4A 01       >	DEFW	#014A
1128+  BA7D AF          >	DEFB	CNT
1127+  BA7E 4A 01       >	DEFW	#014A
1128+  BA80 B7          >	DEFB	CNT
1127+  BA81 4A 01       >	DEFW	#014A
1128+  BA83 BF          >	DEFB	CNT
1131+  BA84             CNT=#3F
1132+  BA84             	DUP     #11
1133+  BA84 B2 01       >	DEFW	#01B2
1134+  BA86 3F          >	DEFB	CNT
1133+  BA87 B2 01       >	DEFW	#01B2
1134+  BA89 47          >	DEFB	CNT
1133+  BA8A B2 01       >	DEFW	#01B2
1134+  BA8C 4F          >	DEFB	CNT
1133+  BA8D B2 01       >	DEFW	#01B2
1134+  BA8F 57          >	DEFB	CNT
1133+  BA90 B2 01       >	DEFW	#01B2
1134+  BA92 5F          >	DEFB	CNT
1133+  BA93 B2 01       >	DEFW	#01B2
1134+  BA95 67          >	DEFB	CNT
1133+  BA96 B2 01       >	DEFW	#01B2
1134+  BA98 6F          >	DEFB	CNT
1133+  BA99 B2 01       >	DEFW	#01B2
1134+  BA9B 77          >	DEFB	CNT
1133+  BA9C B2 01       >	DEFW	#01B2
1134+  BA9E 7F          >	DEFB	CNT
1133+  BA9F B2 01       >	DEFW	#01B2
1134+  BAA1 87          >	DEFB	CNT
1133+  BAA2 B2 01       >	DEFW	#01B2
1134+  BAA4 8F          >	DEFB	CNT
1133+  BAA5 B2 01       >	DEFW	#01B2
1134+  BAA7 97          >	DEFB	CNT
1133+  BAA8 B2 01       >	DEFW	#01B2
1134+  BAAA 9F          >	DEFB	CNT
1133+  BAAB B2 01       >	DEFW	#01B2
1134+  BAAD A7          >	DEFB	CNT
1133+  BAAE B2 01       >	DEFW	#01B2
1134+  BAB0 AF          >	DEFB	CNT
1133+  BAB1 B2 01       >	DEFW	#01B2
1134+  BAB3 B7          >	DEFB	CNT
1133+  BAB4 B2 01       >	DEFW	#01B2
1134+  BAB6 BF          >	DEFB	CNT
1137+  BAB7             CNT=#3F
1138+  BAB7             	DUP     #11
1139+  BAB7 1A 02       >	DEFW	#021A
1140+  BAB9 3F          >	DEFB	CNT
1139+  BABA 1A 02       >	DEFW	#021A
1140+  BABC 47          >	DEFB	CNT
1139+  BABD 1A 02       >	DEFW	#021A
1140+  BABF 4F          >	DEFB	CNT
1139+  BAC0 1A 02       >	DEFW	#021A
1140+  BAC2 57          >	DEFB	CNT
1139+  BAC3 1A 02       >	DEFW	#021A
1140+  BAC5 5F          >	DEFB	CNT
1139+  BAC6 1A 02       >	DEFW	#021A
1140+  BAC8 67          >	DEFB	CNT
1139+  BAC9 1A 02       >	DEFW	#021A
1140+  BACB 6F          >	DEFB	CNT
1139+  BACC 1A 02       >	DEFW	#021A
1140+  BACE 77          >	DEFB	CNT
1139+  BACF 1A 02       >	DEFW	#021A
1140+  BAD1 7F          >	DEFB	CNT
1139+  BAD2 1A 02       >	DEFW	#021A
1140+  BAD4 87          >	DEFB	CNT
1139+  BAD5 1A 02       >	DEFW	#021A
1140+  BAD7 8F          >	DEFB	CNT
1139+  BAD8 1A 02       >	DEFW	#021A
1140+  BADA 97          >	DEFB	CNT
1139+  BADB 1A 02       >	DEFW	#021A
1140+  BADD 9F          >	DEFB	CNT
1139+  BADE 1A 02       >	DEFW	#021A
1140+  BAE0 A7          >	DEFB	CNT
1139+  BAE1 1A 02       >	DEFW	#021A
1140+  BAE3 AF          >	DEFB	CNT
1139+  BAE4 1A 02       >	DEFW	#021A
1140+  BAE6 B7          >	DEFB	CNT
1139+  BAE7 1A 02       >	DEFW	#021A
1140+  BAE9 BF          >	DEFB	CNT
1143+  BAEA             ;[]----------------------------------------------------------[]
1144+  BAEA             SetInvert
1145+  BAEA FD CB 00 7E 	BIT	7,(IY+PanelFlg)
1146+  BAEE C8          	RET	Z
1147+  BAEF 26 9A       	LD	H,PanelCol*#10+FileCol
1148+  BAF1 2E 9B       	LD	L,PanelCol*#10+SFileCol
1149+  BAF3 06 56       	LD	B,InvPCol*#10+InvICol
1150+  BAF5 0E 5C       	LD	C,InvPCol*#10+InvSCol
1151+  BAF7 18 0D       	JR	PrnInvert
1152+  BAF9             ResInvert
1153+  BAF9 FD CB 00 7E 	BIT	7,(IY+PanelFlg)
1154+  BAFD C8          	RET	Z
1155+  BAFE 26 56       	LD	H,InvPCol*#10+InvICol
1156+  BB00 2E 5C       	LD	L,InvPCol*#10+InvSCol
1157+  BB02 06 9A       	LD	B,PanelCol*#10+FileCol
1158+  BB04 0E 9B       	LD	C,PanelCol*#10+SFileCol
1159+  BB06             PrnInvert
1160+  BB06 FD 7E 13    	LD	A,(IY+PanelEFl)
1161+  BB09 FD B6 14    	OR	(IY+PanelEFh)
1162+  BB0C C8          	RET	Z
1163+  BB0D FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1164+  BB11 C2 A2 BB    	JP	NZ,PrnTreeInv
1165+  BB14 E5          	PUSH	HL
1166+  BB15 DB A2       	IN	A,(PAGE1)
1167+  BB17 F5          	PUSH	AF
1168+  BB18 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1169+  BB1C 3A EE A7    	LD	A,(DIRpage1)
1170+  BB1F 28 03       	JR	Z,$+5
1171+  BB21 3A EF A7    	LD	A,(DIRpage2)
1172+  BB24 D3 A2       	OUT	(PAGE1),A
1173+  BB26 FD 6E 15    	LD	L,(IY+PanelFFl)
1174+  BB29 FD 66 16    	LD	H,(IY+PanelFFh)
1175+  BB2C FD 5E 17    	LD	E,(IY+PanelCFl)
1176+  BB2F FD 56 18    	LD	D,(IY+PanelCFh)
1177+  BB32 19          	ADD	HL,DE
1178+  BB33 29          	ADD	HL,HL
1179+  BB34 29          	ADD	HL,HL
1180+  BB35 29          	ADD	HL,HL
1181+  BB36 5D          	LD	E,L
1182+  BB37 54          	LD	D,H
1183+  BB38 29          	ADD	HL,HL
1184+  BB39 19          	ADD	HL,DE
1185+  BB3A CB F4       	SET	6,H
1186+  BB3C 5E          	LD	E,(HL)
1187+  BB3D F1          	POP	AF
1188+  BB3E D3 A2       	OUT	(PAGE1),A
1189+  BB40 E1          	POP	HL
1190+  BB41 7B          	LD	A,E
1191+  BB42 B7          	OR	A
1192+  BB43 58          	LD	E,B
1193+  BB44 54          	LD	D,H
1194+  BB45 28 02       	JR	Z,$+4
1195+  BB47 59          	LD	E,C
1196+  BB48 55          	LD	D,L
1197+  BB49 FD CB 01 46 	BIT	0,(IY+ViewFlg)
1198+  BB4D 20 2D       	JR	NZ,PrnInvertP
1199+  BB4F FD 6E 17    	LD	L,(IY+PanelCFl)
1200+  BB52 FD 66 18    	LD	H,(IY+PanelCFh)
1201+  BB55 4D          	LD	C,L
1202+  BB56 44          	LD	B,H
1203+  BB57 29          	ADD	HL,HL
1204+  BB58 09          	ADD	HL,BC
1205+  BB59 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1206+  BB5D 01 B8 B9    	LD	BC,PositTAB1
1207+  BB60 28 03       	JR	Z,$+5
1208+  BB62 01 51 BA    	LD	BC,PositTAB2
1209+  BB65 09          	ADD	HL,BC
1210+  BB66 D5          	PUSH	DE
1211+  BB67 5E          	LD	E,(HL)
1212+  BB68 23          	INC	HL
1213+  BB69 56          	LD	D,(HL)
1214+  BB6A 23          	INC	HL
1215+  BB6B 4E          	LD	C,(HL)
1216+  BB6C 06 00       	LD	B,#00
1217+  BB6E EB          	EX	DE,HL
1218+  BB6F D1          	POP	DE
1219+  BB70 DD 2E 30    	LD	LX,#30
1220+  BB73 DD 26 08    	LD	HX,#08
1221+  BB76 2B          	DEC	HL
1222+  BB77 2B          	DEC	HL
1223+  BB78 CD A3 8D    	CALL	InvertRectan
1224+  BB7B C9          	RET 
1225+  BB7C             PrnInvertP
1226+  BB7C FD 6E 17    	LD	L,(IY+PanelCFl)
1227+  BB7F FD 66 18    	LD	H,(IY+PanelCFh)
1228+  BB82 29          	ADD	HL,HL
1229+  BB83 29          	ADD	HL,HL
1230+  BB84 29          	ADD	HL,HL
1231+  BB85 01 3F 00    	LD	BC,#003F
1232+  BB88 09          	ADD	HL,BC
1233+  BB89 4D          	LD	C,L
1234+  BB8A 06 00       	LD	B,#00
1235+  BB8C FD CB 00 46 	BIT	0,(IY+PanelFlg)
1236+  BB90 21 06 00    	LD	HL,#0006
1237+  BB93 28 03       	JR	Z,$+5
1238+  BB95 21 46 01    	LD	HL,#0146
1239+  BB98 DD 2E 92    	LD	LX,#92
1240+  BB9B DD 26 08    	LD	HX,#08
1241+  BB9E CD A3 8D    	CALL	InvertRectan
1242+  BBA1 C9          	RET 
1243+  BBA2             PrnTreeInv
1244+  BBA2 E5          	PUSH	HL
1245+  BBA3 DB A2       	IN	A,(PAGE1)
1246+  BBA5 F5          	PUSH	AF
1247+  BBA6 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1248+  BBAA 3A EE A7    	LD	A,(DIRpage1)
1249+  BBAD 28 03       	JR	Z,$+5
1250+  BBAF 3A EF A7    	LD	A,(DIRpage2)
1251+  BBB2 D3 A2       	OUT	(PAGE1),A
1252+  BBB4 FD 6E 15    	LD	L,(IY+PanelFFl)
1253+  BBB7 FD 66 16    	LD	H,(IY+PanelFFh)
1254+  BBBA FD 5E 17    	LD	E,(IY+PanelCFl)
1255+  BBBD FD 56 18    	LD	D,(IY+PanelCFh)
1256+  BBC0 19          	ADD	HL,DE
1257+  BBC1 29          	ADD	HL,HL
1258+  BBC2 29          	ADD	HL,HL
1259+  BBC3 29          	ADD	HL,HL
1260+  BBC4 29          	ADD	HL,HL
1261+  BBC5 CB F4       	SET	6,H
1262+  BBC7 7E          	LD	A,(HL)
1263+  BBC8 08          	EX	AF,AF'
1264+  BBC9 23          	INC	HL
1265+  BBCA 7E          	LD	A,(HL)
1266+  BBCB DD 67       	LD	HX,A
1267+  BBCD DD 2E FF    	LD	LX,#FF
1268+  BBD0 DD 2C       	INC	LX
1269+  BBD2 23          	INC	HL
1270+  BBD3 7E          	LD	A,(HL)
1271+  BBD4 B7          	OR	A
1272+  BBD5 20 F9       	JR	NZ,$-5
1273+  BBD7 DD 7D       	LD	A,LX
1274+  BBD9 87          	ADD	A,A
1275+  BBDA 87          	ADD	A,A
1276+  BBDB DD 6F       	LD	LX,A
1277+  BBDD F1          	POP	AF
1278+  BBDE D3 A2       	OUT	(PAGE1),A
1279+  BBE0 E1          	POP	HL
1280+  BBE1 DD 7C       	LD	A,HX
1281+  BBE3 B7          	OR	A
1282+  BBE4 58          	LD	E,B
1283+  BBE5 54          	LD	D,H
1284+  BBE6 28 02       	JR	Z,$+4
1285+  BBE8 59          	LD	E,C
1286+  BBE9 55          	LD	D,L
1287+  BBEA FD 6E 17    	LD	L,(IY+PanelCFl)
1288+  BBED FD 66 18    	LD	H,(IY+PanelCFh)
1289+  BBF0 29          	ADD	HL,HL
1290+  BBF1 29          	ADD	HL,HL
1291+  BBF2 29          	ADD	HL,HL
1292+  BBF3 01 3F 00    	LD	BC,#003F
1293+  BBF6 09          	ADD	HL,BC
1294+  BBF7 4D          	LD	C,L
1295+  BBF8 06 00       	LD	B,#00
1296+  BBFA FD CB 00 46 	BIT	0,(IY+PanelFlg)
1297+  BBFE 21 12 00    	LD	HL,#0012
1298+  BC01 28 03       	JR	Z,$+5
1299+  BC03 21 52 01    	LD	HL,#0152
1300+  BC06 FD CB 01 56 	BIT	2,(IY+ViewFlg)
1301+  BC0A 28 0F       	JR	Z,PrTreeI
1302+  BC0C 08          	EX	AF,AF'
1303+  BC0D B7          	OR	A
1304+  BC0E 28 0C       	JR	Z,PrTreeI+1
1305+  BC10 08          	EX	AF,AF'
1306+  BC11 DD 7C       	LD	A,HX
1307+  BC13 B7          	OR	A
1308+  BC14 28 05       	JR	Z,PrTreeI
1309+  BC16 C5          	PUSH	BC
1310+  BC17 0E 08       	LD	C,#08
1311+  BC19 09          	ADD	HL,BC
1312+  BC1A C1          	POP	BC
1313+  BC1B 08          PrTreeI	EX	AF,AF'
1314+  BC1C C5          	PUSH	BC
1315+  BC1D E6 7F       	AND	#7F
1316+  BC1F 4F          	LD	C,A
1317+  BC20 CB 21       	SLA	C
1318+  BC22 CB 10       	RL	B
1319+  BC24 CB 21       	SLA	C
1320+  BC26 CB 10       	RL	B
1321+  BC28 CB 21       	SLA	C
1322+  BC2A CB 10       	RL	B
1323+  BC2C 09          	ADD	HL,BC
1324+  BC2D FD CB 01 56 	BIT	2,(IY+ViewFlg)
1325+  BC31 20 01       	JR	NZ,$+3
1326+  BC33 09          	ADD	HL,BC
1327+  BC34 C1          	POP	BC
1328+  BC35 DD 26 08    	LD	HX,#08
1329+  BC38 CD A3 8D    	CALL	InvertRectan
1330+  BC3B C9          	RET 
1331+  BC3C             
1332+  BC3C             
1333+  BC3C             
0271   BC3C             	include "fndos.z80"
0001+  BC3C             
0002+  BC3C             ;[]----------------------------------------------------------[]
0003+  BC3C             BegDIRECTORY
0004+  BC3C 21 21 AF    	LD	HL,BegDIR
0005+  BC3F             NewDIRECTORY
0006+  BC3F E5          	PUSH	HL
0007+  BC40 CD F9 BA    	CALL	ResInvert
0008+  BC43 E1          	POP	HL
0009+  BC44 CD 9C A0    	CALL	SetClock
0010+  BC47 0E 1D       	LD	C,#1D
0011+  BC49 FD E5       	PUSH	IY
0012+  BC4B D7          	RST	#10
0013+  BC4C FD E1       	POP	IY
0014+  BC4E DC A8 86    	CALL	C,DOSError
0015+  BC51 0E 02       	LD	C,#02
0016+  BC53 FD E5       	PUSH	IY
0017+  BC55 D7          	RST	#10
0018+  BC56 FD E1       	POP	IY
0019+  BC58 FD E5       	PUSH	IY
0020+  BC5A E1          	POP	HL
0021+  BC5B 11 2C 00    	LD	DE,BegPath
0022+  BC5E 19          	ADD	HL,DE
0023+  BC5F C6 41       	ADD	A,"A"
0024+  BC61 BE          	CP	(HL)
0025+  BC62 F5          	PUSH	AF
0026+  BC63 77          	LD	(HL),A
0027+  BC64 23          	INC	HL
0028+  BC65 36 3A       	LD	(HL),":"
0029+  BC67 23          	INC	HL
0030+  BC68 0E 1E       	LD	C,#1E
0031+  BC6A FD E5       	PUSH	IY
0032+  BC6C D7          	RST	#10
0033+  BC6D FD E1       	POP	IY
0034+  BC6F F1          	POP	AF
0035+  BC70 28 2A       	JR	Z,NewDIRECT1
0036+  BC72 3A E3 A7    	LD	A,(TreeFlag)
0037+  BC75 B7          	OR	A
0038+  BC76 CA 07 E8    	JP	Z,InitPanel
0039+  BC79 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0040+  BC7D C2 07 E8    	JP	NZ,InitPanel
0041+  BC80 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0042+  BC84 21 B6 A5    	LD	HL,LeftPanel+BegPath
0043+  BC87 11 E2 A6    	LD	DE,RightPanel+BegPath
0044+  BC8A 28 06       	JR	Z,NewDIR0
0045+  BC8C 21 E2 A6    	LD	HL,RightPanel+BegPath
0046+  BC8F 11 B6 A5    	LD	DE,LeftPanel+BegPath
0047+  BC92 97          NewDIR0	SUB	A
0048+  BC93 ED A0       	LDI 
0049+  BC95 BE          	CP	(HL)
0050+  BC96 20 FB       	JR	NZ,$-3
0051+  BC98 12          	LD	(DE),A
0052+  BC99 C3 C3 E7    	JP	InitPanels
0053+  BC9C             NewDIRECT1
0054+  BC9C FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0055+  BCA0 F5          	PUSH	AF
0056+  BCA1 C4 D8 BC    	CALL	NZ,NewDIRTree
0057+  BCA4 F1          	POP	AF
0058+  BCA5 CC F5 A7    	CALL	Z,ReadDIR
0059+  BCA8 CD 38 B2    	CALL	PrintPath
0060+  BCAB FD CB 00 7E 	BIT	7,(IY+PanelFlg)
0061+  BCAF C4 AE B2    	CALL	NZ,PrintDOSPath
0062+  BCB2 CD 45 B5    	CALL	PrintDIR
0063+  BCB5 CD EA BA    	CALL	SetInvert
0064+  BCB8 CD EE B2    	CALL	PrnFileInfo
0065+  BCBB FD E5       	PUSH	IY
0066+  BCBD DD E1       	POP	IX
0067+  BCBF 11 05 00    	LD	DE,BegPBar
0068+  BCC2 DD 19       	ADD	IX,DE
0069+  BCC4 CD F7 96    	CALL	InitScrBar
0070+  BCC7 FD 7E 01    	LD	A,(IY+ViewFlg)
0071+  BCCA E6 03       	AND	#03
0072+  BCCC F5          	PUSH	AF
0073+  BCCD CC 35 97    	CALL	Z,PrnHScrBar
0074+  BCD0 F1          	POP	AF
0075+  BCD1 C4 8E 98    	CALL	NZ,PrnVScrBar
0076+  BCD4 CD 3C A1    	CALL	SetMouse
0077+  BCD7 C9          	RET 
0078+  BCD8             NewDIRTree
0079+  BCD8 FD E5       	PUSH	IY
0080+  BCDA E1          	POP	HL
0081+  BCDB 11 2C 00    	LD	DE,BegPath
0082+  BCDE 19          	ADD	HL,DE
0083+  BCDF 23          	INC	HL
0084+  BCE0 23          	INC	HL
0085+  BCE1 CD F0 B0    	CALL	FindTreeDIR
0086+  BCE4 CD 8A B0    	CALL	MakeTreePath
0087+  BCE7 FD E5       	PUSH	IY
0088+  BCE9 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0089+  BCED FD 21 B6 A6 	LD	IY,RightPanel
0090+  BCF1 28 04       	JR	Z,$+6
0091+  BCF3 FD 21 8A A5 	LD	IY,LeftPanel
0092+  BCF7 CD 3F BC    	CALL	NewDIRECTORY
0093+  BCFA FD E1       	POP	IY
0094+  BCFC C9          	RET 
0095+  BCFD             ;[]----------------------------------------------------------[]
0096+  BCFD             RefreshDIR
0097+  BCFD FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0098+  BD01 20 22       	JR	NZ,RfDIRn1
0099+  BD03 CD F5 A7    	CALL	ReadDIR
0100+  BD06 CD 45 B5    	CALL	PrintDIR
0101+  BD09 CD EE B2    	CALL	PrnFileInfo
0102+  BD0C FD E5       	PUSH	IY
0103+  BD0E DD E1       	POP	IX
0104+  BD10 11 05 00    	LD	DE,BegPBar
0105+  BD13 DD 19       	ADD	IX,DE
0106+  BD15 CD F7 96    	CALL	InitScrBar
0107+  BD18 FD 7E 01    	LD	A,(IY+ViewFlg)
0108+  BD1B E6 03       	AND	#03
0109+  BD1D F5          	PUSH	AF
0110+  BD1E CC 35 97    	CALL	Z,PrnHScrBar
0111+  BD21 F1          	POP	AF
0112+  BD22 C4 8E 98    	CALL	NZ,PrnVScrBar
0113+  BD25 21 B6 A5    RfDIRn1	LD	HL,LeftPanel+BegPath
0114+  BD28 11 E2 A6    	LD	DE,RightPanel+BegPath
0115+  BD2B 1A          RefrDIR	LD	A,(DE)
0116+  BD2C BE          	CP	(HL)
0117+  BD2D C0          	RET	NZ
0118+  BD2E 23          	INC	HL
0119+  BD2F 13          	INC	DE
0120+  BD30 7E          	LD	A,(HL)
0121+  BD31 B7          	OR	A
0122+  BD32 20 F7       	JR	NZ,RefrDIR
0123+  BD34 1A          	LD	A,(DE)
0124+  BD35 B7          	OR	A
0125+  BD36 C0          	RET	NZ
0126+  BD37 FD E5       	PUSH	IY
0127+  BD39 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0128+  BD3D FD 21 B6 A6 	LD	IY,RightPanel
0129+  BD41 28 04       	JR	Z,$+6
0130+  BD43 FD 21 8A A5 	LD	IY,LeftPanel
0131+  BD47 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0132+  BD4B 20 22       	JR	NZ,RefrDex
0133+  BD4D CD F5 A7    	CALL	ReadDIR
0134+  BD50 CD 45 B5    	CALL	PrintDIR
0135+  BD53 CD EE B2    	CALL	PrnFileInfo
0136+  BD56 FD E5       	PUSH	IY
0137+  BD58 DD E1       	POP	IX
0138+  BD5A 11 05 00    	LD	DE,BegPBar
0139+  BD5D DD 19       	ADD	IX,DE
0140+  BD5F CD F7 96    	CALL	InitScrBar
0141+  BD62 FD 7E 01    	LD	A,(IY+ViewFlg)
0142+  BD65 E6 03       	AND	#03
0143+  BD67 F5          	PUSH	AF
0144+  BD68 CC 35 97    	CALL	Z,PrnHScrBar
0145+  BD6B F1          	POP	AF
0146+  BD6C C4 8E 98    	CALL	NZ,PrnVScrBar
0147+  BD6F FD E1       RefrDex	POP	IY
0148+  BD71 C9          	RET 
0149+  BD72             ;[]----------------------------------------------------------[]
0150+  BD72             FindPrevFile
0151+  BD72 FD 7E 13    	LD	A,(IY+PanelEFl)
0152+  BD75 FD B6 14    	OR	(IY+PanelEFh)
0153+  BD78 C8          	RET	Z
0154+  BD79 FD CB 00 7E 	BIT	7,(IY+PanelFlg)
0155+  BD7D C8          	RET	Z
0156+  BD7E DB A2       	IN	A,(PAGE1)
0157+  BD80 F5          	PUSH	AF
0158+  BD81 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0159+  BD85 3A EE A7    	LD	A,(DIRpage1)
0160+  BD88 28 03       	JR	Z,$+5
0161+  BD8A 3A EF A7    	LD	A,(DIRpage2)
0162+  BD8D D3 A2       	OUT	(PAGE1),A
0163+  BD8F DD 21 00 40 	LD	IX,#4000
0164+  BD93 21 01 40    	LD	HL,#4001
0165+  BD96 01 00 00    	LD	BC,#0000
0166+  BD99             FndPrFile0
0167+  BD99 E5          	PUSH	HL
0168+  BD9A DD CB 0E 66 	BIT	4,(IX+#0E)
0169+  BD9E 20 18       	JR	NZ,FndPrFileNxt
0170+  BDA0 11 00 80    	LD	DE,WorkBuffer
0171+  BDA3 D5          	PUSH	DE
0172+  BDA4 C5          	PUSH	BC
0173+  BDA5 CD 6A BE    	CALL	MakeDOSname
0174+  BDA8 C1          	POP	BC
0175+  BDA9 E1          	POP	HL
0176+  BDAA 11 CD BD    	LD	DE,PrevFile
0177+  BDAD             FndPrFile1
0178+  BDAD 1A          	LD	A,(DE)
0179+  BDAE B7          	OR	A
0180+  BDAF 28 16       	JR	Z,FndPrFileE
0181+  BDB1 BE          	CP	(HL)
0182+  BDB2 20 04       	JR	NZ,FndPrFileNxt
0183+  BDB4 23          	INC	HL
0184+  BDB5 13          	INC	DE
0185+  BDB6 18 F5       	JR	FndPrFile1
0186+  BDB8             FndPrFileNxt
0187+  BDB8 E1          	POP	HL
0188+  BDB9 11 18 00    	LD	DE,#0018
0189+  BDBC 19          	ADD	HL,DE
0190+  BDBD DD 19       	ADD	IX,DE
0191+  BDBF 03          	INC	BC
0192+  BDC0 7E          	LD	A,(HL)
0193+  BDC1 B7          	OR	A
0194+  BDC2 20 D5       	JR	NZ,FndPrFile0
0195+  BDC4 C3 59 BE    	JP	FndTreeExt
0196+  BDC7             FndPrFileE
0197+  BDC7 7E          	LD	A,(HL)
0198+  BDC8 B7          	OR	A
0199+  BDC9 20 ED       	JR	NZ,FndPrFileNxt
0200+  BDCB 18 65       	JR	FndTree
0201+  BDCD             PrevFile
0202+  BDCD 00          	DEFS	13,0
0203+  BDDA             ;[]----------------------------------------------------------[]
0204+  BDDA             FindPrevDIR
0205+  BDDA FD 7E 13    	LD	A,(IY+PanelEFl)
0206+  BDDD FD B6 14    	OR	(IY+PanelEFh)
0207+  BDE0 C8          	RET	Z
0208+  BDE1 FD CB 00 7E 	BIT	7,(IY+PanelFlg)
0209+  BDE5 C8          	RET	Z
0210+  BDE6 DB A2       	IN	A,(PAGE1)
0211+  BDE8 F5          	PUSH	AF
0212+  BDE9 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0213+  BDED 3A EE A7    	LD	A,(DIRpage1)
0214+  BDF0 28 03       	JR	Z,$+5
0215+  BDF2 3A EF A7    	LD	A,(DIRpage2)
0216+  BDF5 D3 A2       	OUT	(PAGE1),A
0217+  BDF7 DD 21 00 40 	LD	IX,#4000
0218+  BDFB 21 01 40    	LD	HL,#4001
0219+  BDFE 01 00 00    	LD	BC,#0000
0220+  BE01             FndPrDIR0
0221+  BE01 E5          	PUSH	HL
0222+  BE02 DD CB 0E 66 	BIT	4,(IX+#0E)
0223+  BE06 28 18       	JR	Z,FndPrDIRnxt
0224+  BE08 11 00 80    	LD	DE,WorkBuffer
0225+  BE0B D5          	PUSH	DE
0226+  BE0C C5          	PUSH	BC
0227+  BE0D CD 6A BE    	CALL	MakeDOSname
0228+  BE10 C1          	POP	BC
0229+  BE11 E1          	POP	HL
0230+  BE12 11 5D BE    	LD	DE,PrevDIR
0231+  BE15             FndPrDIR1
0232+  BE15 1A          	LD	A,(DE)
0233+  BE16 B7          	OR	A
0234+  BE17 28 15       	JR	Z,FndPrDIRe
0235+  BE19 BE          	CP	(HL)
0236+  BE1A 20 04       	JR	NZ,FndPrDIRnxt
0237+  BE1C 23          	INC	HL
0238+  BE1D 13          	INC	DE
0239+  BE1E 18 F5       	JR	FndPrDIR1
0240+  BE20             FndPrDIRnxt
0241+  BE20 E1          	POP	HL
0242+  BE21 11 18 00    	LD	DE,#0018
0243+  BE24 19          	ADD	HL,DE
0244+  BE25 DD 19       	ADD	IX,DE
0245+  BE27 03          	INC	BC
0246+  BE28 7E          	LD	A,(HL)
0247+  BE29 B7          	OR	A
0248+  BE2A 20 D5       	JR	NZ,FndPrDIR0
0249+  BE2C 18 2B       	JR	FndTreeExt
0250+  BE2E             FndPrDIRe
0251+  BE2E 7E          	LD	A,(HL)
0252+  BE2F B7          	OR	A
0253+  BE30 20 EE       	JR	NZ,FndPrDIRnxt
0254+  BE32 33          FndTree	INC	SP
0255+  BE33 33          	INC	SP
0256+  BE34 69          	LD	L,C
0257+  BE35 60          	LD	H,B
0258+  BE36 FD 4E 11    	LD	C,(IY+PanelFPl)
0259+  BE39 FD 46 12    	LD	B,(IY+PanelFPh)
0260+  BE3C 11 00 00    	LD	DE,#0000
0261+  BE3F EB          	EX	DE,HL
0262+  BE40 B7          	OR	A
0263+  BE41 ED 42       	SBC	HL,BC
0264+  BE43 EB          	EX	DE,HL
0265+  BE44 EB          	EX	DE,HL
0266+  BE45 09          	ADD	HL,BC
0267+  BE46 EB          	EX	DE,HL
0268+  BE47 B7          	OR	A
0269+  BE48 ED 42       	SBC	HL,BC
0270+  BE4A 30 F8       	JR	NC,$-6
0271+  BE4C 09          	ADD	HL,BC
0272+  BE4D FD 75 17    	LD	(IY+PanelCFl),L
0273+  BE50 FD 74 18    	LD	(IY+PanelCFh),H
0274+  BE53 FD 73 15    	LD	(IY+PanelFFl),E
0275+  BE56 FD 72 16    	LD	(IY+PanelFFh),D
0276+  BE59             FndTreeExt
0277+  BE59 F1          	POP	AF
0278+  BE5A D3 A2       	OUT	(PAGE1),A
0279+  BE5C C9          	RET 
0280+  BE5D             PrevDIR
0281+  BE5D 00          	DEFS	13,0
0282+  BE6A             ;[]----------------------------------------------------------[]
0283+  BE6A             MakeDOSname
0284+  BE6A 01 20 08    	LD	BC,#0820
0285+  BE6D 7E          MDN0	LD	A,(HL)
0286+  BE6E B9          	CP	C
0287+  BE6F 28 05       	JR	Z,MDN1
0288+  BE71 23          	INC	HL
0289+  BE72 12          	LD	(DE),A
0290+  BE73 13          	INC	DE
0291+  BE74 10 F7       	DJNZ	MDN0
0292+  BE76 78          MDN1	LD	A,B
0293+  BE77 B7          	OR	A
0294+  BE78 28 03       	JR	Z,$+5
0295+  BE7A 23          	INC	HL
0296+  BE7B 10 FD       	DJNZ	$-1
0297+  BE7D 06 03       	LD	B,#03
0298+  BE7F 23          	INC	HL
0299+  BE80 7E          MDN2	LD	A,(HL)
0300+  BE81 B9          	CP	C
0301+  BE82 28 0A       	JR	Z,MDNe
0302+  BE84 3E 2E       	LD	A,"."
0303+  BE86 12          	LD	(DE),A
0304+  BE87 13          	INC	DE
0305+  BE88 7E          MDN3	LD	A,(HL)
0306+  BE89 23          	INC	HL
0307+  BE8A 12          	LD	(DE),A
0308+  BE8B 13          	INC	DE
0309+  BE8C 10 FA       	DJNZ	MDN3
0310+  BE8E 97          MDNe	SUB	A
0311+  BE8F 12          	LD	(DE),A
0312+  BE90 C9          	RET 
0313+  BE91             
0314+  BE91             
0315+  BE91             
0316+  BE91             
0317+  BE91             
0272   BE91             	include "fnwork.z80"
0001+  BE91             
0002+  BE91             ;[]===========================================================[]
0003+  BE91             CursUp
0004+  BE91 FD 7E 13    	LD	A,(IY+PanelEFl)
0005+  BE94 FD B6 14    	OR	(IY+PanelEFh)
0006+  BE97 C8          	RET	Z
0007+  BE98 FD 6E 17    	LD	L,(IY+PanelCFl)
0008+  BE9B FD 66 18    	LD	H,(IY+PanelCFh)
0009+  BE9E 7C          	LD	A,H
0010+  BE9F B5          	OR	L
0011+  BEA0 20 09       	JR	NZ,CursUp1
0012+  BEA2 FD 7E 15    	LD	A,(IY+PanelFFl)
0013+  BEA5 FD B6 16    	OR	(IY+PanelFFh)
0014+  BEA8 C8          	RET	Z
0015+  BEA9 18 21       	JR	ScrlDn1
0016+  BEAB 2B          CursUp1	DEC	HL
0017+  BEAC E5          	PUSH	HL
0018+  BEAD CD F9 BA    	CALL	ResInvert
0019+  BEB0 E1          	POP	HL
0020+  BEB1 FD 75 17    	LD	(IY+PanelCFl),L
0021+  BEB4 FD 74 18    	LD	(IY+PanelCFh),H
0022+  BEB7 CD EA BA    	CALL	SetInvert
0023+  BEBA CD EE B2    	CALL	PrnFileInfo
0024+  BEBD C9          	RET 
0025+  BEBE             ScrollDown
0026+  BEBE FD 7E 13    	LD	A,(IY+PanelEFl)
0027+  BEC1 FD B6 14    	OR	(IY+PanelEFh)
0028+  BEC4 C8          	RET	Z
0029+  BEC5 FD 7E 15    	LD	A,(IY+PanelFFl)
0030+  BEC8 FD B6 16    	OR	(IY+PanelFFh)
0031+  BECB C8          	RET	Z
0032+  BECC FD CB 01 46 ScrlDn1	BIT	0,(IY+ViewFlg)
0033+  BED0 C2 E6 BF    	JP	NZ,ScrlDnP
0034+  BED3 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0035+  BED7 C2 9C C0    	JP	NZ,ScrlDnT
0036+  BEDA DB A2       	IN	A,(PAGE1)
0037+  BEDC F5          	PUSH	AF
0038+  BEDD FD CB 00 46 	BIT	0,(IY+PanelFlg)
0039+  BEE1 3A EE A7    	LD	A,(DIRpage1)
0040+  BEE4 28 03       	JR	Z,$+5
0041+  BEE6 3A EF A7    	LD	A,(DIRpage2)
0042+  BEE9 D3 A2       	OUT	(PAGE1),A
0043+  BEEB FD 6E 13    	LD	L,(IY+PanelEFl)
0044+  BEEE FD 66 14    	LD	H,(IY+PanelEFh)
0045+  BEF1 29          	ADD	HL,HL
0046+  BEF2 29          	ADD	HL,HL
0047+  BEF3 29          	ADD	HL,HL
0048+  BEF4 5D          	LD	E,L
0049+  BEF5 54          	LD	D,H
0050+  BEF6 29          	ADD	HL,HL
0051+  BEF7 19          	ADD	HL,DE
0052+  BEF8 CB F4       	SET	6,H
0053+  BEFA E5          	PUSH	HL
0054+  BEFB DD E1       	POP	IX
0055+  BEFD FD 6E 15    	LD	L,(IY+PanelFFl)
0056+  BF00 FD 66 16    	LD	H,(IY+PanelFFh)
0057+  BF03 2B          	DEC	HL
0058+  BF04 29          	ADD	HL,HL
0059+  BF05 29          	ADD	HL,HL
0060+  BF06 29          	ADD	HL,HL
0061+  BF07 5D          	LD	E,L
0062+  BF08 54          	LD	D,H
0063+  BF09 29          	ADD	HL,HL
0064+  BF0A 19          	ADD	HL,DE
0065+  BF0B CB F4       	SET	6,H
0066+  BF0D 11 00 80    	LD	DE,WorkBuffer
0067+  BF10 01 0E 00    	LD	BC,#000E
0068+  BF13 E5          	PUSH	HL
0069+  BF14 ED B0       	LDIR 
0070+  BF16 E1          	POP	HL
0071+  BF17 11 98 01    	LD	DE,#18*#11
0072+  BF1A 19          	ADD	HL,DE
0073+  BF1B DD 5D       	LD	E,LX
0074+  BF1D DD 54       	LD	D,HX
0075+  BF1F B7          	OR	A
0076+  BF20 ED 52       	SBC	HL,DE
0077+  BF22 19          	ADD	HL,DE
0078+  BF23 38 01       	JR	C,$+3
0079+  BF25 EB          	EX	DE,HL
0080+  BF26 11 10 80    	LD	DE,WorkBuffer+#10
0081+  BF29 0E 0E       	LD	C,#0E
0082+  BF2B E5          	PUSH	HL
0083+  BF2C ED B0       	LDIR 
0084+  BF2E E1          	POP	HL
0085+  BF2F 11 98 01    	LD	DE,#18*#11
0086+  BF32 19          	ADD	HL,DE
0087+  BF33 DD 5D       	LD	E,LX
0088+  BF35 DD 54       	LD	D,HX
0089+  BF37 B7          	OR	A
0090+  BF38 ED 52       	SBC	HL,DE
0091+  BF3A 19          	ADD	HL,DE
0092+  BF3B 38 01       	JR	C,$+3
0093+  BF3D EB          	EX	DE,HL
0094+  BF3E 11 20 80    	LD	DE,WorkBuffer+#20
0095+  BF41 0E 0E       	LD	C,#0E
0096+  BF43 ED B0       	LDIR 
0097+  BF45 F1          	POP	AF
0098+  BF46 D3 A2       	OUT	(PAGE1),A
0099+  BF48 06 9A       	LD	B,PanelCol*#10+FileCol
0100+  BF4A 0E 9B       	LD	C,PanelCol*#10+SFileCol
0101+  BF4C CD C0 B8    	CALL	InsPrnColor
0102+  BF4F CD F9 BA    	CALL	ResInvert
0103+  BF52 FD E5       	PUSH	IY
0104+  BF54 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0105+  BF56 4F          	LD	C,A
0106+  BF57 DB A2       	IN	A,(PAGE1)
0107+  BF59 47          	LD	B,A
0108+  BF5A C5          	PUSH	BC
0109+  BF5B 3E 50       	LD	A,#50
0110+  BF5D D3 A2       	OUT	(PAGE1),A
0111+  BF5F FD 6E 03    	LD	L,(IY+PanelXl)
0112+  BF62 FD 66 04    	LD	H,(IY+PanelXh)
0113+  BF65 11 06 00    	LD	DE,#0006
0114+  BF68 19          	ADD	HL,DE
0115+  BF69 16 3F       	LD	D,#3F
0116+  BF6B 1E 47       	LD	E,#3F+#08
0117+  BF6D 01 2E 80    	LD	BC,#802E
0118+  BF70 E5          	PUSH	HL
0119+  BF71 CD 04 C4    	CALL	ScrDIRDnUp
0120+  BF74 D1          	POP	DE
0121+  BF75 21 01 80    	LD	HL,WorkBuffer+#01
0122+  BF78 01 3F 0C    	LD	BC,#0C3F
0123+  BF7B 7E          	LD	A,(HL)
0124+  BF7C 2B          	DEC	HL
0125+  BF7D B7          	OR	A
0126+  BF7E D5          	PUSH	DE
0127+  BF7F C4 33 B9    	CALL	NZ,PrintName
0128+  BF82 E1          	POP	HL
0129+  BF83 11 68 00    	LD	DE,#0068
0130+  BF86 19          	ADD	HL,DE
0131+  BF87 16 3F       	LD	D,#3F
0132+  BF89 1E 47       	LD	E,#3F+#08
0133+  BF8B 01 2E 80    	LD	BC,#802E
0134+  BF8E E5          	PUSH	HL
0135+  BF8F CD 04 C4    	CALL	ScrDIRDnUp
0136+  BF92 D1          	POP	DE
0137+  BF93 21 11 80    	LD	HL,WorkBuffer+#11
0138+  BF96 01 3F 0C    	LD	BC,#0C3F
0139+  BF99 7E          	LD	A,(HL)
0140+  BF9A 2B          	DEC	HL
0141+  BF9B B7          	OR	A
0142+  BF9C D5          	PUSH	DE
0143+  BF9D C4 33 B9    	CALL	NZ,PrintName
0144+  BFA0 E1          	POP	HL
0145+  BFA1 11 68 00    	LD	DE,#0068
0146+  BFA4 19          	ADD	HL,DE
0147+  BFA5 16 3F       	LD	D,#3F
0148+  BFA7 1E 47       	LD	E,#3F+#08
0149+  BFA9 01 2E 80    	LD	BC,#802E
0150+  BFAC E5          	PUSH	HL
0151+  BFAD CD 04 C4    	CALL	ScrDIRDnUp
0152+  BFB0 D1          	POP	DE
0153+  BFB1 21 21 80    	LD	HL,WorkBuffer+#21
0154+  BFB4 01 3F 0C    	LD	BC,#0C3F
0155+  BFB7 7E          	LD	A,(HL)
0156+  BFB8 2B          	DEC	HL
0157+  BFB9 B7          	OR	A
0158+  BFBA C4 33 B9    	CALL	NZ,PrintName
0159+  BFBD C1          	POP	BC
0160+  BFBE 78          	LD	A,B
0161+  BFBF D3 A2       	OUT	(PAGE1),A
0162+  BFC1 79          	LD	A,C
0163+  BFC2 D3 89       	OUT	(YPORT),A
0164+  BFC4 FD E1       	POP	IY
0165+  BFC6 FD 6E 15    	LD	L,(IY+PanelFFl)
0166+  BFC9 FD 66 16    	LD	H,(IY+PanelFFh)
0167+  BFCC 2B          	DEC	HL
0168+  BFCD FD 75 15    	LD	(IY+PanelFFl),L
0169+  BFD0 FD 74 16    	LD	(IY+PanelFFh),H
0170+  BFD3 CD EA BA    	CALL	SetInvert
0171+  BFD6 CD EE B2    	CALL	PrnFileInfo
0172+  BFD9 FD E5       	PUSH	IY
0173+  BFDB DD E1       	POP	IX
0174+  BFDD 11 05 00    	LD	DE,BegPBar
0175+  BFE0 DD 19       	ADD	IX,DE
0176+  BFE2 CD 35 97    	CALL	PrnHScrBar
0177+  BFE5 C9          	RET 
0178+  BFE6             ScrlDnP
0179+  BFE6 DB A2       	IN	A,(PAGE1)
0180+  BFE8 F5          	PUSH	AF
0181+  BFE9 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0182+  BFED 3A EE A7    	LD	A,(DIRpage1)
0183+  BFF0 28 03       	JR	Z,$+5
0184+  BFF2 3A EF A7    	LD	A,(DIRpage2)
0185+  BFF5 D3 A2       	OUT	(PAGE1),A
0186+  BFF7 FD 6E 15    	LD	L,(IY+PanelFFl)
0187+  BFFA FD 66 16    	LD	H,(IY+PanelFFh)
0188+  BFFD 2B          	DEC	HL
0189+  BFFE 29          	ADD	HL,HL
0190+  BFFF 29          	ADD	HL,HL
0191+  C000 29          	ADD	HL,HL
0192+  C001 5D          	LD	E,L
0193+  C002 54          	LD	D,H
0194+  C003 29          	ADD	HL,HL
0195+  C004 19          	ADD	HL,DE
0196+  C005 CB F4       	SET	6,H
0197+  C007 11 00 80    	LD	DE,WorkBuffer
0198+  C00A 01 18 00    	LD	BC,#0018
0199+  C00D ED B0       	LDIR 
0200+  C00F F1          	POP	AF
0201+  C010 D3 A2       	OUT	(PAGE1),A
0202+  C012 DD 21 00 80 	LD	IX,WorkBuffer
0203+  C016 21 00 80    	LD	HL,WorkBuffer
0204+  C019 11 00 82    	LD	DE,WorkBuffer+#200
0205+  C01C 01 0D 00    	LD	BC,#000D
0206+  C01F ED B0       	LDIR 
0207+  C021 3E 01       	LD	A,#01
0208+  C023 12          	LD	(DE),A
0209+  C024 13          	INC	DE
0210+  C025 DD CB 0E 66 	BIT	4,(IX+#0E)
0211+  C029 C4 F2 B6    	CALL	NZ,PutDIRTxt
0212+  C02C CC A1 B3    	CALL	Z,GetFileLen
0213+  C02F 3E 01       	LD	A,#01
0214+  C031 12          	LD	(DE),A
0215+  C032 13          	INC	DE
0216+  C033 CD 67 B4    	CALL	GetData
0217+  C036 3E 01       	LD	A,#01
0218+  C038 12          	LD	(DE),A
0219+  C039 13          	INC	DE
0220+  C03A CD 82 B4    	CALL	GetTime
0221+  C03D 06 9A       	LD	B,PanelCol*#10+FileCol
0222+  C03F 0E 9B       	LD	C,PanelCol*#10+SFileCol
0223+  C041 CD C0 B8    	CALL	InsPrnColor
0224+  C044 CD F9 BA    	CALL	ResInvert
0225+  C047 FD E5       	PUSH	IY
0226+  C049 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0227+  C04B 4F          	LD	C,A
0228+  C04C DB A2       	IN	A,(PAGE1)
0229+  C04E 47          	LD	B,A
0230+  C04F C5          	PUSH	BC
0231+  C050 3E 50       	LD	A,#50
0232+  C052 D3 A2       	OUT	(PAGE1),A
0233+  C054 FD 6E 03    	LD	L,(IY+PanelXl)
0234+  C057 FD 66 04    	LD	H,(IY+PanelXh)
0235+  C05A 11 04 00    	LD	DE,#0004
0236+  C05D 19          	ADD	HL,DE
0237+  C05E 16 3F       	LD	D,#3F
0238+  C060 1E 47       	LD	E,#3F+#08
0239+  C062 01 90 88    	LD	BC,#8890
0240+  C065 E5          	PUSH	HL
0241+  C066 CD 04 C4    	CALL	ScrDIRDnUp
0242+  C069 D1          	POP	DE
0243+  C06A 21 00 82    	LD	HL,WorkBuffer+#200
0244+  C06D 01 3F 26    	LD	BC,#263F
0245+  C070 CD 33 B9    	CALL	PrintName
0246+  C073 C1          	POP	BC
0247+  C074 78          	LD	A,B
0248+  C075 D3 A2       	OUT	(PAGE1),A
0249+  C077 79          	LD	A,C
0250+  C078 D3 89       	OUT	(YPORT),A
0251+  C07A FD E1       	POP	IY
0252+  C07C FD 6E 15    	LD	L,(IY+PanelFFl)
0253+  C07F FD 66 16    	LD	H,(IY+PanelFFh)
0254+  C082 2B          	DEC	HL
0255+  C083 FD 75 15    	LD	(IY+PanelFFl),L
0256+  C086 FD 74 16    	LD	(IY+PanelFFh),H
0257+  C089 CD EA BA    	CALL	SetInvert
0258+  C08C CD EE B2    	CALL	PrnFileInfo
0259+  C08F FD E5       	PUSH	IY
0260+  C091 DD E1       	POP	IX
0261+  C093 11 05 00    	LD	DE,BegPBar
0262+  C096 DD 19       	ADD	IX,DE
0263+  C098 CD 8E 98    	CALL	PrnVScrBar
0264+  C09B C9          	RET 
0265+  C09C             ScrlDnT
0266+  C09C DB A2       	IN	A,(PAGE1)
0267+  C09E F5          	PUSH	AF
0268+  C09F FD CB 00 46 	BIT	0,(IY+PanelFlg)
0269+  C0A3 3A EE A7    	LD	A,(DIRpage1)
0270+  C0A6 28 03       	JR	Z,$+5
0271+  C0A8 3A EF A7    	LD	A,(DIRpage2)
0272+  C0AB D3 A2       	OUT	(PAGE1),A
0273+  C0AD 21 00 80    	LD	HL,WorkBuffer
0274+  C0B0 06 18       	LD	B,#18
0275+  C0B2 3E 80       	LD	A,#80
0276+  C0B4 E5          	PUSH	HL
0277+  C0B5 77          	LD	(HL),A
0278+  C0B6 2C          	INC	L
0279+  C0B7 10 FC       	DJNZ	$-2
0280+  C0B9 D1          	POP	DE
0281+  C0BA 21 00 40    	LD	HL,#4000
0282+  C0BD FD 4E 15    	LD	C,(IY+PanelFFl)
0283+  C0C0 FD 46 16    	LD	B,(IY+PanelFFh)
0284+  C0C3 0B          	DEC	BC
0285+  C0C4 78          	LD	A,B
0286+  C0C5 B1          	OR	C
0287+  C0C6 28 11       	JR	Z,ScrDdn2
0288+  C0C8 C5          ScrDdn1	PUSH	BC
0289+  C0C9 7E          	LD	A,(HL)
0290+  C0CA E6 7F       	AND	#7F
0291+  C0CC 5F          	LD	E,A
0292+  C0CD 7E          	LD	A,(HL)
0293+  C0CE 12          	LD	(DE),A
0294+  C0CF 01 10 00    	LD	BC,#0010
0295+  C0D2 09          	ADD	HL,BC
0296+  C0D3 C1          	POP	BC
0297+  C0D4 0B          	DEC	BC
0298+  C0D5 78          	LD	A,B
0299+  C0D6 B1          	OR	C
0300+  C0D7 20 EF       	JR	NZ,ScrDdn1
0301+  C0D9 11 00 81    ScrDdn2	LD	DE,WorkBuffer+#100
0302+  C0DC 01 10 00    	LD	BC,#0010
0303+  C0DF ED B0       	LDIR 
0304+  C0E1 F1          	POP	AF
0305+  C0E2 D3 A2       	OUT	(PAGE1),A
0306+  C0E4 21 00 81    	LD	HL,WorkBuffer+#100
0307+  C0E7 11 00 82    	LD	DE,WorkBuffer+#200
0308+  C0EA CD 02 B8    	CALL	MakeTreeLine
0309+  C0ED 06 9A       	LD	B,PanelCol*#10+FileCol
0310+  C0EF 0E 9B       	LD	C,PanelCol*#10+SFileCol
0311+  C0F1 CD C0 B8    	CALL	InsPrnColor
0312+  C0F4 CD F9 BA    	CALL	ResInvert
0313+  C0F7 FD E5       	PUSH	IY
0314+  C0F9 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0315+  C0FB 4F          	LD	C,A
0316+  C0FC DB A2       	IN	A,(PAGE1)
0317+  C0FE 47          	LD	B,A
0318+  C0FF C5          	PUSH	BC
0319+  C100 3E 50       	LD	A,#50
0320+  C102 D3 A2       	OUT	(PAGE1),A
0321+  C104 FD 6E 03    	LD	L,(IY+PanelXl)
0322+  C107 FD 66 04    	LD	H,(IY+PanelXh)
0323+  C10A 11 06 00    	LD	DE,#0006
0324+  C10D 19          	ADD	HL,DE
0325+  C10E 16 3F       	LD	D,#3F
0326+  C110 1E 47       	LD	E,#3F+#08
0327+  C112 01 90 88    	LD	BC,#8890
0328+  C115 E5          	PUSH	HL
0329+  C116 CD 04 C4    	CALL	ScrDIRDnUp
0330+  C119 D1          	POP	DE
0331+  C11A 21 00 82    	LD	HL,WorkBuffer+#200
0332+  C11D 01 3F 24    	LD	BC,#243F
0333+  C120 CD 33 B9    	CALL	PrintName
0334+  C123 C1          	POP	BC
0335+  C124 78          	LD	A,B
0336+  C125 D3 A2       	OUT	(PAGE1),A
0337+  C127 79          	LD	A,C
0338+  C128 D3 89       	OUT	(YPORT),A
0339+  C12A FD E1       	POP	IY
0340+  C12C FD 6E 15    	LD	L,(IY+PanelFFl)
0341+  C12F FD 66 16    	LD	H,(IY+PanelFFh)
0342+  C132 2B          	DEC	HL
0343+  C133 FD 75 15    	LD	(IY+PanelFFl),L
0344+  C136 FD 74 16    	LD	(IY+PanelFFh),H
0345+  C139 CD EA BA    	CALL	SetInvert
0346+  C13C CD EE B2    	CALL	PrnFileInfo
0347+  C13F FD E5       	PUSH	IY
0348+  C141 DD E1       	POP	IX
0349+  C143 11 05 00    	LD	DE,BegPBar
0350+  C146 DD 19       	ADD	IX,DE
0351+  C148 CD 8E 98    	CALL	PrnVScrBar
0352+  C14B C9          	RET 
0353+  C14C             ;[]===========================================================[]
0354+  C14C             CursDown
0355+  C14C FD 4E 13    	LD	C,(IY+PanelEFl)
0356+  C14F FD 46 14    	LD	B,(IY+PanelEFh)
0357+  C152 78          	LD	A,B
0358+  C153 B1          	OR	C
0359+  C154 C8          	RET	Z
0360+  C155 FD 6E 17    	LD	L,(IY+PanelCFl)
0361+  C158 FD 66 18    	LD	H,(IY+PanelCFh)
0362+  C15B 23          	INC	HL
0363+  C15C E5          	PUSH	HL
0364+  C15D FD 5E 15    	LD	E,(IY+PanelFFl)
0365+  C160 FD 56 16    	LD	D,(IY+PanelFFh)
0366+  C163 19          	ADD	HL,DE
0367+  C164 B7          	OR	A
0368+  C165 ED 42       	SBC	HL,BC
0369+  C167 E1          	POP	HL
0370+  C168 D0          	RET	NC
0371+  C169 FD 5E 11    	LD	E,(IY+PanelFPl)
0372+  C16C FD 56 12    	LD	D,(IY+PanelFPh)
0373+  C16F B7          	OR	A
0374+  C170 ED 52       	SBC	HL,DE
0375+  C172 30 31       	JR	NC,ScrlUp1
0376+  C174 19          	ADD	HL,DE
0377+  C175 E5          	PUSH	HL
0378+  C176 CD F9 BA    	CALL	ResInvert
0379+  C179 E1          	POP	HL
0380+  C17A FD 75 17    	LD	(IY+PanelCFl),L
0381+  C17D FD 74 18    	LD	(IY+PanelCFh),H
0382+  C180 CD EA BA    	CALL	SetInvert
0383+  C183 CD EE B2    	CALL	PrnFileInfo
0384+  C186 C9          	RET 
0385+  C187             ScrollUp
0386+  C187 FD 7E 13    	LD	A,(IY+PanelEFl)
0387+  C18A FD B6 14    	OR	(IY+PanelEFh)
0388+  C18D C8          	RET	Z
0389+  C18E FD 6E 15    	LD	L,(IY+PanelFFl)
0390+  C191 FD 66 16    	LD	H,(IY+PanelFFh)
0391+  C194 FD 5E 11    	LD	E,(IY+PanelFPl)
0392+  C197 FD 56 12    	LD	D,(IY+PanelFPh)
0393+  C19A 19          	ADD	HL,DE
0394+  C19B FD 5E 13    	LD	E,(IY+PanelEFl)
0395+  C19E FD 56 14    	LD	D,(IY+PanelEFh)
0396+  C1A1 B7          	OR	A
0397+  C1A2 ED 52       	SBC	HL,DE
0398+  C1A4 D0          	RET	NC
0399+  C1A5 FD CB 01 46 ScrlUp1	BIT	0,(IY+ViewFlg)
0400+  C1A9 C2 9A C2    	JP	NZ,ScrlUpP
0401+  C1AC FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0402+  C1B0 C2 53 C3    	JP	NZ,ScrlUpT
0403+  C1B3 DB A2       	IN	A,(PAGE1)
0404+  C1B5 F5          	PUSH	AF
0405+  C1B6 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0406+  C1BA 3A EE A7    	LD	A,(DIRpage1)
0407+  C1BD 28 03       	JR	Z,$+5
0408+  C1BF 3A EF A7    	LD	A,(DIRpage2)
0409+  C1C2 D3 A2       	OUT	(PAGE1),A
0410+  C1C4 FD 6E 15    	LD	L,(IY+PanelFFl)
0411+  C1C7 FD 66 16    	LD	H,(IY+PanelFFh)
0412+  C1CA 11 11 00    	LD	DE,#0011
0413+  C1CD 19          	ADD	HL,DE
0414+  C1CE 29          	ADD	HL,HL
0415+  C1CF 29          	ADD	HL,HL
0416+  C1D0 29          	ADD	HL,HL
0417+  C1D1 5D          	LD	E,L
0418+  C1D2 54          	LD	D,H
0419+  C1D3 29          	ADD	HL,HL
0420+  C1D4 19          	ADD	HL,DE
0421+  C1D5 CB F4       	SET	6,H
0422+  C1D7 11 00 80    	LD	DE,WorkBuffer
0423+  C1DA 01 0E 00    	LD	BC,#000E
0424+  C1DD E5          	PUSH	HL
0425+  C1DE ED B0       	LDIR 
0426+  C1E0 E1          	POP	HL
0427+  C1E1 11 98 01    	LD	DE,#18*#11
0428+  C1E4 19          	ADD	HL,DE
0429+  C1E5 11 10 80    	LD	DE,WorkBuffer+#10
0430+  C1E8 0E 0E       	LD	C,#0E
0431+  C1EA E5          	PUSH	HL
0432+  C1EB ED B0       	LDIR 
0433+  C1ED E1          	POP	HL
0434+  C1EE 11 98 01    	LD	DE,#18*#11
0435+  C1F1 19          	ADD	HL,DE
0436+  C1F2 11 20 80    	LD	DE,WorkBuffer+#20
0437+  C1F5 0E 0E       	LD	C,#0E
0438+  C1F7 ED B0       	LDIR 
0439+  C1F9 F1          	POP	AF
0440+  C1FA D3 A2       	OUT	(PAGE1),A
0441+  C1FC 06 9A       	LD	B,PanelCol*#10+FileCol
0442+  C1FE 0E 9B       	LD	C,PanelCol*#10+SFileCol
0443+  C200 CD C0 B8    	CALL	InsPrnColor
0444+  C203 CD F9 BA    	CALL	ResInvert
0445+  C206 FD E5       	PUSH	IY
0446+  C208 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0447+  C20A 4F          	LD	C,A
0448+  C20B DB A2       	IN	A,(PAGE1)
0449+  C20D 47          	LD	B,A
0450+  C20E C5          	PUSH	BC
0451+  C20F 3E 50       	LD	A,#50
0452+  C211 D3 A2       	OUT	(PAGE1),A
0453+  C213 FD 6E 03    	LD	L,(IY+PanelXl)
0454+  C216 FD 66 04    	LD	H,(IY+PanelXh)
0455+  C219 11 06 00    	LD	DE,#0006
0456+  C21C 19          	ADD	HL,DE
0457+  C21D 16 47       	LD	D,#3F+#08
0458+  C21F 1E 3F       	LD	E,#3F
0459+  C221 01 2E 80    	LD	BC,#802E
0460+  C224 E5          	PUSH	HL
0461+  C225 CD 04 C4    	CALL	ScrDIRDnUp
0462+  C228 D1          	POP	DE
0463+  C229 21 01 80    	LD	HL,WorkBuffer+#01
0464+  C22C 01 BF 0C    	LD	BC,#0CBF
0465+  C22F 7E          	LD	A,(HL)
0466+  C230 2B          	DEC	HL
0467+  C231 B7          	OR	A
0468+  C232 D5          	PUSH	DE
0469+  C233 C4 33 B9    	CALL	NZ,PrintName
0470+  C236 E1          	POP	HL
0471+  C237 11 68 00    	LD	DE,#0068
0472+  C23A 19          	ADD	HL,DE
0473+  C23B 16 47       	LD	D,#3F+#08
0474+  C23D 1E 3F       	LD	E,#3F
0475+  C23F 01 2E 80    	LD	BC,#802E
0476+  C242 E5          	PUSH	HL
0477+  C243 CD 04 C4    	CALL	ScrDIRDnUp
0478+  C246 D1          	POP	DE
0479+  C247 21 11 80    	LD	HL,WorkBuffer+#11
0480+  C24A 01 BF 0C    	LD	BC,#0CBF
0481+  C24D 7E          	LD	A,(HL)
0482+  C24E 2B          	DEC	HL
0483+  C24F B7          	OR	A
0484+  C250 D5          	PUSH	DE
0485+  C251 C4 33 B9    	CALL	NZ,PrintName
0486+  C254 E1          	POP	HL
0487+  C255 11 68 00    	LD	DE,#0068
0488+  C258 19          	ADD	HL,DE
0489+  C259 16 47       	LD	D,#3F+#08
0490+  C25B 1E 3F       	LD	E,#3F
0491+  C25D 01 2E 80    	LD	BC,#802E
0492+  C260 E5          	PUSH	HL
0493+  C261 CD 04 C4    	CALL	ScrDIRDnUp
0494+  C264 D1          	POP	DE
0495+  C265 21 21 80    	LD	HL,WorkBuffer+#21
0496+  C268 01 BF 0C    	LD	BC,#0CBF
0497+  C26B 7E          	LD	A,(HL)
0498+  C26C 2B          	DEC	HL
0499+  C26D B7          	OR	A
0500+  C26E C4 33 B9    	CALL	NZ,PrintName
0501+  C271 C1          	POP	BC
0502+  C272 78          	LD	A,B
0503+  C273 D3 A2       	OUT	(PAGE1),A
0504+  C275 79          	LD	A,C
0505+  C276 D3 89       	OUT	(YPORT),A
0506+  C278 FD E1       	POP	IY
0507+  C27A FD 6E 15    	LD	L,(IY+PanelFFl)
0508+  C27D FD 66 16    	LD	H,(IY+PanelFFh)
0509+  C280 23          	INC	HL
0510+  C281 FD 75 15    	LD	(IY+PanelFFl),L
0511+  C284 FD 74 16    	LD	(IY+PanelFFh),H
0512+  C287 CD EA BA    	CALL	SetInvert
0513+  C28A CD EE B2    	CALL	PrnFileInfo
0514+  C28D FD E5       	PUSH	IY
0515+  C28F DD E1       	POP	IX
0516+  C291 11 05 00    	LD	DE,BegPBar
0517+  C294 DD 19       	ADD	IX,DE
0518+  C296 CD 35 97    	CALL	PrnHScrBar
0519+  C299 C9          	RET 
0520+  C29A             ScrlUpP
0521+  C29A DB A2       	IN	A,(PAGE1)
0522+  C29C F5          	PUSH	AF
0523+  C29D FD CB 00 46 	BIT	0,(IY+PanelFlg)
0524+  C2A1 3A EE A7    	LD	A,(DIRpage1)
0525+  C2A4 28 03       	JR	Z,$+5
0526+  C2A6 3A EF A7    	LD	A,(DIRpage2)
0527+  C2A9 D3 A2       	OUT	(PAGE1),A
0528+  C2AB FD 6E 15    	LD	L,(IY+PanelFFl)
0529+  C2AE FD 66 16    	LD	H,(IY+PanelFFh)
0530+  C2B1 11 12 00    	LD	DE,#0012
0531+  C2B4 19          	ADD	HL,DE
0532+  C2B5 29          	ADD	HL,HL
0533+  C2B6 29          	ADD	HL,HL
0534+  C2B7 29          	ADD	HL,HL
0535+  C2B8 5D          	LD	E,L
0536+  C2B9 54          	LD	D,H
0537+  C2BA 29          	ADD	HL,HL
0538+  C2BB 19          	ADD	HL,DE
0539+  C2BC CB F4       	SET	6,H
0540+  C2BE 11 00 80    	LD	DE,WorkBuffer
0541+  C2C1 01 18 00    	LD	BC,#0018
0542+  C2C4 ED B0       	LDIR 
0543+  C2C6 F1          	POP	AF
0544+  C2C7 D3 A2       	OUT	(PAGE1),A
0545+  C2C9 DD 21 00 80 	LD	IX,WorkBuffer
0546+  C2CD 21 00 80    	LD	HL,WorkBuffer
0547+  C2D0 11 00 82    	LD	DE,WorkBuffer+#200
0548+  C2D3 01 0D 00    	LD	BC,#000D
0549+  C2D6 ED B0       	LDIR 
0550+  C2D8 3E 01       	LD	A,#01
0551+  C2DA 12          	LD	(DE),A
0552+  C2DB 13          	INC	DE
0553+  C2DC DD CB 0E 66 	BIT	4,(IX+#0E)
0554+  C2E0 C4 F2 B6    	CALL	NZ,PutDIRTxt
0555+  C2E3 CC A1 B3    	CALL	Z,GetFileLen
0556+  C2E6 3E 01       	LD	A,#01
0557+  C2E8 12          	LD	(DE),A
0558+  C2E9 13          	INC	DE
0559+  C2EA CD 67 B4    	CALL	GetData
0560+  C2ED 3E 01       	LD	A,#01
0561+  C2EF 12          	LD	(DE),A
0562+  C2F0 13          	INC	DE
0563+  C2F1 CD 82 B4    	CALL	GetTime
0564+  C2F4 06 9A       	LD	B,PanelCol*#10+FileCol
0565+  C2F6 0E 9B       	LD	C,PanelCol*#10+SFileCol
0566+  C2F8 CD C0 B8    	CALL	InsPrnColor
0567+  C2FB CD F9 BA    	CALL	ResInvert
0568+  C2FE FD E5       	PUSH	IY
0569+  C300 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0570+  C302 4F          	LD	C,A
0571+  C303 DB A2       	IN	A,(PAGE1)
0572+  C305 47          	LD	B,A
0573+  C306 C5          	PUSH	BC
0574+  C307 3E 50       	LD	A,#50
0575+  C309 D3 A2       	OUT	(PAGE1),A
0576+  C30B FD 6E 03    	LD	L,(IY+PanelXl)
0577+  C30E FD 66 04    	LD	H,(IY+PanelXh)
0578+  C311 11 04 00    	LD	DE,#0004
0579+  C314 19          	ADD	HL,DE
0580+  C315 16 47       	LD	D,#3F+#08
0581+  C317 1E 3F       	LD	E,#3F
0582+  C319 01 90 88    	LD	BC,#8890
0583+  C31C E5          	PUSH	HL
0584+  C31D CD 04 C4    	CALL	ScrDIRDnUp
0585+  C320 D1          	POP	DE
0586+  C321 21 00 82    	LD	HL,WorkBuffer+#200
0587+  C324 01 C7 26    	LD	BC,#26C7
0588+  C327 CD 33 B9    	CALL	PrintName
0589+  C32A C1          	POP	BC
0590+  C32B 78          	LD	A,B
0591+  C32C D3 A2       	OUT	(PAGE1),A
0592+  C32E 79          	LD	A,C
0593+  C32F D3 89       	OUT	(YPORT),A
0594+  C331 FD E1       	POP	IY
0595+  C333 FD 6E 15    	LD	L,(IY+PanelFFl)
0596+  C336 FD 66 16    	LD	H,(IY+PanelFFh)
0597+  C339 23          	INC	HL
0598+  C33A FD 75 15    	LD	(IY+PanelFFl),L
0599+  C33D FD 74 16    	LD	(IY+PanelFFh),H
0600+  C340 CD EA BA    	CALL	SetInvert
0601+  C343 CD EE B2    	CALL	PrnFileInfo
0602+  C346 FD E5       	PUSH	IY
0603+  C348 DD E1       	POP	IX
0604+  C34A 11 05 00    	LD	DE,BegPBar
0605+  C34D DD 19       	ADD	IX,DE
0606+  C34F CD 8E 98    	CALL	PrnVScrBar
0607+  C352 C9          	RET 
0608+  C353             ScrlUpT
0609+  C353 DB A2       	IN	A,(PAGE1)
0610+  C355 F5          	PUSH	AF
0611+  C356 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0612+  C35A 3A EE A7    	LD	A,(DIRpage1)
0613+  C35D 28 03       	JR	Z,$+5
0614+  C35F 3A EF A7    	LD	A,(DIRpage2)
0615+  C362 D3 A2       	OUT	(PAGE1),A
0616+  C364 21 00 80    	LD	HL,WorkBuffer
0617+  C367 06 18       	LD	B,#18
0618+  C369 3E 80       	LD	A,#80
0619+  C36B E5          	PUSH	HL
0620+  C36C 77          	LD	(HL),A
0621+  C36D 2C          	INC	L
0622+  C36E 10 FC       	DJNZ	$-2
0623+  C370 D1          	POP	DE
0624+  C371 FD 6E 15    	LD	L,(IY+PanelFFl)
0625+  C374 FD 66 16    	LD	H,(IY+PanelFFh)
0626+  C377 01 12 00    	LD	BC,#0012
0627+  C37A 09          	ADD	HL,BC
0628+  C37B 4D          	LD	C,L
0629+  C37C 44          	LD	B,H
0630+  C37D 21 00 40    	LD	HL,#4000
0631+  C380 C5          ScrDup1	PUSH	BC
0632+  C381 7E          	LD	A,(HL)
0633+  C382 E6 7F       	AND	#7F
0634+  C384 5F          	LD	E,A
0635+  C385 7E          	LD	A,(HL)
0636+  C386 12          	LD	(DE),A
0637+  C387 01 10 00    	LD	BC,#0010
0638+  C38A 09          	ADD	HL,BC
0639+  C38B C1          	POP	BC
0640+  C38C 0B          	DEC	BC
0641+  C38D 78          	LD	A,B
0642+  C38E B1          	OR	C
0643+  C38F 20 EF       	JR	NZ,ScrDup1
0644+  C391 11 00 81    	LD	DE,WorkBuffer+#100
0645+  C394 01 10 00    	LD	BC,#0010
0646+  C397 ED B0       	LDIR 
0647+  C399 F1          	POP	AF
0648+  C39A D3 A2       	OUT	(PAGE1),A
0649+  C39C 21 00 81    	LD	HL,WorkBuffer+#100
0650+  C39F 11 00 82    	LD	DE,WorkBuffer+#200
0651+  C3A2 CD 02 B8    	CALL	MakeTreeLine
0652+  C3A5 06 9A       	LD	B,PanelCol*#10+FileCol
0653+  C3A7 0E 9B       	LD	C,PanelCol*#10+SFileCol
0654+  C3A9 CD C0 B8    	CALL	InsPrnColor
0655+  C3AC CD F9 BA    	CALL	ResInvert
0656+  C3AF FD E5       	PUSH	IY
0657+  C3B1 DB 89       	IN	A,(YPORT)	;Сохраняем Y порт
0658+  C3B3 4F          	LD	C,A
0659+  C3B4 DB A2       	IN	A,(PAGE1)
0660+  C3B6 47          	LD	B,A
0661+  C3B7 C5          	PUSH	BC
0662+  C3B8 3E 50       	LD	A,#50
0663+  C3BA D3 A2       	OUT	(PAGE1),A
0664+  C3BC FD 6E 03    	LD	L,(IY+PanelXl)
0665+  C3BF FD 66 04    	LD	H,(IY+PanelXh)
0666+  C3C2 11 06 00    	LD	DE,#0006
0667+  C3C5 19          	ADD	HL,DE
0668+  C3C6 16 47       	LD	D,#3F+#08
0669+  C3C8 1E 3F       	LD	E,#3F
0670+  C3CA 01 90 88    	LD	BC,#8890
0671+  C3CD E5          	PUSH	HL
0672+  C3CE CD 04 C4    	CALL	ScrDIRDnUp
0673+  C3D1 D1          	POP	DE
0674+  C3D2 21 00 82    	LD	HL,WorkBuffer+#200
0675+  C3D5 01 C7 24    	LD	BC,#24C7
0676+  C3D8 CD 33 B9    	CALL	PrintName
0677+  C3DB C1          	POP	BC
0678+  C3DC 78          	LD	A,B
0679+  C3DD D3 A2       	OUT	(PAGE1),A
0680+  C3DF 79          	LD	A,C
0681+  C3E0 D3 89       	OUT	(YPORT),A
0682+  C3E2 FD E1       	POP	IY
0683+  C3E4 FD 6E 15    	LD	L,(IY+PanelFFl)
0684+  C3E7 FD 66 16    	LD	H,(IY+PanelFFh)
0685+  C3EA 23          	INC	HL
0686+  C3EB FD 75 15    	LD	(IY+PanelFFl),L
0687+  C3EE FD 74 16    	LD	(IY+PanelFFh),H
0688+  C3F1 CD EA BA    	CALL	SetInvert
0689+  C3F4 CD EE B2    	CALL	PrnFileInfo
0690+  C3F7 FD E5       	PUSH	IY
0691+  C3F9 DD E1       	POP	IX
0692+  C3FB 11 05 00    	LD	DE,BegPBar
0693+  C3FE DD 19       	ADD	IX,DE
0694+  C400 CD 8E 98    	CALL	PrnVScrBar
0695+  C403 C9          	RET 
0696+  C404             ;На вход:
0697+  C404             ;	 HL - X	позиция
0698+  C404             ;	 D  - Y	откуда
0699+  C404             ;	 Е  - Y	куда
0700+  C404             ;	 BC - длина Y,X
0701+  C404             ScrDIRDnUp
0702+  C404 CB 3C       	SRL	H
0703+  C406 CB 1D       	RR	L
0704+  C408 CB F4       	SET	6,H
0705+  C40A 78          	LD	A,B
0706+  C40B 32 12 C4    	LD	(ScrlLen+1),A
0707+  C40E F3          	DI 
0708+  C40F 41          	LD	B,C
0709+  C410 52          	LD	D,D
0710+  C411 3E 00       ScrlLen	LD	A,#00
0711+  C413 40          	LD	B,B
0712+  C414 7A          ScRect1	LD	A,D
0713+  C415 D3 89       	OUT	(YPORT),A
0714+  C417 7F          	LD	A,A
0715+  C418 7E          	LD	A,(HL)
0716+  C419 40          	LD	B,B
0717+  C41A 7B          	LD	A,E
0718+  C41B D3 89       	OUT	(YPORT),A
0719+  C41D 7F          	LD	A,A
0720+  C41E 77          	LD	(HL),A
0721+  C41F 40          	LD	B,B
0722+  C420 23          	INC	HL
0723+  C421 10 F1       	DJNZ	ScRect1
0724+  C423 FB          	EI 
0725+  C424 C9          	RET 
0726+  C425             ;[]===========================================================[]
0727+  C425             CursLeft
0728+  C425 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0729+  C429 C0          	RET	NZ
0730+  C42A FD 7E 13    	LD	A,(IY+PanelEFl)
0731+  C42D FD B6 14    	OR	(IY+PanelEFh)
0732+  C430 C8          	RET	Z
0733+  C431 FD 6E 17    	LD	L,(IY+PanelCFl)
0734+  C434 FD 66 18    	LD	H,(IY+PanelCFh)
0735+  C437 7C          	LD	A,H
0736+  C438 B5          	OR	L
0737+  C439 CA BB C4    	JP	Z,PageUp
0738+  C43C 11 11 00    	LD	DE,#0011
0739+  C43F ED 52       	SBC	HL,DE
0740+  C441 30 66       	JR	NC,CursLRex
0741+  C443 21 00 00    	LD	HL,#0000
0742+  C446 18 61       	JR	CursLRex
0743+  C448             ;
0744+  C448             CursRight
0745+  C448 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0746+  C44C C0          	RET	NZ
0747+  C44D FD 7E 13    	LD	A,(IY+PanelEFl)
0748+  C450 FD B6 14    	OR	(IY+PanelEFh)
0749+  C453 C8          	RET	Z
0750+  C454 FD 6E 17    	LD	L,(IY+PanelCFl)
0751+  C457 FD 66 18    	LD	H,(IY+PanelCFh)
0752+  C45A FD 5E 11    	LD	E,(IY+PanelFPl)
0753+  C45D FD 56 12    	LD	D,(IY+PanelFPh)
0754+  C460 1B          	DEC	DE
0755+  C461 B7          	OR	A
0756+  C462 E5          	PUSH	HL
0757+  C463 ED 52       	SBC	HL,DE
0758+  C465 E1          	POP	HL
0759+  C466 CA E8 C4    	JP	Z,PageDown
0760+  C469 11 11 00    	LD	DE,#0011
0761+  C46C 19          	ADD	HL,DE
0762+  C46D FD CB 01 46 	BIT	0,(IY+ViewFlg)
0763+  C471 20 03       	JR	NZ,$+5
0764+  C473 11 32 00    	LD	DE,#0032
0765+  C476 EB          	EX	DE,HL
0766+  C477 ED 52       	SBC	HL,DE
0767+  C479 30 07       	JR	NC,CursRg1
0768+  C47B FD 5E 11    	LD	E,(IY+PanelFPl)
0769+  C47E FD 56 12    	LD	D,(IY+PanelFPh)
0770+  C481 1B          	DEC	DE
0771+  C482 EB          CursRg1	EX	DE,HL
0772+  C483 E5          	PUSH	HL
0773+  C484 FD 5E 15    	LD	E,(IY+PanelFFl)
0774+  C487 FD 56 16    	LD	D,(IY+PanelFFh)
0775+  C48A 19          	ADD	HL,DE
0776+  C48B FD 4E 13    	LD	C,(IY+PanelEFl)
0777+  C48E FD 46 14    	LD	B,(IY+PanelEFh)
0778+  C491 B7          	OR	A
0779+  C492 ED 42       	SBC	HL,BC
0780+  C494 E1          	POP	HL
0781+  C495 38 12       	JR	C,CursLRex
0782+  C497 69          	LD	L,C
0783+  C498 60          	LD	H,B
0784+  C499 B7          	OR	A
0785+  C49A ED 52       	SBC	HL,DE
0786+  C49C 2B          	DEC	HL
0787+  C49D E5          	PUSH	HL
0788+  C49E FD 5E 17    	LD	E,(IY+PanelCFl)
0789+  C4A1 FD 56 18    	LD	D,(IY+PanelCFh)
0790+  C4A4 B7          	OR	A
0791+  C4A5 ED 52       	SBC	HL,DE
0792+  C4A7 E1          	POP	HL
0793+  C4A8 C8          	RET	Z
0794+  C4A9             CursLRex
0795+  C4A9 E5          	PUSH	HL
0796+  C4AA CD F9 BA    	CALL	ResInvert
0797+  C4AD E1          	POP	HL
0798+  C4AE FD 75 17    	LD	(IY+PanelCFl),L
0799+  C4B1 FD 74 18    	LD	(IY+PanelCFh),H
0800+  C4B4 CD EA BA    	CALL	SetInvert
0801+  C4B7 CD EE B2    	CALL	PrnFileInfo
0802+  C4BA C9          	RET 
0803+  C4BB             ;[]===========================================================[]
0804+  C4BB             PageUp
0805+  C4BB FD 7E 13    	LD	A,(IY+PanelEFl)
0806+  C4BE FD B6 14    	OR	(IY+PanelEFh)
0807+  C4C1 C8          	RET	Z
0808+  C4C2 FD 6E 15    	LD	L,(IY+PanelFFl)
0809+  C4C5 FD 66 16    	LD	H,(IY+PanelFFh)
0810+  C4C8 7C          	LD	A,H
0811+  C4C9 B5          	OR	L
0812+  C4CA CA 5D C5    	JP	Z,Home
0813+  C4CD E5          	PUSH	HL
0814+  C4CE CD F9 BA    	CALL	ResInvert
0815+  C4D1 E1          	POP	HL
0816+  C4D2 FD 5E 11    	LD	E,(IY+PanelFPl)
0817+  C4D5 FD 56 12    	LD	D,(IY+PanelFPh)
0818+  C4D8 B7          	OR	A
0819+  C4D9 ED 52       	SBC	HL,DE
0820+  C4DB 30 03       	JR	NC,$+5
0821+  C4DD 21 00 00    	LD	HL,#0000
0822+  C4E0 FD 75 15    	LD	(IY+PanelFFl),L
0823+  C4E3 FD 74 16    	LD	(IY+PanelFFh),H
0824+  C4E6 18 48       	JR	PageUDex
0825+  C4E8             ;
0826+  C4E8             PageDown
0827+  C4E8 FD 4E 13    	LD	C,(IY+PanelEFl)
0828+  C4EB FD 46 14    	LD	B,(IY+PanelEFh)
0829+  C4EE 78          	LD	A,B
0830+  C4EF B1          	OR	C
0831+  C4F0 C8          	RET	Z
0832+  C4F1 FD 6E 15    	LD	L,(IY+PanelFFl)
0833+  C4F4 FD 66 16    	LD	H,(IY+PanelFFh)
0834+  C4F7 FD 5E 11    	LD	E,(IY+PanelFPl)
0835+  C4FA FD 56 12    	LD	D,(IY+PanelFPh)
0836+  C4FD 19          	ADD	HL,DE
0837+  C4FE B7          	OR	A
0838+  C4FF ED 42       	SBC	HL,BC
0839+  C501 D2 96 C5    	JP	NC,End
0840+  C504 E5          	PUSH	HL
0841+  C505 C5          	PUSH	BC
0842+  C506 CD F9 BA    	CALL	ResInvert
0843+  C509 C1          	POP	BC
0844+  C50A E1          	POP	HL
0845+  C50B 09          	ADD	HL,BC
0846+  C50C FD 75 15    	LD	(IY+PanelFFl),L
0847+  C50F FD 74 16    	LD	(IY+PanelFFh),H
0848+  C512 FD 5E 17    	LD	E,(IY+PanelCFl)
0849+  C515 FD 56 18    	LD	D,(IY+PanelCFh)
0850+  C518 19          	ADD	HL,DE
0851+  C519 B7          	OR	A
0852+  C51A ED 42       	SBC	HL,BC
0853+  C51C 38 12       	JR	C,PageUDex
0854+  C51E 69          	LD	L,C
0855+  C51F 60          	LD	H,B
0856+  C520 FD 5E 15    	LD	E,(IY+PanelFFl)
0857+  C523 FD 56 16    	LD	D,(IY+PanelFFh)
0858+  C526 B7          	OR	A
0859+  C527 ED 52       	SBC	HL,DE
0860+  C529 2B          	DEC	HL
0861+  C52A FD 75 17    	LD	(IY+PanelCFl),L
0862+  C52D FD 74 18    	LD	(IY+PanelCFh),H
0863+  C530             PageUDex
0864+  C530 CD 45 B5    	CALL	PrintDIR
0865+  C533 CD EA BA    	CALL	SetInvert
0866+  C536 CD EE B2    	CALL	PrnFileInfo
0867+  C539 FD E5       	PUSH	IY
0868+  C53B DD E1       	POP	IX
0869+  C53D 11 05 00    	LD	DE,BegPBar
0870+  C540 DD 19       	ADD	IX,DE
0871+  C542 FD 7E 01    	LD	A,(IY+ViewFlg)
0872+  C545 E6 03       	AND	#03
0873+  C547 F5          	PUSH	AF
0874+  C548 CC 35 97    	CALL	Z,PrnHScrBar
0875+  C54B F1          	POP	AF
0876+  C54C C4 8E 98    	CALL	NZ,PrnVScrBar
0877+  C54F 06 07       	LD	B,#07
0878+  C551 C5          PgUDext	PUSH	BC
0879+  C552 0E 03       	LD	C,#03
0880+  C554 F7          	RST	#30
0881+  C555 C1          	POP	BC
0882+  C556 CB 47       	BIT	0,A
0883+  C558 C8          	RET	Z
0884+  C559 76          	HALT 
0885+  C55A 10 F5       	DJNZ	PgUDext
0886+  C55C C9          	RET 
0887+  C55D             ;[]===========================================================[]
0888+  C55D             Home
0889+  C55D FD 7E 13    	LD	A,(IY+PanelEFl)
0890+  C560 FD B6 14    	OR	(IY+PanelEFh)
0891+  C563 C8          	RET	Z
0892+  C564 FD 7E 15    	LD	A,(IY+PanelFFl)
0893+  C567 FD B6 16    	OR	(IY+PanelFFh)
0894+  C56A 20 18       	JR	NZ,Home1
0895+  C56C FD 7E 17    	LD	A,(IY+PanelCFl)
0896+  C56F FD B6 18    	OR	(IY+PanelCFh)
0897+  C572 C8          	RET	Z
0898+  C573 CD F9 BA    	CALL	ResInvert
0899+  C576 97          	SUB	A
0900+  C577 FD 77 17    	LD	(IY+PanelCFl),A
0901+  C57A FD 77 18    	LD	(IY+PanelCFh),A
0902+  C57D CD EA BA    	CALL	SetInvert
0903+  C580 CD EE B2    	CALL	PrnFileInfo
0904+  C583 C9          	RET 
0905+  C584             Home1
0906+  C584 CD F9 BA    	CALL	ResInvert
0907+  C587 97          	SUB	A
0908+  C588 FD 77 15    	LD	(IY+PanelFFl),A
0909+  C58B FD 77 16    	LD	(IY+PanelFFh),A
0910+  C58E FD 77 17    	LD	(IY+PanelCFl),A
0911+  C591 FD 77 18    	LD	(IY+PanelCFh),A
0912+  C594 18 9A       	JR	PageUDex
0913+  C596             ;
0914+  C596             End
0915+  C596 FD 4E 13    	LD	C,(IY+PanelEFl)
0916+  C599 FD 46 14    	LD	B,(IY+PanelEFh)
0917+  C59C 78          	LD	A,B
0918+  C59D B1          	OR	C
0919+  C59E C8          	RET	Z
0920+  C59F FD 6E 15    	LD	L,(IY+PanelFFl)
0921+  C5A2 FD 66 16    	LD	H,(IY+PanelFFh)
0922+  C5A5 FD 5E 17    	LD	E,(IY+PanelCFl)
0923+  C5A8 FD 56 18    	LD	D,(IY+PanelCFh)
0924+  C5AB 19          	ADD	HL,DE
0925+  C5AC 23          	INC	HL
0926+  C5AD B7          	OR	A
0927+  C5AE ED 42       	SBC	HL,BC
0928+  C5B0 C8          	RET	Z
0929+  C5B1 C5          	PUSH	BC
0930+  C5B2 CD F9 BA    	CALL	ResInvert
0931+  C5B5 C1          	POP	BC
0932+  C5B6 FD 6E 15    	LD	L,(IY+PanelFFl)
0933+  C5B9 FD 66 16    	LD	H,(IY+PanelFFh)
0934+  C5BC FD CB 01 46 	BIT	0,(IY+ViewFlg)
0935+  C5C0 FD 5E 11    	LD	E,(IY+PanelFPl)
0936+  C5C3 FD 56 12    	LD	D,(IY+PanelFPh)
0937+  C5C6 19          	ADD	HL,DE
0938+  C5C7 23          	INC	HL
0939+  C5C8 B7          	OR	A
0940+  C5C9 ED 42       	SBC	HL,BC
0941+  C5CB 28 1F       	JR	Z,End1
0942+  C5CD 38 1D       	JR	C,End1
0943+  C5CF FD 6E 13    	LD	L,(IY+PanelEFl)
0944+  C5D2 FD 66 14    	LD	H,(IY+PanelEFh)
0945+  C5D5 FD 5E 15    	LD	E,(IY+PanelFFl)
0946+  C5D8 FD 56 16    	LD	D,(IY+PanelFFh)
0947+  C5DB B7          	OR	A
0948+  C5DC ED 52       	SBC	HL,DE
0949+  C5DE 2B          	DEC	HL
0950+  C5DF FD 75 17    	LD	(IY+PanelCFl),L
0951+  C5E2 FD 74 18    	LD	(IY+PanelCFh),H
0952+  C5E5 CD EA BA    	CALL	SetInvert
0953+  C5E8 CD EE B2    	CALL	PrnFileInfo
0954+  C5EB C9          	RET 
0955+  C5EC 69          End1	LD	L,C
0956+  C5ED 60          	LD	H,B
0957+  C5EE B7          	OR	A
0958+  C5EF ED 52       	SBC	HL,DE
0959+  C5F1 FD 75 15    	LD	(IY+PanelFFl),L
0960+  C5F4 FD 74 16    	LD	(IY+PanelFFh),H
0961+  C5F7 FD CB 01 46 	BIT	0,(IY+ViewFlg)
0962+  C5FB FD 6E 11    	LD	L,(IY+PanelFPl)
0963+  C5FE FD 66 12    	LD	H,(IY+PanelFPh)
0964+  C601 2B          	DEC	HL
0965+  C602 FD 75 17    	LD	(IY+PanelCFl),L
0966+  C605 FD 74 18    	LD	(IY+PanelCFh),H
0967+  C608 C3 30 C5    	JP	PageUDex
0968+  C60B             ;[]==========================================================[]
0969+  C60B             NewFile
0970+  C60B FD 7E 13    	LD	A,(IY+PanelEFl)
0971+  C60E FD B6 14    	OR	(IY+PanelEFh)
0972+  C611 C8          	RET	Z
0973+  C612 FD 7E 01    	LD	A,(IY+ViewFlg)
0974+  C615 E6 03       	AND	#03
0975+  C617 3E 00       	LD	A,#00
0976+  C619 20 56       	JR	NZ,NewFile1
0977+  C61B FD CB 00 46 	BIT	0,(IY+PanelFlg)
0978+  C61F 01 68 00    	LD	BC,#0068
0979+  C622 28 03       	JR	Z,$+5
0980+  C624 01 A8 01    	LD	BC,#01A8
0981+  C627 B7          	OR	A
0982+  C628 ED 42       	SBC	HL,BC
0983+  C62A 38 45       	JR	C,NewFile1
0984+  C62C 09          	ADD	HL,BC
0985+  C62D FD CB 00 46 	BIT	0,(IY+PanelFlg)
0986+  C631 01 70 00    	LD	BC,#0070
0987+  C634 28 03       	JR	Z,$+5
0988+  C636 01 B0 01    	LD	BC,#01B0
0989+  C639 ED 42       	SBC	HL,BC
0990+  C63B D8          	RET	C
0991+  C63C 09          	ADD	HL,BC
0992+  C63D FD CB 00 46 	BIT	0,(IY+PanelFlg)
0993+  C641 01 D0 00    	LD	BC,#00D0
0994+  C644 28 03       	JR	Z,$+5
0995+  C646 01 10 02    	LD	BC,#0210
0996+  C649 ED 42       	SBC	HL,BC
0997+  C64B 3E 11       	LD	A,#11
0998+  C64D 38 22       	JR	C,NewFile1
0999+  C64F 09          	ADD	HL,BC
1000+  C650 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1001+  C654 01 D8 00    	LD	BC,#00D8
1002+  C657 28 03       	JR	Z,$+5
1003+  C659 01 18 02    	LD	BC,#0218
1004+  C65C ED 42       	SBC	HL,BC
1005+  C65E D8          	RET	C
1006+  C65F 09          	ADD	HL,BC
1007+  C660 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1008+  C664 01 38 01    	LD	BC,#0138
1009+  C667 28 03       	JR	Z,$+5
1010+  C669 01 78 02    	LD	BC,#0278
1011+  C66C ED 42       	SBC	HL,BC
1012+  C66E D0          	RET	NC
1013+  C66F 3E 22       	LD	A,#22
1014+  C671             NewFile1
1015+  C671 21 3F 00    	LD	HL,#003F
1016+  C674 B7          	OR	A
1017+  C675 EB          	EX	DE,HL
1018+  C676 ED 52       	SBC	HL,DE
1019+  C678 CB 3C       	SRL	H
1020+  C67A CB 1D       	RR	L
1021+  C67C CB 3C       	SRL	H
1022+  C67E CB 1D       	RR	L
1023+  C680 CB 3C       	SRL	H
1024+  C682 CB 1D       	RR	L
1025+  C684 4F          	LD	C,A
1026+  C685 06 00       	LD	B,#00
1027+  C687 09          	ADD	HL,BC
1028+  C688 FD 4E 17    	LD	C,(IY+PanelCFl)
1029+  C68B FD 46 18    	LD	B,(IY+PanelCFh)
1030+  C68E B7          	OR	A
1031+  C68F ED 42       	SBC	HL,BC
1032+  C691 CA BF C6    	JP	Z,OpenFile
1033+  C694 09          	ADD	HL,BC
1034+  C695 FD 5E 15    	LD	E,(IY+PanelFFl)
1035+  C698 FD 56 16    	LD	D,(IY+PanelFFh)
1036+  C69B 19          	ADD	HL,DE
1037+  C69C FD 4E 13    	LD	C,(IY+PanelEFl)
1038+  C69F FD 46 14    	LD	B,(IY+PanelEFh)
1039+  C6A2 B7          	OR	A
1040+  C6A3 ED 42       	SBC	HL,BC
1041+  C6A5 D0          	RET	NC
1042+  C6A6 09          	ADD	HL,BC
1043+  C6A7 B7          	OR	A
1044+  C6A8 ED 52       	SBC	HL,DE
1045+  C6AA E5          	PUSH	HL
1046+  C6AB CD F9 BA    	CALL	ResInvert
1047+  C6AE E1          	POP	HL
1048+  C6AF FD 75 17    	LD	(IY+PanelCFl),L
1049+  C6B2 FD 74 18    	LD	(IY+PanelCFh),H
1050+  C6B5 CD EA BA    	CALL	SetInvert
1051+  C6B8 CD EE B2    	CALL	PrnFileInfo
1052+  C6BB CD 0D 9B    	CALL	ResFire
1053+  C6BE C9          	RET 
1054+  C6BF             ;[]==========================================================[]
1055+  C6BF             OpenFile
1056+  C6BF FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1057+  C6C3 C2 28 B0    	JP	NZ,TestTreeBeg
1058+  C6C6 FD 7E 13    	LD	A,(IY+PanelEFl)
1059+  C6C9 FD B6 14    	OR	(IY+PanelEFh)
1060+  C6CC C8          	RET	Z
1061+  C6CD DB A2       	IN	A,(PAGE1)
1062+  C6CF F5          	PUSH	AF
1063+  C6D0 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1064+  C6D4 3A EE A7    	LD	A,(DIRpage1)
1065+  C6D7 28 03       	JR	Z,$+5
1066+  C6D9 3A EF A7    	LD	A,(DIRpage2)
1067+  C6DC D3 A2       	OUT	(PAGE1),A
1068+  C6DE FD 6E 15    	LD	L,(IY+PanelFFl)
1069+  C6E1 FD 66 16    	LD	H,(IY+PanelFFh)
1070+  C6E4 FD 5E 17    	LD	E,(IY+PanelCFl)
1071+  C6E7 FD 56 18    	LD	D,(IY+PanelCFh)
1072+  C6EA 19          	ADD	HL,DE
1073+  C6EB 29          	ADD	HL,HL
1074+  C6EC 29          	ADD	HL,HL
1075+  C6ED 29          	ADD	HL,HL
1076+  C6EE 5D          	LD	E,L
1077+  C6EF 54          	LD	D,H
1078+  C6F0 29          	ADD	HL,HL
1079+  C6F1 19          	ADD	HL,DE
1080+  C6F2 CB F4       	SET	6,H
1081+  C6F4 11 00 80    	LD	DE,WorkBuffer
1082+  C6F7 01 0E 00    	LD	BC,#000E
1083+  C6FA E5          	PUSH	HL
1084+  C6FB 09          	ADD	HL,BC
1085+  C6FC ED A0       	LDI 
1086+  C6FE E1          	POP	HL
1087+  C6FF 23          	INC	HL
1088+  C700 CD 6A BE    	CALL	MakeDOSname
1089+  C703 F1          	POP	AF
1090+  C704 D3 A2       	OUT	(PAGE1),A
1091+  C706 21 00 80    	LD	HL,WorkBuffer
1092+  C709 CB 66       	BIT	4,(HL)
1093+  C70B 23          	INC	HL
1094+  C70C CA 44 C9    	JP	Z,RunEXEfile
1095+  C70F 7E          	LD	A,(HL)
1096+  C710 FE 2E       	CP	"."
1097+  C712 20 25       	JR	NZ,OpenF2
1098+  C714 E5          	PUSH	HL
1099+  C715 FD E5       	PUSH	IY
1100+  C717 E1          	POP	HL
1101+  C718 11 2C 00    	LD	DE,BegPath
1102+  C71B 19          	ADD	HL,DE
1103+  C71C 97          	SUB	A
1104+  C71D 23          	INC	HL
1105+  C71E BE          	CP	(HL)
1106+  C71F 20 FC       	JR	NZ,$-2
1107+  C721 3E 5C       	LD	A,"\\"
1108+  C723 2B          	DEC	HL
1109+  C724 BE          	CP	(HL)
1110+  C725 28 11       	JR	Z,OpenF1
1111+  C727 2B          	DEC	HL
1112+  C728 BE          	CP	(HL)
1113+  C729 20 FC       	JR	NZ,$-2
1114+  C72B 23          	INC	HL
1115+  C72C 97          	SUB	A
1116+  C72D 11 5D BE    	LD	DE,PrevDIR
1117+  C730 ED A0       	LDI 
1118+  C732 BE          	CP	(HL)
1119+  C733 20 FB       	JR	NZ,$-3
1120+  C735 12          	LD	(DE),A
1121+  C736 3E 2E       	LD	A,"."
1122+  C738 E1          OpenF1	POP	HL
1123+  C739 F5          OpenF2	PUSH	AF
1124+  C73A E5          	PUSH	HL
1125+  C73B CD F9 BA    	CALL	ResInvert
1126+  C73E E1          	POP	HL
1127+  C73F CD 9C A0    	CALL	SetClock
1128+  C742 0E 1D       	LD	C,#1D
1129+  C744 FD E5       	PUSH	IY
1130+  C746 D7          	RST	#10
1131+  C747 FD E1       	POP	IY
1132+  C749 DC A8 86    	CALL	C,DOSError
1133+  C74C CD F5 A7    	CALL	ReadDIR
1134+  C74F FD E5       	PUSH	IY
1135+  C751 0E 02       	LD	C,#02
1136+  C753 FD E5       	PUSH	IY
1137+  C755 D7          	RST	#10
1138+  C756 E1          	POP	HL
1139+  C757 11 2C 00    	LD	DE,BegPath
1140+  C75A 19          	ADD	HL,DE
1141+  C75B C6 41       	ADD	A,"A"
1142+  C75D 77          	LD	(HL),A
1143+  C75E 23          	INC	HL
1144+  C75F 36 3A       	LD	(HL),":"
1145+  C761 23          	INC	HL
1146+  C762 0E 1E       	LD	C,#1E
1147+  C764 D7          	RST	#10
1148+  C765 FD E1       	POP	IY
1149+  C767 CD 38 B2    	CALL	PrintPath
1150+  C76A FD CB 00 7E 	BIT	7,(IY+PanelFlg)
1151+  C76E C4 AE B2    	CALL	NZ,PrintDOSPath
1152+  C771 F1          	POP	AF
1153+  C772 FE 2E       	CP	"."
1154+  C774 CC DA BD    	CALL	Z,FindPrevDIR
1155+  C777 CD 45 B5    	CALL	PrintDIR
1156+  C77A CD EA BA    	CALL	SetInvert
1157+  C77D CD EE B2    	CALL	PrnFileInfo
1158+  C780 FD E5       	PUSH	IY
1159+  C782 DD E1       	POP	IX
1160+  C784 11 05 00    	LD	DE,BegPBar
1161+  C787 DD 19       	ADD	IX,DE
1162+  C789 CD F7 96    	CALL	InitScrBar
1163+  C78C FD 7E 01    	LD	A,(IY+ViewFlg)
1164+  C78F E6 03       	AND	#03
1165+  C791 F5          	PUSH	AF
1166+  C792 CC 35 97    	CALL	Z,PrnHScrBar
1167+  C795 F1          	POP	AF
1168+  C796 C4 8E 98    	CALL	NZ,PrnVScrBar
1169+  C799 CD 3C A1    	CALL	SetMouse
1170+  C79C 3A E3 A7    	LD	A,(TreeFlag)
1171+  C79F B7          	OR	A
1172+  C7A0 CA 0D 9B    	JP	Z,ResFire
1173+  C7A3 FD E5       	PUSH	IY
1174+  C7A5 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1175+  C7A9 FD 21 8A A5 	LD	IY,LeftPanel
1176+  C7AD 21 B6 A6    	LD	HL,RightPanel
1177+  C7B0 20 07       	JR	NZ,$+9
1178+  C7B2 FD 21 B6 A6 	LD	IY,RightPanel
1179+  C7B6 21 8A A5    	LD	HL,LeftPanel
1180+  C7B9 11 2C 00    	LD	DE,BegPath
1181+  C7BC 19          	ADD	HL,DE
1182+  C7BD 23          	INC	HL
1183+  C7BE 23          	INC	HL
1184+  C7BF CD F0 B0    	CALL	FindTreeDIR
1185+  C7C2 CD 45 B5    	CALL	PrintDIR
1186+  C7C5 CD EE B2    	CALL	PrnFileInfo
1187+  C7C8 FD E5       	PUSH	IY
1188+  C7CA DD E1       	POP	IX
1189+  C7CC 11 05 00    	LD	DE,BegPBar
1190+  C7CF DD 19       	ADD	IX,DE
1191+  C7D1 CD 8E 98    	CALL	PrnVScrBar
1192+  C7D4 FD E1       	POP	IY
1193+  C7D6 C9          	RET 
1194+  C7D7             ;[]==========================================================[]
1195+  C7D7             ChPanel
1196+  C7D7 CD F9 BA    	CALL	ResInvert
1197+  C7DA 3A 8A A5    	LD	A,(LeftPanel)
1198+  C7DD EE 80       	XOR	#80
1199+  C7DF 32 8A A5    	LD	(LeftPanel),A
1200+  C7E2 3A B6 A6    	LD	A,(RightPanel)
1201+  C7E5 EE 80       	XOR	#80
1202+  C7E7 32 B6 A6    	LD	(RightPanel),A
1203+  C7EA CD 38 B2    	CALL	PrintPath
1204+  C7ED FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1205+  C7F1 28 31       	JR	Z,ChPan1
1206+  C7F3 DB A2       	IN	A,(PAGE1)
1207+  C7F5 F5          	PUSH	AF
1208+  C7F6 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1209+  C7FA 3A EE A7    	LD	A,(DIRpage1)
1210+  C7FD 28 03       	JR	Z,$+5
1211+  C7FF 3A EF A7    	LD	A,(DIRpage2)
1212+  C802 D3 A2       	OUT	(PAGE1),A
1213+  C804 3E C0       	LD	A,#C0
1214+  C806 D3 89       	OUT	(YPORT),A
1215+  C808 FD 6E 15    	LD	L,(IY+PanelFFl)
1216+  C80B FD 66 16    	LD	H,(IY+PanelFFh)
1217+  C80E FD 5E 17    	LD	E,(IY+PanelCFl)
1218+  C811 FD 56 18    	LD	D,(IY+PanelCFh)
1219+  C814 19          	ADD	HL,DE
1220+  C815 29          	ADD	HL,HL
1221+  C816 29          	ADD	HL,HL
1222+  C817 29          	ADD	HL,HL
1223+  C818 29          	ADD	HL,HL
1224+  C819 CB F4       	SET	6,H
1225+  C81B 23          	INC	HL
1226+  C81C CB CE       	SET	1,(HL)
1227+  C81E F1          	POP	AF
1228+  C81F D3 A2       	OUT	(PAGE1),A
1229+  C821 CD 45 B5    	CALL	PrintDIR
1230+  C824 FD 21 8A A5 ChPan1	LD	IY,LeftPanel
1231+  C828 FD CB 00 7E 	BIT	7,(IY+PanelFlg)
1232+  C82C 20 04       	JR	NZ,$+6
1233+  C82E FD 21 B6 A6 	LD	IY,RightPanel
1234+  C832 CD 38 B2    	CALL	PrintPath
1235+  C835 CD AE B2    	CALL	PrintDOSPath
1236+  C838 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1237+  C83C 28 31       	JR	Z,ChPan2
1238+  C83E DB A2       	IN	A,(PAGE1)
1239+  C840 F5          	PUSH	AF
1240+  C841 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1241+  C845 3A EE A7    	LD	A,(DIRpage1)
1242+  C848 28 03       	JR	Z,$+5
1243+  C84A 3A EF A7    	LD	A,(DIRpage2)
1244+  C84D D3 A2       	OUT	(PAGE1),A
1245+  C84F 3E C0       	LD	A,#C0
1246+  C851 D3 89       	OUT	(YPORT),A
1247+  C853 FD 6E 15    	LD	L,(IY+PanelFFl)
1248+  C856 FD 66 16    	LD	H,(IY+PanelFFh)
1249+  C859 FD 5E 17    	LD	E,(IY+PanelCFl)
1250+  C85C FD 56 18    	LD	D,(IY+PanelCFh)
1251+  C85F 19          	ADD	HL,DE
1252+  C860 29          	ADD	HL,HL
1253+  C861 29          	ADD	HL,HL
1254+  C862 29          	ADD	HL,HL
1255+  C863 29          	ADD	HL,HL
1256+  C864 CB F4       	SET	6,H
1257+  C866 23          	INC	HL
1258+  C867 CB 8E       	RES	1,(HL)
1259+  C869 F1          	POP	AF
1260+  C86A D3 A2       	OUT	(PAGE1),A
1261+  C86C CD 45 B5    	CALL	PrintDIR
1262+  C86F CD EA BA    ChPan2	CALL	SetInvert
1263+  C872 FD E5       	PUSH	IY
1264+  C874 E1          	POP	HL
1265+  C875 11 2C 00    	LD	DE,BegPath
1266+  C878 19          	ADD	HL,DE
1267+  C879 0E 1D       	LD	C,#1D
1268+  C87B FD E5       	PUSH	IY
1269+  C87D D7          	RST	#10
1270+  C87E FD E1       	POP	IY
1271+  C880 D0          	RET	NC
1272+  C881 CD A8 86    	CALL	DOSError
1273+  C884 C3 3C BC    	JP	BegDIRECTORY
1274+  C887             ;[]==========================================================[]
1275+  C887             ChangeDriveL
1276+  C887 DD 21 8A A5 	LD	IX,LeftPanel
1277+  C88B 18 04       	JR	ChangeDrive
1278+  C88D             ChangeDriveR
1279+  C88D DD 21 B6 A6 	LD	IX,RightPanel
1280+  C891             ChangeDrive
1281+  C891 FD E5       	PUSH	IY
1282+  C893 DD E5       	PUSH	IX
1283+  C895 FD E1       	POP	IY
1284+  C897 FD 4E 03    	LD	C,(IY+PanelXl)
1285+  C89A FD 46 04    	LD	B,(IY+PanelXh)
1286+  C89D 03          	INC	BC
1287+  C89E 03          	INC	BC
1288+  C89F B7          	OR	A
1289+  C8A0 ED 42       	SBC	HL,BC
1290+  C8A2 01 1C 00    	LD	BC,#001C
1291+  C8A5 3E FF       	LD	A,#FF
1292+  C8A7 3C          	INC	A
1293+  C8A8 ED 42       	SBC	HL,BC
1294+  C8AA 30 FB       	JR	NC,$-3
1295+  C8AC C6 41       	ADD	A,"A"
1296+  C8AE FD E5       	PUSH	IY
1297+  C8B0 E1          	POP	HL
1298+  C8B1 11 2C 00    	LD	DE,BegPath
1299+  C8B4 19          	ADD	HL,DE
1300+  C8B5 72          	LD	(HL),D
1301+  C8B6 21 D9 C8    	LD	HL,NewDrive
1302+  C8B9 77          	LD	(HL),A
1303+  C8BA CD 3F BC    	CALL	NewDIRECTORY
1304+  C8BD FD CB 00 7E 	BIT	7,(IY+PanelFlg)
1305+  C8C1 FD E1       	POP	IY
1306+  C8C3 C0          	RET	NZ
1307+  C8C4 FD E5       	PUSH	IY
1308+  C8C6 E1          	POP	HL
1309+  C8C7 11 2C 00    	LD	DE,BegPath
1310+  C8CA 19          	ADD	HL,DE
1311+  C8CB 0E 1D       	LD	C,#1D
1312+  C8CD FD E5       	PUSH	IY
1313+  C8CF D7          	RST	#10
1314+  C8D0 FD E1       	POP	IY
1315+  C8D2 D0          	RET	NC
1316+  C8D3 CD A8 86    	CALL	DOSError
1317+  C8D6 C3 3C BC    	JP	BegDIRECTORY
1318+  C8D9             NewDrive
1319+  C8D9 20 3A 5C 00 	DEFB	" :\\",0
1320+  C8DD             ;[]==========================================================[]
1321+  C8DD             ReplacePanels
1322+  C8DD DD 21 8A A5 	LD	IX,LeftPanel
1323+  C8E1 DD CB 00 C6 	SET	0,(IX+PanelFlg)
1324+  C8E5 DD 6E 03    	LD	L,(IX+PanelXl)
1325+  C8E8 DD 66 04    	LD	H,(IX+PanelXh)
1326+  C8EB DD 21 B6 A6 	LD	IX,RightPanel
1327+  C8EF DD CB 00 86 	RES	0,(IX+PanelFlg)
1328+  C8F3 DD 5E 03    	LD	E,(IX+PanelXl)
1329+  C8F6 DD 56 04    	LD	D,(IX+PanelXh)
1330+  C8F9 DD 75 03    	LD	(IX+PanelXl),L
1331+  C8FC DD 74 04    	LD	(IX+PanelXh),H
1332+  C8FF DD 21 8A A5 	LD	IX,LeftPanel
1333+  C903 DD 73 03    	LD	(IX+PanelXl),E
1334+  C906 DD 72 04    	LD	(IX+PanelXh),D
1335+  C909 21 EE A7    	LD	HL,DIRpage1
1336+  C90C 11 EF A7    	LD	DE,DIRpage2
1337+  C90F 1A          	LD	A,(DE)
1338+  C910 ED A0       	LDI 
1339+  C912 2B          	DEC	HL
1340+  C913 77          	LD	(HL),A
1341+  C914 21 8A A5    	LD	HL,LeftPanel
1342+  C917 11 B6 A6    	LD	DE,RightPanel
1343+  C91A 01 2C 01    	LD	BC,BegPath+#100
1344+  C91D 1A          ReplPan	LD	A,(DE)
1345+  C91E ED A0       	LDI 
1346+  C920 2B          	DEC	HL
1347+  C921 77          	LD	(HL),A
1348+  C922 23          	INC	HL
1349+  C923 EA 1D C9    	JP	PE,ReplPan
1350+  C926 3E 01       	LD	A,#01
1351+  C928 CD C3 E7    	CALL	InitPanels
1352+  C92B C9          	RET 
1353+  C92C             ;[]==========================================================[]
1354+  C92C             ShowDOSscreen
1355+  C92C CD 98 E4    	CALL	ResVMode
1356+  C92F             ShowDSlp
1357+  C92F 0E 31       	LD	C,#31
1358+  C931 D7          	RST	#10
1359+  C932 20 06       	JR	NZ,ShowDSexit
1360+  C934 0E 03       	LD	C,#03
1361+  C936 F7          	RST	#30
1362+  C937 B7          	OR	A
1363+  C938 28 F5       	JR	Z,ShowDSlp
1364+  C93A             ShowDSexit
1365+  C93A 01 50 00    	LD	BC,#0050
1366+  C93D 3E 82       	LD	A,#82
1367+  C93F D7          	RST	#10
1368+  C940 CD 0D 9B    	CALL	ResFire
1369+  C943 C9          	RET 
1370+  C944             
1371+  C944             
1372+  C944             
1373+  C944             ;[]==========================================================[]
1374+  C944             RunEXEfile
1375+  C944 DD 21 00 42 	LD	IX,fn_ext
1376+  C948 11 CD BD    	LD	DE,PrevFile
1377+  C94B D5          	PUSH	DE
1378+  C94C 97          	SUB	A
1379+  C94D ED A0       	LDI 
1380+  C94F BE          	CP	(HL)
1381+  C950 20 FB       	JR	NZ,$-3
1382+  C952 12          	LD	(DE),A
1383+  C953 D1          	POP	DE
1384+  C954 6B          	LD	L,E
1385+  C955 62          	LD	H,D
1386+  C956 3E 2E       	LD	A,"."
1387+  C958 23          	INC	HL
1388+  C959 BE          	CP	(HL)
1389+  C95A 20 FC       	JR	NZ,$-2
1390+  C95C 23          	INC	HL
1391+  C95D 7E          	LD	A,(HL)
1392+  C95E 23          	INC	HL
1393+  C95F CB AF       	RES	5,A
1394+  C961 FE 46       	CP	"F"
1395+  C963 CA AF C9    	JP	Z,RunFLXfile
1396+  C966 FE 54       	CP	"T"
1397+  C968 CA D2 C9    	JP	Z,RunTRDfile
1398+  C96B FE 45       	CP	"E"
1399+  C96D C2 69 CC    	JP	NZ,TestEXT
1400+  C970 7E          	LD	A,(HL)
1401+  C971 23          	INC	HL
1402+  C972 CB AF       	RES	5,A
1403+  C974 FE 58       	CP	"X"
1404+  C976 C2 69 CC    	JP	NZ,TestEXT
1405+  C979 7E          	LD	A,(HL)
1406+  C97A CB AF       	RES	5,A
1407+  C97C FE 45       	CP	"E"
1408+  C97E C2 69 CC    	JP	NZ,TestEXT
1409+  C981 D5          	PUSH	DE
1410+  C982 CD 16 E6    	CALL	ResDrivers
1411+  C985 97          	SUB	A
1412+  C986 CD BB 86    	CALL	ClearScreen
1413+  C989 CD 98 E4    	CALL	ResVModeE
1414+  C98C E1          	POP	HL
1415+  C98D 01 40 00    	LD	BC,#0040
1416+  C990 D7          	RST	#10
1417+  C991 F5          	PUSH	AF
1418+  C992 97          	SUB	A
1419+  C993 D3 FE       	OUT	(BORDER),A
1420+  C995 3E C0       	LD	A,#C0
1421+  C997 D3 89       	OUT	(YPORT),A
1422+  C999 CD 10 E4    	CALL	InitVMode
1423+  C99C CD A4 E4    	CALL	InitDrivers
1424+  C99F CD 20 E6    	CALL	InitScreen
1425+  C9A2 CD 88 EB    	CALL	ClrDOSline
1426+  C9A5 3E 02       	LD	A,#02
1427+  C9A7 CD C3 E7    	CALL	InitPanels
1428+  C9AA F1          	POP	AF
1429+  C9AB DC A8 86    	CALL	C,DOSError
1430+  C9AE C9          	RET 
1431+  C9AF             ;[]----------------------------------------------------------[]
1432+  C9AF             RunFLXfile
1433+  C9AF 7E          	LD	A,(HL)
1434+  C9B0 23          	INC	HL
1435+  C9B1 CB AF       	RES	5,A
1436+  C9B3 FE 4C       	CP	"L"
1437+  C9B5 C2 69 CC    	JP	NZ,TestEXT
1438+  C9B8 7E          	LD	A,(HL)
1439+  C9B9 CB AF       	RES	5,A
1440+  C9BB FE 58       	CP	"X"
1441+  C9BD C2 69 CC    	JP	NZ,TestEXT
1442+  C9C0 EB          	EX	DE,HL
1443+  C9C1 11 00 80    	LD	DE,WorkBuffer
1444+  C9C4 97          	SUB	A
1445+  C9C5 ED A0       	LDI 
1446+  C9C7 BE          	CP	(HL)
1447+  C9C8 20 FB       	JR	NZ,$-3
1448+  C9CA 12          	LD	(DE),A
1449+  C9CB CD B9 CD    	CALL	RunFLEX
1450+  C9CE DC A8 86    	CALL	C,DOSError
1451+  C9D1 C9          	RET 
1452+  C9D2             ;[]----------------------------------------------------------[]
1453+  C9D2             RunTRDfile
1454+  C9D2 7E          	LD	A,(HL)
1455+  C9D3 23          	INC	HL
1456+  C9D4 CB AF       	RES	5,A
1457+  C9D6 FE 52       	CP	"R"
1458+  C9D8 C2 69 CC    	JP	NZ,TestEXT
1459+  C9DB 7E          	LD	A,(HL)
1460+  C9DC CB AF       	RES	5,A
1461+  C9DE FE 44       	CP	"D"
1462+  C9E0 C2 69 CC    	JP	NZ,TestEXT
1463+  C9E3 EB          	EX	DE,HL
1464+  C9E4 FD E5       	PUSH	IY
1465+  C9E6 CD 54 CA    	CALL	LoadTRD
1466+  C9E9 FD E1       	POP	IY
1467+  C9EB D8          	RET	C
1468+  C9EC 0E CA       	LD	C,#CA	;Clear RAMdisk Indef
1469+  C9EE 97          	SUB	A
1470+  C9EF CF          	RST	#08
1471+  C9F0 0E C3       	LD	C,#C3
1472+  C9F2 78          	LD	A,B
1473+  C9F3 D4 08 00    	CALL	NC,#0008
1474+  C9F6 3A 68 CC    	LD	A,(TRDIndef)
1475+  C9F9 47          	LD	B,A
1476+  C9FA 0E C9       	LD	C,#C9
1477+  C9FC 97          	SUB	A
1478+  C9FD CF          	RST	#08
1479+  C9FE 01 CB 00    	LD	BC,#00CB
1480+  CA01 97          	SUB	A
1481+  CA02 CF          	RST	#08
1482+  CA03 3E 05       	LD	A,#05
1483+  CA05 D3 A2       	OUT	(PAGE1),A
1484+  CA07 21 14 CA    	LD	HL,TRDResident
1485+  CA0A 11 00 60    	LD	DE,#6000
1486+  CA0D 01 40 00    	LD	BC,TRDResidentE-TRDResident
1487+  CA10 D5          	PUSH	DE
1488+  CA11 ED B0       	LDIR 
1489+  CA13 C9          	RET 
1490+  CA14             TRDResident
1491+  CA14 F3          	DI 
1492+  CA15 31 FF BF    	LD	SP,#BFFF
1493+  CA18 3E 02       	LD	A,#02
1494+  CA1A D3 C2       	OUT	(PAGE2),A
1495+  CA1C 97          	SUB	A
1496+  CA1D D3 89       	OUT	(YPORT),A
1497+  CA1F D3 A9       	OUT	(#A9),A
1498+  CA21 D3 C9       	OUT	(#C9),A
1499+  CA23 01 FD 1F    	LD	BC,#1FFD
1500+  CA26 ED 79       	OUT	(C),A
1501+  CA28 D3 82       	OUT	(PAGE0),A
1502+  CA2A D3 E2       	OUT	(PAGE3),A
1503+  CA2C 01 FD 7F    	LD	BC,#7FFD
1504+  CA2F 3E 10       	LD	A,#10
1505+  CA31 ED 79       	OUT	(C),A
1506+  CA33 0E F0       	LD	C,#F0
1507+  CA35 CD 14 3D    	CALL	#3D14
1508+  CA38 0E F2       	LD	C,#F2
1509+  CA3A CD 14 3D    	CALL	#3D14
1510+  CA3D 01 80 00    	LD	BC,#0080
1511+  CA40 1E 01       	LD	E,#01
1512+  CA42 CD 14 3D    	CALL	#3D14
1513+  CA45 01 A6 02    	LD	BC,#02A6
1514+  CA48 97          	SUB	A
1515+  CA49 5F          	LD	E,A
1516+  CA4A CD 14 3D    	CALL	#3D14
1517+  CA4D 21 00 00    	LD	HL,#0000
1518+  CA50 E5          	PUSH	HL
1519+  CA51 C3 2F 3D    	JP	#3D2F
1520+  CA54             TRDResidentE
1521+  CA54             
1522+  CA54             TRDfile=WorkBuffer+#100
1523+  CA54             LoadTRD
1524+  CA54 CD 9C A0    	CALL	SetClock
1525+  CA57 11 00 81    	LD	DE,TRDfile
1526+  CA5A 01 19 01    	LD	BC,#0119
1527+  CA5D 3E 37       	LD	A,#37
1528+  CA5F D7          	RST	#10
1529+  CA60 F5          	PUSH	AF
1530+  CA61 DC A8 86    	CALL	C,DOSError
1531+  CA64 F1          	POP	AF
1532+  CA65 D8          	RET	C
1533+  CA66 21 21 81    	LD	HL,TRDfile+33
1534+  CA69 7E          	LD	A,(HL)
1535+  CA6A CD 57 AA    LoadTR0	CALL	CorrBigChar
1536+  CA6D 77          	LD	(HL),A
1537+  CA6E 23          	INC	HL
1538+  CA6F 7E          	LD	A,(HL)
1539+  CA70 B7          	OR	A
1540+  CA71 20 F7       	JR	NZ,LoadTR0
1541+  CA73 DD 21 00 81 	LD	IX,TRDfile
1542+  CA77 DD 66 1C    	LD	H,(IX+28)
1543+  CA7A DD 7E 1D    	LD	A,(IX+29)
1544+  CA7D DD 5E 1E    	LD	E,(IX+30)
1545+  CA80 DD 56 1F    	LD	D,(IX+31)
1546+  CA83 2E 00       	LD	L,#00
1547+  CA85 CB 27       	SLA	A
1548+  CA87 CB 13       	RL	E
1549+  CA89 CB 12       	RL	D
1550+  CA8B CB 15       	RL	L
1551+  CA8D CB 27       	SLA	A
1552+  CA8F CB 13       	RL	E
1553+  CA91 CB 12       	RL	D
1554+  CA93 CB 15       	RL	L
1555+  CA95 B4          	OR	H
1556+  CA96 26 00       	LD	H,#00
1557+  CA98 EB          	EX	DE,HL
1558+  CA99 28 01       	JR	Z,$+3
1559+  CA9B 23          	INC	HL
1560+  CA9C 7C          	LD	A,H
1561+  CA9D B5          	OR	L
1562+  CA9E 20 01       	JR	NZ,LoadTR1
1563+  CAA0 13          	INC	DE
1564+  CAA1 7A          LoadTR1	LD	A,D
1565+  CAA2 B3          	OR	E
1566+  CAA3 3E 1E       	LD	A,#1E
1567+  CAA5 F5          	PUSH	AF
1568+  CAA6 C4 A8 86    	CALL	NZ,DOSError	;!!!!!!!!!!!! Нет памяти
1569+  CAA9 F1          	POP	AF
1570+  CAAA 37          	SCF 
1571+  CAAB C0          	RET	NZ
1572+  CAAC 0E 3C       	LD	C,#3C
1573+  CAAE E5          	PUSH	HL
1574+  CAAF D7          	RST	#10
1575+  CAB0 D1          	POP	DE
1576+  CAB1 69          	LD	L,C
1577+  CAB2 60          	LD	H,B
1578+  CAB3 B7          	OR	A
1579+  CAB4 ED 52       	SBC	HL,DE
1580+  CAB6 3E 1E       	LD	A,#1E
1581+  CAB8 D5          	PUSH	DE
1582+  CAB9 F5          	PUSH	AF
1583+  CABA DC A8 86    	CALL	C,DOSError	;!!!!!!!!!!!! Нет памяти
1584+  CABD F1          	POP	AF
1585+  CABE D1          	POP	DE
1586+  CABF D8          	RET	C
1587+  CAC0 DD 21 50 CC 	LD	IX,ProcessTRD
1588+  CAC4 DD 73 0A    	LD	(IX+ProcMAXl1),E
1589+  CAC7 DD 72 0B    	LD	(IX+ProcMAXh1),D
1590+  CACA 97          	SUB	A
1591+  CACB DD 77 0C    	LD	(IX+ProcMAXl2),A
1592+  CACE DD 77 0D    	LD	(IX+ProcMAXh2),A
1593+  CAD1 D5          	PUSH	DE
1594+  CAD2 CD E6 99    	CALL	InitProcess
1595+  CAD5 D1          	POP	DE
1596+  CAD6 43          	LD	B,E
1597+  CAD7 0E 3D       	LD	C,#3D
1598+  CAD9 D7          	RST	#10
1599+  CADA 32 68 CC    	LD	(TRDIndef),A
1600+  CADD 21 00 84    	LD	HL,PagesList
1601+  CAE0 0E C5       	LD	C,#C5
1602+  CAE2 CF          	RST	#08
1603+  CAE3 CD F0 86    	CALL	MakeWindow
1604+  CAE6 01          	DEFB	#01
1605+  CAE7 A0 00 58 00 	DEFW	#00A0,#0058
1606+  CAEB 40 01 30 00 	DEFW	#0140,#0030
1607+  CAEF 02          	DEFB	#02	;Head place
1608+  CAF0 04 00 02 00 	DEFW	#0004,#0002
1609+  CAF4 38 01 0A 00 	DEFW	#0138,#000A
1610+  CAF8 00          	DEFB	#00
1611+  CAF9 01          	DEFB	#01	;Text Line
1612+  CAFA 7C 00 03 00 	DEFW	#007C,#0003
1613+  CAFE 0F          	DEFB	#0F
1614+  CAFF             	DEFB	"Run TRD image",0
1614+  CAFF 52756E2054524420696D61676500
1615+  CB0D 01          	DEFB	#01	;Text Line
1616+  CB0E 08 00 10 00 	DEFW	#0008,#0010
1617+  CB12 80          	DEFB	#80
1618+  CB13             	DEFB	"Reading:",0
1618+  CB13 52656164696E673A00
1619+  CB1C 03          	DEFB	#03	;Углубление
1620+  CB1D 10 00 1C 00 	DEFW	#0010,#001C
1621+  CB21 20 01 0C 00 	DEFW	#0120,#000C
1622+  CB25 02          	DEFB	#02	;Head place
1623+  CB26 12 00 1D 00 	DEFW	#0012,#001D
1624+  CB2A 1C 01 0A 00 	DEFW	#011C,#000A
1625+  CB2E 0F          	DEFB	#0F
1626+  CB2F 00          	DEFB	#00
1627+  CB30 0E 02       	LD	C,#02
1628+  CB32 D7          	RST	#10
1629+  CB33 21 00 80    	LD	HL,WorkBuffer
1630+  CB36 C6 41       	ADD	A,"A"
1631+  CB38 77          	LD	(HL),A
1632+  CB39 23          	INC	HL
1633+  CB3A 36 3A       	LD	(HL),":"
1634+  CB3C 23          	INC	HL
1635+  CB3D 0E 1E       	LD	C,#1E
1636+  CB3F E5          	PUSH	HL
1637+  CB40 D7          	RST	#10
1638+  CB41 E1          	POP	HL
1639+  CB42 97          	SUB	A
1640+  CB43 23          	INC	HL
1641+  CB44 BE          	CP	(HL)
1642+  CB45 20 FC       	JR	NZ,$-2
1643+  CB47 2B          	DEC	HL
1644+  CB48 3E 5C       	LD	A,"\\"
1645+  CB4A BE          	CP	(HL)
1646+  CB4B 23          	INC	HL
1647+  CB4C 28 02       	JR	Z,$+4
1648+  CB4E 77          	LD	(HL),A
1649+  CB4F 23          	INC	HL
1650+  CB50 EB          	EX	DE,HL
1651+  CB51 21 21 81    	LD	HL,TRDfile+33
1652+  CB54 97          	SUB	A
1653+  CB55 ED A0       	LDI 
1654+  CB57 BE          	CP	(HL)
1655+  CB58 20 FB       	JR	NZ,$-3
1656+  CB5A 12          	LD	(DE),A
1657+  CB5B DD 21 00 01 	LD	IX,#0100
1658+  CB5F 21 00 80    	LD	HL,WorkBuffer
1659+  CB62 11 D8 00    	LD	DE,#00D8
1660+  CB65 01 68 00    	LD	BC,#0068
1661+  CB68 3E 80       	LD	A,#80
1662+  CB6A CD 4B 8E    	CALL	PrnRangPathL
1663+  CB6D             
1664+  CB6D 21 21 81    	LD	HL,TRDfile+33
1665+  CB70 3E 01       	LD	A,#01
1666+  CB72 0E 11       	LD	C,#11
1667+  CB74 D7          	RST	#10
1668+  CB75 30 0A       	JR	NC,LoadTRn
1669+  CB77 3A 68 CC    	LD	A,(TRDIndef)
1670+  CB7A 0E 3E       	LD	C,#3E
1671+  CB7C D7          	RST	#10
1672+  CB7D 37          	SCF 
1673+  CB7E C3 0A CC    	JP	LoadTExit
1674+  CB81             
1675+  CB81 32 63 CC    LoadTRn	LD	(FHandleTR),A
1676+  CB84 DD 21 00 81 	LD	IX,TRDfile
1677+  CB88 DD 6E 1C    	LD	L,(IX+28)
1678+  CB8B DD 66 1D    	LD	H,(IX+29)
1679+  CB8E 22 64 CC    	LD	(ReadTLen),HL
1680+  CB91 DD 6E 1E    	LD	L,(IX+30)
1681+  CB94 DD 66 1F    	LD	H,(IX+31)
1682+  CB97 22 66 CC    	LD	(ReadTLen+2),HL
1683+  CB9A 3E C0       	LD	A,#C0
1684+  CB9C D3 89       	OUT	(YPORT),A
1685+  CB9E             
1686+  CB9E DB A2       	IN	A,(PAGE1)
1687+  CBA0 F5          	PUSH	AF
1688+  CBA1 21 00 84    	LD	HL,PagesList
1689+  CBA4 7E          	LD	A,(HL)
1690+  CBA5 23          ReadTR1	INC	HL
1691+  CBA6 E5          	PUSH	HL
1692+  CBA7 D3 A2       	OUT	(PAGE1),A
1693+  CBA9 0E 31       	LD	C,#31
1694+  CBAB D7          	RST	#10
1695+  CBAC 21 1B 01    	LD	HL,#011B
1696+  CBAF B7          	OR	A
1697+  CBB0 ED 52       	SBC	HL,DE
1698+  CBB2 CA 17 CC    	JP	Z,TRDabort
1699+  CBB5 2A 64 CC    	LD	HL,(ReadTLen)
1700+  CBB8 ED 5B 66 CC 	LD	DE,(ReadTLen+2)
1701+  CBBC 01 00 40    	LD	BC,#4000
1702+  CBBF B7          	OR	A
1703+  CBC0 ED 42       	SBC	HL,BC
1704+  CBC2 06 00       	LD	B,#00
1705+  CBC4 EB          	EX	DE,HL
1706+  CBC5 ED 42       	SBC	HL,BC
1707+  CBC7 EB          	EX	DE,HL
1708+  CBC8 38 21       	JR	C,ReadTEnd
1709+  CBCA 22 64 CC    	LD	(ReadTLen),HL
1710+  CBCD ED 53 66 CC 	LD	(ReadTLen+2),DE
1711+  CBD1 21 00 40    	LD	HL,#4000
1712+  CBD4 11 00 40    	LD	DE,#4000
1713+  CBD7 3A 63 CC    	LD	A,(FHandleTR)
1714+  CBDA 0E 13       	LD	C,#13
1715+  CBDC D7          	RST	#10
1716+  CBDD CD 2A CC    	CALL	NextProcessTR
1717+  CBE0 E1          	POP	HL
1718+  CBE1 7E          	LD	A,(HL)
1719+  CBE2 FE FF       	CP	#FF
1720+  CBE4 20 BF       	JR	NZ,ReadTR1
1721+  CBE6 F1          	POP	AF
1722+  CBE7 D3 A2       	OUT	(PAGE1),A
1723+  CBE9 18 18       	JR	ReadTExit
1724+  CBEB             ReadTEnd
1725+  CBEB 21 00 40    	LD	HL,#4000
1726+  CBEE ED 5B 64 CC 	LD	DE,(ReadTLen)
1727+  CBF2 7A          	LD	A,D
1728+  CBF3 B3          	OR	E
1729+  CBF4 28 09       	JR	Z,ReadTRe
1730+  CBF6 3A 63 CC    	LD	A,(FHandleTR)
1731+  CBF9 0E 13       	LD	C,#13
1732+  CBFB D7          	RST	#10
1733+  CBFC CD 2A CC    	CALL	NextProcessTR
1734+  CBFF E1          ReadTRe	POP	HL
1735+  CC00 F1          	POP	AF
1736+  CC01 D3 A2       	OUT	(PAGE1),A
1737+  CC03             ReadTExit
1738+  CC03 3A 63 CC    	LD	A,(FHandleTR)
1739+  CC06 0E 12       	LD	C,#12
1740+  CC08 D7          	RST	#10
1741+  CC09 B7          	OR	A
1742+  CC0A             LoadTExit
1743+  CC0A 76          	HALT 
1744+  CC0B 76          	HALT 
1745+  CC0C CD F0 86    	CALL	MakeWindow
1746+  CC0F 7F          	DEFB	#7F
1747+  CC10 00          	DEFB	#00
1748+  CC11 F5          	PUSH	AF
1749+  CC12 CD 3C A1    	CALL	SetMouse
1750+  CC15 F1          	POP	AF
1751+  CC16 C9          	RET 
1752+  CC17             TRDabort
1753+  CC17 E1          	POP	HL
1754+  CC18 F1          	POP	AF
1755+  CC19 D3 A2       	OUT	(PAGE1),A
1756+  CC1B 3A 63 CC    	LD	A,(FHandleTR)
1757+  CC1E 0E 12       	LD	C,#12
1758+  CC20 D7          	RST	#10
1759+  CC21 3A 68 CC    	LD	A,(TRDIndef)
1760+  CC24 0E 3E       	LD	C,#3E
1761+  CC26 D7          	RST	#10
1762+  CC27 37          	SCF 
1763+  CC28 18 E0       	JR	LoadTExit
1764+  CC2A             NextProcessTR
1765+  CC2A DD 21 50 CC 	LD	IX,ProcessTRD
1766+  CC2E DD 6E 0E    	LD	L,(IX+ProcCURl1)
1767+  CC31 DD 66 0F    	LD	H,(IX+ProcCURh1)
1768+  CC34 23          	INC	HL
1769+  CC35 DD 75 0E    	LD	(IX+ProcCURl1),L
1770+  CC38 DD 74 0F    	LD	(IX+ProcCURh1),H
1771+  CC3B 7C          	LD	A,H
1772+  CC3C B5          	OR	L
1773+  CC3D 20 0D       	JR	NZ,NextTR1
1774+  CC3F DD 6E 10    	LD	L,(IX+ProcCURl2)
1775+  CC42 DD 66 11    	LD	H,(IX+ProcCURh2)
1776+  CC45 23          	INC	HL
1777+  CC46 DD 75 10    	LD	(IX+ProcCURl2),L
1778+  CC49 DD 74 11    	LD	(IX+ProcCURh2),H
1779+  CC4C CD 45 9A    NextTR1	CALL	PrnProcess
1780+  CC4F C9          	RET 
1781+  CC50             ProcessTRD
1782+  CC50 B2 00       	DEFW	#00B2
1783+  CC52 75 00       	DEFW	#0075
1784+  CC54 1C 01       	DEFW	#011C
1785+  CC56 00 00       	DEFW	#0000
1786+  CC58 00 00       	DEFW	#0000
1787+  CC5A 00 00       	DEFW	#0000
1788+  CC5C 00 00       	DEFW	#0000
1789+  CC5E 00 00       	DEFW	#0000
1790+  CC60 00 00       	DEFW	#0000
1791+  CC62 4F          	DEFB	#4F
1792+  CC63             FHandleTR
1793+  CC63 00          	DEFB	#00
1794+  CC64             ReadTLen
1795+  CC64 00          	DEFS	4,0
1796+  CC68             TRDIndef
1797+  CC68 00          	DEFB	#00
1798+  CC69             ;[]-----------------------------------------------------------[]
1799+  CC69             TestEXT
1800+  CC69 DD E5       	PUSH	IX
1801+  CC6B DD 6B       	LD	LX,E
1802+  CC6D DD 62       	LD	HX,D
1803+  CC6F EB          	EX	DE,HL
1804+  CC70 3E 2E       	LD	A,"."
1805+  CC72 23          	INC	HL
1806+  CC73 BE          	CP	(HL)
1807+  CC74 20 FC       	JR	NZ,$-2
1808+  CC76 23          	INC	HL
1809+  CC77 EB          	EX	DE,HL
1810+  CC78 E1          	POP	HL
1811+  CC79 DB A2       	IN	A,(PAGE1)
1812+  CC7B F5          	PUSH	AF
1813+  CC7C 3A EA A7    	LD	A,(HelpPg)
1814+  CC7F D3 A2       	OUT	(PAGE1),A
1815+  CC81             TestEXT1
1816+  CC81 4E          	LD	C,(HL)
1817+  CC82 23          	INC	HL
1818+  CC83 46          	LD	B,(HL)
1819+  CC84 23          	INC	HL
1820+  CC85 78          	LD	A,B
1821+  CC86 B1          	OR	C
1822+  CC87 28 25       	JR	Z,TestEND
1823+  CC89 D5          	PUSH	DE
1824+  CC8A EB          	EX	DE,HL
1825+  CC8B 1A          	LD	A,(DE)
1826+  CC8C 13          	INC	DE
1827+  CC8D FE 3F       	CP	"?"
1828+  CC8F 28 03       	JR	Z,$+5
1829+  CC91 BE          	CP	(HL)
1830+  CC92 20 12       	JR	NZ,TestEXTn
1831+  CC94 23          	INC	HL
1832+  CC95 1A          	LD	A,(DE)
1833+  CC96 13          	INC	DE
1834+  CC97 FE 3F       	CP	"?"
1835+  CC99 28 03       	JR	Z,$+5
1836+  CC9B BE          	CP	(HL)
1837+  CC9C 20 08       	JR	NZ,TestEXTn
1838+  CC9E 23          	INC	HL
1839+  CC9F 1A          	LD	A,(DE)
1840+  CCA0 13          	INC	DE
1841+  CCA1 FE 3F       	CP	"?"
1842+  CCA3 28 01       	JR	Z,TestEXTn
1843+  CCA5 BE          	CP	(HL)
1844+  CCA6             TestEXTn
1845+  CCA6 EB          	EX	DE,HL
1846+  CCA7 D1          	POP	DE
1847+  CCA8 28 09       	JR	Z,TestEXTok
1848+  CCAA 69          	LD	L,C
1849+  CCAB 60          	LD	H,B
1850+  CCAC 18 D3       	JR	TestEXT1
1851+  CCAE             TestEND
1852+  CCAE F1          	POP	AF
1853+  CCAF D3 A2       	OUT	(PAGE1),A
1854+  CCB1 37          	SCF 
1855+  CCB2 C9          	RET 
1856+  CCB3             TestEXTok
1857+  CCB3 11 00 80    	LD	DE,WorkBuffer
1858+  CCB6 0E 00       	LD	C,#00
1859+  CCB8 79          TstEXT0	LD	A,C
1860+  CCB9 ED A0       	LDI 
1861+  CCBB 4F          	LD	C,A
1862+  CCBC 7E          	LD	A,(HL)
1863+  CCBD B7          	OR	A
1864+  CCBE 28 58       	JR	Z,TstEXT2
1865+  CCC0 FE 20       	CP	#20
1866+  CCC2 28 37       	JR	Z,TstEXT1
1867+  CCC4 FE 2E       	CP	"."
1868+  CCC6 20 F0       	JR	NZ,TstEXT0
1869+  CCC8 12          	LD	(DE),A
1870+  CCC9 23          	INC	HL
1871+  CCCA 13          	INC	DE
1872+  CCCB 7E          	LD	A,(HL)
1873+  CCCC 12          	LD	(DE),A
1874+  CCCD 23          	INC	HL
1875+  CCCE 13          	INC	DE
1876+  CCCF FE 20       	CP	#20
1877+  CCD1 28 28       	JR	Z,TstEXT1
1878+  CCD3 CB AF       	RES	5,A
1879+  CCD5 FE 46       	CP	"F"
1880+  CCD7 20 02       	JR	NZ,$+4
1881+  CCD9 CB C1       	SET	0,C
1882+  CCDB 7E          	LD	A,(HL)
1883+  CCDC 12          	LD	(DE),A
1884+  CCDD 23          	INC	HL
1885+  CCDE 13          	INC	DE
1886+  CCDF FE 20       	CP	#20
1887+  CCE1 28 18       	JR	Z,TstEXT1
1888+  CCE3 CB AF       	RES	5,A
1889+  CCE5 FE 4C       	CP	"L"
1890+  CCE7 20 02       	JR	NZ,$+4
1891+  CCE9 CB C9       	SET	1,C
1892+  CCEB 7E          	LD	A,(HL)
1893+  CCEC 12          	LD	(DE),A
1894+  CCED 23          	INC	HL
1895+  CCEE 13          	INC	DE
1896+  CCEF FE 20       	CP	#20
1897+  CCF1 28 08       	JR	Z,TstEXT1
1898+  CCF3 CB AF       	RES	5,A
1899+  CCF5 FE 58       	CP	"X"
1900+  CCF7 20 02       	JR	NZ,TstEXT1
1901+  CCF9 CB D1       	SET	2,C
1902+  CCFB 7E          TstEXT1	LD	A,(HL)
1903+  CCFC FE 21       	CP	"!"
1904+  CCFE 20 12       	JR	NZ,TstEX11
1905+  CD00 23          	INC	HL
1906+  CD01 7E          	LD	A,(HL)
1907+  CD02 FE 2E       	CP	"."
1908+  CD04 CA 76 CD    	JP	Z,EName
1909+  CD07 FE 3A       	CP	":"
1910+  CD09 CA 8F CD    	JP	Z,EDrive
1911+  CD0C FE 5C       	CP	"\\"
1912+  CD0E CA 9C CD    	JP	Z,EPath
1913+  CD11 2B          	DEC	HL
1914+  CD12 12          TstEX11	LD	(DE),A
1915+  CD13 23          	INC	HL
1916+  CD14 13          	INC	DE
1917+  CD15 B7          	OR	A
1918+  CD16 20 E3       	JR	NZ,TstEXT1
1919+  CD18 12          TstEXT2	LD	(DE),A
1920+  CD19 F1          	POP	AF
1921+  CD1A D3 A2       	OUT	(PAGE1),A
1922+  CD1C 21 00 80    	LD	HL,WorkBuffer
1923+  CD1F 79          	LD	A,C
1924+  CD20 FE 07       	CP	#07
1925+  CD22 CA B9 CD    	JP	Z,RunFLEX
1926+  CD25 11 00 81    	LD	DE,WorkBuffer+#100
1927+  CD28 01 19 01    	LD	BC,#0119
1928+  CD2B 3E 37       	LD	A,#37
1929+  CD2D FD E5       	PUSH	IY
1930+  CD2F D7          	RST	#10
1931+  CD30 FD E1       	POP	IY
1932+  CD32 DA 65 CD    	JP	C,RestoreDIR
1933+  CD35 CD 16 E6    	CALL	ResDrivers
1934+  CD38 97          	SUB	A
1935+  CD39 CD BB 86    	CALL	ClearScreen
1936+  CD3C CD 98 E4    	CALL	ResVModeE
1937+  CD3F 21 00 80    	LD	HL,WorkBuffer
1938+  CD42 01 40 00    	LD	BC,#0040
1939+  CD45 D7          	RST	#10
1940+  CD46 F5          	PUSH	AF
1941+  CD47 97          	SUB	A
1942+  CD48 D3 FE       	OUT	(BORDER),A
1943+  CD4A 3E C0       	LD	A,#C0
1944+  CD4C D3 89       	OUT	(YPORT),A
1945+  CD4E CD 10 E4    	CALL	InitVMode
1946+  CD51 CD A4 E4    	CALL	InitDrivers
1947+  CD54 CD 20 E6    	CALL	InitScreen
1948+  CD57 CD 88 EB    	CALL	ClrDOSline
1949+  CD5A 3E 02       	LD	A,#02
1950+  CD5C CD C3 E7    	CALL	InitPanels
1951+  CD5F F1          	POP	AF
1952+  CD60 DC A8 86    	CALL	C,DOSError
1953+  CD63 B7          	OR	A
1954+  CD64 C9          	RET 
1955+  CD65             RestoreDIR
1956+  CD65 F5          	PUSH	AF
1957+  CD66 FD E5       	PUSH	IY
1958+  CD68 E1          	POP	HL
1959+  CD69 01 2C 00    	LD	BC,BegPath
1960+  CD6C 09          	ADD	HL,BC
1961+  CD6D 0E 1D       	LD	C,#1D
1962+  CD6F FD E5       	PUSH	IY
1963+  CD71 D7          	RST	#10
1964+  CD72 FD E1       	POP	IY
1965+  CD74 F1          	POP	AF
1966+  CD75 C9          	RET 
1967+  CD76             EName
1968+  CD76 23          	INC	HL
1969+  CD77 7E          	LD	A,(HL)
1970+  CD78 2B          	DEC	HL
1971+  CD79 FE 21       	CP	"!"
1972+  CD7B 20 95       	JR	NZ,TstEX11
1973+  CD7D 23          	INC	HL
1974+  CD7E E5          	PUSH	HL
1975+  CD7F C5          	PUSH	BC
1976+  CD80 21 CD BD    	LD	HL,PrevFile
1977+  CD83 97          	SUB	A
1978+  CD84 ED A0       	LDI 
1979+  CD86 BE          	CP	(HL)
1980+  CD87 20 FB       	JR	NZ,$-3
1981+  CD89 C1          	POP	BC
1982+  CD8A E1          	POP	HL
1983+  CD8B 23          	INC	HL
1984+  CD8C C3 FB CC    	JP	TstEXT1
1985+  CD8F             EDrive
1986+  CD8F FD 7E 2C    	LD	A,(IY+BegPath)
1987+  CD92 12          	LD	(DE),A
1988+  CD93 13          	INC	DE
1989+  CD94 3E 3A       	LD	A,":"
1990+  CD96 12          	LD	(DE),A
1991+  CD97 13          	INC	DE
1992+  CD98 23          	INC	HL
1993+  CD99 C3 FB CC    	JP	TstEXT1
1994+  CD9C             EPath
1995+  CD9C E5          	PUSH	HL
1996+  CD9D C5          	PUSH	BC
1997+  CD9E FD E5       	PUSH	IY
1998+  CDA0 E1          	POP	HL
1999+  CDA1 01 2C 00    	LD	BC,BegPath
2000+  CDA4 09          	ADD	HL,BC
2001+  CDA5 97          	SUB	A
2002+  CDA6 ED A0       	LDI 
2003+  CDA8 BE          	CP	(HL)
2004+  CDA9 20 FB       	JR	NZ,$-3
2005+  CDAB 2B          	DEC	HL
2006+  CDAC 3E 5C       	LD	A,"\\"
2007+  CDAE BE          	CP	(HL)
2008+  CDAF 28 02       	JR	Z,$+4
2009+  CDB1 12          	LD	(DE),A
2010+  CDB2 13          	INC	DE
2011+  CDB3 C1          	POP	BC
2012+  CDB4 E1          	POP	HL
2013+  CDB5 23          	INC	HL
2014+  CDB6 C3 FB CC    	JP	TstEXT1
2015+  CDB9             RunFLEX
2016+  CDB9 21 65 CD    	LD	HL,RestoreDIR
2017+  CDBC E5          	PUSH	HL
2018+  CDBD 21 00 80    	LD	HL,WorkBuffer
2019+  CDC0 3E 21       	LD	A,#21
2020+  CDC2 23          	INC	HL
2021+  CDC3 BE          	CP	(HL)
2022+  CDC4 38 FC       	JR	C,$-2
2023+  CDC6 97          	SUB	A
2024+  CDC7 77          	LD	(HL),A
2025+  CDC8 23          	INC	HL
2026+  CDC9 E5          	PUSH	HL
2027+  CDCA 21 00 80    	LD	HL,WorkBuffer
2028+  CDCD 3E 01       	LD	A,#01
2029+  CDCF 0E 11       	LD	C,#11
2030+  CDD1 FD E5       	PUSH	IY
2031+  CDD3 D7          	RST	#10
2032+  CDD4 FD E1       	POP	IY
2033+  CDD6 E1          	POP	HL
2034+  CDD7 D8          	RET	C
2035+  CDD8 32 A2 CE    	LD	(FLXHandle),A
2036+  CDDB E5          	PUSH	HL
2037+  CDDC DD 21 00 00 	LD	IX,#0000
2038+  CDE0 21 00 00    	LD	HL,#0000
2039+  CDE3 01 15 02    	LD	BC,#0215
2040+  CDE6 FD E5       	PUSH	IY
2041+  CDE8 D7          	RST	#10
2042+  CDE9 FD E1       	POP	IY
2043+  CDEB DD 7C       	LD	A,HX
2044+  CDED E6 C0       	AND	#C0
2045+  CDEF B4          	OR	H
2046+  CDF0 B5          	OR	L
2047+  CDF1 E1          	POP	HL
2048+  CDF2 37          	SCF 
2049+  CDF3 3E 1E       	LD	A,#1E
2050+  CDF5 C0          	RET	NZ
2051+  CDF6             
2052+  CDF6 FD E5       	PUSH	IY
2053+  CDF8 E5          	PUSH	HL
2054+  CDF9 3E C0       	LD	A,#C0
2055+  CDFB D3 89       	OUT	(YPORT),A
2056+  CDFD DD 21 00 00 	LD	IX,#0000
2057+  CE01 21 00 00    	LD	HL,#0000
2058+  CE04 01 15 00    	LD	BC,#0015
2059+  CE07 3A A2 CE    	LD	A,(FLXHandle)
2060+  CE0A D7          	RST	#10
2061+  CE0B DB A2       	IN	A,(PAGE1)
2062+  CE0D F5          	PUSH	AF
2063+  CE0E 3A ED A7    	LD	A,(WorkPage)
2064+  CE11 D3 A2       	OUT	(PAGE1),A
2065+  CE13 21 00 81    	LD	HL,#8100
2066+  CE16 11 10 00    	LD	DE,#0010
2067+  CE19 3A A2 CE    	LD	A,(FLXHandle)
2068+  CE1C 0E 13       	LD	C,#13
2069+  CE1E E5          	PUSH	HL
2070+  CE1F D7          	RST	#10
2071+  CE20 E1          	POP	HL
2072+  CE21 38 3F       	JR	C,RFlex1
2073+  CE23 7E          	LD	A,(HL)
2074+  CE24 23          	INC	HL
2075+  CE25 FE 46       	CP	"F"
2076+  CE27 37          	SCF 
2077+  CE28 3E 10       	LD	A,#10
2078+  CE2A 20 36       	JR	NZ,RFlex1
2079+  CE2C 7E          	LD	A,(HL)
2080+  CE2D 23          	INC	HL
2081+  CE2E FE 4C       	CP	"L"
2082+  CE30 37          	SCF 
2083+  CE31 3E 10       	LD	A,#10
2084+  CE33 20 2D       	JR	NZ,RFlex1
2085+  CE35 7E          	LD	A,(HL)
2086+  CE36 23          	INC	HL
2087+  CE37 FE 58       	CP	"X"
2088+  CE39 37          	SCF 
2089+  CE3A 3E 10       	LD	A,#10
2090+  CE3C 20 24       	JR	NZ,RFlex1
2091+  CE3E 2E 08       	LD	L,#08
2092+  CE40 5E          	LD	E,(HL)
2093+  CE41 23          	INC	HL
2094+  CE42 56          	LD	D,(HL)
2095+  CE43 23          	INC	HL
2096+  CE44 4E          	LD	C,(HL)
2097+  CE45 23          	INC	HL
2098+  CE46 46          	LD	B,(HL)
2099+  CE47 23          	INC	HL
2100+  CE48 ED 43 74 CE 	LD	(FLXexec+1),BC
2101+  CE4C 7E          	LD	A,(HL)
2102+  CE4D 23          	INC	HL
2103+  CE4E 32 89 CE    	LD	(FLXmode+1),A
2104+  CE51 CB BA       	RES	7,D
2105+  CE53 CB F2       	SET	6,D
2106+  CE55 21 00 80    	LD	HL,#8000
2107+  CE58 B7          	OR	A
2108+  CE59 ED 52       	SBC	HL,DE
2109+  CE5B EB          	EX	DE,HL
2110+  CE5C 3A A2 CE    	LD	A,(FLXHandle)
2111+  CE5F 0E 13       	LD	C,#13
2112+  CE61 D7          	RST	#10
2113+  CE62 08          RFlex1	EX	AF,AF'
2114+  CE63 F1          	POP	AF
2115+  CE64 D3 A2       	OUT	(PAGE1),A
2116+  CE66 08          	EX	AF,AF'
2117+  CE67 F5          	PUSH	AF
2118+  CE68 3A A2 CE    	LD	A,(FLXHandle)
2119+  CE6B 0E 12       	LD	C,#12
2120+  CE6D D7          	RST	#10
2121+  CE6E F1          	POP	AF
2122+  CE6F E1          	POP	HL
2123+  CE70 FD E1       	POP	IY
2124+  CE72 D8          	RET	C
2125+  CE73 11 00 00    FLXexec	LD	DE,#0000
2126+  CE76 CB FA       	SET	7,D
2127+  CE78 CB F2       	SET	6,D
2128+  CE7A 3A ED A7    	LD	A,(WorkPage)
2129+  CE7D 0E E2       	LD	C,PAGE3
2130+  CE7F FD E5       	PUSH	IY
2131+  CE81 CD 9A A4    	CALL	Resident
2132+  CE84 FD E1       	POP	IY
2133+  CE86 3F          	CCF 
2134+  CE87 D0          	RET	NC
2135+  CE88 3E 00       FLXmode	LD	A,#00
2136+  CE8A B7          	OR	A
2137+  CE8B C8          	RET	Z
2138+  CE8C 33          	INC	SP
2139+  CE8D 33          	INC	SP
2140+  CE8E 97          	SUB	A
2141+  CE8F D3 FE       	OUT	(BORDER),A
2142+  CE91 3E C0       	LD	A,#C0
2143+  CE93 D3 89       	OUT	(YPORT),A
2144+  CE95 CD 20 E6    	CALL	InitScreen
2145+  CE98 CD 88 EB    	CALL	ClrDOSline
2146+  CE9B 3E 02       	LD	A,#02
2147+  CE9D CD C3 E7    	CALL	InitPanels
2148+  CEA0 B7          	OR	A
2149+  CEA1 C9          	RET 
2150+  CEA2             FLXHandle
2151+  CEA2 00          	DEFB	#00
2152+  CEA3             ;[]===========================================================[]
2153+  CEA3             Help
2154+  CEA3 11 38 4F    	LD	DE,HelpR
2155+  CEA6 3A EA A7    	LD	A,(HelpPg)
2156+  CEA9 0E A2       	LD	C,PAGE1
2157+  CEAB CD 9A A4    	CALL	Resident
2158+  CEAE C9          	RET 
2159+  CEAF             ;[]----------------------------------------------------------[]
2160+  CEAF             ViewFileSH
2161+  CEAF FD CB 01 4E 	BIT	1,(IY+ViewFlg)
2162+  CEB3 C0          	RET	NZ
2163+  CEB4 FD 7E 13    	LD	A,(IY+PanelEFl)
2164+  CEB7 FD B6 14    	OR	(IY+PanelEFh)
2165+  CEBA C8          	RET	Z
2166+  CEBB CD F9 BA    	CALL	ResInvert
2167+  CEBE 21 EA BA    	LD	HL,SetInvert
2168+  CEC1 E5          	PUSH	HL
2169+  CEC2 CD F0 86    	CALL	MakeWindow
2170+  CEC5 01          	DEFB	#01
2171+  CEC6 C8 00 51 00 	DEFW	#00C8,#0051
2172+  CECA F0 00 3E 00 	DEFW	#00F0,#003E
2173+  CECE 02          	DEFB	#02	;Head place
2174+  CECF 04 00 02 00 	DEFW	#0004,#0002
2175+  CED3 E8 00 0A 00 	DEFW	#00E8,#000A
2176+  CED7 00          	DEFB	#00
2177+  CED8 01          	DEFB	#01	;Text Line
2178+  CED9 6C 00 03 00 	DEFW	#006C,#0003
2179+  CEDD 0F          	DEFB	#0F
2180+  CEDE 5669657700  	DEFB	"View",0
2181+  CEE3 04          	DEFB	#04	;UpRectan
2182+  CEE4 28 00 2A 00 	DEFW	#0028,#002A
2183+  CEE8 48 00 0E 00 	DEFW	#0048,#000E
2184+  CEEC 01          	DEFB	#01	;Text Line
2185+  CEED 44 00 2D 00 	DEFW	#0044,#002D
2186+  CEF1 80          	DEFB	#80
2187+  CEF2 4F 6B 00    	DEFB	"Ok",0
2188+  CEF5 04          	DEFB	#04	;UpRectan
2189+  CEF6 80 00 2A 00 	DEFW	#0080,#002A
2190+  CEFA 48 00 0E 00 	DEFW	#0048,#000E
2191+  CEFE 01          	DEFB	#01	;Text Line
2192+  CEFF 94 00 2D 00 	DEFW	#0094,#002D
2193+  CF03 80          	DEFB	#80
2194+  CF04             	DEFB	"Cancel",0
2194+  CF04 43616E63656C00
2195+  CF0B 01          	DEFB	#01	;Text Line
2196+  CF0C 0C 00 19 00 	DEFW	#000C,#0019
2197+  CF10 80          	DEFB	#80
2198+  CF11             	DEFB	"View the file:",0
2198+  CF11 56696577207468652066696C653A00
2199+  CF20 03          	DEFB	#03	;Углубление
2200+  CF21 56 00 16 00 	DEFW	#0056,#0016
2201+  CF25 86 00 0C 00 	DEFW	#0086,#000C
2202+  CF29 02          	DEFB	#02	;Head place
2203+  CF2A 58 00 17 00 	DEFW	#0058,#0017
2204+  CF2E 82 00 0A 00 	DEFW	#0082,#000A
2205+  CF32 0F          	DEFB	#0F
2206+  CF33 00          	DEFB	#00
2207+  CF34 DD 21 63 CF 	LD	IX,ViewStr
2208+  CF38 21 59 FC    	LD	HL,ViewEditTab
2209+  CF3B CD 68 91    	CALL	InputLine
2210+  CF3E CD F0 86    	CALL	MakeWindow
2211+  CF41 7F          	DEFB	#7F
2212+  CF42 00          	DEFB	#00
2213+  CF43 D8          	RET	C
2214+  CF44 3A 67 CF    	LD	A,(ViewLen)
2215+  CF47 B7          	OR	A
2216+  CF48 C8          	RET	Z
2217+  CF49 21 6F CF    	LD	HL,ViewName
2218+  CF4C 11 CD BD    	LD	DE,PrevFile
2219+  CF4F 47          	LD	B,A
2220+  CF50 7E          ViewSH1	LD	A,(HL)
2221+  CF51 CD 57 AA    	CALL	CorrBigChar
2222+  CF54 77          	LD	(HL),A
2223+  CF55 12          	LD	(DE),A
2224+  CF56 23          	INC	HL
2225+  CF57 13          	INC	DE
2226+  CF58 10 F6       	DJNZ	ViewSH1
2227+  CF5A 97          	SUB	A
2228+  CF5B 12          	LD	(DE),A
2229+  CF5C E1          	POP	HL
2230+  CF5D CD EA BA    	CALL	SetInvert
2231+  CF60 C3 DF CF    	JP	View
2232+  CF63             ViewStr
2233+  CF63 0C 00 00 00 	DEFB	#0C,#00,#00,#00
2234+  CF67 00          ViewLen	DEFB	#00
2235+  CF68 22 01 6A 00 	DEFW	#0122,#006A
2236+  CF6C 68 00       	DEFW	#0068
2237+  CF6E F0          	DEFB	#F0
2238+  CF6F 00          ViewName DEFS	 #0D,#00
2239+  CF7C             ;-------------------------------------------
2240+  CF7C             ViewFile
2241+  CF7C 97          	SUB	A
2242+  CF7D 18 02       	JR	StViewFile+2
2243+  CF7F             ;-------------------------------------------
2244+  CF7F             StViewFile
2245+  CF7F 3E 01       	LD	A,#01
2246+  CF81 32 DB CF    	LD	(VFlag+1),A
2247+  CF84 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
2248+  CF88 C0          	RET	NZ
2249+  CF89 FD 7E 13    	LD	A,(IY+PanelEFl)
2250+  CF8C FD B6 14    	OR	(IY+PanelEFh)
2251+  CF8F C8          	RET	Z
2252+  CF90 DB A2       	IN	A,(PAGE1)
2253+  CF92 F5          	PUSH	AF
2254+  CF93 FD CB 00 46 	BIT	0,(IY+PanelFlg)
2255+  CF97 3A EE A7    	LD	A,(DIRpage1)
2256+  CF9A 28 03       	JR	Z,$+5
2257+  CF9C 3A EF A7    	LD	A,(DIRpage2)
2258+  CF9F D3 A2       	OUT	(PAGE1),A
2259+  CFA1 FD 6E 15    	LD	L,(IY+PanelFFl)
2260+  CFA4 FD 66 16    	LD	H,(IY+PanelFFh)
2261+  CFA7 FD 5E 17    	LD	E,(IY+PanelCFl)
2262+  CFAA FD 56 18    	LD	D,(IY+PanelCFh)
2263+  CFAD 19          	ADD	HL,DE
2264+  CFAE 29          	ADD	HL,HL
2265+  CFAF 29          	ADD	HL,HL
2266+  CFB0 29          	ADD	HL,HL
2267+  CFB1 5D          	LD	E,L
2268+  CFB2 54          	LD	D,H
2269+  CFB3 29          	ADD	HL,HL
2270+  CFB4 19          	ADD	HL,DE
2271+  CFB5 CB F4       	SET	6,H
2272+  CFB7 11 00 80    	LD	DE,WorkBuffer
2273+  CFBA 01 0E 00    	LD	BC,#000E
2274+  CFBD E5          	PUSH	HL
2275+  CFBE 09          	ADD	HL,BC
2276+  CFBF ED A0       	LDI 
2277+  CFC1 E1          	POP	HL
2278+  CFC2 23          	INC	HL
2279+  CFC3 CD 6A BE    	CALL	MakeDOSname
2280+  CFC6 F1          	POP	AF
2281+  CFC7 D3 A2       	OUT	(PAGE1),A
2282+  CFC9 21 00 80    	LD	HL,WorkBuffer
2283+  CFCC CB 66       	BIT	4,(HL)
2284+  CFCE C0          	RET	NZ
2285+  CFCF 23          	INC	HL
2286+  CFD0 11 CD BD    	LD	DE,PrevFile
2287+  CFD3 97          	SUB	A
2288+  CFD4 ED A0       	LDI 
2289+  CFD6 BE          	CP	(HL)
2290+  CFD7 20 FB       	JR	NZ,$-3
2291+  CFD9 12          	LD	(DE),A
2292+  CFDA 3E 00       VFlag	LD	A,#00
2293+  CFDC B7          	OR	A
2294+  CFDD 20 0B       	JR	NZ,View1
2295+  CFDF DD 21 00 46 View	LD	IX,fnview_ext
2296+  CFE3 11 CD BD    	LD	DE,PrevFile
2297+  CFE6 CD 69 CC    	CALL	TestEXT
2298+  CFE9 D0          	RET	NC
2299+  CFEA CD F9 BA    View1	CALL	ResInvert
2300+  CFED 21 EA BA    	LD	HL,SetInvert
2301+  CFF0 E5          	PUSH	HL
2302+  CFF1 FD E5       	PUSH	IY
2303+  CFF3 21 CD BD    	LD	HL,PrevFile
2304+  CFF6 11 00 C0    	LD	DE,#C000
2305+  CFF9 3A E8 A7    	LD	A,(ViewPg)
2306+  CFFC 0E E2       	LD	C,PAGE3
2307+  CFFE CD 9A A4    	CALL	Resident
2308+  D001 FD E1       	POP	IY
2309+  D003 D8          	RET	C
2310+  D004 97          	SUB	A
2311+  D005 D3 FE       	OUT	(BORDER),A
2312+  D007 3E C0       	LD	A,#C0
2313+  D009 D3 89       	OUT	(YPORT),A
2314+  D00B CD 20 E6    	CALL	InitScreen
2315+  D00E CD 88 EB    	CALL	ClrDOSline
2316+  D011 3E 02       	LD	A,#02
2317+  D013 CD C3 E7    	CALL	InitPanels
2318+  D016 E1          	POP	HL
2319+  D017 C9          	RET 
2320+  D018             ;[]----------------------------------------------------------[]
2321+  D018             EditFileSH
2322+  D018 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
2323+  D01C C0          	RET	NZ
2324+  D01D CD F9 BA    	CALL	ResInvert
2325+  D020 21 EA BA    	LD	HL,SetInvert
2326+  D023 E5          	PUSH	HL
2327+  D024 CD F0 86    	CALL	MakeWindow
2328+  D027 01          	DEFB	#01
2329+  D028 C8 00 51 00 	DEFW	#00C8,#0051
2330+  D02C F0 00 3E 00 	DEFW	#00F0,#003E
2331+  D030 02          	DEFB	#02	;Head place
2332+  D031 04 00 02 00 	DEFW	#0004,#0002
2333+  D035 E8 00 0A 00 	DEFW	#00E8,#000A
2334+  D039 00          	DEFB	#00
2335+  D03A 01          	DEFB	#01	;Text Line
2336+  D03B 6E 00 03 00 	DEFW	#006E,#0003
2337+  D03F 0F          	DEFB	#0F
2338+  D040 4564697400  	DEFB	"Edit",0
2339+  D045 04          	DEFB	#04	;UpRectan
2340+  D046 28 00 2A 00 	DEFW	#0028,#002A
2341+  D04A 48 00 0E 00 	DEFW	#0048,#000E
2342+  D04E 01          	DEFB	#01	;Text Line
2343+  D04F 44 00 2D 00 	DEFW	#0044,#002D
2344+  D053 80          	DEFB	#80
2345+  D054 4F 6B 00    	DEFB	"Ok",0
2346+  D057 04          	DEFB	#04	;UpRectan
2347+  D058 80 00 2A 00 	DEFW	#0080,#002A
2348+  D05C 48 00 0E 00 	DEFW	#0048,#000E
2349+  D060 01          	DEFB	#01	;Text Line
2350+  D061 94 00 2D 00 	DEFW	#0094,#002D
2351+  D065 80          	DEFB	#80
2352+  D066             	DEFB	"Cancel",0
2352+  D066 43616E63656C00
2353+  D06D 01          	DEFB	#01	;Text Line
2354+  D06E 0C 00 19 00 	DEFW	#000C,#0019
2355+  D072 80          	DEFB	#80
2356+  D073             	DEFB	"Edit the file:",0
2356+  D073 45646974207468652066696C653A00
2357+  D082 03          	DEFB	#03	;Углубление
2358+  D083 56 00 16 00 	DEFW	#0056,#0016
2359+  D087 86 00 0C 00 	DEFW	#0086,#000C
2360+  D08B 02          	DEFB	#02	;Head place
2361+  D08C 58 00 17 00 	DEFW	#0058,#0017
2362+  D090 82 00 0A 00 	DEFW	#0082,#000A
2363+  D094 0F          	DEFB	#0F
2364+  D095 00          	DEFB	#00
2365+  D096 DD 21 C5 D0 	LD	IX,EditStr
2366+  D09A 21 59 FC    	LD	HL,ViewEditTab
2367+  D09D CD 68 91    	CALL	InputLine
2368+  D0A0 CD F0 86    	CALL	MakeWindow
2369+  D0A3 7F          	DEFB	#7F
2370+  D0A4 00          	DEFB	#00
2371+  D0A5 D8          	RET	C
2372+  D0A6 3A C9 D0    	LD	A,(EditLen)
2373+  D0A9 B7          	OR	A
2374+  D0AA C8          	RET	Z
2375+  D0AB 21 D1 D0    	LD	HL,EditName
2376+  D0AE 11 CD BD    	LD	DE,PrevFile
2377+  D0B1 47          	LD	B,A
2378+  D0B2 7E          EditSH1	LD	A,(HL)
2379+  D0B3 CD 57 AA    	CALL	CorrBigChar
2380+  D0B6 77          	LD	(HL),A
2381+  D0B7 12          	LD	(DE),A
2382+  D0B8 23          	INC	HL
2383+  D0B9 13          	INC	DE
2384+  D0BA 10 F6       	DJNZ	EditSH1
2385+  D0BC 97          	SUB	A
2386+  D0BD 12          	LD	(DE),A
2387+  D0BE E1          	POP	HL
2388+  D0BF CD EA BA    	CALL	SetInvert
2389+  D0C2 C3 41 D1    	JP	Edit
2390+  D0C5             EditStr
2391+  D0C5 0C 00 00 00 	DEFB	#0C,#00,#00,#00
2392+  D0C9 00          EditLen	DEFB	#00
2393+  D0CA 22 01 6A 00 	DEFW	#0122,#006A
2394+  D0CE 68 00       	DEFW	#0068
2395+  D0D0 F0          	DEFB	#F0
2396+  D0D1 00          EditName DEFS	 #0D,#00
2397+  D0DE             ;-------------------------------------------
2398+  D0DE             EditFile
2399+  D0DE 97          	SUB	A
2400+  D0DF 18 02       	JR	StEditFile+2
2401+  D0E1             ;-------------------------------------------
2402+  D0E1             StEditFile
2403+  D0E1 3E 01       	LD	A,#01
2404+  D0E3 32 3D D1    	LD	(EFlag+1),A
2405+  D0E6 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
2406+  D0EA C0          	RET	NZ
2407+  D0EB FD 7E 13    	LD	A,(IY+PanelEFl)
2408+  D0EE FD B6 14    	OR	(IY+PanelEFh)
2409+  D0F1 C8          	RET	Z
2410+  D0F2 DB A2       	IN	A,(PAGE1)
2411+  D0F4 F5          	PUSH	AF
2412+  D0F5 FD CB 00 46 	BIT	0,(IY+PanelFlg)
2413+  D0F9 3A EE A7    	LD	A,(DIRpage1)
2414+  D0FC 28 03       	JR	Z,$+5
2415+  D0FE 3A EF A7    	LD	A,(DIRpage2)
2416+  D101 D3 A2       	OUT	(PAGE1),A
2417+  D103 FD 6E 15    	LD	L,(IY+PanelFFl)
2418+  D106 FD 66 16    	LD	H,(IY+PanelFFh)
2419+  D109 FD 5E 17    	LD	E,(IY+PanelCFl)
2420+  D10C FD 56 18    	LD	D,(IY+PanelCFh)
2421+  D10F 19          	ADD	HL,DE
2422+  D110 29          	ADD	HL,HL
2423+  D111 29          	ADD	HL,HL
2424+  D112 29          	ADD	HL,HL
2425+  D113 5D          	LD	E,L
2426+  D114 54          	LD	D,H
2427+  D115 29          	ADD	HL,HL
2428+  D116 19          	ADD	HL,DE
2429+  D117 CB F4       	SET	6,H
2430+  D119 11 00 80    	LD	DE,WorkBuffer
2431+  D11C 01 0E 00    	LD	BC,#000E
2432+  D11F E5          	PUSH	HL
2433+  D120 09          	ADD	HL,BC
2434+  D121 ED A0       	LDI 
2435+  D123 E1          	POP	HL
2436+  D124 23          	INC	HL
2437+  D125 CD 6A BE    	CALL	MakeDOSname
2438+  D128 F1          	POP	AF
2439+  D129 D3 A2       	OUT	(PAGE1),A
2440+  D12B 21 00 80    	LD	HL,WorkBuffer
2441+  D12E CB 66       	BIT	4,(HL)
2442+  D130 C0          	RET	NZ
2443+  D131 23          	INC	HL
2444+  D132 11 CD BD    	LD	DE,PrevFile
2445+  D135 97          	SUB	A
2446+  D136 ED A0       	LDI 
2447+  D138 BE          	CP	(HL)
2448+  D139 20 FB       	JR	NZ,$-3
2449+  D13B 12          	LD	(DE),A
2450+  D13C 3E 00       EFlag	LD	A,#00
2451+  D13E B7          	OR	A
2452+  D13F 20 0B       	JR	NZ,Edit1
2453+  D141 DD 21 00 4A Edit	LD	IX,fnedit_ext
2454+  D145 11 CD BD    	LD	DE,PrevFile
2455+  D148 CD 69 CC    	CALL	TestEXT
2456+  D14B D0          	RET	NC
2457+  D14C CD F9 BA    Edit1	CALL	ResInvert
2458+  D14F 21 EA BA    	LD	HL,SetInvert
2459+  D152 E5          	PUSH	HL
2460+  D153 FD E5       	PUSH	IY
2461+  D155 21 CD BD    	LD	HL,PrevFile
2462+  D158 11 00 C0    	LD	DE,#C000
2463+  D15B 3A E9 A7    	LD	A,(EditPg)
2464+  D15E 0E E2       	LD	C,PAGE3
2465+  D160 CD 9A A4    	CALL	Resident
2466+  D163 FD E1       	POP	IY
2467+  D165 D8          	RET	C
2468+  D166 97          	SUB	A
2469+  D167 D3 FE       	OUT	(BORDER),A
2470+  D169 3E C0       	LD	A,#C0
2471+  D16B D3 89       	OUT	(YPORT),A
2472+  D16D CD 20 E6    	CALL	InitScreen
2473+  D170 CD 88 EB    	CALL	ClrDOSline
2474+  D173 3E 02       	LD	A,#02
2475+  D175 CD C3 E7    	CALL	InitPanels
2476+  D178 E1          	POP	HL
2477+  D179 C9          	RET 
2478+  D17A             ;[]----------------------------------------------------------[]
2479+  D17A             CopyFiles
2480+  D17A 11 00 40    	LD	DE,CopyFilesR
2481+  D17D 3A E7 A7    	LD	A,(FunctPg)
2482+  D180 0E A2       	LD	C,PAGE1
2483+  D182 CD 9A A4    	CALL	Resident
2484+  D185 C9          	RET 
2485+  D186             ;[]----------------------------------------------------------[]
2486+  D186             ReName
2487+  D186 11 32 48    	LD	DE,ReNameR
2488+  D189 3A E7 A7    	LD	A,(FunctPg)
2489+  D18C 0E A2       	LD	C,PAGE1
2490+  D18E CD 9A A4    	CALL	Resident
2491+  D191 C9          	RET 
2492+  D192             ;[]----------------------------------------------------------[]
2493+  D192             MakeDIR
2494+  D192 11 85 4C    	LD	DE,MakeDIRR
2495+  D195 3A E7 A7    	LD	A,(FunctPg)
2496+  D198 0E A2       	LD	C,PAGE1
2497+  D19A CD 9A A4    	CALL	Resident
2498+  D19D C9          	RET 
2499+  D19E             ;[]----------------------------------------------------------[]
2500+  D19E             DeleteFiles
2501+  D19E 11 64 4F    	LD	DE,DeleteFilesR
2502+  D1A1 3A E7 A7    	LD	A,(FunctPg)
2503+  D1A4 0E A2       	LD	C,PAGE1
2504+  D1A6 CD 9A A4    	CALL	Resident
2505+  D1A9 C9          	RET 
2506+  D1AA             ;[]----------------------------------------------------------[]
2507+  D1AA             Quit
2508+  D1AA CD F9 BA    	CALL	ResInvert
2509+  D1AD 11 BF 55    	LD	DE,QuitR
2510+  D1B0 3A E7 A7    	LD	A,(FunctPg)
2511+  D1B3 0E A2       	LD	C,PAGE1
2512+  D1B5 CD 9A A4    	CALL	Resident
2513+  D1B8 DA EA BA    	JP	C,SetInvert
2514+  D1BB 21 4C A5    	LD	HL,ComExit
2515+  D1BE E3          	EX	(SP),HL
2516+  D1BF C9          	RET 
2517+  D1C0             ;[]==========================================================[]
2518+  D1C0             Setup
2519+  D1C0 11 ED 62    	LD	DE,SetupR
2520+  D1C3 3A E7 A7    	LD	A,(FunctPg)
2521+  D1C6 0E A2       	LD	C,PAGE1
2522+  D1C8 CD 9A A4    	CALL	Resident
2523+  D1CB C9          	RET 
2524+  D1CC             ;[]----------------------------------------------------------[]
2525+  D1CC             FileInfo
2526+  D1CC CD F9 BA    	CALL	ResInvert
2527+  D1CF 21 EA BA    	LD	HL,SetInvert
2528+  D1D2 E5          	PUSH	HL
2529+  D1D3 11 5F 56    	LD	DE,FileInfoR
2530+  D1D6 3A E7 A7    	LD	A,(FunctPg)
2531+  D1D9 0E A2       	LD	C,PAGE1
2532+  D1DB CD 9A A4    	CALL	Resident
2533+  D1DE C9          	RET 
2534+  D1DF             ;[]----------------------------------------------------------[]
2535+  D1DF             PrintFile
2536+  D1DF CD F9 BA    	CALL	ResInvert
2537+  D1E2 21 EA BA    	LD	HL,SetInvert
2538+  D1E5 E5          	PUSH	HL
2539+  D1E6 11 4D 58    	LD	DE,PrintFileR
2540+  D1E9 3A E7 A7    	LD	A,(FunctPg)
2541+  D1EC 0E A2       	LD	C,PAGE1
2542+  D1EE CD 9A A4    	CALL	Resident
2543+  D1F1 C9          	RET 
2544+  D1F2             ;[]----------------------------------------------------------[]
2545+  D1F2             DiskInfo
2546+  D1F2 CD F9 BA    	CALL	ResInvert
2547+  D1F5 11 D0 5C    	LD	DE,DiskInfoR
2548+  D1F8 3A E7 A7    	LD	A,(FunctPg)
2549+  D1FB 0E A2       	LD	C,PAGE1
2550+  D1FD CD 9A A4    	CALL	Resident
2551+  D200 C9          	RET 
2552+  D201             ;[]----------------------------------------------------------[]
2553+  D201             SystemInfo
2554+  D201 11 CC 5A    	LD	DE,SystemInfoR
2555+  D204 3A E7 A7    	LD	A,(FunctPg)
2556+  D207 0E A2       	LD	C,PAGE1
2557+  D209 CD 9A A4    	CALL	Resident
2558+  D20C C9          	RET 
2559+  D20D             ;[]----------------------------------------------------------[]
2560+  D20D             Version
2561+  D20D 11 07 5F    	LD	DE,VersionR
2562+  D210 3A E7 A7    	LD	A,(FunctPg)
2563+  D213 0E A2       	LD	C,PAGE1
2564+  D215 CD 9A A4    	CALL	Resident
2565+  D218 C9          	RET 
2566+  D219             ;[]----------------------------------------------------------[]
2567+  D219             QSearch
2568+  D219 11 DF 5F    	LD	DE,QSearchR
2569+  D21C 3A E7 A7    	LD	A,(FunctPg)
2570+  D21F 0E A2       	LD	C,PAGE1
2571+  D221 CD 9A A4    	CALL	Resident
2572+  D224 C9          	RET 
2573+  D225             
2574+  D225             
2575+  D225             
0273   D225             	include "fnmenu.z80"
0001+  D225             
0002+  D225             ;[]==========================================================[]
0003+  D225             EPullMenu EQU	#06
0004+  D225             
0005+  D225             PullDown
0006+  D225 CD F9 BA    	CALL	ResInvert
0007+  D228 CD BC D2    	CALL	SetPullInvert
0008+  D22B             PullLoop
0009+  D22B DD 21 B1 FA 	LD	IX,PullTab
0010+  D22F CD 1C 9B    	CALL	TestCoords
0011+  D232 0E 31       	LD	C,#31
0012+  D234 D7          	RST	#10
0013+  D235 28 F4       	JR	Z,PullLoop
0014+  D237 78          	LD	A,B
0015+  D238 B7          	OR	A
0016+  D239 20 F0       	JR	NZ,PullLoop
0017+  D23B 21 2B D2    	LD	HL,PullLoop
0018+  D23E E5          	PUSH	HL
0019+  D23F 7B          	LD	A,E
0020+  D240 FE 1B       	CP	#1B
0021+  D242 28 18       	JR	Z,PullExit
0022+  D244 FE 0D       	CP	#0D
0023+  D246 28 42       	JR	Z,PullEnter
0024+  D248 B7          	OR	A
0025+  D249 C0          	RET	NZ
0026+  D24A 7A          	LD	A,D
0027+  D24B FE 52       	CP	#52
0028+  D24D 28 3B       	JR	Z,PullEnter
0029+  D24F FE 58       	CP	#58
0030+  D251 28 37       	JR	Z,PullEnter
0031+  D253 FE 54       	CP	#54
0032+  D255 28 0D       	JR	Z,PullLeft
0033+  D257 FE 56       	CP	#56
0034+  D259 28 1C       	JR	Z,PullRight
0035+  D25B C9          	RET 
0036+  D25C             PullExit
0037+  D25C D1          	POP	DE
0038+  D25D CD B5 D2    	CALL	ResPullInvert
0039+  D260 CD EA BA    	CALL	SetInvert
0040+  D263 C9          	RET 
0041+  D264             PullLeft
0042+  D264 3A 58 D8    	LD	A,(CurMenu)
0043+  D267 3D          	DEC	A
0044+  D268 F2 6D D2    	JP	P,$+5
0045+  D26B 3E 05       	LD	A,EPullMenu-1
0046+  D26D 32 58 D8    	LD	(CurMenu),A
0047+  D270 CD B5 D2    	CALL	ResPullInvert
0048+  D273 CD BC D2    	CALL	SetPullInvert
0049+  D276 C9          	RET 
0050+  D277             PullRight
0051+  D277 3A 58 D8    	LD	A,(CurMenu)
0052+  D27A 3C          	INC	A
0053+  D27B FE 06       	CP	EPullMenu
0054+  D27D 20 01       	JR	NZ,$+3
0055+  D27F 97          	SUB	A
0056+  D280 32 58 D8    	LD	(CurMenu),A
0057+  D283 CD B5 D2    	CALL	ResPullInvert
0058+  D286 CD BC D2    	CALL	SetPullInvert
0059+  D289 C9          	RET 
0060+  D28A             PullEnter
0061+  D28A 3E 01       	LD	A,#01
0062+  D28C 32 E7 D7    	LD	(MKeyFlg+1),A
0063+  D28F 21 F7 D2    	LD	HL,MFile
0064+  D292 3A 58 D8    	LD	A,(CurMenu)
0065+  D295 B7          	OR	A
0066+  D296 28 1B       	JR	Z,PullRun
0067+  D298 21 FD D2    	LD	HL,MSelect
0068+  D29B 3D          	DEC	A
0069+  D29C 28 15       	JR	Z,PullRun
0070+  D29E 21 03 D3    	LD	HL,MOption
0071+  D2A1 3D          	DEC	A
0072+  D2A2 28 0F       	JR	Z,PullRun
0073+  D2A4 21 09 D3    	LD	HL,MView
0074+  D2A7 3D          	DEC	A
0075+  D2A8 28 09       	JR	Z,PullRun
0076+  D2AA 21 0F D3    	LD	HL,MConfig
0077+  D2AD 3D          	DEC	A
0078+  D2AE 28 03       	JR	Z,PullRun
0079+  D2B0 21 15 D3    	LD	HL,MAbout
0080+  D2B3 E3          PullRun	EX	(SP),HL
0081+  D2B4 C9          	RET 
0082+  D2B5             ResPullInvert
0083+  D2B5 11 80 4F    	LD	DE,#4F80
0084+  D2B8 3E 00       SavPull	LD	A,#00
0085+  D2BA 18 09       	JR	PullInvert
0086+  D2BC             SetPullInvert
0087+  D2BC 11 4F 80    	LD	DE,#804F
0088+  D2BF 3A 58 D8    	LD	A,(CurMenu)
0089+  D2C2 32 B9 D2    	LD	(SavPull+1),A
0090+  D2C5             PullInvert
0091+  D2C5 6F          	LD	L,A
0092+  D2C6 26 00       	LD	H,#00
0093+  D2C8 29          	ADD	HL,HL
0094+  D2C9 29          	ADD	HL,HL
0095+  D2CA 29          	ADD	HL,HL
0096+  D2CB 29          	ADD	HL,HL
0097+  D2CC 01 B1 FA    	LD	BC,PullTab
0098+  D2CF 09          	ADD	HL,BC
0099+  D2D0 E5          	PUSH	HL
0100+  D2D1 DD E1       	POP	IX
0101+  D2D3 DD 6E 00    	LD	L,(IX+#00)
0102+  D2D6 DD 66 01    	LD	H,(IX+#01)
0103+  D2D9 DD 4E 04    	LD	C,(IX+#04)
0104+  D2DC DD 46 05    	LD	B,(IX+#05)
0105+  D2DF DD 7E 02    	LD	A,(IX+#02)
0106+  D2E2 DD 96 00    	SUB	(IX+#00)
0107+  D2E5 08          	EX	AF,AF'
0108+  D2E6 DD 7E 06    	LD	A,(IX+#06)
0109+  D2E9 DD 96 04    	SUB	(IX+#04)
0110+  D2EC DD 67       	LD	HX,A
0111+  D2EE 08          	EX	AF,AF'
0112+  D2EF CB 3F       	SRL	A
0113+  D2F1 DD 6F       	LD	LX,A
0114+  D2F3 CD A3 8D    	CALL	InvertRectan
0115+  D2F6 C9          	RET 
0116+  D2F7             MFile
0117+  D2F7 CD B5 D2    	CALL	ResPullInvert
0118+  D2FA C3 22 D3    	JP	MenuFile+7
0119+  D2FD             MSelect
0120+  D2FD CD B5 D2    	CALL	ResPullInvert
0121+  D300 C3 A8 D3    	JP	MenuSelect+7
0122+  D303             MOption
0123+  D303 CD B5 D2    	CALL	ResPullInvert
0124+  D306 C3 69 D4    	JP	MenuOption+7
0125+  D309             MView
0126+  D309 CD B5 D2    	CALL	ResPullInvert
0127+  D30C C3 FD D4    	JP	MenuView+7
0128+  D30F             MConfig
0129+  D30F CD B5 D2    	CALL	ResPullInvert
0130+  D312 C3 5A D7    	JP	MenuConfig+7
0131+  D315             MAbout
0132+  D315 CD B5 D2    	CALL	ResPullInvert
0133+  D318 C3 99 D7    	JP	MenuAbout+7
0134+  D31B             ;[]==========================================================[]
0135+  D31B             MenuFile
0136+  D31B CD F9 BA    	CALL	ResInvert
0137+  D31E 97          	SUB	A
0138+  D31F 32 E7 D7    	LD	(MKeyFlg+1),A
0139+  D322 FD 7E 01    	LD	A,(IY+ViewFlg)
0140+  D325 32 65 D8    	LD	(SvView1+1),A
0141+  D328 FD 7E 02    	LD	A,(IY+SortFlg)
0142+  D32B 32 6D D8    	LD	(SvView2+1),A
0143+  D32E CD F0 86    	CALL	MakeWindow
0144+  D331 01          	DEFB	#01
0145+  D332 04 00 1A 00 	DEFW	#0004,#001A
0146+  D336 A0 00 36 00 	DEFW	#00A0,#0036
0147+  D33A 01          	DEFB	#01	;Text Line
0148+  D33B 10 00 06 00 	DEFW	#0010,#0006
0149+  D33F 80          	DEFB	#80
0150+  D340             	DEFB	"File info...",0
0150+  D340 46696C6520696E666F2E2E2E00
0151+  D34D 01          	DEFB	#01	;Text Line
0152+  D34E 64 00 06 00 	DEFW	#0064,#0006
0153+  D352 80          	DEFB	#80
0154+  D353             	DEFB	"ALT+ENT",0
0154+  D353 414C542B454E5400
0155+  D35B 01          	DEFB	#01	;Text Line
0156+  D35C 10 00 14 00 	DEFW	#0010,#0014
0157+  D360 80          	DEFB	#80
0158+  D361             	DEFB	"Print",0
0158+  D361 5072696E7400
0159+  D367 01          	DEFB	#01	;Text Line
0160+  D368 64 00 14 00 	DEFW	#0064,#0014
0161+  D36C 80          	DEFB	#80
0162+  D36D             	DEFB	"CTRL+F9",0
0162+  D36D 4354524C2B463900
0163+  D375 06          	DEFB	#06	;Horizontal line
0164+  D376 04 00 21 00 	DEFW	#0004,#0021
0165+  D37A 98 00       	DEFW	#0098
0166+  D37C 01          	DEFB	#01	;Text Line
0167+  D37D 10 00 28 00 	DEFW	#0010,#0028
0168+  D381 80          	DEFB	#80
0169+  D382 4578697400  	DEFB	"Exit",0
0170+  D387 01          	DEFB	#01	;Text Line
0171+  D388 64 00 28 00 	DEFW	#0064,#0028
0172+  D38C 80          	DEFB	#80
0173+  D38D 46 31 30 00 	DEFB	"F10",0
0174+  D391 00          	DEFB	#00
0175+  D392 21 55 F5    	LD	HL,FileTab
0176+  D395 97          	SUB	A
0177+  D396 32 58 D8    	LD	(CurMenu),A
0178+  D399 32 B9 D2    	LD	(SavPull+1),A
0179+  D39C 3E 03       	LD	A,#03
0180+  D39E C3 D0 D7    	JP	MenuWork
0181+  D3A1             MenuSelect
0182+  D3A1 CD F9 BA    	CALL	ResInvert
0183+  D3A4 97          	SUB	A
0184+  D3A5 32 E7 D7    	LD	(MKeyFlg+1),A
0185+  D3A8 FD 7E 01    	LD	A,(IY+ViewFlg)
0186+  D3AB 32 65 D8    	LD	(SvView1+1),A
0187+  D3AE FD 7E 02    	LD	A,(IY+SortFlg)
0188+  D3B1 32 6D D8    	LD	(SvView2+1),A
0189+  D3B4 CD F0 86    	CALL	MakeWindow
0190+  D3B7 01          	DEFB	#01
0191+  D3B8 28 00 1A 00 	DEFW	#0028,#001A
0192+  D3BC A0 00 4C 00 	DEFW	#00A0,#004C
0193+  D3C0 01          	DEFB	#01	;Text Line
0194+  D3C1 10 00 06 00 	DEFW	#0010,#0006
0195+  D3C5 80          	DEFB	#80
0196+  D3C6             	DEFB	"Mark group...",0
0196+  D3C6 4D61726B2067726F75702E2E2E00
0197+  D3D4 01          	DEFB	#01	;Text Line
0198+  D3D5 70 00 06 00 	DEFW	#0070,#0006
0199+  D3D9 80          	DEFB	#80
0200+  D3DA 2B 00       	DEFB	"+",0
0201+  D3DC 01          	DEFB	#01	;Text Line
0202+  D3DD 10 00 14 00 	DEFW	#0010,#0014
0203+  D3E1 80          	DEFB	#80
0204+  D3E2             	DEFB	"Unmark group...",0
0204+  D3E2 556E6D61726B2067726F75702E2E2E00
0205+  D3F2 01          	DEFB	#01	;Text Line
0206+  D3F3 70 00 14 00 	DEFW	#0070,#0014
0207+  D3F7 80          	DEFB	#80
0208+  D3F8 2D 00       	DEFB	"-",0
0209+  D3FA 01          	DEFB	#01	;Text Line
0210+  D3FB 10 00 22 00 	DEFW	#0010,#0022
0211+  D3FF 80          	DEFB	#80
0212+  D400             	DEFB	"Mark all",0
0212+  D400 4D61726B20616C6C00
0213+  D409 01          	DEFB	#01	;Text Line
0214+  D40A 70 00 22 00 	DEFW	#0070,#0022
0215+  D40E 80          	DEFB	#80
0216+  D40F             	DEFB	"CTRL+",0
0216+  D40F 4354524C2B00
0217+  D415 01          	DEFB	#01	;Text Line
0218+  D416 10 00 30 00 	DEFW	#0010,#0030
0219+  D41A 80          	DEFB	#80
0220+  D41B             	DEFB	"Unmark all",0
0220+  D41B 556E6D61726B20616C6C00
0221+  D426 01          	DEFB	#01	;Text Line
0222+  D427 70 00 30 00 	DEFW	#0070,#0030
0223+  D42B 80          	DEFB	#80
0224+  D42C             	DEFB	"CTRL-",0
0224+  D42C 4354524C2D00
0225+  D432 01          	DEFB	#01	;Text Line
0226+  D433 10 00 3E 00 	DEFW	#0010,#003E
0227+  D437 80          	DEFB	#80
0228+  D438             	DEFB	"Invert selection",0
0228+  D438 496E766572742073656C656374696F6E00
0229+  D449 01          	DEFB	#01	;Text Line
0230+  D44A 70 00 3E 00 	DEFW	#0070,#003E
0231+  D44E 80          	DEFB	#80
0232+  D44F 2A 00       	DEFB	"*",0
0233+  D451 00          	DEFB	#00
0234+  D452 21 27 F6    	LD	HL,SelectTab
0235+  D455 3E 01       	LD	A,#01
0236+  D457 32 58 D8    	LD	(CurMenu),A
0237+  D45A 32 B9 D2    	LD	(SavPull+1),A
0238+  D45D 3E 05       	LD	A,#05
0239+  D45F C3 D0 D7    	JP	MenuWork
0240+  D462             MenuOption
0241+  D462 CD F9 BA    	CALL	ResInvert
0242+  D465 97          	SUB	A
0243+  D466 32 E7 D7    	LD	(MKeyFlg+1),A
0244+  D469 FD 7E 01    	LD	A,(IY+ViewFlg)
0245+  D46C 32 65 D8    	LD	(SvView1+1),A
0246+  D46F FD 7E 02    	LD	A,(IY+SortFlg)
0247+  D472 32 6D D8    	LD	(SvView2+1),A
0248+  D475 CD F0 86    	CALL	MakeWindow
0249+  D478 01          	DEFB	#01
0250+  D479 54 00 1A 00 	DEFW	#0054,#001A
0251+  D47D D0 00 36 00 	DEFW	#00D0,#0036
0252+  D481 01          	DEFB	#01	;Text Line
0253+  D482 10 00 06 00 	DEFW	#0010,#0006
0254+  D486 80          	DEFB	#80
0255+  D487             	DEFB	"Refresh tree",0
0255+  D487 52656672657368207472656500
0256+  D494 01          	DEFB	#01	;Text Line
0257+  D495 98 00 06 00 	DEFW	#0098,#0006
0258+  D499 80          	DEFB	#80
0259+  D49A             	DEFB	"ALT+F10",0
0259+  D49A 414C542B46313000
0260+  D4A2 01          	DEFB	#01	;Text Line
0261+  D4A3 10 00 14 00 	DEFW	#0010,#0014
0262+  D4A7 80          	DEFB	#80
0263+  D4A8             	DEFB	"Disk info...",0
0263+  D4A8 4469736B20696E666F2E2E2E00
0264+  D4B5 01          	DEFB	#01	;Text Line
0265+  D4B6 98 00 14 00 	DEFW	#0098,#0014
0266+  D4BA 80          	DEFB	#80
0267+  D4BB             	DEFB	"CTRL+L",0
0267+  D4BB 4354524C2B4C00
0268+  D4C2 06          	DEFB	#06	;Horizontal line
0269+  D4C3 04 00 21 00 	DEFW	#0004,#0021
0270+  D4C7 C8 00       	DEFW	#00C8
0271+  D4C9 01          	DEFB	#01	;Text Line
0272+  D4CA 10 00 28 00 	DEFW	#0010,#0028
0273+  D4CE 80          	DEFB	#80
0274+  D4CF             	DEFB	"System information...",0
0274+  D4CF 53797374656D20696E666F726D6174696F6E2E2E2E00
0275+  D4E5 00          	DEFB	#00
0276+  D4E6 21 19 F7    	LD	HL,OptionTab
0277+  D4E9 3E 02       	LD	A,#02
0278+  D4EB 32 58 D8    	LD	(CurMenu),A
0279+  D4EE 32 B9 D2    	LD	(SavPull+1),A
0280+  D4F1 3E 03       	LD	A,#03
0281+  D4F3 C3 D0 D7    	JP	MenuWork
0282+  D4F6             MenuView
0283+  D4F6 CD F9 BA    	CALL	ResInvert
0284+  D4F9 97          	SUB	A
0285+  D4FA 32 E7 D7    	LD	(MKeyFlg+1),A
0286+  D4FD FD 7E 01    	LD	A,(IY+ViewFlg)
0287+  D500 32 65 D8    	LD	(SvView1+1),A
0288+  D503 B7          	OR	A
0289+  D504 01 FE FF    	LD	BC,#FFFE
0290+  D507 1E FE       	LD	E,#FE
0291+  D509 28 0E       	JR	Z,MVnxt0
0292+  D50B 01 FF FE    	LD	BC,#FEFF
0293+  D50E 1E FE       	LD	E,#FE
0294+  D510 CB 47       	BIT	0,A
0295+  D512 20 05       	JR	NZ,MVnxt0
0296+  D514 01 FE FE    	LD	BC,#FEFE
0297+  D517 1E FF       	LD	E,#FF
0298+  D519 78          MVnxt0	LD	A,B
0299+  D51A 32 D8 D5    	LD	(view1),A
0300+  D51D 79          	LD	A,C
0301+  D51E 32 F4 D5    	LD	(view2),A
0302+  D521 7B          	LD	A,E
0303+  D522 32 10 D6    	LD	(view3),A
0304+  D525 FD 7E 02    	LD	A,(IY+SortFlg)
0305+  D528 32 6D D8    	LD	(SvView2+1),A
0306+  D52B E6 F0       	AND	#F0
0307+  D52D 01 FE FF    	LD	BC,#FFFE
0308+  D530 1E FE       	LD	E,#FE
0309+  D532 28 0E       	JR	Z,MVnxt1
0310+  D534 CB 67       	BIT	4,A
0311+  D536 01 FF FE    	LD	BC,#FEFF
0312+  D539 1E FE       	LD	E,#FE
0313+  D53B 20 05       	JR	NZ,MVnxt1
0314+  D53D 01 FE FE    	LD	BC,#FEFE
0315+  D540 1E FF       	LD	E,#FF
0316+  D542 78          MVnxt1	LD	A,B
0317+  D543 32 38 D6    	LD	(filt1),A
0318+  D546 79          	LD	A,C
0319+  D547 32 5E D6    	LD	(filt2),A
0320+  D54A 7B          	LD	A,E
0321+  D54B 32 83 D6    	LD	(filt3),A
0322+  D54E FD 7E 02    	LD	A,(IY+SortFlg)
0323+  D551 E6 0F       	AND	#0F
0324+  D553 01 FE FE    	LD	BC,#FEFE
0325+  D556 11 FE FE    	LD	DE,#FEFE
0326+  D559 2E FF       	LD	L,#FF
0327+  D55B 28 2C       	JR	Z,MVnxt2
0328+  D55D CB 47       	BIT	0,A
0329+  D55F 01 FE FF    	LD	BC,#FFFE
0330+  D562 11 FE FE    	LD	DE,#FEFE
0331+  D565 2E FE       	LD	L,#FE
0332+  D567 20 20       	JR	NZ,MVnxt2
0333+  D569 CB 4F       	BIT	1,A
0334+  D56B 01 FF FE    	LD	BC,#FEFF
0335+  D56E 11 FE FE    	LD	DE,#FEFE
0336+  D571 2E FE       	LD	L,#FE
0337+  D573 20 14       	JR	NZ,MVnxt2
0338+  D575 CB 57       	BIT	2,A
0339+  D577 01 FE FE    	LD	BC,#FEFE
0340+  D57A 11 FE FF    	LD	DE,#FFFE
0341+  D57D 2E FE       	LD	L,#FE
0342+  D57F 20 08       	JR	NZ,MVnxt2
0343+  D581 01 FE FE    	LD	BC,#FEFE
0344+  D584 11 FF FE    	LD	DE,#FEFF
0345+  D587 2E FE       	LD	L,#FE
0346+  D589 78          MVnxt2	LD	A,B
0347+  D58A 32 BE D6    	LD	(sort1),A
0348+  D58D 79          	LD	A,C
0349+  D58E 32 DF D6    	LD	(sort2),A
0350+  D591 7A          	LD	A,D
0351+  D592 32 FB D6    	LD	(sort3),A
0352+  D595 7B          	LD	A,E
0353+  D596 32 17 D7    	LD	(sort4),A
0354+  D599 7D          	LD	A,L
0355+  D59A 32 37 D7    	LD	(sort5),A
0356+  D59D FD E5       	PUSH	IY
0357+  D59F E1          	POP	HL
0358+  D5A0 01 1F 00    	LD	BC,BegMask
0359+  D5A3 09          	ADD	HL,BC
0360+  D5A4 11 70 D6    	LD	DE,Tfilter
0361+  D5A7 0E 0C       	LD	C,#0C
0362+  D5A9 97          	SUB	A
0363+  D5AA ED A0       	LDI 
0364+  D5AC BE          	CP	(HL)
0365+  D5AD 20 FB       	JR	NZ,$-3
0366+  D5AF 79          	LD	A,C
0367+  D5B0 B7          	OR	A
0368+  D5B1 28 07       	JR	Z,MVnxt3
0369+  D5B3 47          	LD	B,A
0370+  D5B4 3E 20       	LD	A,#20
0371+  D5B6 12          	LD	(DE),A
0372+  D5B7 13          	INC	DE
0373+  D5B8 10 FC       	DJNZ	$-2
0374+  D5BA CD F0 86    MVnxt3	CALL	MakeWindow
0375+  D5BD 01          	DEFB	#01
0376+  D5BE 8A 00 1A 00 	DEFW	#008A,#001A
0377+  D5C2 BE 00 BA 00 	DEFW	#00BE,#00BA
0378+  D5C6 01          	DEFB	#01	;Text Line
0379+  D5C7 10 00 06 00 	DEFW	#0010,#0006
0380+  D5CB 80          	DEFB	#80
0381+  D5CC             	DEFB	"Brief",0
0381+  D5CC 427269656600
0382+  D5D2 01          	DEFB	#01	;Text Line
0383+  D5D3 6E 00 06 00 	DEFW	#006E,#0006
0384+  D5D7 80          	DEFB	#80
0385+  D5D8             view1	DEFB	#FE,"  CTRL+F1",0
0385+  D5D8 FE20204354524C2B463100
0386+  D5E3 01          	DEFB	#01	;Text Line
0387+  D5E4 10 00 14 00 	DEFW	#0010,#0014
0388+  D5E8 80          	DEFB	#80
0389+  D5E9 46756C6C00  	DEFB	"Full",0
0390+  D5EE 01          	DEFB	#01	;Text Line
0391+  D5EF 6E 00 14 00 	DEFW	#006E,#0014
0392+  D5F3 80          	DEFB	#80
0393+  D5F4             view2	DEFB	#FE,"  CTRL+F2",0
0393+  D5F4 FE20204354524C2B463200
0394+  D5FF 01          	DEFB	#01	;Text Line
0395+  D600 10 00 22 00 	DEFW	#0010,#0022
0396+  D604 80          	DEFB	#80
0397+  D605 5472656500  	DEFB	"Tree",0
0398+  D60A 01          	DEFB	#01	;Text Line
0399+  D60B 6E 00 22 00 	DEFW	#006E,#0022
0400+  D60F 80          	DEFB	#80
0401+  D610             view3	DEFB	#FE,"  CTRL+F8",0
0401+  D610 FE20204354524C2B463800
0402+  D61B 06          	DEFB	#06	;Horizontal line
0403+  D61C 04 00 2F 00 	DEFW	#0004,#002F
0404+  D620 B6 00       	DEFW	#00B6
0405+  D622 01          	DEFB	#01	;Text Line
0406+  D623 10 00 36 00 	DEFW	#0010,#0036
0407+  D627 80          	DEFB	#80
0408+  D628             	DEFB	"All files",0
0408+  D628 416C6C2066696C657300
0409+  D632 01          	DEFB	#01	;Text Line
0410+  D633 6E 00 36 00 	DEFW	#006E,#0036
0411+  D637 80          	DEFB	#80
0412+  D638             filt1	DEFB	#FE,"  CTRL+F10",0
0412+  D638 FE20204354524C2B46313000
0413+  D644 01          	DEFB	#01	;Text Line
0414+  D645 10 00 44 00 	DEFW	#0010,#0044
0415+  D649 80          	DEFB	#80
0416+  D64A             	DEFB	"Exexute files",0
0416+  D64A 457865787574652066696C657300
0417+  D658 01          	DEFB	#01	;Text Line
0418+  D659 6E 00 44 00 	DEFW	#006E,#0044
0419+  D65D 80          	DEFB	#80
0420+  D65E             filt2	DEFB	#FE,"  CTRL+F11",0
0420+  D65E FE20204354524C2B46313100
0421+  D66A 01          	DEFB	#01	;Text Line
0422+  D66B 10 00 52 00 	DEFW	#0010,#0052
0423+  D66F 80          	DEFB	#80
0424+  D670             Tfilter	DEFB	"*.*         ",0
0424+  D670 2A2E2A20202020202020202000
0425+  D67D 01          	DEFB	#01	;Text Line
0426+  D67E 6E 00 52 00 	DEFW	#006E,#0052
0427+  D682 80          	DEFB	#80
0428+  D683 FE 00       filt3	DEFB	#FE,0
0429+  D685 01          	DEFB	#01	;Text Line
0430+  D686 10 00 60 00 	DEFW	#0010,#0060
0431+  D68A 80          	DEFB	#80
0432+  D68B             	DEFB	"Filtr...",0
0432+  D68B 46696C74722E2E2E00
0433+  D694 01          	DEFB	#01	;Text Line
0434+  D695 6E 00 60 00 	DEFW	#006E,#0060
0435+  D699 80          	DEFB	#80
0436+  D69A             	DEFB	#FE,"  CTRL+F12",0
0436+  D69A FE20204354524C2B46313200
0437+  D6A6 06          	DEFB	#06	;Horizontal line
0438+  D6A7 04 00 6D 00 	DEFW	#0004,#006D
0439+  D6AB B6 00       	DEFW	#00B6
0440+  D6AD 01          	DEFB	#01	;Text Line
0441+  D6AE 10 00 74 00 	DEFW	#0010,#0074
0442+  D6B2 80          	DEFB	#80
0443+  D6B3 4E616D6500  	DEFB	"Name",0
0444+  D6B8 01          	DEFB	#01	;Text Line
0445+  D6B9 6E 00 74 00 	DEFW	#006E,#0074
0446+  D6BD 80          	DEFB	#80
0447+  D6BE             sort1	DEFB	#FE,"  CTRL+F3",0
0447+  D6BE FE20204354524C2B463300
0448+  D6C9 01          	DEFB	#01	;Text Line
0449+  D6CA 10 00 82 00 	DEFW	#0010,#0082
0450+  D6CE 80          	DEFB	#80
0451+  D6CF             	DEFB	"Extention",0
0451+  D6CF 457874656E74696F6E00
0452+  D6D9 01          	DEFB	#01	;Text Line
0453+  D6DA 6E 00 82 00 	DEFW	#006E,#0082
0454+  D6DE 80          	DEFB	#80
0455+  D6DF             sort2	DEFB	#FE,"  CTRL+F4",0
0455+  D6DF FE20204354524C2B463400
0456+  D6EA 01          	DEFB	#01	;Text Line
0457+  D6EB 10 00 90 00 	DEFW	#0010,#0090
0458+  D6EF 80          	DEFB	#80
0459+  D6F0 4461746100  	DEFB	"Data",0
0460+  D6F5 01          	DEFB	#01	;Text Line
0461+  D6F6 6E 00 90 00 	DEFW	#006E,#0090
0462+  D6FA 80          	DEFB	#80
0463+  D6FB             sort3	DEFB	#FE,"  CTRL+F5",0
0463+  D6FB FE20204354524C2B463500
0464+  D706 01          	DEFB	#01	;Text Line
0465+  D707 10 00 9E 00 	DEFW	#0010,#009E
0466+  D70B 80          	DEFB	#80
0467+  D70C 53697A6500  	DEFB	"Size",0
0468+  D711 01          	DEFB	#01	;Text Line
0469+  D712 6E 00 9E 00 	DEFW	#006E,#009E
0470+  D716 80          	DEFB	#80
0471+  D717             sort4	DEFB	#FE,"  CTRL+F6",0
0471+  D717 FE20204354524C2B463600
0472+  D722 01          	DEFB	#01	;Text Line
0473+  D723 10 00 AC 00 	DEFW	#0010,#00AC
0474+  D727 80          	DEFB	#80
0475+  D728             	DEFB	"Unsorted",0
0475+  D728 556E736F7274656400
0476+  D731 01          	DEFB	#01	;Text Line
0477+  D732 6E 00 AC 00 	DEFW	#006E,#00AC
0478+  D736 80          	DEFB	#80
0479+  D737             sort5	DEFB	#FE,"  CTRL+F7",0
0479+  D737 FE20204354524C2B463700
0480+  D742 00          	DEFB	#00
0481+  D743 21 EB F7    	LD	HL,ViewTab
0482+  D746 3E 03       	LD	A,#03
0483+  D748 32 58 D8    	LD	(CurMenu),A
0484+  D74B 32 B9 D2    	LD	(SavPull+1),A
0485+  D74E 3E 0C       	LD	A,#0C
0486+  D750 C3 D0 D7    	JP	MenuWork
0487+  D753             MenuConfig
0488+  D753 CD F9 BA    	CALL	ResInvert
0489+  D756 97          	SUB	A
0490+  D757 32 E7 D7    	LD	(MKeyFlg+1),A
0491+  D75A FD 7E 01    	LD	A,(IY+ViewFlg)
0492+  D75D 32 65 D8    	LD	(SvView1+1),A
0493+  D760 FD 7E 02    	LD	A,(IY+SortFlg)
0494+  D763 32 6D D8    	LD	(SvView2+1),A
0495+  D766 CD F0 86    	CALL	MakeWindow
0496+  D769 01          	DEFB	#01
0497+  D76A AE 00 1A 00 	DEFW	#00AE,#001A
0498+  D76E 60 00 14 00 	DEFW	#0060,#0014
0499+  D772 01          	DEFB	#01	;Text Line
0500+  D773 10 00 06 00 	DEFW	#0010,#0006
0501+  D777 80          	DEFB	#80
0502+  D778             	DEFB	"Setup...",0
0502+  D778 53657475702E2E2E00
0503+  D781 00          	DEFB	#00
0504+  D782 21 4D F9    	LD	HL,ConfigTab
0505+  D785 3E 04       	LD	A,#04
0506+  D787 32 58 D8    	LD	(CurMenu),A
0507+  D78A 32 B9 D2    	LD	(SavPull+1),A
0508+  D78D 3E 01       	LD	A,#01
0509+  D78F C3 D0 D7    	JP	MenuWork
0510+  D792             MenuAbout
0511+  D792 CD F9 BA    	CALL	ResInvert
0512+  D795 97          	SUB	A
0513+  D796 32 E7 D7    	LD	(MKeyFlg+1),A
0514+  D799 FD 7E 01    	LD	A,(IY+ViewFlg)
0515+  D79C 32 65 D8    	LD	(SvView1+1),A
0516+  D79F FD 7E 02    	LD	A,(IY+SortFlg)
0517+  D7A2 32 6D D8    	LD	(SvView2+1),A
0518+  D7A5 CD F0 86    	CALL	MakeWindow
0519+  D7A8 01          	DEFB	#01
0520+  D7A9 DE 00 1A 00 	DEFW	#00DE,#001A
0521+  D7AD 70 00 14 00 	DEFW	#0070,#0014
0522+  D7B1 01          	DEFB	#01	;Text Line
0523+  D7B2 10 00 06 00 	DEFW	#0010,#0006
0524+  D7B6 80          	DEFB	#80
0525+  D7B7             	DEFB	"Version...",0
0525+  D7B7 56657273696F6E2E2E2E00
0526+  D7C2 00          	DEFB	#00
0527+  D7C3 21 FF F9    	LD	HL,AboutTab
0528+  D7C6 3E 05       	LD	A,#05
0529+  D7C8 32 58 D8    	LD	(CurMenu),A
0530+  D7CB 32 B9 D2    	LD	(SavPull+1),A
0531+  D7CE 3E 01       	LD	A,#01
0532+  D7D0             MenuWork
0533+  D7D0 22 EE D7    	LD	(CurWTab+2),HL
0534+  D7D3 32 5A D8    	LD	(MaxLines),A
0535+  D7D6 97          	SUB	A
0536+  D7D7 32 59 D8    	LD	(CurMLine),A
0537+  D7DA DD 2A EE D7 	LD	IX,(CurWTab+2)
0538+  D7DE CD 1C 9B    	CALL	TestCoords
0539+  D7E1 CD 2F D8    	CALL	TestInvert
0540+  D7E4 20 06       	JR	NZ,MenuLoop
0541+  D7E6 3E 00       MKeyFlg	LD	A,#00
0542+  D7E8 B7          	OR	A
0543+  D7E9 C4 15 D9    	CALL	NZ,SetMSelect
0544+  D7EC             MenuLoop
0545+  D7EC DD 21 00 00 CurWTab	LD	IX,#0000
0546+  D7F0 CD 1C 9B    	CALL	TestCoords
0547+  D7F3 0E 31       	LD	C,#31
0548+  D7F5 D7          	RST	#10
0549+  D7F6 28 F4       	JR	Z,MenuLoop
0550+  D7F8 78          	LD	A,B
0551+  D7F9 B7          	OR	A
0552+  D7FA 20 F0       	JR	NZ,MenuLoop
0553+  D7FC 21 EC D7    	LD	HL,MenuLoop
0554+  D7FF E5          	PUSH	HL
0555+  D800 7B          	LD	A,E
0556+  D801 FE 1B       	CP	#1B
0557+  D803 28 56       	JR	Z,MenuKExt
0558+  D805 FE 0D       	CP	#0D
0559+  D807 CA 2C D9    	JP	Z,ChangeSet
0560+  D80A FE 20       	CP	#20
0561+  D80C CA 2C D9    	JP	Z,ChangeSet
0562+  D80F B7          	OR	A
0563+  D810 C0          	RET	NZ
0564+  D811 7A          	LD	A,D
0565+  D812 FE 54       	CP	#54
0566+  D814 28 62       	JR	Z,MenuLeft
0567+  D816 FE 56       	CP	#56
0568+  D818 28 72       	JR	Z,MenuRight
0569+  D81A FE 58       	CP	#58
0570+  D81C CA A0 D8    	JP	Z,MenuUp
0571+  D81F FE 52       	CP	#52
0572+  D821 CA BE D8    	JP	Z,MenuDown
0573+  D824 FE 57       	CP	#57
0574+  D826 CA DE D8    	JP	Z,MenuHome
0575+  D829 FE 51       	CP	#51
0576+  D82B CA F3 D8    	JP	Z,MenuEnd
0577+  D82E C9          	RET 
0578+  D82F             TestInvert
0579+  D82F 2A EE D7    	LD	HL,(CurWTab+2)
0580+  D832 11 09 00    	LD	DE,#0009
0581+  D835 19          	ADD	HL,DE
0582+  D836 3A 5A D8    	LD	A,(MaxLines)
0583+  D839 47          	LD	B,A
0584+  D83A 0E 00       	LD	C,#00
0585+  D83C 11 10 00    	LD	DE,#0010
0586+  D83F CB 7E       MenuLp0	BIT	7,(HL)
0587+  D841 28 06       	JR	Z,MenuLp1
0588+  D843 79          	LD	A,C
0589+  D844 CB FF       	SET	7,A
0590+  D846 32 59 D8    	LD	(CurMLine),A
0591+  D849 0C          MenuLp1	INC	C
0592+  D84A 19          	ADD	HL,DE
0593+  D84B 10 F2       	DJNZ	MenuLp0
0594+  D84D 3A 59 D8    	LD	A,(CurMLine)
0595+  D850 CB 7F       	BIT	7,A
0596+  D852 CB BF       	RES	7,A
0597+  D854 32 59 D8    	LD	(CurMLine),A
0598+  D857 C9          	RET 
0599+  D858             CurMenu
0600+  D858 00          	DEFB	#00
0601+  D859             CurMLine
0602+  D859 00          	DEFB	#00
0603+  D85A             MaxLines
0604+  D85A 00          	DEFB	#00
0605+  D85B             MenuKExt		;Выход по Esc
0606+  D85B D1          	POP	DE
0607+  D85C CD F0 86    	CALL	MakeWindow
0608+  D85F 7F          	DEFB	#7F
0609+  D860 00          	DEFB	#00
0610+  D861 C3 2B D2    	JP	PullLoop
0611+  D864             MenuExit
0612+  D864 3E 00       SvView1	LD	A,#00
0613+  D866 FD BE 01    	CP	(IY+ViewFlg)
0614+  D869 C2 07 E8    	JP	NZ,InitPanel
0615+  D86C 3E 00       SvView2	LD	A,#00
0616+  D86E FD BE 02    	CP	(IY+SortFlg)
0617+  D871 C2 07 E8    	JP	NZ,InitPanel
0618+  D874 CD EA BA    	CALL	SetInvert
0619+  D877 C9          	RET 
0620+  D878             MenuLeft
0621+  D878 CD F0 86    	CALL	MakeWindow
0622+  D87B 7F          	DEFB	#7F
0623+  D87C 00          	DEFB	#00
0624+  D87D 3A 58 D8    	LD	A,(CurMenu)
0625+  D880 3D          	DEC	A
0626+  D881 F2 86 D8    	JP	P,$+5
0627+  D884 3E 05       	LD	A,EPullMenu-1
0628+  D886 32 58 D8    	LD	(CurMenu),A
0629+  D889 C3 8A D2    	JP	PullEnter
0630+  D88C             MenuRight
0631+  D88C CD F0 86    	CALL	MakeWindow
0632+  D88F 7F          	DEFB	#7F
0633+  D890 00          	DEFB	#00
0634+  D891 3A 58 D8    	LD	A,(CurMenu)
0635+  D894 3C          	INC	A
0636+  D895 FE 06       	CP	EPullMenu
0637+  D897 20 01       	JR	NZ,$+3
0638+  D899 97          	SUB	A
0639+  D89A 32 58 D8    	LD	(CurMenu),A
0640+  D89D C3 8A D2    	JP	PullEnter
0641+  D8A0             MenuUp
0642+  D8A0 CD 2F D8    	CALL	TestInvert
0643+  D8A3 28 0E       	JR	Z,MenuUp1
0644+  D8A5 3A 5A D8    	LD	A,(MaxLines)
0645+  D8A8 3D          	DEC	A
0646+  D8A9 C8          	RET	Z
0647+  D8AA CD 10 D9    	CALL	ResMSelect
0648+  D8AD 3A 59 D8    	LD	A,(CurMLine)
0649+  D8B0 B7          	OR	A
0650+  D8B1 20 03       	JR	NZ,$+5
0651+  D8B3 3A 5A D8    MenuUp1	LD	A,(MaxLines)
0652+  D8B6 3D          	DEC	A
0653+  D8B7 32 59 D8    	LD	(CurMLine),A
0654+  D8BA CD 15 D9    	CALL	SetMSelect
0655+  D8BD C9          	RET 
0656+  D8BE             MenuDown
0657+  D8BE CD 2F D8    	CALL	TestInvert
0658+  D8C1 28 13       	JR	Z,MenuDn1
0659+  D8C3 3A 5A D8    	LD	A,(MaxLines)
0660+  D8C6 3D          	DEC	A
0661+  D8C7 C8          	RET	Z
0662+  D8C8 CD 10 D9    	CALL	ResMSelect
0663+  D8CB 3A 5A D8    	LD	A,(MaxLines)
0664+  D8CE 47          	LD	B,A
0665+  D8CF 3A 59 D8    	LD	A,(CurMLine)
0666+  D8D2 3C          	INC	A
0667+  D8D3 B8          	CP	B
0668+  D8D4 20 01       	JR	NZ,$+3
0669+  D8D6 97          MenuDn1	SUB	A
0670+  D8D7 32 59 D8    	LD	(CurMLine),A
0671+  D8DA CD 15 D9    	CALL	SetMSelect
0672+  D8DD C9          	RET 
0673+  D8DE             MenuHome
0674+  D8DE CD 2F D8    	CALL	TestInvert
0675+  D8E1 28 08       	JR	Z,MHome1
0676+  D8E3 3A 59 D8    	LD	A,(CurMLine)
0677+  D8E6 B7          	OR	A
0678+  D8E7 C8          	RET	Z
0679+  D8E8 CD 10 D9    	CALL	ResMSelect
0680+  D8EB 97          MHome1	SUB	A
0681+  D8EC 32 59 D8    	LD	(CurMLine),A
0682+  D8EF CD 15 D9    	CALL	SetMSelect
0683+  D8F2 C9          	RET 
0684+  D8F3             MenuEnd
0685+  D8F3 CD 2F D8    	CALL	TestInvert
0686+  D8F6 28 0D       	JR	Z,MEnd1
0687+  D8F8 3A 5A D8    	LD	A,(MaxLines)
0688+  D8FB 47          	LD	B,A
0689+  D8FC 3A 59 D8    	LD	A,(CurMLine)
0690+  D8FF 3C          	INC	A
0691+  D900 B8          	CP	B
0692+  D901 C8          	RET	Z
0693+  D902 CD 10 D9    	CALL	ResMSelect
0694+  D905 3A 5A D8    MEnd1	LD	A,(MaxLines)
0695+  D908 3D          	DEC	A
0696+  D909 32 59 D8    	LD	(CurMLine),A
0697+  D90C CD 15 D9    	CALL	SetMSelect
0698+  D90F C9          	RET 
0699+  D910             ResMSelect
0700+  D910 21 E2 9C    	LD	HL,ResSelect1
0701+  D913 18 03       	JR	MSel
0702+  D915             SetMSelect
0703+  D915 21 90 9C    	LD	HL,SetSelect1
0704+  D918 E5          MSel	PUSH	HL
0705+  D919 3A 59 D8    	LD	A,(CurMLine)
0706+  D91C 6F          	LD	L,A
0707+  D91D 26 00       	LD	H,#00
0708+  D91F 29          	ADD	HL,HL
0709+  D920 29          	ADD	HL,HL
0710+  D921 29          	ADD	HL,HL
0711+  D922 29          	ADD	HL,HL
0712+  D923 ED 4B EE D7 	LD	BC,(CurWTab+2)
0713+  D927 09          	ADD	HL,BC
0714+  D928 E5          	PUSH	HL
0715+  D929 DD E1       	POP	IX
0716+  D92B C9          	RET 
0717+  D92C             ChangeSet
0718+  D92C CD 2F D8    	CALL	TestInvert
0719+  D92F CA 5B D8    	JP	Z,MenuKExt
0720+  D932 3A 59 D8    	LD	A,(CurMLine)
0721+  D935 6F          	LD	L,A
0722+  D936 26 00       	LD	H,#00
0723+  D938 29          	ADD	HL,HL
0724+  D939 29          	ADD	HL,HL
0725+  D93A 29          	ADD	HL,HL
0726+  D93B 29          	ADD	HL,HL
0727+  D93C ED 4B EE D7 	LD	BC,(CurWTab+2)
0728+  D940 09          	ADD	HL,BC
0729+  D941 E5          	PUSH	HL
0730+  D942 DD E1       	POP	IX
0731+  D944 DD 4E 0C    	LD	C,(IX+#0C)	;запуск	по левой кнопке
0732+  D947 DD 46 0D    	LD	B,(IX+#0D)
0733+  D94A 78          	LD	A,B
0734+  D94B B1          	OR	C
0735+  D94C C8          	RET	Z
0736+  D94D DD CB 08 6E 	BIT	5,(IX+#08)	;запуск	без возврата
0737+  D951 28 01       	JR	Z,$+3
0738+  D953 F1          	POP	AF
0739+  D954 C5          	PUSH	BC
0740+  D955 DD CB 08 56 	BIT	2,(IX+#08)
0741+  D959 C4 E2 9C    	CALL	NZ,ResSelect1
0742+  D95C CD 54 9D    	CALL	ResSelect2
0743+  D95F DD CB 09 46 	BIT	0,(IX+#09)
0744+  D963 C8          	RET	Z
0745+  D964 CD F0 86    	CALL	MakeWindow
0746+  D967 7F          	DEFB	#7F
0747+  D968 00          	DEFB	#00
0748+  D969 C9          	RET 
0749+  D96A             ChView1
0750+  D96A FD CB 01 86 	RES	0,(IY+ViewFlg)
0751+  D96E FD CB 01 8E 	RES	1,(IY+ViewFlg)
0752+  D972 C3 64 D8    	JP	MenuExit
0753+  D975             ChView2
0754+  D975 FD CB 01 C6 	SET	0,(IY+ViewFlg)
0755+  D979 FD CB 01 8E 	RES	1,(IY+ViewFlg)
0756+  D97D C3 64 D8    	JP	MenuExit
0757+  D980             ChView3
0758+  D980 3A E3 A7    	LD	A,(TreeFlag)
0759+  D983 B7          	OR	A
0760+  D984 C2 64 D8    	JP	NZ,MenuExit
0761+  D987 FD CB 01 86 	RES	0,(IY+ViewFlg)
0762+  D98B FD CB 01 CE 	SET	1,(IY+ViewFlg)
0763+  D98F C3 64 D8    	JP	MenuExit
0764+  D992             ChFilt1
0765+  D992 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0766+  D996 C2 64 D8    	JP	NZ,MenuExit
0767+  D999 FD CB 02 A6 	RES	4,(IY+SortFlg)
0768+  D99D FD CB 02 AE 	RES	5,(IY+SortFlg)
0769+  D9A1 C3 64 D8    	JP	MenuExit
0770+  D9A4             ChFilt2
0771+  D9A4 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0772+  D9A8 C2 64 D8    	JP	NZ,MenuExit
0773+  D9AB FD CB 02 E6 	SET	4,(IY+SortFlg)
0774+  D9AF FD CB 02 AE 	RES	5,(IY+SortFlg)
0775+  D9B3 C3 64 D8    	JP	MenuExit
0776+  D9B6             ChFilt3
0777+  D9B6 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0778+  D9BA C2 64 D8    	JP	NZ,MenuExit
0779+  D9BD FD CB 02 A6 	RES	4,(IY+SortFlg)
0780+  D9C1 FD CB 02 EE 	SET	5,(IY+SortFlg)
0781+  D9C5 C3 64 D8    	JP	MenuExit
0782+  D9C8             ChSort1
0783+  D9C8 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0784+  D9CC C2 64 D8    	JP	NZ,MenuExit
0785+  D9CF FD CB 02 C6 	SET	0,(IY+SortFlg)
0786+  D9D3 FD CB 02 8E 	RES	1,(IY+SortFlg)
0787+  D9D7 FD CB 02 96 	RES	2,(IY+SortFlg)
0788+  D9DB FD CB 02 9E 	RES	3,(IY+SortFlg)
0789+  D9DF C3 64 D8    	JP	MenuExit
0790+  D9E2             ChSort2
0791+  D9E2 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0792+  D9E6 C2 64 D8    	JP	NZ,MenuExit
0793+  D9E9 FD CB 02 86 	RES	0,(IY+SortFlg)
0794+  D9ED FD CB 02 CE 	SET	1,(IY+SortFlg)
0795+  D9F1 FD CB 02 96 	RES	2,(IY+SortFlg)
0796+  D9F5 FD CB 02 9E 	RES	3,(IY+SortFlg)
0797+  D9F9 C3 64 D8    	JP	MenuExit
0798+  D9FC             ChSort3
0799+  D9FC FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0800+  DA00 C2 64 D8    	JP	NZ,MenuExit
0801+  DA03 FD CB 02 86 	RES	0,(IY+SortFlg)
0802+  DA07 FD CB 02 8E 	RES	1,(IY+SortFlg)
0803+  DA0B FD CB 02 D6 	SET	2,(IY+SortFlg)
0804+  DA0F FD CB 02 9E 	RES	3,(IY+SortFlg)
0805+  DA13 C3 64 D8    	JP	MenuExit
0806+  DA16             ChSort4
0807+  DA16 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0808+  DA1A C2 64 D8    	JP	NZ,MenuExit
0809+  DA1D FD CB 02 86 	RES	0,(IY+SortFlg)
0810+  DA21 FD CB 02 8E 	RES	1,(IY+SortFlg)
0811+  DA25 FD CB 02 96 	RES	2,(IY+SortFlg)
0812+  DA29 FD CB 02 DE 	SET	3,(IY+SortFlg)
0813+  DA2D C3 64 D8    	JP	MenuExit
0814+  DA30             ChSort5
0815+  DA30 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0816+  DA34 C2 64 D8    	JP	NZ,MenuExit
0817+  DA37 FD 7E 02    	LD	A,(IY+SortFlg)
0818+  DA3A E6 F0       	AND	#F0
0819+  DA3C FD 77 02    	LD	(IY+SortFlg),A
0820+  DA3F C3 64 D8    	JP	MenuExit
0821+  DA42             ;[]==========================================================[]
0822+  DA42             Brief
0823+  DA42 FD 7E 01    	LD	A,(IY+ViewFlg)
0824+  DA45 E6 03       	AND	#03
0825+  DA47 C8          	RET	Z
0826+  DA48 FD CB 01 86 	RES	0,(IY+ViewFlg)
0827+  DA4C FD CB 01 8E 	RES	1,(IY+ViewFlg)
0828+  DA50 C3 07 E8    	JP	InitPanel
0829+  DA53             Full
0830+  DA53 FD CB 01 46 	BIT	0,(IY+ViewFlg)
0831+  DA57 C0          	RET	NZ
0832+  DA58 FD CB 01 C6 	SET	0,(IY+ViewFlg)
0833+  DA5C FD CB 01 8E 	RES	1,(IY+ViewFlg)
0834+  DA60 C3 07 E8    	JP	InitPanel
0835+  DA63             Tree
0836+  DA63 3A E3 A7    	LD	A,(TreeFlag)
0837+  DA66 B7          	OR	A
0838+  DA67 C0          	RET	NZ
0839+  DA68 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0840+  DA6C C0          	RET	NZ
0841+  DA6D FD CB 01 86 	RES	0,(IY+ViewFlg)
0842+  DA71 FD CB 01 CE 	SET	1,(IY+ViewFlg)
0843+  DA75 C3 07 E8    	JP	InitPanel
0844+  DA78             AllFiles
0845+  DA78 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0846+  DA7C C0          	RET	NZ
0847+  DA7D FD 7E 02    	LD	A,(IY+SortFlg)
0848+  DA80 E6 30       	AND	#30
0849+  DA82 C8          	RET	Z
0850+  DA83 FD CB 02 A6 	RES	4,(IY+SortFlg)
0851+  DA87 FD CB 02 AE 	RES	5,(IY+SortFlg)
0852+  DA8B C3 07 E8    	JP	InitPanel
0853+  DA8E             ExeFiles
0854+  DA8E FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0855+  DA92 C0          	RET	NZ
0856+  DA93 FD CB 02 66 	BIT	4,(IY+SortFlg)
0857+  DA97 C0          	RET	NZ
0858+  DA98 FD CB 02 E6 	SET	4,(IY+SortFlg)
0859+  DA9C FD CB 02 AE 	RES	5,(IY+SortFlg)
0860+  DAA0 C3 07 E8    	JP	InitPanel
0861+  DAA3             NameS
0862+  DAA3 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0863+  DAA7 C0          	RET	NZ
0864+  DAA8 FD CB 02 46 	BIT	0,(IY+SortFlg)
0865+  DAAC C0          	RET	NZ
0866+  DAAD FD CB 02 C6 	SET	0,(IY+SortFlg)
0867+  DAB1 FD CB 02 8E 	RES	1,(IY+SortFlg)
0868+  DAB5 FD CB 02 96 	RES	2,(IY+SortFlg)
0869+  DAB9 FD CB 02 9E 	RES	3,(IY+SortFlg)
0870+  DABD C3 07 E8    	JP	InitPanel
0871+  DAC0             Extention
0872+  DAC0 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0873+  DAC4 C0          	RET	NZ
0874+  DAC5 FD CB 02 4E 	BIT	1,(IY+SortFlg)
0875+  DAC9 C0          	RET	NZ
0876+  DACA FD CB 02 86 	RES	0,(IY+SortFlg)
0877+  DACE FD CB 02 CE 	SET	1,(IY+SortFlg)
0878+  DAD2 FD CB 02 96 	RES	2,(IY+SortFlg)
0879+  DAD6 FD CB 02 9E 	RES	3,(IY+SortFlg)
0880+  DADA C3 07 E8    	JP	InitPanel
0881+  DADD             Data
0882+  DADD FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0883+  DAE1 C0          	RET	NZ
0884+  DAE2 FD CB 02 56 	BIT	2,(IY+SortFlg)
0885+  DAE6 C0          	RET	NZ
0886+  DAE7 FD CB 02 86 	RES	0,(IY+SortFlg)
0887+  DAEB FD CB 02 8E 	RES	1,(IY+SortFlg)
0888+  DAEF FD CB 02 D6 	SET	2,(IY+SortFlg)
0889+  DAF3 FD CB 02 9E 	RES	3,(IY+SortFlg)
0890+  DAF7 C3 07 E8    	JP	InitPanel
0891+  DAFA             Size
0892+  DAFA FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0893+  DAFE C0          	RET	NZ
0894+  DAFF FD CB 02 5E 	BIT	3,(IY+SortFlg)
0895+  DB03 C0          	RET	NZ
0896+  DB04 FD CB 02 86 	RES	0,(IY+SortFlg)
0897+  DB08 FD CB 02 8E 	RES	1,(IY+SortFlg)
0898+  DB0C FD CB 02 96 	RES	2,(IY+SortFlg)
0899+  DB10 FD CB 02 DE 	SET	3,(IY+SortFlg)
0900+  DB14 C3 07 E8    	JP	InitPanel
0901+  DB17             UnSort
0902+  DB17 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0903+  DB1B C0          	RET	NZ
0904+  DB1C FD 7E 02    	LD	A,(IY+SortFlg)
0905+  DB1F E6 0F       	AND	#0F
0906+  DB21 C8          	RET	Z
0907+  DB22 FD 7E 02    	LD	A,(IY+SortFlg)
0908+  DB25 E6 F0       	AND	#F0
0909+  DB27 FD 77 02    	LD	(IY+SortFlg),A
0910+  DB2A C3 07 E8    	JP	InitPanel
0911+  DB2D             ;[]==========================================================[]
0912+  DB2D             RefreshTree
0913+  DB2D 3A E3 A7    	LD	A,(TreeFlag)
0914+  DB30 B7          	OR	A
0915+  DB31 28 1C       	JR	Z,RfTree1
0916+  DB33 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0917+  DB37 20 16       	JR	NZ,RfTree1
0918+  DB39 FD E5       	PUSH	IY
0919+  DB3B FD CB 00 46 	BIT	0,(IY+PanelFlg)
0920+  DB3F FD 21 B6 A6 	LD	IY,RightPanel
0921+  DB43 28 04       	JR	Z,$+6
0922+  DB45 FD 21 8A A5 	LD	IY,LeftPanel
0923+  DB49 CD 4F DB    	CALL	RfTree1
0924+  DB4C FD E1       	POP	IY
0925+  DB4E C9          	RET 
0926+  DB4F 21 21 AF    RfTree1	LD	HL,BegDIR
0927+  DB52 0E 1D       	LD	C,#1D
0928+  DB54 FD E5       	PUSH	IY
0929+  DB56 D7          	RST	#10
0930+  DB57 FD E1       	POP	IY
0931+  DB59 D8          	RET	C
0932+  DB5A 21 04 AF    	LD	HL,TreeName
0933+  DB5D 97          	SUB	A
0934+  DB5E 0E 0E       	LD	C,#0E
0935+  DB60 FD E5       	PUSH	IY
0936+  DB62 D7          	RST	#10
0937+  DB63 FD E1       	POP	IY
0938+  DB65 FD CB 01 86 	RES	0,(IY+ViewFlg)
0939+  DB69 FD CB 01 CE 	SET	1,(IY+ViewFlg)
0940+  DB6D CD 07 E8    	CALL	InitPanel
0941+  DB70 C9          	RET 
0942+  DB71             ;[]==========================================================[]
0943+  DB71             NewFilter
0944+  DB71 CD F9 BA    	CALL	ResInvert
0945+  DB74 21 EA BA    	LD	HL,SetInvert
0946+  DB77 E5          	PUSH	HL
0947+  DB78 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0948+  DB7C C0          	RET	NZ
0949+  DB7D CD F0 86    	CALL	MakeWindow
0950+  DB80 01          	DEFB	#01
0951+  DB81 D0 00 51 00 	DEFW	#00D0,#0051
0952+  DB85 E0 00 3E 00 	DEFW	#00E0,#003E
0953+  DB89 02          	DEFB	#02	;Head place
0954+  DB8A 04 00 02 00 	DEFW	#0004,#0002
0955+  DB8E D8 00 0A 00 	DEFW	#00D8,#000A
0956+  DB92 00          	DEFB	#00
0957+  DB93 01          	DEFB	#01	;Text Line
0958+  DB94 62 00 03 00 	DEFW	#0062,#0003
0959+  DB98 0F          	DEFB	#0F
0960+  DB99             	DEFB	"Filter",0
0960+  DB99 46696C74657200
0961+  DBA0 04          	DEFB	#04	;UpRectan
0962+  DBA1 20 00 2A 00 	DEFW	#0020,#002A
0963+  DBA5 48 00 0E 00 	DEFW	#0048,#000E
0964+  DBA9 01          	DEFB	#01	;Text Line
0965+  DBAA 3C 00 2D 00 	DEFW	#003C,#002D
0966+  DBAE 80          	DEFB	#80
0967+  DBAF 4F 6B 00    	DEFB	"Ok",0
0968+  DBB2 04          	DEFB	#04	;UpRectan
0969+  DBB3 78 00 2A 00 	DEFW	#0078,#002A
0970+  DBB7 48 00 0E 00 	DEFW	#0048,#000E
0971+  DBBB 01          	DEFB	#01	;Text Line
0972+  DBBC 8C 00 2D 00 	DEFW	#008C,#002D
0973+  DBC0 80          	DEFB	#80
0974+  DBC1             	DEFB	"Cancel",0
0974+  DBC1 43616E63656C00
0975+  DBC8 01          	DEFB	#01	;Text Line
0976+  DBC9 10 00 19 00 	DEFW	#0010,#0019
0977+  DBCD 80          	DEFB	#80
0978+  DBCE             	DEFB	"New filter:",0
0978+  DBCE 4E65772066696C7465723A00
0979+  DBDA 03          	DEFB	#03	;Углубление
0980+  DBDB 46 00 16 00 	DEFW	#0046,#0016
0981+  DBDF 86 00 0C 00 	DEFW	#0086,#000C
0982+  DBE3 02          	DEFB	#02	;Head place
0983+  DBE4 48 00 17 00 	DEFW	#0048,#0017
0984+  DBE8 82 00 0A 00 	DEFW	#0082,#000A
0985+  DBEC 0F          	DEFB	#0F
0986+  DBED 00          	DEFB	#00
0987+  DBEE FD E5       	PUSH	IY
0988+  DBF0 E1          	POP	HL
0989+  DBF1 01 1F 00    	LD	BC,BegMask
0990+  DBF4 09          	ADD	HL,BC
0991+  DBF5 11 59 DC    	LD	DE,CurFilt
0992+  DBF8 97          	SUB	A
0993+  DBF9 4F          	LD	C,A
0994+  DBFA ED A0       	LDI 
0995+  DBFC BE          	CP	(HL)
0996+  DBFD 20 FB       	JR	NZ,$-3
0997+  DBFF 79          	LD	A,C
0998+  DC00 ED 44       	NEG 
0999+  DC02 32 51 DC    	LD	(FiltLen),A
1000+  DC05 DD 21 4D DC 	LD	IX,FilterStr
1001+  DC09 21 53 FB    	LD	HL,FilterTab
1002+  DC0C CD 68 91    	CALL	InputLine
1003+  DC0F CD F0 86    	CALL	MakeWindow
1004+  DC12 7F          	DEFB	#7F
1005+  DC13 00          	DEFB	#00
1006+  DC14 D8          	RET	C
1007+  DC15 3A 51 DC    	LD	A,(FiltLen)
1008+  DC18 B7          	OR	A
1009+  DC19 C8          	RET	Z
1010+  DC1A 21 59 DC    	LD	HL,CurFilt
1011+  DC1D 11 0C E2    	LD	DE,SelMask
1012+  DC20 CD 17 E2    	CALL	MakeMask
1013+  DC23 D0          	RET	NC
1014+  DC24 FD E5       	PUSH	IY
1015+  DC26 E1          	POP	HL
1016+  DC27 11 1F 00    	LD	DE,BegMask
1017+  DC2A 19          	ADD	HL,DE
1018+  DC2B EB          	EX	DE,HL
1019+  DC2C 21 59 DC    	LD	HL,CurFilt
1020+  DC2F 3A 51 DC    	LD	A,(FiltLen)
1021+  DC32 47          	LD	B,A
1022+  DC33 7E          Mfilter	LD	A,(HL)
1023+  DC34 CD 57 AA    	CALL	CorrBigChar
1024+  DC37 12          	LD	(DE),A
1025+  DC38 23          	INC	HL
1026+  DC39 13          	INC	DE
1027+  DC3A 10 F7       	DJNZ	Mfilter
1028+  DC3C 97          	SUB	A
1029+  DC3D 12          	LD	(DE),A
1030+  DC3E FD 7E 02    	LD	A,(IY+SortFlg)
1031+  DC41 E6 0F       	AND	#0F
1032+  DC43 CB EF       	SET	5,A
1033+  DC45 FD 77 02    	LD	(IY+SortFlg),A
1034+  DC48 E1          	POP	HL
1035+  DC49 CD 07 E8    	CALL	InitPanel
1036+  DC4C C9          	RET 
1037+  DC4D             FilterStr
1038+  DC4D 0C 00 00 00 	DEFB	#0C,#00,#00,#00
1039+  DC51 00          FiltLen	DEFB	#00
1040+  DC52 1A 01 6A 00 	DEFW	#011A,#006A
1041+  DC56 68 00       	DEFW	#0068
1042+  DC58 F0          	DEFB	#F0
1043+  DC59 00          CurFilt	DEFS	#0D,#00
1044+  DC66             ;[]==========================================================[]
1045+  DC66             LeftDrive
1046+  DC66 CD F9 BA    	CALL	ResInvert
1047+  DC69 CD F0 86    	CALL	MakeWindow
1048+  DC6C 01          	DEFB	#01
1049+  DC6D 20 00 5C 00 	DEFW	#0020,#005C
1050+  DC71 E0 00 24 00 	DEFW	#00E0,#0024
1051+  DC75 02          	DEFB	#02	;Head place
1052+  DC76 04 00 02 00 	DEFW	#0004,#0002
1053+  DC7A D8 00 0A 00 	DEFW	#00D8,#000A
1054+  DC7E 00          	DEFB	#00
1055+  DC7F 01          	DEFB	#01	;Text Line
1056+  DC80 56 00 03 00 	DEFW	#0056,#0003
1057+  DC84 0F          	DEFB	#0F
1058+  DC85             	DEFB	"Left drive",0
1058+  DC85 4C65667420647269766500
1059+  DC90 00          	DEFB	#00
1060+  DC91 21 A6 DC    	LD	HL,LeftTab
1061+  DC94 11 BB FC    	LD	DE,DriveTab
1062+  DC97 01 20 00    	LD	BC,#0020
1063+  DC9A ED B0       	LDIR 
1064+  DC9C DD 21 8A A5 	LD	IX,LeftPanel
1065+  DCA0 21 32 00    	LD	HL,#0032
1066+  DCA3 C3 26 DD    	JP	ChangeDrv
1067+  DCA6             LeftTab
1068+  DCA6             	DEFW #0000,#0020,#0000,#0100,#20,#0000,DriveExit,#0000
1068+  DCA6 000020000000000120000000DEDD0000
1069+  DCB6             	DEFW #0100,#0280,#0000,#0100,#20,#0000,DriveExit,#0000
1069+  DCB6 000180020000000120000000DEDD0000
1070+  DCC6             RightDrive
1071+  DCC6 CD F9 BA    	CALL	ResInvert
1072+  DCC9 CD F0 86    	CALL	MakeWindow
1073+  DCCC 01          	DEFB	#01
1074+  DCCD 60 01 5C 00 	DEFW	#0160,#005C
1075+  DCD1 E0 00 24 00 	DEFW	#00E0,#0024
1076+  DCD5 02          	DEFB	#02	;Head place
1077+  DCD6 04 00 02 00 	DEFW	#0004,#0002
1078+  DCDA D8 00 0A 00 	DEFW	#00D8,#000A
1079+  DCDE 00          	DEFB	#00
1080+  DCDF 01          	DEFB	#01	;Text Line
1081+  DCE0 56 00 03 00 	DEFW	#0056,#0003
1082+  DCE4 0F          	DEFB	#0F
1083+  DCE5             	DEFB	"Right drive",0
1083+  DCE5 526967687420647269766500
1084+  DCF1 00          	DEFB	#00
1085+  DCF2 21 06 DD    	LD	HL,RightTab
1086+  DCF5 11 BB FC    	LD	DE,DriveTab
1087+  DCF8 01 20 00    	LD	BC,#0020
1088+  DCFB ED B0       	LDIR 
1089+  DCFD DD 21 B6 A6 	LD	IX,RightPanel
1090+  DD01 21 72 01    	LD	HL,#0172
1091+  DD04 18 20       	JR	ChangeDrv
1092+  DD06             RightTab
1093+  DD06             	DEFW #0000,#0160,#0000,#0100,#20,#0000,DriveExit,#0000
1093+  DD06 000060010000000120000000DEDD0000
1094+  DD16             	DEFW #0240,#0280,#0000,#0100,#20,#0000,DriveExit,#0000
1094+  DD16 400280020000000120000000DEDD0000
1095+  DD26             ChangeDrv
1096+  DD26 FD E5       	PUSH	IY
1097+  DD28 DD E5       	PUSH	IX
1098+  DD2A FD E1       	POP	IY
1099+  DD2C DD 21 FB FC 	LD	IX,BegDrive
1100+  DD30 3A E2 A7    	LD	A,(EquipDisks)
1101+  DD33 87          	ADD	A,A
1102+  DD34 4F          	LD	C,A
1103+  DD35 87          	ADD	A,A
1104+  DD36 87          	ADD	A,A
1105+  DD37 87          	ADD	A,A
1106+  DD38 81          	ADD	A,C
1107+  DD39 D6 C6       	SUB	11*#12
1108+  DD3B ED 44       	NEG 
1109+  DD3D CB 3F       	SRL	A
1110+  DD3F 85          	ADD	A,L
1111+  DD40 5F          	LD	E,A
1112+  DD41 7C          	LD	A,H
1113+  DD42 CE 00       	ADC	A,#00
1114+  DD44 57          	LD	D,A
1115+  DD45 21 AC DE    	LD	HL,Drive
1116+  DD48 36 41       	LD	(HL),"A"
1117+  DD4A 01 70 00    	LD	BC,#0070
1118+  DD4D 3A E2 A7    	LD	A,(EquipDisks)
1119+  DD50 F5          Drive1	PUSH	AF
1120+  DD51 DD E5       	PUSH	IX
1121+  DD53 E5          	PUSH	HL
1122+  DD54 D5          	PUSH	DE
1123+  DD55 C5          	PUSH	BC
1124+  DD56 3E 80       	LD	A,#80
1125+  DD58 CD B3 8F    	CALL	PrnTxtLnIFF
1126+  DD5B C1          	POP	BC
1127+  DD5C D1          	POP	DE
1128+  DD5D E1          	POP	HL
1129+  DD5E DD E1       	POP	IX
1130+  DD60 7B          	LD	A,E
1131+  DD61 D6 06       	SUB	#06
1132+  DD63 DD 77 00    	LD	(IX+#00),A
1133+  DD66 7A          	LD	A,D
1134+  DD67 DE 00       	SBC	A,#00
1135+  DD69 DD 77 01    	LD	(IX+#01),A
1136+  DD6C 7B          	LD	A,E
1137+  DD6D C6 12       	ADD	A,#12
1138+  DD6F 5F          	LD	E,A
1139+  DD70 30 01       	JR	NC,$+3
1140+  DD72 14          	INC	D
1141+  DD73 7B          	LD	A,E
1142+  DD74 D6 06       	SUB	#06
1143+  DD76 DD 77 02    	LD	(IX+#02),A
1144+  DD79 7A          	LD	A,D
1145+  DD7A DE 00       	SBC	A,#00
1146+  DD7C DD 72 03    	LD	(IX+#03),D
1147+  DD7F DD 7D       	LD	A,LX
1148+  DD81 C6 10       	ADD	A,#10
1149+  DD83 DD 6F       	LD	LX,A
1150+  DD85 30 02       	JR	NC,$+4
1151+  DD87 DD 24       	INC	HX
1152+  DD89 34          	INC	(HL)
1153+  DD8A F1          	POP	AF
1154+  DD8B 3D          	DEC	A
1155+  DD8C 20 C2       	JR	NZ,Drive1
1156+  DD8E DD 36 00 00 	LD	(IX+#00),#00
1157+  DD92 DD 36 01 80 	LD	(IX+#01),#80
1158+  DD96 FD 7E 2C    	LD	A,(IY+BegPath)
1159+  DD99 D6 41       	SUB	"A"
1160+  DD9B 32 AB DE    	LD	(CurDrive),A
1161+  DD9E CD 73 DE    	CALL	SetDriveInv
1162+  DDA1             DriveLoop
1163+  DDA1 DD 21 BB FC 	LD	IX,DriveTab
1164+  DDA5 CD 1C 9B    	CALL	TestCoords
1165+  DDA8 0E 31       	LD	C,#31
1166+  DDAA D7          	RST	#10
1167+  DDAB 28 F4       	JR	Z,DriveLoop
1168+  DDAD 78          	LD	A,B
1169+  DDAE B7          	OR	A
1170+  DDAF 20 F0       	JR	NZ,DriveLoop
1171+  DDB1 7B          	LD	A,E
1172+  DDB2 FE 1B       	CP	#1B
1173+  DDB4 28 28       	JR	Z,DriveExit
1174+  DDB6 FE 0D       	CP	#0D
1175+  DDB8 28 7E       	JR	Z,DriveEnter
1176+  DDBA B7          	OR	A
1177+  DDBB 28 13       	JR	Z,DriveLoop1
1178+  DDBD 3A E2 A7    	LD	A,(EquipDisks)
1179+  DDC0 4F          	LD	C,A
1180+  DDC1 7B          	LD	A,E
1181+  DDC2 CB AF       	RES	5,A
1182+  DDC4 D6 41       	SUB	#41
1183+  DDC6 38 D9       	JR	C,DriveLoop
1184+  DDC8 B9          	CP	C
1185+  DDC9 30 D6       	JR	NC,DriveLoop
1186+  DDCB 32 AB DE    	LD	(CurDrive),A
1187+  DDCE 18 68       	JR	DriveEnter
1188+  DDD0             DriveLoop1
1189+  DDD0 21 A1 DD    	LD	HL,DriveLoop
1190+  DDD3 E5          	PUSH	HL
1191+  DDD4 7A          	LD	A,D
1192+  DDD5 FE 54       	CP	#54
1193+  DDD7 28 10       	JR	Z,DriveLeft
1194+  DDD9 FE 56       	CP	#56
1195+  DDDB 28 27       	JR	Z,DriveRight
1196+  DDDD C9          	RET 
1197+  DDDE             DriveExit
1198+  DDDE CD F0 86    	CALL	MakeWindow
1199+  DDE1 7F          	DEFB	#7F
1200+  DDE2 00          	DEFB	#00
1201+  DDE3 FD E1       	POP	IY
1202+  DDE5 CD EA BA    	CALL	SetInvert
1203+  DDE8 C9          	RET 
1204+  DDE9             DriveLeft
1205+  DDE9 3A E2 A7    	LD	A,(EquipDisks)
1206+  DDEC 3D          	DEC	A
1207+  DDED C8          	RET	Z
1208+  DDEE 3A AB DE    	LD	A,(CurDrive)
1209+  DDF1 B7          	OR	A
1210+  DDF2 20 03       	JR	NZ,$+5
1211+  DDF4 3A E2 A7    	LD	A,(EquipDisks)
1212+  DDF7 3D          	DEC	A
1213+  DDF8 F5          	PUSH	AF
1214+  DDF9 CD 6B DE    	CALL	ResDriveInv
1215+  DDFC F1          	POP	AF
1216+  DDFD 32 AB DE    	LD	(CurDrive),A
1217+  DE00 CD 73 DE    	CALL	SetDriveInv
1218+  DE03 C9          	RET 
1219+  DE04             DriveRight
1220+  DE04 3A E2 A7    	LD	A,(EquipDisks)
1221+  DE07 FE 01       	CP	#01
1222+  DE09 C8          	RET	Z
1223+  DE0A 47          	LD	B,A
1224+  DE0B 3A AB DE    	LD	A,(CurDrive)
1225+  DE0E 3C          	INC	A
1226+  DE0F B8          	CP	B
1227+  DE10 20 01       	JR	NZ,$+3
1228+  DE12 97          	SUB	A
1229+  DE13 F5          	PUSH	AF
1230+  DE14 CD 6B DE    	CALL	ResDriveInv
1231+  DE17 F1          	POP	AF
1232+  DE18 32 AB DE    	LD	(CurDrive),A
1233+  DE1B CD 73 DE    	CALL	SetDriveInv
1234+  DE1E C9          	RET 
1235+  DE1F             DriveMouse
1236+  DE1F DD 21 FB FC 	LD	IX,BegDrive
1237+  DE23 DD 4E 00    	LD	C,(IX+#00)
1238+  DE26 DD 46 01    	LD	B,(IX+#01)
1239+  DE29 B7          	OR	A
1240+  DE2A ED 42       	SBC	HL,BC
1241+  DE2C 01 12 00    	LD	BC,#0012
1242+  DE2F 3E FF       	LD	A,#FF
1243+  DE31 3C          	INC	A
1244+  DE32 ED 42       	SBC	HL,BC
1245+  DE34 30 FB       	JR	NC,$-3
1246+  DE36 18 03       	JR	SetDrive
1247+  DE38             DriveEnter
1248+  DE38 3A AB DE    	LD	A,(CurDrive)
1249+  DE3B             SetDrive
1250+  DE3B 21 D9 C8    	LD	HL,NewDrive
1251+  DE3E C6 41       	ADD	A,"A"
1252+  DE40 77          	LD	(HL),A
1253+  DE41 FD 36 2C 00 	LD	(IY+BegPath),#00
1254+  DE45 CD F0 86    	CALL	MakeWindow
1255+  DE48 7F          	DEFB	#7F
1256+  DE49 00          	DEFB	#00
1257+  DE4A FD E3       	EX	(SP),IY
1258+  DE4C CD EA BA    	CALL	SetInvert
1259+  DE4F FD E3       	EX	(SP),IY
1260+  DE51 21 D9 C8    	LD	HL,NewDrive
1261+  DE54 CD 3F BC    	CALL	NewDIRECTORY
1262+  DE57 21 8A A5    	LD	HL,LeftPanel
1263+  DE5A 11 2C 00    	LD	DE,BegPath
1264+  DE5D CB 7E       	BIT	7,(HL)
1265+  DE5F 20 03       	JR	NZ,$+5
1266+  DE61 21 B6 A6    	LD	HL,RightPanel
1267+  DE64 19          	ADD	HL,DE
1268+  DE65 0E 1D       	LD	C,#1D
1269+  DE67 D7          	RST	#10
1270+  DE68 FD E1       	POP	IY
1271+  DE6A C9          	RET 
1272+  DE6B             ResDriveInv
1273+  DE6B 11 80 4F    	LD	DE,#4F80
1274+  DE6E 3A AB DE    	LD	A,(CurDrive)
1275+  DE71 18 06       	JR	DriveInvert
1276+  DE73             SetDriveInv
1277+  DE73 11 4F 80    	LD	DE,#804F
1278+  DE76 3A AB DE    	LD	A,(CurDrive)
1279+  DE79             DriveInvert
1280+  DE79 6F          	LD	L,A
1281+  DE7A 26 00       	LD	H,#00
1282+  DE7C 29          	ADD	HL,HL
1283+  DE7D 29          	ADD	HL,HL
1284+  DE7E 29          	ADD	HL,HL
1285+  DE7F 29          	ADD	HL,HL
1286+  DE80 01 FB FC    	LD	BC,BegDrive
1287+  DE83 09          	ADD	HL,BC
1288+  DE84 E5          	PUSH	HL
1289+  DE85 DD E1       	POP	IX
1290+  DE87 DD 6E 00    	LD	L,(IX+#00)
1291+  DE8A DD 66 01    	LD	H,(IX+#01)
1292+  DE8D DD 4E 04    	LD	C,(IX+#04)
1293+  DE90 DD 46 05    	LD	B,(IX+#05)
1294+  DE93 DD 7E 02    	LD	A,(IX+#02)
1295+  DE96 DD 96 00    	SUB	(IX+#00)
1296+  DE99 08          	EX	AF,AF'
1297+  DE9A DD 7E 06    	LD	A,(IX+#06)
1298+  DE9D DD 96 04    	SUB	(IX+#04)
1299+  DEA0 DD 67       	LD	HX,A
1300+  DEA2 08          	EX	AF,AF'
1301+  DEA3 CB 3F       	SRL	A
1302+  DEA5 DD 6F       	LD	LX,A
1303+  DEA7 CD A3 8D    	CALL	InvertRectan
1304+  DEAA C9          	RET 
1305+  DEAB             CurDrive
1306+  DEAB 00          	DEFB	#00
1307+  DEAC             Drive
1308+  DEAC 20 00       	DEFB	" ",0
1309+  DEAE             
1310+  DEAE             
1311+  DEAE             
0274   DEAE             	include "fnmark.z80"
0001+  DEAE             
0002+  DEAE             ;[]==========================================================[]
0003+  DEAE             MarkFile
0004+  DEAE FD 7E 13    	LD	A,(IY+PanelEFl)
0005+  DEB1 FD B6 14    	OR	(IY+PanelEFh)
0006+  DEB4 C8          	RET	Z
0007+  DEB5 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0008+  DEB9 C0          	RET	NZ
0009+  DEBA DB A2       	IN	A,(PAGE1)
0010+  DEBC F5          	PUSH	AF
0011+  DEBD FD CB 00 46 	BIT	0,(IY+PanelFlg)
0012+  DEC1 3A EE A7    	LD	A,(DIRpage1)
0013+  DEC4 28 03       	JR	Z,$+5
0014+  DEC6 3A EF A7    	LD	A,(DIRpage2)
0015+  DEC9 D3 A2       	OUT	(PAGE1),A
0016+  DECB FD 6E 15    	LD	L,(IY+PanelFFl)
0017+  DECE FD 66 16    	LD	H,(IY+PanelFFh)
0018+  DED1 FD 5E 17    	LD	E,(IY+PanelCFl)
0019+  DED4 FD 56 18    	LD	D,(IY+PanelCFh)
0020+  DED7 19          	ADD	HL,DE
0021+  DED8 29          	ADD	HL,HL
0022+  DED9 29          	ADD	HL,HL
0023+  DEDA 29          	ADD	HL,HL
0024+  DEDB 5D          	LD	E,L
0025+  DEDC 54          	LD	D,H
0026+  DEDD 29          	ADD	HL,HL
0027+  DEDE 19          	ADD	HL,DE
0028+  DEDF CB F4       	SET	6,H
0029+  DEE1 5E          	LD	E,(HL)
0030+  DEE2 F1          	POP	AF
0031+  DEE3 D3 A2       	OUT	(PAGE1),A
0032+  DEE5 CB 43       	BIT	0,E
0033+  DEE7 F5          	PUSH	AF
0034+  DEE8 CC 03 DF    	CALL	Z,SelectFile
0035+  DEEB F1          	POP	AF
0036+  DEEC C4 08 DF    	CALL	NZ,UnSelectFile
0037+  DEEF CD 4C C1    	CALL	CursDown
0038+  DEF2 CD EE B2    	CALL	PrnFileInfo
0039+  DEF5 06 07       	LD	B,#07
0040+  DEF7 C5          MarkFex	PUSH	BC
0041+  DEF8 0E 03       	LD	C,#03
0042+  DEFA F7          	RST	#30
0043+  DEFB C1          	POP	BC
0044+  DEFC CB 4F       	BIT	1,A
0045+  DEFE C8          	RET	Z
0046+  DEFF 76          	HALT 
0047+  DF00 10 F5       	DJNZ	MarkFex
0048+  DF02 C9          	RET 
0049+  DF03             ;[]==========================================================[]
0050+  DF03             SelectFile
0051+  DF03 DD 2E 01    	LD	LX,#01
0052+  DF06 18 03       	JR	$+5
0053+  DF08             UnSelectFile
0054+  DF08 DD 2E 00    	LD	LX,#00
0055+  DF0B DB A2       	IN	A,(PAGE1)
0056+  DF0D F5          	PUSH	AF
0057+  DF0E FD CB 00 46 	BIT	0,(IY+PanelFlg)
0058+  DF12 3A EE A7    	LD	A,(DIRpage1)
0059+  DF15 28 03       	JR	Z,$+5
0060+  DF17 3A EF A7    	LD	A,(DIRpage2)
0061+  DF1A D3 A2       	OUT	(PAGE1),A
0062+  DF1C 3E C0       	LD	A,#C0
0063+  DF1E D3 89       	OUT	(YPORT),A
0064+  DF20 FD 6E 15    	LD	L,(IY+PanelFFl)
0065+  DF23 FD 66 16    	LD	H,(IY+PanelFFh)
0066+  DF26 FD 5E 17    	LD	E,(IY+PanelCFl)
0067+  DF29 FD 56 18    	LD	D,(IY+PanelCFh)
0068+  DF2C 19          	ADD	HL,DE
0069+  DF2D 29          	ADD	HL,HL
0070+  DF2E 29          	ADD	HL,HL
0071+  DF2F 29          	ADD	HL,HL
0072+  DF30 5D          	LD	E,L
0073+  DF31 54          	LD	D,H
0074+  DF32 29          	ADD	HL,HL
0075+  DF33 19          	ADD	HL,DE
0076+  DF34 CB F4       	SET	6,H
0077+  DF36 E5          	PUSH	HL
0078+  DF37 11 0E 00    	LD	DE,#000E
0079+  DF3A 19          	ADD	HL,DE
0080+  DF3B 4E          	LD	C,(HL)
0081+  DF3C E1          	POP	HL
0082+  DF3D CB 61       	BIT	4,C
0083+  DF3F 20 0E       	JR	NZ,MrFile1
0084+  DF41 46          	LD	B,(HL)
0085+  DF42 DD 7D       	LD	A,LX
0086+  DF44 77          	LD	(HL),A
0087+  DF45 11 00 80    	LD	DE,WorkBuffer
0088+  DF48 C5          	PUSH	BC
0089+  DF49 01 18 00    	LD	BC,#0018
0090+  DF4C ED B0       	LDIR 
0091+  DF4E C1          	POP	BC
0092+  DF4F F1          MrFile1	POP	AF
0093+  DF50 D3 A2       	OUT	(PAGE1),A
0094+  DF52 CB 61       	BIT	4,C
0095+  DF54 C0          	RET	NZ
0096+  DF55 78          	LD	A,B
0097+  DF56 DD BD       	CP	LX
0098+  DF58 C8          	RET	Z
0099+  DF59 FD CB 01 46 	BIT	0,(IY+ViewFlg)
0100+  DF5D 20 3D       	JR	NZ,MarkFull
0101+  DF5F FD 6E 17    	LD	L,(IY+PanelCFl)
0102+  DF62 FD 66 18    	LD	H,(IY+PanelCFh)
0103+  DF65 5D          	LD	E,L
0104+  DF66 54          	LD	D,H
0105+  DF67 29          	ADD	HL,HL
0106+  DF68 19          	ADD	HL,DE
0107+  DF69 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0108+  DF6D 11 B8 B9    	LD	DE,PositTAB1
0109+  DF70 28 03       	JR	Z,$+5
0110+  DF72 11 51 BA    	LD	DE,PositTAB2
0111+  DF75 19          	ADD	HL,DE
0112+  DF76 5E          	LD	E,(HL)
0113+  DF77 23          	INC	HL
0114+  DF78 56          	LD	D,(HL)
0115+  DF79 23          	INC	HL
0116+  DF7A 4E          	LD	C,(HL)
0117+  DF7B 06 00       	LD	B,#00
0118+  DF7D EB          	EX	DE,HL
0119+  DF7E DD 7D       	LD	A,LX
0120+  DF80 B7          	OR	A
0121+  DF81 F5          	PUSH	AF
0122+  DF82 16 56       	LD	D,InvPCol*#10+InvICol
0123+  DF84 1E 5C       	LD	E,InvPCol*#10+InvSCol
0124+  DF86 20 04       	JR	NZ,$+6
0125+  DF88 16 5C       	LD	D,InvPCol*#10+InvSCol
0126+  DF8A 1E 56       	LD	E,InvPCol*#10+InvICol
0127+  DF8C DD 2E 30    	LD	LX,#30
0128+  DF8F DD 26 08    	LD	HX,#08
0129+  DF92 2B          	DEC	HL
0130+  DF93 2B          	DEC	HL
0131+  DF94 CD A3 8D    	CALL	InvertRectan
0132+  DF97 F1          	POP	AF
0133+  DF98 20 38       	JR	NZ,MarkExit1
0134+  DF9A 18 6F       	JR	MarkExit2
0135+  DF9C             MarkFull
0136+  DF9C FD 6E 17    	LD	L,(IY+PanelCFl)
0137+  DF9F FD 66 18    	LD	H,(IY+PanelCFh)
0138+  DFA2 29          	ADD	HL,HL
0139+  DFA3 29          	ADD	HL,HL
0140+  DFA4 29          	ADD	HL,HL
0141+  DFA5 01 3F 00    	LD	BC,#003F
0142+  DFA8 09          	ADD	HL,BC
0143+  DFA9 4D          	LD	C,L
0144+  DFAA 06 00       	LD	B,#00
0145+  DFAC FD CB 00 46 	BIT	0,(IY+PanelFlg)
0146+  DFB0 21 06 00    	LD	HL,#0006
0147+  DFB3 28 03       	JR	Z,$+5
0148+  DFB5 21 46 01    	LD	HL,#0146
0149+  DFB8 DD 7D       	LD	A,LX
0150+  DFBA B7          	OR	A
0151+  DFBB F5          	PUSH	AF
0152+  DFBC 16 56       	LD	D,InvPCol*#10+InvICol
0153+  DFBE 1E 5C       	LD	E,InvPCol*#10+InvSCol
0154+  DFC0 20 04       	JR	NZ,$+6
0155+  DFC2 16 5C       	LD	D,InvPCol*#10+InvSCol
0156+  DFC4 1E 56       	LD	E,InvPCol*#10+InvICol
0157+  DFC6 DD 2E 92    	LD	LX,#92
0158+  DFC9 DD 26 08    	LD	HX,#08
0159+  DFCC CD A3 8D    	CALL	InvertRectan
0160+  DFCF F1          	POP	AF
0161+  DFD0 28 39       	JR	Z,MarkExit2
0162+  DFD2             MarkExit1
0163+  DFD2 DD 21 00 80 	LD	IX,WorkBuffer
0164+  DFD6 FD 6E 19    	LD	L,(IY+PanelMFl)
0165+  DFD9 FD 66 1A    	LD	H,(IY+PanelMFh)
0166+  DFDC 23          	INC	HL
0167+  DFDD FD 75 19    	LD	(IY+PanelMFl),L
0168+  DFE0 FD 74 1A    	LD	(IY+PanelMFh),H
0169+  DFE3 DD 6E 0F    	LD	L,(IX+#0F)
0170+  DFE6 DD 66 10    	LD	H,(IX+#10)
0171+  DFE9 FD 5E 1B    	LD	E,(IY+PanelMBl1)
0172+  DFEC FD 56 1C    	LD	D,(IY+PanelMBh1)
0173+  DFEF 19          	ADD	HL,DE
0174+  DFF0 FD 75 1B    	LD	(IY+PanelMBl1),L
0175+  DFF3 FD 74 1C    	LD	(IY+PanelMBh1),H
0176+  DFF6 DD 6E 11    	LD	L,(IX+#11)
0177+  DFF9 DD 66 12    	LD	H,(IX+#12)
0178+  DFFC FD 5E 1D    	LD	E,(IY+PanelMBl2)
0179+  DFFF FD 56 1E    	LD	D,(IY+PanelMBh2)
0180+  E002 ED 5A       	ADC	HL,DE
0181+  E004 FD 75 1D    	LD	(IY+PanelMBl2),L
0182+  E007 FD 74 1E    	LD	(IY+PanelMBh2),H
0183+  E00A C9          	RET 
0184+  E00B             MarkExit2
0185+  E00B DD 21 00 80 	LD	IX,WorkBuffer
0186+  E00F FD 6E 19    	LD	L,(IY+PanelMFl)
0187+  E012 FD 66 1A    	LD	H,(IY+PanelMFh)
0188+  E015 2B          	DEC	HL
0189+  E016 FD 75 19    	LD	(IY+PanelMFl),L
0190+  E019 FD 74 1A    	LD	(IY+PanelMFh),H
0191+  E01C FD 6E 1B    	LD	L,(IY+PanelMBl1)
0192+  E01F FD 66 1C    	LD	H,(IY+PanelMBh1)
0193+  E022 DD 5E 0F    	LD	E,(IX+#0F)
0194+  E025 DD 56 10    	LD	D,(IX+#10)
0195+  E028 B7          	OR	A
0196+  E029 ED 52       	SBC	HL,DE
0197+  E02B FD 75 1B    	LD	(IY+PanelMBl1),L
0198+  E02E FD 74 1C    	LD	(IY+PanelMBh1),H
0199+  E031 FD 6E 1D    	LD	L,(IY+PanelMBl2)
0200+  E034 FD 66 1E    	LD	H,(IY+PanelMBh2)
0201+  E037 DD 5E 11    	LD	E,(IX+#11)
0202+  E03A DD 56 12    	LD	D,(IX+#12)
0203+  E03D ED 52       	SBC	HL,DE
0204+  E03F FD 75 1D    	LD	(IY+PanelMBl2),L
0205+  E042 FD 74 1E    	LD	(IY+PanelMBh2),H
0206+  E045 C9          	RET 
0207+  E046             ;[]==========================================================[]
0208+  E046             UnMarkGroup
0209+  E046 CD F9 BA    	CALL	ResInvert
0210+  E049 21 EA BA    	LD	HL,SetInvert
0211+  E04C E5          	PUSH	HL
0212+  E04D 97          	SUB	A
0213+  E04E 18 09       	JR	SelectGroup
0214+  E050             MarkGroup
0215+  E050 CD F9 BA    	CALL	ResInvert
0216+  E053 21 EA BA    	LD	HL,SetInvert
0217+  E056 E5          	PUSH	HL
0218+  E057 3E 01       	LD	A,#01
0219+  E059             SelectGroup
0220+  E059 32 55 E1    	LD	(SelMode+2),A
0221+  E05C FD 7E 13    	LD	A,(IY+PanelEFl)
0222+  E05F FD B6 14    	OR	(IY+PanelEFh)
0223+  E062 C8          	RET	Z
0224+  E063 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0225+  E067 C0          	RET	NZ
0226+  E068 CD F0 86    	CALL	MakeWindow
0227+  E06B 01          	DEFB	#01
0228+  E06C D0 00 51 00 	DEFW	#00D0,#0051
0229+  E070 E0 00 3E 00 	DEFW	#00E0,#003E
0230+  E074 02          	DEFB	#02	;Head place
0231+  E075 04 00 02 00 	DEFW	#0004,#0002
0232+  E079 D8 00 0A 00 	DEFW	#00D8,#000A
0233+  E07D 00          	DEFB	#00
0234+  E07E 01          	DEFB	#01	;Text Line
0235+  E07F 52 00 03 00 	DEFW	#0052,#0003
0236+  E083 0F          	DEFB	#0F
0237+  E084             	DEFB	"Select mask",0
0237+  E084 53656C656374206D61736B00
0238+  E090 04          	DEFB	#04	;UpRectan
0239+  E091 20 00 2A 00 	DEFW	#0020,#002A
0240+  E095 48 00 0E 00 	DEFW	#0048,#000E
0241+  E099 01          	DEFB	#01	;Text Line
0242+  E09A 3C 00 2D 00 	DEFW	#003C,#002D
0243+  E09E 80          	DEFB	#80
0244+  E09F 4F 6B 00    	DEFB	"Ok",0
0245+  E0A2 04          	DEFB	#04	;UpRectan
0246+  E0A3 78 00 2A 00 	DEFW	#0078,#002A
0247+  E0A7 48 00 0E 00 	DEFW	#0048,#000E
0248+  E0AB 01          	DEFB	#01	;Text Line
0249+  E0AC 8C 00 2D 00 	DEFW	#008C,#002D
0250+  E0B0 80          	DEFB	#80
0251+  E0B1             	DEFB	"Cancel",0
0251+  E0B1 43616E63656C00
0252+  E0B8 01          	DEFB	#01	;Text Line
0253+  E0B9 0A 00 19 00 	DEFW	#000A,#0019
0254+  E0BD 80          	DEFB	#80
0255+  E0BE             	DEFB	"Mark mask:",0
0255+  E0BE 4D61726B206D61736B3A00
0256+  E0C9 03          	DEFB	#03	;Углубление
0257+  E0CA 46 00 16 00 	DEFW	#0046,#0016
0258+  E0CE 86 00 0C 00 	DEFW	#0086,#000C
0259+  E0D2 02          	DEFB	#02	;Head place
0260+  E0D3 48 00 17 00 	DEFW	#0048,#0017
0261+  E0D7 82 00 0A 00 	DEFW	#0082,#000A
0262+  E0DB 0F          	DEFB	#0F
0263+  E0DC 00          	DEFB	#00
0264+  E0DD DD 21 F3 E1 	LD	IX,SMaskStr
0265+  E0E1 21 B5 FB    	LD	HL,SMaskTab
0266+  E0E4 CD 68 91    	CALL	InputLine
0267+  E0E7 CD F0 86    	CALL	MakeWindow
0268+  E0EA 7F          	DEFB	#7F
0269+  E0EB 00          	DEFB	#00
0270+  E0EC D8          	RET	C
0271+  E0ED 3A F7 E1    	LD	A,(MaskLen)
0272+  E0F0 B7          	OR	A
0273+  E0F1 C8          	RET	Z
0274+  E0F2 47          	LD	B,A
0275+  E0F3 21 FF E1    	LD	HL,CrSMask
0276+  E0F6 7E          CorMask	LD	A,(HL)
0277+  E0F7 CD 57 AA    	CALL	CorrBigChar
0278+  E0FA 77          	LD	(HL),A
0279+  E0FB 23          	INC	HL
0280+  E0FC 10 F8       	DJNZ	CorMask
0281+  E0FE 21 FF E1    	LD	HL,CrSMask
0282+  E101 11 0C E2    	LD	DE,SelMask
0283+  E104 CD 17 E2    	CALL	MakeMask
0284+  E107 38 15       	JR	C,MarkGNext
0285+  E109 21 80 A8    	LD	HL,NORMmask
0286+  E10C 11 FF E1    	LD	DE,CrSMask
0287+  E10F 01 0D 00    	LD	BC,#000D
0288+  E112 ED B0       	LDIR 
0289+  E114 21 FF E1    	LD	HL,CrSMask
0290+  E117 11 0C E2    	LD	DE,SelMask
0291+  E11A CD 17 E2    	CALL	MakeMask
0292+  E11D C9          	RET 
0293+  E11E             MarkGNext
0294+  E11E DB A2       	IN	A,(PAGE1)
0295+  E120 F5          	PUSH	AF
0296+  E121 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0297+  E125 3A EE A7    	LD	A,(DIRpage1)
0298+  E128 28 03       	JR	Z,$+5
0299+  E12A 3A EF A7    	LD	A,(DIRpage2)
0300+  E12D D3 A2       	OUT	(PAGE1),A
0301+  E12F 3E C0       	LD	A,#C0
0302+  E131 D3 89       	OUT	(YPORT),A
0303+  E133 DD 21 00 40 	LD	IX,#4000
0304+  E137 21 00 40    	LD	HL,#4000
0305+  E13A 11 0C E2    	LD	DE,SelMask
0306+  E13D D9          	EXX 
0307+  E13E FD 6E 1B    	LD	L,(IY+PanelMBl1)
0308+  E141 FD 66 1C    	LD	H,(IY+PanelMBh1)
0309+  E144 FD 5E 1D    	LD	E,(IY+PanelMBl2)
0310+  E147 FD 56 1E    	LD	D,(IY+PanelMBh2)
0311+  E14A FD 4E 19    	LD	C,(IY+PanelMFl)
0312+  E14D FD 46 1A    	LD	B,(IY+PanelMFh)
0313+  E150 D9          	EXX 
0314+  E151 FD E5       	PUSH	IY
0315+  E153 FD 2E 00    SelMode	LD	LY,#00
0316+  E156 FD 26 00    	LD	HY,#00
0317+  E159 D5          Select1	PUSH	DE
0318+  E15A DD CB 0E 66 	BIT	4,(IX+#0E)
0319+  E15E 20 60       	JR	NZ,Select8
0320+  E160 FD 7D       	LD	A,LY
0321+  E162 BE          	CP	(HL)
0322+  E163 28 5B       	JR	Z,Select8
0323+  E165 E5          	PUSH	HL
0324+  E166 23          	INC	HL
0325+  E167 06 08       	LD	B,08
0326+  E169 1A          Select2	LD	A,(DE)
0327+  E16A FE 3F       	CP	"?"
0328+  E16C 28 03       	JR	Z,Select3
0329+  E16E BE          	CP	(HL)
0330+  E16F 20 13       	JR	NZ,Select6
0331+  E171 23          Select3	INC	HL
0332+  E172 13          	INC	DE
0333+  E173 10 F4       	DJNZ	Select2
0334+  E175 23          	INC	HL
0335+  E176 06 03       	LD	B,03
0336+  E178 1A          Select4	LD	A,(DE)
0337+  E179 FE 3F       	CP	"?"
0338+  E17B 28 03       	JR	Z,Select5
0339+  E17D BE          	CP	(HL)
0340+  E17E 20 04       	JR	NZ,Select6
0341+  E180 23          Select5	INC	HL
0342+  E181 13          	INC	DE
0343+  E182 10 F4       	DJNZ	Select4
0344+  E184 E1          Select6	POP	HL
0345+  E185 20 39       	JR	NZ,Select8
0346+  E187 FD 26 01    	LD	HY,#01
0347+  E18A FD 7D       	LD	A,LY
0348+  E18C 77          	LD	(HL),A
0349+  E18D B7          	OR	A
0350+  E18E 28 18       	JR	Z,Select7
0351+  E190 D9          	EXX 
0352+  E191 C5          	PUSH	BC
0353+  E192 DD 4E 0F    	LD	C,(IX+#0F)
0354+  E195 DD 46 10    	LD	B,(IX+#10)
0355+  E198 09          	ADD	HL,BC
0356+  E199 DD 4E 11    	LD	C,(IX+#11)
0357+  E19C DD 46 12    	LD	B,(IX+#12)
0358+  E19F EB          	EX	DE,HL
0359+  E1A0 ED 4A       	ADC	HL,BC
0360+  E1A2 EB          	EX	DE,HL
0361+  E1A3 C1          	POP	BC
0362+  E1A4 03          	INC	BC
0363+  E1A5 D9          	EXX 
0364+  E1A6 18 18       	JR	Select8
0365+  E1A8 D9          Select7	EXX 
0366+  E1A9 C5          	PUSH	BC
0367+  E1AA DD 4E 0F    	LD	C,(IX+#0F)
0368+  E1AD DD 46 10    	LD	B,(IX+#10)
0369+  E1B0 B7          	OR	A
0370+  E1B1 ED 42       	SBC	HL,BC
0371+  E1B3 DD 4E 11    	LD	C,(IX+#11)
0372+  E1B6 DD 46 12    	LD	B,(IX+#12)
0373+  E1B9 EB          	EX	DE,HL
0374+  E1BA ED 42       	SBC	HL,BC
0375+  E1BC EB          	EX	DE,HL
0376+  E1BD C1          	POP	BC
0377+  E1BE 0B          	DEC	BC
0378+  E1BF D9          	EXX 
0379+  E1C0 11 18 00    Select8	LD	DE,#0018
0380+  E1C3 19          	ADD	HL,DE
0381+  E1C4 DD 19       	ADD	IX,DE
0382+  E1C6 D1          	POP	DE
0383+  E1C7 DD 7E 01    	LD	A,(IX+#01)
0384+  E1CA B7          	OR	A
0385+  E1CB 20 8C       	JR	NZ,Select1
0386+  E1CD FD 7C       	LD	A,HY
0387+  E1CF 08          	EX	AF,AF'
0388+  E1D0 FD E1       	POP	IY
0389+  E1D2 F1          	POP	AF
0390+  E1D3 D3 A2       	OUT	(PAGE1),A
0391+  E1D5 D9          	EXX 
0392+  E1D6 FD 75 1B    	LD	(IY+PanelMBl1),L
0393+  E1D9 FD 74 1C    	LD	(IY+PanelMBh1),H
0394+  E1DC FD 73 1D    	LD	(IY+PanelMBl2),E
0395+  E1DF FD 72 1E    	LD	(IY+PanelMBh2),D
0396+  E1E2 FD 71 19    	LD	(IY+PanelMFl),C
0397+  E1E5 FD 70 1A    	LD	(IY+PanelMFh),B
0398+  E1E8 D9          	EXX 
0399+  E1E9 08          	EX	AF,AF'
0400+  E1EA B7          	OR	A
0401+  E1EB C8          	RET	Z
0402+  E1EC CD 45 B5    	CALL	PrintDIR
0403+  E1EF CD EE B2    	CALL	PrnFileInfo
0404+  E1F2 C9          	RET 
0405+  E1F3             SMaskStr
0406+  E1F3 0C 00 00 00 	DEFB	#0C,#00,#00,#00
0407+  E1F7 03          MaskLen	DEFB	#03
0408+  E1F8 1A 01 6A 00 	DEFW	#011A,#006A
0409+  E1FC 68 00       	DEFW	#0068
0410+  E1FE F0          	DEFB	#F0
0411+  E1FF 2A 2E 2A    CrSMask	DEFB	"*.*"
0412+  E202 00          	DEFS	10,0
0413+  E20C             SelMask
0414+  E20C             	DEFB	"???????????"
0414+  E20C 3F3F3F3F3F3F3F3F3F3F3F
0415+  E217             MakeMask
0416+  E217 01 02 09    	LD	BC,#0902
0417+  E21A 7E          SMaskLp	LD	A,(HL)
0418+  E21B FE 21       	CP	#21
0419+  E21D D8          	RET	C
0420+  E21E FE 22       	CP	#22
0421+  E220 C8          	RET	Z
0422+  E221 FE 2A       	CP	"*"
0423+  E223 28 32       	JR	Z,SMask1
0424+  E225 FE 2B       	CP	"+"
0425+  E227 C8          	RET	Z
0426+  E228 FE 2C       	CP	","
0427+  E22A C8          	RET	Z
0428+  E22B FE 2E       	CP	"."
0429+  E22D 28 36       	JR	Z,SMask2
0430+  E22F FE 2F       	CP	"/"
0431+  E231 C8          	RET	Z
0432+  E232 FE 3A       	CP	":"
0433+  E234 C8          	RET	Z
0434+  E235 FE 3B       	CP	";"
0435+  E237 C8          	RET	Z
0436+  E238 FE 3C       	CP	"<"
0437+  E23A C8          	RET	Z
0438+  E23B FE 3D       	CP	"="
0439+  E23D C8          	RET	Z
0440+  E23E FE 3E       	CP	">"
0441+  E240 C8          	RET	Z
0442+  E241 FE 5B       	CP	"["
0443+  E243 C8          	RET	Z
0444+  E244 FE 5C       	CP	"\\"
0445+  E246 C8          	RET	Z
0446+  E247 FE 5D       	CP	"]"
0447+  E249 C8          	RET	Z
0448+  E24A FE 7C       	CP	"|"
0449+  E24C C8          	RET	Z
0450+  E24D CD 57 AA    	CALL	CorrBigChar
0451+  E250 12          	LD	(DE),A
0452+  E251 23          	INC	HL
0453+  E252 13          	INC	DE
0454+  E253 10 C5       	DJNZ	SMaskLp
0455+  E255 A7          	AND	A
0456+  E256 C9          	RET 
0457+  E257             SMask1
0458+  E257 3E 3F       	LD	A,"?"
0459+  E259 23          	INC	HL
0460+  E25A 10 02       	DJNZ	SMask11
0461+  E25C A7          	AND	A
0462+  E25D C9          	RET 
0463+  E25E             SMask11
0464+  E25E 12          	LD	(DE),A
0465+  E25F 13          	INC	DE
0466+  E260 10 FC       	DJNZ	SMask11
0467+  E262 04          	INC	B
0468+  E263 18 B5       	JR	SMaskLp
0469+  E265             SMask2
0470+  E265 3E 20       	LD	A," "
0471+  E267 23          	INC	HL
0472+  E268 10 07       	DJNZ	SMask21
0473+  E26A 06 04       	LD	B,#04
0474+  E26C 0D          	DEC	C
0475+  E26D 20 AB       	JR	NZ,SMaskLp
0476+  E26F A7          	AND	A
0477+  E270 C9          	RET 
0478+  E271             SMask21
0479+  E271 12          	LD	(DE),A
0480+  E272 13          	INC	DE
0481+  E273 10 FC       	DJNZ	SMask21
0482+  E275 06 04       	LD	B,#04
0483+  E277 0D          	DEC	C
0484+  E278 20 A0       	JR	NZ,SMaskLp
0485+  E27A A7          	AND	A
0486+  E27B C9          	RET 
0487+  E27C             ;[]==========================================================[]
0488+  E27C             SelectAll
0489+  E27C CD F9 BA    	CALL	ResInvert
0490+  E27F 21 EA BA    	LD	HL,SetInvert
0491+  E282 E5          	PUSH	HL
0492+  E283 FD 7E 13    	LD	A,(IY+PanelEFl)
0493+  E286 FD B6 14    	OR	(IY+PanelEFh)
0494+  E289 C8          	RET	Z
0495+  E28A FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0496+  E28E C0          	RET	NZ
0497+  E28F DB A2       	IN	A,(PAGE1)
0498+  E291 F5          	PUSH	AF
0499+  E292 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0500+  E296 3A EE A7    	LD	A,(DIRpage1)
0501+  E299 28 03       	JR	Z,$+5
0502+  E29B 3A EF A7    	LD	A,(DIRpage2)
0503+  E29E D3 A2       	OUT	(PAGE1),A
0504+  E2A0 3E C0       	LD	A,#C0
0505+  E2A2 D3 89       	OUT	(YPORT),A
0506+  E2A4 DD 21 00 40 	LD	IX,#4000
0507+  E2A8 01 18 00    	LD	BC,#0018
0508+  E2AB 97          	SUB	A
0509+  E2AC 6F          	LD	L,A
0510+  E2AD 65          	LD	H,L
0511+  E2AE 5D          	LD	E,L
0512+  E2AF 54          	LD	D,H
0513+  E2B0 D9          	EXX 
0514+  E2B1 6F          	LD	L,A
0515+  E2B2 65          	LD	H,L
0516+  E2B3 D9          	EXX 
0517+  E2B4 DD CB 0E 66 SelAll0	BIT	4,(IX+#0E)
0518+  E2B8 20 1B       	JR	NZ,SelAll1
0519+  E2BA DD CB 00 C6 	SET	0,(IX+#00)
0520+  E2BE DD 4E 0F    	LD	C,(IX+#0F)
0521+  E2C1 DD 46 10    	LD	B,(IX+#10)
0522+  E2C4 09          	ADD	HL,BC
0523+  E2C5 DD 4E 11    	LD	C,(IX+#11)
0524+  E2C8 DD 46 12    	LD	B,(IX+#12)
0525+  E2CB EB          	EX	DE,HL
0526+  E2CC ED 4A       	ADC	HL,BC
0527+  E2CE EB          	EX	DE,HL
0528+  E2CF D9          	EXX 
0529+  E2D0 23          	INC	HL
0530+  E2D1 D9          	EXX 
0531+  E2D2 01 18 00    	LD	BC,#0018
0532+  E2D5 DD 09       SelAll1	ADD	IX,BC
0533+  E2D7 DD 7E 01    	LD	A,(IX+#01)
0534+  E2DA B7          	OR	A
0535+  E2DB 20 D7       	JR	NZ,SelAll0
0536+  E2DD F1          	POP	AF
0537+  E2DE D3 A2       	OUT	(PAGE1),A
0538+  E2E0 D9          	EXX 
0539+  E2E1 FD 5E 19    	LD	E,(IY+PanelMFl)
0540+  E2E4 FD 56 1A    	LD	D,(IY+PanelMFh)
0541+  E2E7 B7          	OR	A
0542+  E2E8 ED 52       	SBC	HL,DE
0543+  E2EA C8          	RET	Z
0544+  E2EB 19          	ADD	HL,DE
0545+  E2EC FD 75 19    	LD	(IY+PanelMFl),L
0546+  E2EF FD 74 1A    	LD	(IY+PanelMFh),H
0547+  E2F2 D9          	EXX 
0548+  E2F3 FD 75 1B    	LD	(IY+PanelMBl1),L
0549+  E2F6 FD 74 1C    	LD	(IY+PanelMBh1),H
0550+  E2F9 FD 73 1D    	LD	(IY+PanelMBl2),E
0551+  E2FC FD 72 1E    	LD	(IY+PanelMBh2),D
0552+  E2FF CD 45 B5    	CALL	PrintDIR
0553+  E302 CD EE B2    	CALL	PrnFileInfo
0554+  E305 C9          	RET 
0555+  E306             ;[]==========================================================[]
0556+  E306             UnSelectAll
0557+  E306 CD F9 BA    	CALL	ResInvert
0558+  E309 21 EA BA    	LD	HL,SetInvert
0559+  E30C E5          	PUSH	HL
0560+  E30D FD 7E 13    	LD	A,(IY+PanelEFl)
0561+  E310 FD B6 14    	OR	(IY+PanelEFh)
0562+  E313 C8          	RET	Z
0563+  E314 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0564+  E318 C0          	RET	NZ
0565+  E319 FD 7E 19    	LD	A,(IY+PanelMFl)
0566+  E31C FD B6 1A    	OR	(IY+PanelMFh)
0567+  E31F C8          	RET	Z
0568+  E320 97          	SUB	A
0569+  E321 FD 77 19    	LD	(IY+PanelMFl),A	     ;Equip mark files
0570+  E324 FD 77 1A    	LD	(IY+PanelMFh),A
0571+  E327 FD 77 1B    	LD	(IY+PanelMBl1),A      ;Equip mark bytes
0572+  E32A FD 77 1C    	LD	(IY+PanelMBh1),A
0573+  E32D FD 77 1D    	LD	(IY+PanelMBl2),A      ;Equip mark bytes
0574+  E330 FD 77 1E    	LD	(IY+PanelMBh2),A
0575+  E333 DB A2       	IN	A,(PAGE1)
0576+  E335 F5          	PUSH	AF
0577+  E336 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0578+  E33A 3A EE A7    	LD	A,(DIRpage1)
0579+  E33D 28 03       	JR	Z,$+5
0580+  E33F 3A EF A7    	LD	A,(DIRpage2)
0581+  E342 D3 A2       	OUT	(PAGE1),A
0582+  E344 3E C0       	LD	A,#C0
0583+  E346 D3 89       	OUT	(YPORT),A
0584+  E348 21 00 40    	LD	HL,#4000
0585+  E34B 01 19 00    	LD	BC,#0019
0586+  E34E CB 86       UnSelA1	RES	0,(HL)
0587+  E350 09          	ADD	HL,BC
0588+  E351 7E          	LD	A,(HL)
0589+  E352 2B          	DEC	HL
0590+  E353 B7          	OR	A
0591+  E354 20 F8       	JR	NZ,UnSelA1
0592+  E356 F1          	POP	AF
0593+  E357 D3 A2       	OUT	(PAGE1),A
0594+  E359 CD 45 B5    	CALL	PrintDIR
0595+  E35C CD EE B2    	CALL	PrnFileInfo
0596+  E35F C9          	RET 
0597+  E360             ;[]==========================================================[]
0598+  E360             InvertSelect
0599+  E360 CD F9 BA    	CALL	ResInvert
0600+  E363 21 EA BA    	LD	HL,SetInvert
0601+  E366 E5          	PUSH	HL
0602+  E367 FD 7E 13    	LD	A,(IY+PanelEFl)
0603+  E36A FD B6 14    	OR	(IY+PanelEFh)
0604+  E36D C8          	RET	Z
0605+  E36E FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0606+  E372 C0          	RET	NZ
0607+  E373 DB A2       	IN	A,(PAGE1)
0608+  E375 F5          	PUSH	AF
0609+  E376 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0610+  E37A 3A EE A7    	LD	A,(DIRpage1)
0611+  E37D 28 03       	JR	Z,$+5
0612+  E37F 3A EF A7    	LD	A,(DIRpage2)
0613+  E382 D3 A2       	OUT	(PAGE1),A
0614+  E384 3E C0       	LD	A,#C0
0615+  E386 D3 89       	OUT	(YPORT),A
0616+  E388 DD 21 00 40 	LD	IX,#4000
0617+  E38C 11 18 00    	LD	DE,#0018
0618+  E38F 06 00       	LD	B,#00
0619+  E391 D9          	EXX 
0620+  E392 FD 6E 1B    	LD	L,(IY+PanelMBl1)
0621+  E395 FD 66 1C    	LD	H,(IY+PanelMBh1)
0622+  E398 FD 5E 1D    	LD	E,(IY+PanelMBl2)
0623+  E39B FD 56 1E    	LD	D,(IY+PanelMBh2)
0624+  E39E FD 4E 19    	LD	C,(IY+PanelMFl)
0625+  E3A1 FD 46 1A    	LD	B,(IY+PanelMFh)
0626+  E3A4 D9          	EXX 
0627+  E3A5 DD CB 0E 66 InvSel1	BIT	4,(IX+#0E)
0628+  E3A9 20 3C       	JR	NZ,InvSel3
0629+  E3AB 06 01       	LD	B,#01
0630+  E3AD DD 7E 00    	LD	A,(IX+#00)
0631+  E3B0 EE 01       	XOR	#01
0632+  E3B2 DD 77 00    	LD	(IX+#00),A
0633+  E3B5 28 18       	JR	Z,InvSel2
0634+  E3B7 D9          	EXX 
0635+  E3B8 C5          	PUSH	BC
0636+  E3B9 DD 4E 0F    	LD	C,(IX+#0F)
0637+  E3BC DD 46 10    	LD	B,(IX+#10)
0638+  E3BF 09          	ADD	HL,BC
0639+  E3C0 DD 4E 11    	LD	C,(IX+#11)
0640+  E3C3 DD 46 12    	LD	B,(IX+#12)
0641+  E3C6 EB          	EX	DE,HL
0642+  E3C7 ED 4A       	ADC	HL,BC
0643+  E3C9 EB          	EX	DE,HL
0644+  E3CA C1          	POP	BC
0645+  E3CB 03          	INC	BC
0646+  E3CC D9          	EXX 
0647+  E3CD 18 18       	JR	InvSel3
0648+  E3CF D9          InvSel2	EXX 
0649+  E3D0 C5          	PUSH	BC
0650+  E3D1 DD 4E 0F    	LD	C,(IX+#0F)
0651+  E3D4 DD 46 10    	LD	B,(IX+#10)
0652+  E3D7 B7          	OR	A
0653+  E3D8 ED 42       	SBC	HL,BC
0654+  E3DA DD 4E 11    	LD	C,(IX+#11)
0655+  E3DD DD 46 12    	LD	B,(IX+#12)
0656+  E3E0 EB          	EX	DE,HL
0657+  E3E1 ED 42       	SBC	HL,BC
0658+  E3E3 EB          	EX	DE,HL
0659+  E3E4 C1          	POP	BC
0660+  E3E5 0B          	DEC	BC
0661+  E3E6 D9          	EXX 
0662+  E3E7 DD 19       InvSel3	ADD	IX,DE
0663+  E3E9 DD 7E 01    	LD	A,(IX+#01)
0664+  E3EC B7          	OR	A
0665+  E3ED 20 B6       	JR	NZ,InvSel1
0666+  E3EF F1          	POP	AF
0667+  E3F0 D3 A2       	OUT	(PAGE1),A
0668+  E3F2 D9          	EXX 
0669+  E3F3 FD 75 1B    	LD	(IY+PanelMBl1),L
0670+  E3F6 FD 74 1C    	LD	(IY+PanelMBh1),H
0671+  E3F9 FD 73 1D    	LD	(IY+PanelMBl2),E
0672+  E3FC FD 72 1E    	LD	(IY+PanelMBh2),D
0673+  E3FF FD 71 19    	LD	(IY+PanelMFl),C
0674+  E402 FD 70 1A    	LD	(IY+PanelMFh),B
0675+  E405 D9          	EXX 
0676+  E406 78          	LD	A,B
0677+  E407 B7          	OR	A
0678+  E408 C8          	RET	Z
0679+  E409 CD 45 B5    	CALL	PrintDIR
0680+  E40C CD EE B2    	CALL	PrnFileInfo
0681+  E40F C9          	RET 
0682+  E410             
0683+  E410             
0684+  E410             
0275   E410             	include "fninit.z80"
0001+  E410             
0002+  E410             ;[]==========================================================[]
0003+  E410             InitVMode
0004+  E410 0E 51       	LD	C,#51
0005+  E412 D7          	RST	#10
0006+  E413 4F          	LD	C,A
0007+  E414 3A 33 E5    	LD	A,(InitFlg+1)
0008+  E417 B7          	OR	A
0009+  E418 20 08       	JR	NZ,InitVM0
0010+  E41A 79          	LD	A,C
0011+  E41B 32 9B E4    	LD	(VMode+1),A
0012+  E41E 78          	LD	A,B
0013+  E41F 32 99 E4    	LD	(VScrn+1),A
0014+  E422 21 00 80    InitVM0	LD	HL,WorkBuffer
0015+  E425 0E EF       	LD	C,#EF
0016+  E427 CF          	RST	#08
0017+  E428 21 FD FF    	LD	HL,#FFFD
0018+  E42B B7          	OR	A
0019+  E42C ED 42       	SBC	HL,BC
0020+  E42E 28 1E       	JR	Z,InitVM1
0021+  E430 97          	SUB	A
0022+  E431 01 FD 1F    	LD	BC,#1FFD
0023+  E434 ED 79       	OUT	(C),A
0024+  E436 DB C9       	IN	A,(#C9)
0025+  E438 F5          	PUSH	AF
0026+  E439 0E F1       	LD	C,#F1
0027+  E43B CD 14 3D    	CALL	#3D14
0028+  E43E 97          	SUB	A
0029+  E43F D3 FE       	OUT	(BORDER),A
0030+  E441 F1          	POP	AF
0031+  E442 D3 C9       	OUT	(#C9),A
0032+  E444 3E 01       	LD	A,#01
0033+  E446 01 FD 1F    	LD	BC,#1FFD
0034+  E449 ED 79       	OUT	(C),A
0035+  E44B CD 64 E4    	CALL	InitComPorts
0036+  E44E 01 50 00    InitVM1	LD	BC,#0050
0037+  E451 3E 82       	LD	A,#82
0038+  E453 D7          	RST	#10
0039+  E454 97          	SUB	A
0040+  E455 CD BB 86    	CALL	ClearScreen
0041+  E458 21 00 85    InitPAL	LD	HL,PALETTE
0042+  E45B 11 00 10    	LD	DE,#1000
0043+  E45E 01 A4 FF    	LD	BC,#FFA4
0044+  E461 97          	SUB	A
0045+  E462 CF          	RST	#08
0046+  E463 C9          	RET 
0047+  E464             
0048+  E464             ComA	EQU	#19
0049+  E464             DataA	EQU	#18
0050+  E464             LPT1C	EQU	#1D
0051+  E464             LPT2C	EQU	#1F
0052+  E464             
0053+  E464             InitComPorts
0054+  E464 3E 00       	LD	A,#00
0055+  E466 D3 19       	OUT	(ComA),A
0056+  E468 3E 01       	LD	A,#01
0057+  E46A D3 19       	OUT	(ComA),A
0058+  E46C 3E 00       	LD	A,#00		;#18
0059+  E46E D3 19       	OUT	(ComA),A
0060+  E470 3E 03       	LD	A,#03
0061+  E472 D3 19       	OUT	(ComA),A
0062+  E474 3E C1       	LD	A,#C1
0063+  E476 D3 19       	OUT	(ComA),A
0064+  E478 3E 04       	LD	A,#04
0065+  E47A D3 19       	OUT	(ComA),A
0066+  E47C 3E 07       	LD	A,#07		;#05
0067+  E47E D3 19       	OUT	(ComA),A
0068+  E480 3E 05       	LD	A,#05
0069+  E482 D3 19       	OUT	(ComA),A
0070+  E484 3E 60       	LD	A,#60
0071+  E486 D3 19       	OUT	(ComA),A
0072+  E488 3E 8F       	LD	A,#8F
0073+  E48A D3 1D       	OUT	(LPT1C),A
0074+  E48C 3E CF       	LD	A,#CF
0075+  E48E 01 1F 00    	LD	BC,LPT2C
0076+  E491 ED 79       	OUT	(C),A
0077+  E493 3E FF       	LD	A,#FF
0078+  E495 ED 79       	OUT	(C),A
0079+  E497 C9          	RET 
0080+  E498             ;[]----------------------------------------------------------[]
0081+  E498             ResVMode
0082+  E498             ResVModeE
0083+  E498 06 00       VScrn	LD	B,#00
0084+  E49A 3E 00       VMode	LD	A,#00
0085+  E49C 0E 50       	LD	C,#50
0086+  E49E FD E5       	PUSH	IY
0087+  E4A0 D7          	RST	#10
0088+  E4A1 FD E1       	POP	IY
0089+  E4A3 C9          	RET 
0090+  E4A4             ;[]==========================================================[]
0091+  E4A4             InitDrivers
0092+  E4A4 97          	SUB	A
0093+  E4A5 32 E4 A7    	LD	(CMOSFlag),A
0094+  E4A8 6F          	LD	L,A
0095+  E4A9 67          	LD	H,A
0096+  E4AA 22 24 9B    	LD	(PrvTabl+1),HL
0097+  E4AD 22 4C 9B    	LD	(PrMousX+1),HL
0098+  E4B0 22 57 9B    	LD	(PrMousY+1),HL
0099+  E4B3 01 3D 07    	LD	BC,#073D
0100+  E4B6 D7          	RST	#10
0101+  E4B7 30 37       	JR	NC,InitDrv
0102+  E4B9 CD 98 E4    	CALL	ResVMode
0103+  E4BC 21 CC E4    	LD	HL,NoEnMemory
0104+  E4BF 0E 5C       	LD	C,#5C		;печатаем
0105+  E4C1 D7          	RST	#10
0106+  E4C2 3A E6 A7    	LD	A,(FNIndef)
0107+  E4C5 0E 3E       	LD	C,#3E
0108+  E4C7 D7          	RST	#10
0109+  E4C8 01 41 FF    	LD	BC,#FF41
0110+  E4CB D7          	RST	#10
0111+  E4CC             NoEnMemory
0112+  E4CC             	DEFB	"Not enough memory to run program.",#0D,#0A,#00
0112+  E4CC 4E6F7420656E6F756768206D656D6F727920746F2072756E2070726F6772616D
0112+  E4EC 2E0D0A00
0113+  E4F0             InitDrv
0114+  E4F0 32 EC A7    	LD	(BuffInd),A
0115+  E4F3 21 ED A7    	LD	HL,WorkPage
0116+  E4F6 0E C5       	LD	C,#C5
0117+  E4F8 CF          	RST	#08
0118+  E4F9 0E 02       InDrv0	LD	C,#02
0119+  E4FB D7          	RST	#10
0120+  E4FC 0E 01       	LD	C,#01
0121+  E4FE D7          	RST	#10
0122+  E4FF F5          	PUSH	AF
0123+  E500 DC A8 86    	CALL	C,DOSError
0124+  E503 F1          	POP	AF
0125+  E504 38 F3       	JR	C,InDrv0
0126+  E506 FE 0C       	CP	12
0127+  E508 38 02       	JR	C,$+4
0128+  E50A 3E 0B       	LD	A,11
0129+  E50C 32 E2 A7    	LD	(EquipDisks),A
0130+  E50F 0E 21       	LD	C,#21
0131+  E511 D7          	RST	#10
0132+  E512 38 16       	JR	C,InDrv1
0133+  E514 7A          	LD	A,D
0134+  E515 FE 20       	CP	32
0135+  E517 3F          	CCF 
0136+  E518 38 10       	JR	C,InDrv1
0137+  E51A 7B          	LD	A,E
0138+  E51B FE 0D       	CP	13
0139+  E51D 3F          	CCF 
0140+  E51E 38 0A       	JR	C,InDrv1
0141+  E520 7C          	LD	A,H
0142+  E521 FE 18       	CP	24
0143+  E523 3F          	CCF 
0144+  E524 38 04       	JR	C,InDrv1
0145+  E526 7D          	LD	A,L
0146+  E527 FE 3C       	CP	60
0147+  E529 3F          	CCF 
0148+  E52A 3E 00       InDrv1	LD	A,#00
0149+  E52C 38 01       	JR	C,$+3
0150+  E52E 3C          	INC	A
0151+  E52F 32 E4 A7    	LD	(CMOSFlag),A
0152+  E532 3E 00       InitFlg	LD	A,#00
0153+  E534 B7          	OR	A
0154+  E535 CC 47 E5    	CALL	Z,FirstInit
0155+  E538 0E 00       	LD	C,#00
0156+  E53A F7          	RST	#30
0157+  E53B 3A E5 A7    	LD	A,(MouseFlag)
0158+  E53E B7          	OR	A
0159+  E53F 0E 01       	LD	C,#01
0160+  E541 20 02       	JR	NZ,$+4
0161+  E543 0E 02       	LD	C,#02
0162+  E545 F7          	RST	#30
0163+  E546 C9          	RET 
0164+  E547             FirstInit
0165+  E547 0E 02       	LD	C,#02
0166+  E549 D7          	RST	#10
0167+  E54A 21 B6 A5    	LD	HL,LeftPanel+BegPath
0168+  E54D E5          	PUSH	HL
0169+  E54E C6 41       	ADD	A,"A"
0170+  E550 77          	LD	(HL),A
0171+  E551 23          	INC	HL
0172+  E552 36 3A       	LD	(HL),":"
0173+  E554 23          	INC	HL
0174+  E555 0E 1E       	LD	C,#1E
0175+  E557 D7          	RST	#10
0176+  E558 E1          	POP	HL
0177+  E559 11 E2 A6    	LD	DE,RightPanel+BegPath
0178+  E55C 01 00 01    	LD	BC,#0100
0179+  E55F ED B0       	LDIR 
0180+  E561 DB A2       	IN	A,(PAGE1)
0181+  E563 F5          	PUSH	AF
0182+  E564 3A E7 A7    	LD	A,(FunctPg)
0183+  E567 D3 A2       	OUT	(PAGE1),A
0184+  E569 21 B6 A5    	LD	HL,LeftPanel+BegPath
0185+  E56C 11 62 74    	LD	DE,FlexDIRECTORY
0186+  E56F 01 00 01    	LD	BC,#0100
0187+  E572 ED B0       	LDIR 
0188+  E574 21 2E 66    	LD	HL,SetupName
0189+  E577 0E 11       	LD	C,#11
0190+  E579 3E 01       	LD	A,#01
0191+  E57B D7          	RST	#10
0192+  E57C 38 66       	JR	C,InDrv3
0193+  E57E F5          	PUSH	AF
0194+  E57F 21 00 80    	LD	HL,WorkBuffer
0195+  E582 11 00 01    	LD	DE,#0100
0196+  E585 0E 13       	LD	C,#13
0197+  E587 D7          	RST	#10
0198+  E588 F1          	POP	AF
0199+  E589 0E 12       	LD	C,#12
0200+  E58B D7          	RST	#10
0201+  E58C 21 00 80    	LD	HL,WorkBuffer
0202+  E58F 11 23 66    	LD	DE,SetupHead
0203+  E592 06 0B       	LD	B,11
0204+  E594 1A          InDrv2	LD	A,(DE)
0205+  E595 BE          	CP	(HL)
0206+  E596 20 4C       	JR	NZ,InDrv3
0207+  E598 23          	INC	HL
0208+  E599 13          	INC	DE
0209+  E59A 10 F8       	DJNZ	InDrv2
0210+  E59C 11 00 85    	LD	DE,PALETTE
0211+  E59F 01 40 00    	LD	BC,#0040
0212+  E5A2 ED B0       	LDIR 
0213+  E5A4 7E          	LD	A,(HL)
0214+  E5A5 23          	INC	HL
0215+  E5A6 B7          	OR	A
0216+  E5A7 28 38       	JR	Z,InDrvPL
0217+  E5A9 7E          	LD	A,(HL)
0218+  E5AA 23          	INC	HL
0219+  E5AB E6 01       	AND	#01
0220+  E5AD 32 E5 A7    	LD	(MouseFlag),A
0221+  E5B0 11 8A A5    	LD	DE,LeftPanel
0222+  E5B3 D5          	PUSH	DE
0223+  E5B4 ED A0       	LDI 
0224+  E5B6 ED A0       	LDI 
0225+  E5B8 ED A0       	LDI 
0226+  E5BA D1          	POP	DE
0227+  E5BB EB          	EX	DE,HL
0228+  E5BC 01 1F 00    	LD	BC,BegMask
0229+  E5BF 09          	ADD	HL,BC
0230+  E5C0 EB          	EX	DE,HL
0231+  E5C1 97          	SUB	A
0232+  E5C2 ED A0       	LDI 
0233+  E5C4 BE          	CP	(HL)
0234+  E5C5 20 FB       	JR	NZ,$-3
0235+  E5C7 12          	LD	(DE),A
0236+  E5C8 23          	INC	HL
0237+  E5C9 11 B6 A6    	LD	DE,RightPanel
0238+  E5CC D5          	PUSH	DE
0239+  E5CD ED A0       	LDI 
0240+  E5CF ED A0       	LDI 
0241+  E5D1 ED A0       	LDI 
0242+  E5D3 D1          	POP	DE
0243+  E5D4 EB          	EX	DE,HL
0244+  E5D5 01 1F 00    	LD	BC,BegMask
0245+  E5D8 09          	ADD	HL,BC
0246+  E5D9 EB          	EX	DE,HL
0247+  E5DA 97          	SUB	A
0248+  E5DB ED A0       	LDI 
0249+  E5DD BE          	CP	(HL)
0250+  E5DE 20 FB       	JR	NZ,$-3
0251+  E5E0 12          	LD	(DE),A
0252+  E5E1 CD 58 E4    InDrvPL	CALL	InitPAL
0253+  E5E4 F1          InDrv3	POP	AF
0254+  E5E5 D3 A2       	OUT	(PAGE1),A
0255+  E5E7 21 41 F1    	LD	HL,BgDISKl
0256+  E5EA 11 F3 F3    	LD	DE,BgDISKr
0257+  E5ED 01 20 00    	LD	BC,#0020
0258+  E5F0 3A E2 A7    	LD	A,(EquipDisks)
0259+  E5F3 09          InDrv4	ADD	HL,BC
0260+  E5F4 EB          	EX	DE,HL
0261+  E5F5 09          	ADD	HL,BC
0262+  E5F6 EB          	EX	DE,HL
0263+  E5F7 3D          	DEC	A
0264+  E5F8 20 F9       	JR	NZ,InDrv4
0265+  E5FA 36 00       	LD	(HL),#00
0266+  E5FC 23          	INC	HL
0267+  E5FD 36 80       	LD	(HL),#80
0268+  E5FF EB          	EX	DE,HL
0269+  E600 36 00       	LD	(HL),#00
0270+  E602 23          	INC	HL
0271+  E603 36 80       	LD	(HL),#80
0272+  E605 11 00 4E    	LD	DE,InitExtention
0273+  E608 3A EA A7    	LD	A,(HelpPg)
0274+  E60B 0E A2       	LD	C,PAGE1
0275+  E60D CD 9A A4    	CALL	Resident
0276+  E610 3E 01       	LD	A,#01
0277+  E612 32 33 E5    	LD	(InitFlg+1),A
0278+  E615 C9          	RET 
0279+  E616             ;[]----------------------------------------------------------[]
0280+  E616             ResDrivers
0281+  E616 0E 02       	LD	C,#02
0282+  E618 F7          	RST	#30
0283+  E619 3A EC A7    	LD	A,(BuffInd)
0284+  E61C 0E 3E       	LD	C,#3E
0285+  E61E D7          	RST	#10
0286+  E61F C9          	RET 
0287+  E620             ;[]==========================================================[]
0288+  E620             InitScreen
0289+  E620 CD F0 86    	CALL	MakeWindow
0290+  E623 00          	DEFB	#00	;Main window
0291+  E624 00 00 00 00 	DEFW	#0000,#0000
0292+  E628 80 02 00 01 	DEFW	#0280,#0100
0293+  E62C 02          	DEFB	#02	;Head place
0294+  E62D 04 00 02 00 	DEFW	#0004,#0002
0295+  E631 78 02 0A 00 	DEFW	#0278,#000A
0296+  E635 00          	DEFB	#00
0297+  E636 01          	DEFB	#01	;Text Line
0298+  E637 10 00 03 00 	DEFW	#0010,#0003
0299+  E63B 0F          	DEFB	#0F
0300+  E63C             	DEFB	"Flex Navigator v1.10",0
0300+  E63C 466C6578204E6176696761746F722076312E313000
0301+  E651 06          	DEFB	#06	;Horizontal line
0302+  E652 00 00 0D 00 	DEFW	#0000,#000D
0303+  E656 80 02       	DEFW	#0280
0304+  E658 01          	DEFB	#01	;Text Line
0305+  E659 10 00 11 00 	DEFW	#0010,#0011
0306+  E65D 80          	DEFB	#80
0307+  E65E             	DEFB	"File    Select    Options    View    Config"
0307+  E65E 46696C652020202053656C656374202020204F7074696F6E7320202020566965
0307+  E67E 7720202020436F6E666967
0308+  E689             	DEFB	"    About",0
0308+  E689 2020202041626F757400
0309+  E693             
0310+  E693 06          	DEFB	#06	;Horizontal line
0311+  E694 00 00 1B 00 	DEFW	#0000,#001B
0312+  E698 80 02       	DEFW	#0280
0313+  E69A 07          	DEFB	#07	;Vertical line
0314+  E69B 3E 01 1E 00 	DEFW	#013E,#001E
0315+  E69F 0C 00       	DEFW	#000C
0316+  E6A1 06          	DEFB	#06	;Horizontal line
0317+  E6A2 00 00 2B 00 	DEFW	#0000,#002B
0318+  E6A6 80 02       	DEFW	#0280
0319+  E6A8             
0320+  E6A8 06          	DEFB	#06	;Horizontal line
0321+  E6A9 00 00 D3 00 	DEFW	#0000,#00D3
0322+  E6AD 80 02       	DEFW	#0280
0323+  E6AF 07          	DEFB	#07	;Vertical line
0324+  E6B0 3E 01 D6 00 	DEFW	#013E,#00D6
0325+  E6B4 0A 00       	DEFW	#000A
0326+  E6B6 06          	DEFB	#06	;Horizontal line
0327+  E6B7 00 00 E1 00 	DEFW	#0000,#00E1
0328+  E6BB 80 02       	DEFW	#0280
0329+  E6BD 03          	DEFB	#03	;Углубление
0330+  E6BE FC 00 E4 00 	DEFW	#00FC,#00E4
0331+  E6C2 80 01 0C 00 	DEFW	#0180,#000C
0332+  E6C6 02          	DEFB	#02	;Head place
0333+  E6C7 FE 00 E5 00 	DEFW	#00FE,#00E5
0334+  E6CB 7C 01 0A 00 	DEFW	#017C,#000A
0335+  E6CF 09          	DEFB	PanelCol
0336+  E6D0 06          	DEFB	#06	;Horizontal line
0337+  E6D1 00 00 F1 00 	DEFW	#0000,#00F1
0338+  E6D5 80 02       	DEFW	#0280
0339+  E6D7 04          	DEFB	#04	;UpRectan
0340+  E6D8 00 00 F2 00 	DEFW	#0000,#00F2
0341+  E6DC 50 00 0E 00 	DEFW	#0050,#000E
0342+  E6E0 01          	DEFB	#01	;Text Line
0343+  E6E1 16 00 F5 00 	DEFW	#0016,#00F5
0344+  E6E5 80          	DEFB	#80
0345+  E6E6             	DEFB	"F1 Help",0
0345+  E6E6 46312048656C7000
0346+  E6EE 04          	DEFB	#04	;UpRectan
0347+  E6EF 50 00 F2 00 	DEFW	#0050,#00F2
0348+  E6F3 50 00 0E 00 	DEFW	#0050,#000E
0349+  E6F7 01          	DEFB	#01	;Text Line
0350+  E6F8 64 00 F5 00 	DEFW	#0064,#00F5
0351+  E6FC 80          	DEFB	#80
0352+  E6FD             	DEFB	"F3 View",0
0352+  E6FD 4633205669657700
0353+  E705 04          	DEFB	#04	;UpRectan
0354+  E706 A0 00 F2 00 	DEFW	#00A0,#00F2
0355+  E70A 50 00 0E 00 	DEFW	#0050,#000E
0356+  E70E 01          	DEFB	#01	;Text Line
0357+  E70F B6 00 F5 00 	DEFW	#00B6,#00F5
0358+  E713 80          	DEFB	#80
0359+  E714             	DEFB	"F4 Edit",0
0359+  E714 4634204564697400
0360+  E71C 04          	DEFB	#04	;UpRectan
0361+  E71D F0 00 F2 00 	DEFW	#00F0,#00F2
0362+  E721 50 00 0E 00 	DEFW	#0050,#000E
0363+  E725 01          	DEFB	#01	;Text Line
0364+  E726 04 01 F5 00 	DEFW	#0104,#00F5
0365+  E72A 80          	DEFB	#80
0366+  E72B             	DEFB	"F5 Copy",0
0366+  E72B 463520436F707900
0367+  E733 04          	DEFB	#04	;UpRectan
0368+  E734 40 01 F2 00 	DEFW	#0140,#00F2
0369+  E738 50 00 0E 00 	DEFW	#0050,#000E
0370+  E73C 01          	DEFB	#01	;Text Line
0371+  E73D 4E 01 F5 00 	DEFW	#014E,#00F5
0372+  E741 80          	DEFB	#80
0373+  E742             	DEFB	"F6 Rename",0
0373+  E742 46362052656E616D6500
0374+  E74C 04          	DEFB	#04	;UpRectan
0375+  E74D 90 01 F2 00 	DEFW	#0190,#00F2
0376+  E751 50 00 0E 00 	DEFW	#0050,#000E
0377+  E755 01          	DEFB	#01	;Text Line
0378+  E756 9E 01 F5 00 	DEFW	#019E,#00F5
0379+  E75A 80          	DEFB	#80
0380+  E75B             	DEFB	"F7 MakeDir",0
0380+  E75B 4637204D616B6544697200
0381+  E766 04          	DEFB	#04	;UpRectan
0382+  E767 E0 01 F2 00 	DEFW	#01E0,#00F2
0383+  E76B 50 00 0E 00 	DEFW	#0050,#000E
0384+  E76F 01          	DEFB	#01	;Text Line
0385+  E770 F0 01 F5 00 	DEFW	#01F0,#00F5
0386+  E774 80          	DEFB	#80
0387+  E775             	DEFB	"F8 Delete",0
0387+  E775 46382044656C65746500
0388+  E77F 04          	DEFB	#04	;UpRectan
0389+  E780 30 02 F2 00 	DEFW	#0230,#00F2
0390+  E784 50 00 0E 00 	DEFW	#0050,#000E
0391+  E788 01          	DEFB	#01	;Text Line
0392+  E789 44 02 F5 00 	DEFW	#0244,#00F5
0393+  E78D 80          	DEFB	#80
0394+  E78E             	DEFB	"F10 Quit",0
0394+  E78E 463130205175697400
0395+  E797 00          	DEFB	#00
0396+  E798 3A E4 A7    	LD	A,(CMOSFlag)
0397+  E79B B7          	OR	A
0398+  E79C C8          	RET	Z
0399+  E79D CD F0 86    	CALL	MakeWindow
0400+  E7A0 80          	DEFB	#80
0401+  E7A1 03          	DEFB	#03
0402+  E7A2 F4 01 0F 00 	DEFW	#01F4,#000F
0403+  E7A6 88 00 0C 00 	DEFW	#0088,#000C
0404+  E7AA 00          	DEFB	#00
0405+  E7AB 21 FC 01    	LD	HL,#01FC
0406+  E7AE 11 12 00    	LD	DE,#0012
0407+  E7B1 06 80       	LD	B,#80
0408+  E7B3 D9          	EXX 
0409+  E7B4 21 2E 02    	LD	HL,#022E
0410+  E7B7 11 12 00    	LD	DE,#0012
0411+  E7BA 06 80       	LD	B,#80
0412+  E7BC D9          	EXX 
0413+  E7BD 3E 02       	LD	A,#02
0414+  E7BF CD B5 9E    	CALL	SetCMOSPrint
0415+  E7C2 C9          	RET 
0416+  E7C3             ;[]==========================================================[]
0417+  E7C3             InitPanels
0418+  E7C3 32 F0 EA    	LD	(InitPanFlg),A
0419+  E7C6 21 8B A5    	LD	HL,LeftPanel+ViewFlg
0420+  E7C9 3A B7 A6    	LD	A,(RightPanel+ViewFlg)
0421+  E7CC B6          	OR	(HL)
0422+  E7CD E6 02       	AND	#02
0423+  E7CF 20 10       	JR	NZ,InitPanTree
0424+  E7D1 FD 21 8A A5 	LD	IY,LeftPanel
0425+  E7D5 CD 0B E8    	CALL	InitPanelE
0426+  E7D8 FD 21 B6 A6 	LD	IY,RightPanel
0427+  E7DC CD 0B E8    	CALL	InitPanelE
0428+  E7DF 18 11       	JR	InitPanExit
0429+  E7E1             InitPanTree
0430+  E7E1 FD 21 8A A5 	LD	IY,LeftPanel
0431+  E7E5 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0432+  E7E9 20 04       	JR	NZ,$+6
0433+  E7EB FD 21 B6 A6 	LD	IY,RightPanel
0434+  E7EF CD 0B E8    	CALL	InitPanelE
0435+  E7F2             InitPanExit
0436+  E7F2 21 8A A5    	LD	HL,LeftPanel
0437+  E7F5 11 2C 00    	LD	DE,BegPath
0438+  E7F8 CB 7E       	BIT	7,(HL)
0439+  E7FA 20 03       	JR	NZ,$+5
0440+  E7FC 21 B6 A6    	LD	HL,RightPanel
0441+  E7FF E5          	PUSH	HL
0442+  E800 19          	ADD	HL,DE
0443+  E801 0E 1D       	LD	C,#1D
0444+  E803 D7          	RST	#10
0445+  E804 FD E1       	POP	IY
0446+  E806 C9          	RET 
0447+  E807             ;
0448+  E807             InitPanel
0449+  E807 97          	SUB	A
0450+  E808             InitPanel1
0451+  E808 32 F0 EA    	LD	(InitPanFlg),A
0452+  E80B             InitPanelE
0453+  E80B 3A F0 EA    	LD	A,(InitPanFlg)
0454+  E80E CB 47       	BIT	0,A
0455+  E810 CC 9C A0    	CALL	Z,SetClock
0456+  E813 CD B8 B1    	CALL	PrintDisks
0457+  E816 CD 38 B2    	CALL	PrintPath
0458+  E819 FD CB 00 7E 	BIT	7,(IY+PanelFlg)
0459+  E81D C4 AE B2    	CALL	NZ,PrintDOSPath
0460+  E820 FD 7E 01    	LD	A,(IY+ViewFlg)
0461+  E823 E6 03       	AND	#03
0462+  E825 C2 35 E9    	JP	NZ,InitPPanel
0463+  E828 FD 6E 03    	LD	L,(IY+PanelXl)
0464+  E82B FD 66 04    	LD	H,(IY+PanelXh)
0465+  E82E 22 87 E8    	LD	(PanelN1),HL
0466+  E831 23          	INC	HL
0467+  E832 23          	INC	HL
0468+  E833 22 90 E8    	LD	(PanelN2),HL
0469+  E836 22 AE E8    	LD	(PanelN6),HL
0470+  E839 22 9A E8    	LD	(PanelN3),HL
0471+  E83C 22 F5 E8    	LD	(Nbut1),HL
0472+  E83F 22 E5 E8    	LD	(Nfile),HL
0473+  E842 11 10 00    	LD	DE,#0010
0474+  E845 19          	ADD	HL,DE
0475+  E846 22 9F E8    	LD	(PanelN4),HL
0476+  E849 22 F7 E8    	LD	(Nbut1+2),HL
0477+  E84C 22 15 E9    	LD	(Nbar1),HL
0478+  E84F FD 75 05    	LD	(IY+PanBarXl),L
0479+  E852 FD 74 06    	LD	(IY+PanBarXh),H
0480+  E855 FD 36 07 C9 	LD	(IY+PanBarYl),#C9
0481+  E859 FD 36 08 00 	LD	(IY+PanBarYh),#00
0482+  E85D 11 14 01    	LD	DE,#0114
0483+  E860 19          	ADD	HL,DE
0484+  E861 22 A9 E8    	LD	(PanelN5),HL
0485+  E864 22 27 E9    	LD	(Nbar2+2),HL
0486+  E867 22 05 E9    	LD	(Nbut2),HL
0487+  E86A FD 73 09    	LD	(IY+PanBrMLl),E
0488+  E86D FD 72 0A    	LD	(IY+PanBrMLh),D
0489+  E870 11 10 00    	LD	DE,#0010
0490+  E873 19          	ADD	HL,DE
0491+  E874 22 07 E9    	LD	(Nbut2+2),HL
0492+  E877 22 E7 E8    	LD	(Nfile+2),HL
0493+  E87A FD 36 11 33 	LD	(IY+PanelFPl),#33
0494+  E87E FD 36 12 00 	LD	(IY+PanelFPh),#00
0495+  E882             ;Краткая панель
0496+  E882 CD F0 86    	CALL	MakeWindow
0497+  E885 80          	DEFB	#80
0498+  E886 03          	DEFB	#03		;Углубл.для файлов
0499+  E887 00 00 3B 00 PanelN1	DEFW	#0000,#003B
0500+  E88B 38 01 97 00 	DEFW	#0138,#0097
0501+  E88F 02          	DEFB	#02		;Фон для файлов
0502+  E890 00 00 3C 00 PanelN2	DEFW	#0000,#003C
0503+  E894 34 01 95 00 	DEFW	#0134,#0095
0504+  E898 09          	DEFB	PanelCol
0505+  E899 08          	DEFB	#08		;Кнопка	SB левая
0506+  E89A 00 00 C9 00 PanelN3	DEFW	#0000,#00C9
0507+  E89E 02          	DEFB	#02
0508+  E89F 00 00 C9 00 PanelN4	DEFW	#0000,#00C9
0509+  E8A3 14 01 08 00 	DEFW	#0114,#0008
0510+  E8A7 08          	DEFB	#08
0511+  E8A8 09          	DEFB	#09		;Кнопка	SB правая
0512+  E8A9 00 00 C9 00 PanelN5	DEFW	#0000,#00C9
0513+  E8AD 02          	DEFB	#02		;Место для FileInfo
0514+  E8AE 00 00 D5 00 PanelN6	DEFW	#0000,#00D5
0515+  E8B2 36 01 0C 00 	DEFW	#0136,#000C
0516+  E8B6 08          	DEFB	#08
0517+  E8B7 00          	DEFB	#00
0518+  E8B8 21 E5 E8    	LD	HL,NormMouse
0519+  E8BB 11 61 F0    	LD	DE,PanelPlaceL
0520+  E8BE FD CB 00 46 	BIT	0,(IY+PanelFlg)
0521+  E8C2 28 03       	JR	Z,$+5
0522+  E8C4 11 13 F3    	LD	DE,PanelPlaceR
0523+  E8C7 D5          	PUSH	DE
0524+  E8C8 01 50 00    	LD	BC,#0050
0525+  E8CB ED B0       	LDIR 
0526+  E8CD E1          	POP	HL
0527+  E8CE 01 32 00    	LD	BC,#0032
0528+  E8D1 09          	ADD	HL,BC
0529+  E8D2 FD 75 0D    	LD	(IY+PanBrLFl),L
0530+  E8D5 FD 74 0E    	LD	(IY+PanBrLFh),H
0531+  E8D8 01 0E 00    	LD	BC,#000E
0532+  E8DB 09          	ADD	HL,BC
0533+  E8DC FD 75 0F    	LD	(IY+PanBrRTl),L
0534+  E8DF FD 74 10    	LD	(IY+PanBrRTh),H
0535+  E8E2 C3 46 EA    	JP	InitPanEx
0536+  E8E5             NormMouse
0537+  E8E5             Nfile	DEFW #0000,#0000,#003F,#00C7,#00,#0000,NewFile,MarkFile
0537+  E8E5 000000003F00C700000000000BC6AEDE
0538+  E8F5             Nbut1	DEFW #0000,#0000,#00C9,#00D1,#03,#0000,ScrollDown,#0000
0538+  E8F5 00000000C900D10003000000BEBE0000
0539+  E905             Nbut2	DEFW #0000,#0000,#00C9,#00D1,#03,#0000,ScrollUp,#0000
0539+  E905 00000000C900D1000300000087C10000
0540+  E915             Nbar1	DEFW #0000,#0000,#00C9,#00D1,#00,#0000,PageUp,#0000
0540+  E915 00000000C900D10000000000BBC40000
0541+  E925             Nbar2	DEFW #0000,#0000,#00C9,#00D1,#00,#0000,PageDown,#0000
0541+  E925 00000000C900D10000000000E8C40000
0542+  E935             ;Подробная панель и панель с деревом
0543+  E935             InitPPanel
0544+  E935 FD 6E 03    	LD	L,(IY+PanelXl)
0545+  E938 FD 66 04    	LD	H,(IY+PanelXh)
0546+  E93B 22 98 E9    	LD	(PanelP1),HL
0547+  E93E 23          	INC	HL
0548+  E93F 23          	INC	HL
0549+  E940 22 A1 E9    	LD	(PanelP2),HL
0550+  E943 22 BF E9    	LD	(PanelP6),HL
0551+  E946 22 F6 E9    	LD	(Pfile),HL
0552+  E949 11 24 01    	LD	DE,#0124
0553+  E94C 19          	ADD	HL,DE
0554+  E94D 22 AB E9    	LD	(PanelP3),HL
0555+  E950 22 B0 E9    	LD	(PanelP4),HL
0556+  E953 22 BA E9    	LD	(PanelP5),HL
0557+  E956 22 06 EA    	LD	(Pbut1),HL
0558+  E959 22 16 EA    	LD	(Pbut2),HL
0559+  E95C 22 26 EA    	LD	(Pbar1),HL
0560+  E95F 22 36 EA    	LD	(Pbar2),HL
0561+  E962 22 F8 E9    	LD	(Pfile+2),HL
0562+  E965 FD 75 05    	LD	(IY+PanBarXl),L
0563+  E968 FD 74 06    	LD	(IY+PanBarXh),H
0564+  E96B 11 10 00    	LD	DE,#0010
0565+  E96E 19          	ADD	HL,DE
0566+  E96F 22 08 EA    	LD	(Pbut1+2),HL
0567+  E972 22 18 EA    	LD	(Pbut2+2),HL
0568+  E975 22 28 EA    	LD	(Pbar1+2),HL
0569+  E978 22 38 EA    	LD	(Pbar2+2),HL
0570+  E97B FD 36 07 44 	LD	(IY+PanBarYl),#44
0571+  E97F FD 36 08 00 	LD	(IY+PanBarYh),#00
0572+  E983 FD 36 09 85 	LD	(IY+PanBrMLl),#85
0573+  E987 FD 36 0A 00 	LD	(IY+PanBrMLh),#00
0574+  E98B FD 36 11 12 	LD	(IY+PanelFPl),#12
0575+  E98F FD 36 12 00 	LD	(IY+PanelFPh),#00
0576+  E993 CD F0 86    	CALL	MakeWindow
0577+  E996 80          	DEFB	#80
0578+  E997 03          	DEFB	#03		;Углубл.для файлов
0579+  E998 00 00 3B 00 PanelP1	DEFW	#0000,#003B
0580+  E99C 38 01 97 00 	DEFW	#0138,#0097
0581+  E9A0 02          	DEFB	#02		;Фон для файлов
0582+  E9A1 00 00 3C 00 PanelP2	DEFW	#0000,#003C
0583+  E9A5 34 01 95 00 	DEFW	#0134,#0095
0584+  E9A9 09          	DEFB	PanelCol
0585+  E9AA 0A          	DEFB	#0A		;Кнопка	SB верхняя
0586+  E9AB 00 00 3C 00 PanelP3	DEFW	#0000,#003C
0587+  E9AF 02          	DEFB	#02
0588+  E9B0 00 00 44 00 PanelP4	DEFW	#0000,#0044
0589+  E9B4 10 00 85 00 	DEFW	#0010,#0085
0590+  E9B8 08          	DEFB	#08
0591+  E9B9 0B          	DEFB	#0B		;Кнопка	SB нижняя
0592+  E9BA 00 00 C9 00 PanelP5	DEFW	#0000,#00C9
0593+  E9BE 02          	DEFB	#02		;Место для FileInfo
0594+  E9BF 00 00 D5 00 PanelP6	DEFW	#0000,#00D5
0595+  E9C3 36 01 0C 00 	DEFW	#0136,#000C
0596+  E9C7 08          	DEFB	#08
0597+  E9C8 00          	DEFB	#00
0598+  E9C9 21 F6 E9    	LD	HL,PodrMouse
0599+  E9CC 11 61 F0    	LD	DE,PanelPlaceL
0600+  E9CF FD CB 00 46 	BIT	0,(IY+PanelFlg)
0601+  E9D3 28 03       	JR	Z,$+5
0602+  E9D5 11 13 F3    	LD	DE,PanelPlaceR
0603+  E9D8 D5          	PUSH	DE
0604+  E9D9 01 50 00    	LD	BC,#0050
0605+  E9DC ED B0       	LDIR 
0606+  E9DE E1          	POP	HL
0607+  E9DF 01 36 00    	LD	BC,#0036
0608+  E9E2 09          	ADD	HL,BC
0609+  E9E3 FD 75 0D    	LD	(IY+PanBrLFl),L
0610+  E9E6 FD 74 0E    	LD	(IY+PanBrLFh),H
0611+  E9E9 01 0E 00    	LD	BC,#000E
0612+  E9EC 09          	ADD	HL,BC
0613+  E9ED FD 75 0F    	LD	(IY+PanBrRTl),L
0614+  E9F0 FD 74 10    	LD	(IY+PanBrRTh),H
0615+  E9F3 C3 46 EA    	JP	InitPanEx
0616+  E9F6             PodrMouse
0617+  E9F6             Pfile	DEFW #0000,#0000,#003F,#00CF,#00,#0000,NewFile,MarkFile
0617+  E9F6 000000003F00CF00000000000BC6AEDE
0618+  EA06             Pbut1	DEFW #0000,#0000,#003C,#0044,#03,#0000,ScrollDown,#0000
0618+  EA06 000000003C00440003000000BEBE0000
0619+  EA16             Pbut2	DEFW #0000,#0000,#00C9,#00D1,#03,#0000,ScrollUp,#0000
0619+  EA16 00000000C900D1000300000087C10000
0620+  EA26             Pbar1	DEFW #0000,#0000,#0044,#0000,#00,#0000,PageUp,#0000
0620+  EA26 000000004400000000000000BBC40000
0621+  EA36             Pbar2	DEFW #0000,#0000,#0000,#00D1,#00,#0000,PageDown,#0000
0621+  EA36 000000000000D10000000000E8C40000
0622+  EA46             InitPanEx
0623+  EA46 3A F0 EA    	LD	A,(InitPanFlg)
0624+  EA49 CB 47       	BIT	0,A
0625+  EA4B 20 3D       	JR	NZ,InPan1
0626+  EA4D FD E5       	PUSH	IY
0627+  EA4F FD E5       	PUSH	IY
0628+  EA51 E1          	POP	HL
0629+  EA52 11 2C 00    	LD	DE,BegPath
0630+  EA55 19          	ADD	HL,DE
0631+  EA56 0E 1D       	LD	C,#1D		;Change	DIR
0632+  EA58 D7          	RST	#10
0633+  EA59 FD E1       	POP	IY
0634+  EA5B 30 22       	JR	NC,InPan0
0635+  EA5D CD A8 86    	CALL	DOSError
0636+  EA60 0E 02       	LD	C,#02
0637+  EA62 FD E5       	PUSH	IY
0638+  EA64 D7          	RST	#10
0639+  EA65 FD E1       	POP	IY
0640+  EA67 FD E5       	PUSH	IY
0641+  EA69 E1          	POP	HL
0642+  EA6A 11 2C 00    	LD	DE,BegPath
0643+  EA6D 19          	ADD	HL,DE
0644+  EA6E C6 41       	ADD	A,"A"
0645+  EA70 77          	LD	(HL),A
0646+  EA71 23          	INC	HL
0647+  EA72 36 3A       	LD	(HL),":"
0648+  EA74 23          	INC	HL
0649+  EA75 0E 1E       	LD	C,#1E
0650+  EA77 FD E5       	PUSH	IY
0651+  EA79 D7          	RST	#10
0652+  EA7A FD E1       	POP	IY
0653+  EA7C C3 07 E8    	JP	InitPanel
0654+  EA7F CD F5 A7    InPan0	CALL	ReadDIR
0655+  EA82 3A F0 EA    	LD	A,(InitPanFlg)
0656+  EA85 CB 4F       	BIT	1,A
0657+  EA87 C4 72 BD    	CALL	NZ,FindPrevFile
0658+  EA8A CD 45 B5    InPan1	CALL	PrintDIR
0659+  EA8D CD EA BA    	CALL	SetInvert
0660+  EA90 CD EE B2    	CALL	PrnFileInfo
0661+  EA93 FD E5       	PUSH	IY
0662+  EA95 DD E1       	POP	IX
0663+  EA97 11 05 00    	LD	DE,BegPBar
0664+  EA9A DD 19       	ADD	IX,DE
0665+  EA9C CD F7 96    	CALL	InitScrBar
0666+  EA9F FD 7E 01    	LD	A,(IY+ViewFlg)
0667+  EAA2 E6 03       	AND	#03
0668+  EAA4 F5          	PUSH	AF
0669+  EAA5 CC 35 97    	CALL	Z,PrnHScrBar
0670+  EAA8 F1          	POP	AF
0671+  EAA9 C4 8E 98    	CALL	NZ,PrnVScrBar
0672+  EAAC CD 3C A1    	CALL	SetMouse
0673+  EAAF 3A F0 EA    	LD	A,(InitPanFlg)
0674+  EAB2 CB 47       	BIT	0,A
0675+  EAB4 C0          	RET	NZ
0676+  EAB5 21 8B A5    	LD	HL,LeftPanel+ViewFlg
0677+  EAB8 3A B7 A6    	LD	A,(RightPanel+ViewFlg)
0678+  EABB B6          	OR	(HL)
0679+  EABC E6 02       	AND	#02
0680+  EABE 0F          	RRCA 
0681+  EABF 32 E3 A7    	LD	(TreeFlag),A
0682+  EAC2 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0683+  EAC6 C8          	RET	Z
0684+  EAC7 FD E5       	PUSH	IY
0685+  EAC9 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0686+  EACD FD 21 B6 A6 	LD	IY,RightPanel
0687+  EAD1 21 B6 A5    	LD	HL,LeftPanel+BegPath
0688+  EAD4 11 E2 A6    	LD	DE,RightPanel+BegPath
0689+  EAD7 28 0A       	JR	Z,InPan2
0690+  EAD9 FD 21 8A A5 	LD	IY,LeftPanel
0691+  EADD 21 E2 A6    	LD	HL,RightPanel+BegPath
0692+  EAE0 11 B6 A5    	LD	DE,LeftPanel+BegPath
0693+  EAE3 97          InPan2	SUB	A
0694+  EAE4 ED A0       	LDI 
0695+  EAE6 BE          	CP	(HL)
0696+  EAE7 20 FB       	JR	NZ,$-3
0697+  EAE9 12          	LD	(DE),A
0698+  EAEA CD 0B E8    	CALL	InitPanelE
0699+  EAED FD E1       	POP	IY
0700+  EAEF C9          	RET 
0701+  EAF0             InitPanFlg
0702+  EAF0 00          	DEFB	#00
0703+  EAF1             
0704+  EAF1             
0705+  EAF1             
0276   EAF1             	include "fndosln.z80"
0001+  EAF1             
0002+  EAF1             ;[]==========================================================[]
0003+  EAF1             DOSline
0004+  EAF1 97          	SUB	A
0005+  EAF2 32 F0 EF    	LD	(HistCurrent),A
0006+  EAF5 0E 37       	LD	C,#37
0007+  EAF7 D7          	RST	#10
0008+  EAF8 CB 60       	BIT	4,B
0009+  EAFA 28 29       	JR	Z,DOSln0
0010+  EAFC 7A          	LD	A,D
0011+  EAFD E6 7F       	AND	#7F
0012+  EAFF FE 02       	CP	#02
0013+  EB01 38 52       	JR	C,DOSlnEx
0014+  EB03 FE 0E       	CP	#0E
0015+  EB05 DA 19 D2    	JP	C,QSearch
0016+  EB08 FE 10       	CP	#10
0017+  EB0A 38 49       	JR	C,DOSlnEx
0018+  EB0C FE 1A       	CP	#1A
0019+  EB0E DA 19 D2    	JP	C,QSearch
0020+  EB11 FE 1D       	CP	#1D
0021+  EB13 38 40       	JR	C,DOSlnEx
0022+  EB15 FE 26       	CP	#26
0023+  EB17 DA 19 D2    	JP	C,QSearch
0024+  EB1A FE 2A       	CP	#2A
0025+  EB1C 38 37       	JR	C,DOSlnEx
0026+  EB1E FE 31       	CP	#31
0027+  EB20 DA 19 D2    	JP	C,QSearch
0028+  EB23 18 30       	JR	DOSlnEx
0029+  EB25 7B          DOSln0	LD	A,E
0030+  EB26 FE 0D       	CP	#0D
0031+  EB28 CA B4 EB    	JP	Z,RunDOSline
0032+  EB2B FE 1B       	CP	#1B
0033+  EB2D CA 7E EB    	JP	Z,ClrDOSln1
0034+  EB30 FE 21       	CP	#21
0035+  EB32 30 25       	JR	NC,DOSloop
0036+  EB34 FE 20       	CP	#20
0037+  EB36 20 0C       	JR	NZ,DOSln1
0038+  EB38 3A 64 EF    	LD	A,(DOSslen)
0039+  EB3B B7          	OR	A
0040+  EB3C 20 1B       	JR	NZ,DOSloop
0041+  EB3E 0E 31       	LD	C,#31
0042+  EB40 D7          	RST	#10
0043+  EB41 C3 AE DE    	JP	MarkFile
0044+  EB44 7A          DOSln1	LD	A,D
0045+  EB45 FE A8       	CP	#A8
0046+  EB47 28 10       	JR	Z,DOSloop
0047+  EB49 FE 9A       	CP	#9A
0048+  EB4B 28 0C       	JR	Z,DOSloop
0049+  EB4D FE 9B       	CP	#9B
0050+  EB4F 28 08       	JR	Z,DOSloop
0051+  EB51 FE 92       	CP	#92
0052+  EB53 28 04       	JR	Z,DOSloop
0053+  EB55 0E 31       DOSlnEx	LD	C,#31
0054+  EB57 D7          	RST	#10
0055+  EB58 C9          	RET 
0056+  EB59 97          DOSloop	SUB	A
0057+  EB5A 32 F0 EF    	LD	(HistCurrent),A
0058+  EB5D DD 21 60 EF 	LD	IX,DOSstr
0059+  EB61 21 17 FC    	LD	HL,DOSTab
0060+  EB64 CD 66 ED    	CALL	DOSInputLine
0061+  EB67 D8          	RET	C
0062+  EB68 28 4A       	JR	Z,RunDOSline
0063+  EB6A 0E 37       	LD	C,#37
0064+  EB6C D7          	RST	#10
0065+  EB6D 7B          	LD	A,E
0066+  EB6E FE 1B       	CP	#1B
0067+  EB70 C0          	RET	NZ
0068+  EB71 3A 64 EF    	LD	A,(DOSslen)
0069+  EB74 B7          	OR	A
0070+  EB75 C8          	RET	Z
0071+  EB76 CD 88 EB    	CALL	ClrDOSline
0072+  EB79 0E 31       	LD	C,#31
0073+  EB7B D7          	RST	#10
0074+  EB7C 18 DB       	JR	DOSloop
0075+  EB7E             ;[]----------------------------------------------------------[]
0076+  EB7E             ClrDOSln1
0077+  EB7E 0E 31       	LD	C,#31
0078+  EB80 D7          	RST	#10
0079+  EB81 3A 64 EF    	LD	A,(DOSslen)
0080+  EB84 B7          	OR	A
0081+  EB85 CA 2C C9    	JP	Z,ShowDOSscreen
0082+  EB88             ClrDOSline
0083+  EB88 97          	SUB	A
0084+  EB89 32 F0 EF    	LD	(HistCurrent),A
0085+  EB8C 3A 64 EF    	LD	A,(DOSslen)
0086+  EB8F B7          	OR	A
0087+  EB90 C8          	RET	Z
0088+  EB91 21 6C EF    	LD	HL,DOSinp
0089+  EB94 97          	SUB	A
0090+  EB95 06 80       	LD	B,#80
0091+  EB97 77          	LD	(HL),A
0092+  EB98 23          	INC	HL
0093+  EB99 10 FC       	DJNZ	$-2
0094+  EB9B 32 64 EF    	LD	(DOSslen),A
0095+  EB9E 32 62 EF    	LD	(DOSposX),A
0096+  EBA1 32 63 EF    	LD	(DOSaddX),A
0097+  EBA4 CD F0 86    	CALL	MakeWindow
0098+  EBA7 80          	DEFB	#80
0099+  EBA8 02          	DEFB	#02	;Head place
0100+  EBA9 FE 00 E5 00 	DEFW	#00FE,#00E5
0101+  EBAD 7C 01 0A 00 	DEFW	#017C,#000A
0102+  EBB1 09          	DEFB	PanelCol
0103+  EBB2 00          	DEFB	#00
0104+  EBB3 C9          	RET 
0105+  EBB4             ;[]----------------------------------------------------------[]
0106+  EBB4             RunDOSline
0107+  EBB4 0E 31       	LD	C,#31
0108+  EBB6 D7          	RST	#10
0109+  EBB7 3A 64 EF    	LD	A,(DOSslen)
0110+  EBBA B7          	OR	A
0111+  EBBB CA BF C6    	JP	Z,OpenFile
0112+  EBBE CD AD EC    	CALL	SaveDOSline
0113+  EBC1 21 6C EF    	LD	HL,DOSinp
0114+  EBC4 7E          	LD	A,(HL)
0115+  EBC5 FE 20       	CP	#20
0116+  EBC7 CA 88 EB    	JP	Z,ClrDOSline
0117+  EBCA 3A 64 EF    	LD	A,(DOSslen)
0118+  EBCD 47          	LD	B,A
0119+  EBCE 0E 00       	LD	C,#00
0120+  EBD0 3E 20       	LD	A,#20
0121+  EBD2 BE          RunDLn0	CP	(HL)
0122+  EBD3 28 04       	JR	Z,RunDLine
0123+  EBD5 23          	INC	HL
0124+  EBD6 0C          	INC	C
0125+  EBD7 10 F9       	DJNZ	RunDLn0
0126+  EBD9             RunDLine
0127+  EBD9 2B          	DEC	HL
0128+  EBDA 3E 5C       	LD	A,"\\"
0129+  EBDC BE          	CP	(HL)
0130+  EBDD C2 3D EC    	JP	NZ,RunDOSexe
0131+  EBE0 21 6C EF    	LD	HL,DOSinp
0132+  EBE3 11 00 80    	LD	DE,WorkBuffer
0133+  EBE6 D5          	PUSH	DE
0134+  EBE7 06 00       	LD	B,#00
0135+  EBE9 ED B0       	LDIR 
0136+  EBEB 97          	SUB	A
0137+  EBEC 12          	LD	(DE),A
0138+  EBED CD 88 EB    	CALL	ClrDOSline
0139+  EBF0 E1          	POP	HL
0140+  EBF1 3A 6D EF    	LD	A,(DOSinp+1)
0141+  EBF4 FE 3A       	CP	":"
0142+  EBF6 20 04       	JR	NZ,$+6
0143+  EBF8 FD 36 2C 00 	LD	(IY+BegPath),#00
0144+  EBFC CD 3F BC    	CALL	NewDIRECTORY
0145+  EBFF 3A E3 A7    	LD	A,(TreeFlag)
0146+  EC02 B7          	OR	A
0147+  EC03 C8          	RET	Z
0148+  EC04 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0149+  EC08 C0          	RET	NZ
0150+  EC09 FD E5       	PUSH	IY
0151+  EC0B FD CB 00 46 	BIT	0,(IY+PanelFlg)
0152+  EC0F FD 21 8A A5 	LD	IY,LeftPanel
0153+  EC13 21 B6 A6    	LD	HL,RightPanel
0154+  EC16 20 07       	JR	NZ,$+9
0155+  EC18 FD 21 B6 A6 	LD	IY,RightPanel
0156+  EC1C 21 8A A5    	LD	HL,LeftPanel
0157+  EC1F 11 2C 00    	LD	DE,BegPath
0158+  EC22 19          	ADD	HL,DE
0159+  EC23 23          	INC	HL
0160+  EC24 23          	INC	HL
0161+  EC25 CD F0 B0    	CALL	FindTreeDIR
0162+  EC28 CD 45 B5    	CALL	PrintDIR
0163+  EC2B CD EE B2    	CALL	PrnFileInfo
0164+  EC2E FD E5       	PUSH	IY
0165+  EC30 DD E1       	POP	IX
0166+  EC32 11 05 00    	LD	DE,BegPBar
0167+  EC35 DD 19       	ADD	IX,DE
0168+  EC37 CD 8E 98    	CALL	PrnVScrBar
0169+  EC3A FD E1       	POP	IY
0170+  EC3C C9          	RET 
0171+  EC3D             RunDOSexe
0172+  EC3D 21 6C EF    	LD	HL,DOSinp
0173+  EC40 2B          	DEC	HL
0174+  EC41 23          RunDE1	INC	HL
0175+  EC42 7E          	LD	A,(HL)
0176+  EC43 FE 21       	CP	#21
0177+  EC45 38 33       	JR	C,RunDOSexe1
0178+  EC47 FE 2E       	CP	"."
0179+  EC49 20 F6       	JR	NZ,RunDE1
0180+  EC4B 23          	INC	HL
0181+  EC4C 7E          	LD	A,(HL)
0182+  EC4D CB AF       	RES	5,A
0183+  EC4F FE 46       	CP	"F"
0184+  EC51 20 27       	JR	NZ,RunDOSexe1
0185+  EC53 23          	INC	HL
0186+  EC54 7E          	LD	A,(HL)
0187+  EC55 CB AF       	RES	5,A
0188+  EC57 FE 4C       	CP	"L"
0189+  EC59 20 1F       	JR	NZ,RunDOSexe1
0190+  EC5B 23          	INC	HL
0191+  EC5C 7E          	LD	A,(HL)
0192+  EC5D CB AF       	RES	5,A
0193+  EC5F FE 58       	CP	"X"
0194+  EC61 20 17       	JR	NZ,RunDOSexe1
0195+  EC63 21 6C EF    	LD	HL,DOSinp
0196+  EC66 11 00 80    	LD	DE,WorkBuffer
0197+  EC69 97          	SUB	A
0198+  EC6A ED A0       	LDI 
0199+  EC6C BE          	CP	(HL)
0200+  EC6D 20 FB       	JR	NZ,$-3
0201+  EC6F 12          	LD	(DE),A
0202+  EC70 CD 88 EB    	CALL	ClrDOSline
0203+  EC73 CD B9 CD    	CALL	RunFLEX
0204+  EC76 DC A8 86    	CALL	C,DOSError
0205+  EC79 C9          	RET 
0206+  EC7A             RunDOSexe1
0207+  EC7A CD 16 E6    	CALL	ResDrivers
0208+  EC7D 97          	SUB	A
0209+  EC7E CD BB 86    	CALL	ClearScreen
0210+  EC81 CD 98 E4    	CALL	ResVModeE
0211+  EC84 21 AE A4    	LD	HL,BEGCOM
0212+  EC87 E3          	EX	(SP),HL
0213+  EC88 21 6C EF    	LD	HL,DOSinp
0214+  EC8B 01 40 00    	LD	BC,#0040
0215+  EC8E D7          	RST	#10
0216+  EC8F D0          	RET	NC
0217+  EC90 F5          	PUSH	AF
0218+  EC91 97          	SUB	A
0219+  EC92 D3 FE       	OUT	(BORDER),A
0220+  EC94 CD 10 E4    	CALL	InitVMode
0221+  EC97 CD A4 E4    	CALL	InitDrivers
0222+  EC9A CD 20 E6    	CALL	InitScreen
0223+  EC9D CD 88 EB    	CALL	ClrDOSline
0224+  ECA0 97          	SUB	A
0225+  ECA1 CD C3 E7    	CALL	InitPanels
0226+  ECA4 F1          	POP	AF
0227+  ECA5 CD A8 86    	CALL	DOSError
0228+  ECA8 21 C8 A4    	LD	HL,ComLoop
0229+  ECAB E3          	EX	(SP),HL
0230+  ECAC C9          	RET 
0231+  ECAD             ;[]----------------------------------------------------------[]
0232+  ECAD             SaveDOSline
0233+  ECAD DB A2       	IN	A,(PAGE1)
0234+  ECAF F5          	PUSH	AF
0235+  ECB0 3A EA A7    	LD	A,(HelpPg)
0236+  ECB3 D3 A2       	OUT	(PAGE1),A
0237+  ECB5 3E C0       	LD	A,#C0
0238+  ECB7 D3 89       	OUT	(YPORT),A
0239+  ECB9 DD 21 60 EF 	LD	IX,DOSstr
0240+  ECBD 2A ED EF    	LD	HL,(HistSpace)
0241+  ECC0 DD 4E 04    	LD	C,(IX+#04)
0242+  ECC3 06 00       	LD	B,#00
0243+  ECC5 B7          SavDOS0	OR	A
0244+  ECC6 ED 42       	SBC	HL,BC
0245+  ECC8 38 02       	JR	C,$+4
0246+  ECCA 20 15       	JR	NZ,SavDOS1
0247+  ECCC 3A EF EF    	LD	A,(HistCount)
0248+  ECCF 3D          	DEC	A
0249+  ECD0 32 EF EF    	LD	(HistCount),A
0250+  ECD3 C5          	PUSH	BC
0251+  ECD4 CD 59 ED    	CALL	FindHistory
0252+  ECD7 C1          	POP	BC
0253+  ECD8 11 00 42    	LD	DE,DOShistory+#200
0254+  ECDB B7          	OR	A
0255+  ECDC EB          	EX	DE,HL
0256+  ECDD ED 52       	SBC	HL,DE
0257+  ECDF 18 E4       	JR	SavDOS0
0258+  ECE1 2B          SavDOS1	DEC	HL
0259+  ECE2 22 ED EF    	LD	(HistSpace),HL
0260+  ECE5 C5          	PUSH	BC
0261+  ECE6 3A EF EF    	LD	A,(HistCount)
0262+  ECE9 CD 59 ED    	CALL	FindHistory
0263+  ECEC 5D          	LD	E,L
0264+  ECED 54          	LD	D,H
0265+  ECEE 09          	ADD	HL,BC
0266+  ECEF 23          	INC	HL
0267+  ECF0 EB          	EX	DE,HL
0268+  ECF1 E5          	PUSH	HL
0269+  ECF2 01 00 40    	LD	BC,DOShistory
0270+  ECF5 B7          	OR	A
0271+  ECF6 ED 42       	SBC	HL,BC
0272+  ECF8 4D          	LD	C,L
0273+  ECF9 44          	LD	B,H
0274+  ECFA E1          	POP	HL
0275+  ECFB 78          	LD	A,B
0276+  ECFC B1          	OR	C
0277+  ECFD 28 04       	JR	Z,$+6
0278+  ECFF 2B          	DEC	HL
0279+  ED00 1B          	DEC	DE
0280+  ED01 ED B8       	LDDR 
0281+  ED03 C1          	POP	BC
0282+  ED04 21 6C EF    	LD	HL,DOSinp
0283+  ED07 11 00 40    	LD	DE,DOShistory
0284+  ED0A 79          	LD	A,C
0285+  ED0B 3C          	INC	A
0286+  ED0C 12          	LD	(DE),A
0287+  ED0D 13          	INC	DE
0288+  ED0E ED B0       	LDIR 
0289+  ED10 97          	SUB	A
0290+  ED11 32 F0 EF    	LD	(HistCurrent),A
0291+  ED14 F1          	POP	AF
0292+  ED15 D3 A2       	OUT	(PAGE1),A
0293+  ED17 21 EF EF    	LD	HL,HistCount
0294+  ED1A 34          	INC	(HL)
0295+  ED1B C9          	RET 
0296+  ED1C             GetDOShistory
0297+  ED1C DD 21 60 EF 	LD	IX,DOSstr
0298+  ED20 21 EF EF    	LD	HL,HistCount
0299+  ED23 3A F0 EF    	LD	A,(HistCurrent)
0300+  ED26 34          	INC	(HL)
0301+  ED27 35          	DEC	(HL)
0302+  ED28 CA 88 EB    	JP	Z,ClrDOSline
0303+  ED2B BE          	CP	(HL)
0304+  ED2C C8          	RET	Z
0305+  ED2D 08          	EX	AF,AF'
0306+  ED2E DB A2       	IN	A,(PAGE1)
0307+  ED30 F5          	PUSH	AF
0308+  ED31 3A EA A7    	LD	A,(HelpPg)
0309+  ED34 D3 A2       	OUT	(PAGE1),A
0310+  ED36 08          	EX	AF,AF'
0311+  ED37 F5          	PUSH	AF
0312+  ED38 CD 59 ED    	CALL	FindHistory
0313+  ED3B 11 6C EF    	LD	DE,DOSinp
0314+  ED3E 7E          	LD	A,(HL)
0315+  ED3F 23          	INC	HL
0316+  ED40 3D          	DEC	A
0317+  ED41 DD 77 04    	LD	(IX+#04),A
0318+  ED44 DD 77 02    	LD	(IX+#02),A
0319+  ED47 4F          	LD	C,A
0320+  ED48 06 00       	LD	B,#00
0321+  ED4A ED B0       	LDIR 
0322+  ED4C 97          	SUB	A
0323+  ED4D DD 77 03    	LD	(IX+#03),A
0324+  ED50 F1          	POP	AF
0325+  ED51 3C          	INC	A
0326+  ED52 32 F0 EF    	LD	(HistCurrent),A
0327+  ED55 F1          	POP	AF
0328+  ED56 D3 A2       	OUT	(PAGE1),A
0329+  ED58 C9          	RET 
0330+  ED59             FindHistory
0331+  ED59 21 00 40    	LD	HL,DOShistory
0332+  ED5C B7          	OR	A
0333+  ED5D C8          	RET	Z
0334+  ED5E 47          	LD	B,A
0335+  ED5F 16 00       	LD	D,#00
0336+  ED61 5E          	LD	E,(HL)
0337+  ED62 19          	ADD	HL,DE
0338+  ED63 10 FC       	DJNZ	$-2
0339+  ED65 C9          	RET 
0340+  ED66             ;[]----------------------------------------------------------[]
0341+  ED66             DOSInputLine
0342+  ED66 DD 22 44 92 	LD	(InpLnData),IX
0343+  ED6A 22 B1 91    	LD	(InpMous+2),HL
0344+  ED6D DD CB 01 BE 	RES	7,(IX+#01)
0345+  ED71 DD CB 01 F6 	SET	6,(IX+#01)
0346+  ED75 0E 37       	LD	C,#37
0347+  ED77 D7          	RST	#10
0348+  ED78 20 04       	JR	NZ,$+6
0349+  ED7A DD CB 01 B6 	RES	6,(IX+#01)
0350+  ED7E CD 97 94    	CALL	InsInpLnCol
0351+  ED81 DD E5       	PUSH	IX
0352+  ED83 E1          	POP	HL
0353+  ED84 11 0C 00    	LD	DE,LenInpData
0354+  ED87 19          	ADD	HL,DE
0355+  ED88 DD 5E 04    	LD	E,(IX+#04)
0356+  ED8B 19          	ADD	HL,DE
0357+  ED8C 72          	LD	(HL),D
0358+  ED8D CD D2 94    	CALL	PrintInpLn+3
0359+  ED90             DOSLineLp
0360+  ED90 76          	HALT 
0361+  ED91 CD D2 96    	CALL	ChCursor
0362+  ED94 DD 2A B1 91 	LD	IX,(InpMous+2)
0363+  ED98 CD 1C 9B    	CALL	TestCoords
0364+  ED9B 0E 37       	LD	C,#37
0365+  ED9D D7          	RST	#10
0366+  ED9E 28 F0       	JR	Z,DOSLineLp
0367+  EDA0 CB BA       	RES	7,D
0368+  EDA2 CB 60       	BIT	4,B
0369+  EDA4 20 EA       	JR	NZ,DOSLineLp
0370+  EDA6 DD 21 56 EE 	LD	IX,DOSTable2
0371+  EDAA CB 68       	BIT	5,B
0372+  EDAC 20 04       	JR	NZ,DOSKeys
0373+  EDAE DD 21 35 EE 	LD	IX,DOSTable1
0374+  EDB2 DD 7E 00    DOSKeys	LD	A,(IX+#00)
0375+  EDB5 DD 23       	INC	IX
0376+  EDB7 FE FF       	CP	#FF
0377+  EDB9 28 36       	JR	Z,DOSLineLp1
0378+  EDBB 6F          	LD	L,A
0379+  EDBC DD 66 00    	LD	H,(IX+#00)
0380+  EDBF DD 23       	INC	IX
0381+  EDC1 DD 4E 00    	LD	C,(IX+#00)
0382+  EDC4 DD 23       	INC	IX
0383+  EDC6 DD 46 00    	LD	B,(IX+#00)
0384+  EDC9 DD 23       	INC	IX
0385+  EDCB B7          	OR	A
0386+  EDCC ED 52       	SBC	HL,DE
0387+  EDCE 20 E2       	JR	NZ,DOSKeys
0388+  EDD0 DD 2A 44 92 	LD	IX,(InpLnData)
0389+  EDD4 DD CB 01 B6 	RES	6,(IX+#01)
0390+  EDD8 7B          	LD	A,E
0391+  EDD9 FE 1B       	CP	#1B
0392+  EDDB 20 07       	JR	NZ,DOSLnNx
0393+  EDDD CD 99 96    	CALL	ResCursor
0394+  EDE0 3E 01       	LD	A,#01
0395+  EDE2 B7          	OR	A
0396+  EDE3 C9          	RET 
0397+  EDE4 21 90 ED    DOSLnNx	LD	HL,DOSLineLp
0398+  EDE7 E5          	PUSH	HL
0399+  EDE8 C5          	PUSH	BC
0400+  EDE9 DD E5       	PUSH	IX
0401+  EDEB 0E 31       	LD	C,#31
0402+  EDED D7          	RST	#10
0403+  EDEE DD E1       	POP	IX
0404+  EDF0 C9          	RET 
0405+  EDF1             DOSLineLp1
0406+  EDF1 DD 2A 44 92 	LD	IX,(InpLnData)
0407+  EDF5 7B          	LD	A,E
0408+  EDF6 FE 20       	CP	#20
0409+  EDF8 30 14       	JR	NC,DOSLineLp2
0410+  EDFA DD CB 01 76 	BIT	6,(IX+#01)
0411+  EDFE 28 07       	JR	Z,DOSLnE0
0412+  EE00 DD E5       	PUSH	IX
0413+  EE02 0E 31       	LD	C,#31
0414+  EE04 D7          	RST	#10
0415+  EE05 DD E1       	POP	IX
0416+  EE07 CD 99 96    DOSLnE0	CALL	ResCursor
0417+  EE0A 3E 01       	LD	A,#01
0418+  EE0C B7          	OR	A
0419+  EE0D C9          	RET 
0420+  EE0E             DOSLineLp2
0421+  EE0E DD CB 01 B6 	RES	6,(IX+#01)
0422+  EE12 21 90 ED    	LD	HL,DOSLineLp
0423+  EE15 E5          	PUSH	HL
0424+  EE16 DD E5       	PUSH	IX
0425+  EE18 0E 31       	LD	C,#31
0426+  EE1A D7          	RST	#10
0427+  EE1B DD E1       	POP	IX
0428+  EE1D 7B          	LD	A,E
0429+  EE1E C3 78 92    	JP	InsertSymbol
0430+  EE21             DOSLnExtN
0431+  EE21 E1          	POP	HL
0432+  EE22 DD 2A 44 92 	LD	IX,(InpLnData)
0433+  EE26 CD 99 96    	CALL	ResCursor
0434+  EE29 AF          	XOR	A
0435+  EE2A C9          	RET 
0436+  EE2B             DOSLnExtC
0437+  EE2B E1          	POP	HL
0438+  EE2C DD 2A 44 92 	LD	IX,(InpLnData)
0439+  EE30 CD 99 96    	CALL	ResCursor
0440+  EE33 37          	SCF 
0441+  EE34 C9          	RET 
0442+  EE35             DOSTable1
0443+  EE35 1B 01 18 92 	DEFW	#011B,InpLnExtC
0444+  EE39 0D 28 0E 92 	DEFW	#280D,InpLnExtN
0445+  EE3D 00 54 DC 92 	DEFW	#5400,ILleft
0446+  EE41 00 56 EC 92 	DEFW	#5600,ILright
0447+  EE45 08 0E FE 92 	DEFW	#0E08,ILdelet
0448+  EE49 00 4F 31 93 	DEFW	#4F00,IL_del_
0449+  EE4D 00 57 5C 93 	DEFW	#5700,ILhome
0450+  EE51 00 51 6D 93 	DEFW	#5100,ILend
0451+  EE55 FF          	DEFB	#FF
0452+  EE56             DOSTable2
0453+  EE56 00 54 CA 93 	DEFW	#5400,ILwordL
0454+  EE5A 00 56 7F 93 	DEFW	#5600,ILwordR
0455+  EE5E 00 0E 12 94 	DEFW	#0E00,ILdelWR
0456+  EE62 00 28 73 EE 	DEFW	#2800,InsFileName
0457+  EE66 00 1A E6 EE 	DEFW	#1A00,InsLeftPath
0458+  EE6A 00 1B EB EE 	DEFW	#1B00,InsRightPath
0459+  EE6E 00 12 59 EF 	DEFW	#1200,InsHistory
0460+  EE72 FF          	DEFB	#FF
0461+  EE73             InsFileName
0462+  EE73 DB A2       	IN	A,(PAGE1)
0463+  EE75 F5          	PUSH	AF
0464+  EE76 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0465+  EE7A 3A EE A7    	LD	A,(DIRpage1)
0466+  EE7D 28 03       	JR	Z,$+5
0467+  EE7F 3A EF A7    	LD	A,(DIRpage2)
0468+  EE82 D3 A2       	OUT	(PAGE1),A
0469+  EE84 FD 6E 15    	LD	L,(IY+PanelFFl)
0470+  EE87 FD 66 16    	LD	H,(IY+PanelFFh)
0471+  EE8A FD 5E 17    	LD	E,(IY+PanelCFl)
0472+  EE8D FD 56 18    	LD	D,(IY+PanelCFh)
0473+  EE90 19          	ADD	HL,DE
0474+  EE91 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0475+  EE95 28 12       	JR	Z,InsFN1
0476+  EE97 29          	ADD	HL,HL
0477+  EE98 29          	ADD	HL,HL
0478+  EE99 29          	ADD	HL,HL
0479+  EE9A 29          	ADD	HL,HL
0480+  EE9B CB F4       	SET	6,H
0481+  EE9D 23          	INC	HL
0482+  EE9E 23          	INC	HL
0483+  EE9F 11 D8 EE    	LD	DE,TempName
0484+  EEA2 01 0D 00    	LD	BC,#000D
0485+  EEA5 ED B0       	LDIR 
0486+  EEA7 18 10       	JR	InsFN2
0487+  EEA9 29          InsFN1	ADD	HL,HL
0488+  EEAA 29          	ADD	HL,HL
0489+  EEAB 29          	ADD	HL,HL
0490+  EEAC 5D          	LD	E,L
0491+  EEAD 54          	LD	D,H
0492+  EEAE 29          	ADD	HL,HL
0493+  EEAF 19          	ADD	HL,DE
0494+  EEB0 CB F4       	SET	6,H
0495+  EEB2 23          	INC	HL
0496+  EEB3 11 D8 EE    	LD	DE,TempName
0497+  EEB6 CD 6A BE    	CALL	MakeDOSname
0498+  EEB9 F1          InsFN2	POP	AF
0499+  EEBA D3 A2       	OUT	(PAGE1),A
0500+  EEBC 21 D8 EE    	LD	HL,TempName
0501+  EEBF 7E          	LD	A,(HL)
0502+  EEC0 FE 2E       	CP	"."
0503+  EEC2 C8          	RET	Z
0504+  EEC3 FE 5C       	CP	"\\"
0505+  EEC5 C8          	RET	Z
0506+  EEC6 E5          	PUSH	HL
0507+  EEC7 97          	SUB	A
0508+  EEC8 4F          	LD	C,A
0509+  EEC9 0C          	INC	C
0510+  EECA 23          	INC	HL
0511+  EECB BE          	CP	(HL)
0512+  EECC 20 FB       	JR	NZ,$-3
0513+  EECE 36 20       	LD	(HL),#20
0514+  EED0 23          	INC	HL
0515+  EED1 77          	LD	(HL),A
0516+  EED2 0C          	INC	C
0517+  EED3 E1          	POP	HL
0518+  EED4 CD 0A EF    	CALL	InsertWord
0519+  EED7 C9          	RET 
0520+  EED8             TempName
0521+  EED8 00          	DEFS	14,0
0522+  EEE6             InsLeftPath
0523+  EEE6 21 B6 A5    	LD	HL,LeftPanel+BegPath
0524+  EEE9 18 03       	JR	InsPath
0525+  EEEB             InsRightPath
0526+  EEEB 21 E2 A6    	LD	HL,RightPanel+BegPath
0527+  EEEE 11 00 81    InsPath	LD	DE,WorkBuffer+#100
0528+  EEF1 D5          	PUSH	DE
0529+  EEF2 97          	SUB	A
0530+  EEF3 4F          	LD	C,A
0531+  EEF4 ED A0       	LDI 
0532+  EEF6 BE          	CP	(HL)
0533+  EEF7 20 FB       	JR	NZ,$-3
0534+  EEF9 2B          	DEC	HL
0535+  EEFA 3E 5C       	LD	A,"\\"
0536+  EEFC BE          	CP	(HL)
0537+  EEFD 28 03       	JR	Z,$+5
0538+  EEFF 12          	LD	(DE),A
0539+  EF00 13          	INC	DE
0540+  EF01 0D          	DEC	C
0541+  EF02 97          	SUB	A
0542+  EF03 91          	SUB	C
0543+  EF04 4F          	LD	C,A
0544+  EF05 E1          	POP	HL
0545+  EF06 CD 0A EF    	CALL	InsertWord
0546+  EF09 C9          	RET 
0547+  EF0A             InsertWord
0548+  EF0A DD 7E 04    	LD	A,(IX+#04)	;InpytSymb
0549+  EF0D 81          	ADD	A,C
0550+  EF0E D8          	RET	C
0551+  EF0F DD 96 00    	SUB	(IX+#00)	;Max len
0552+  EF12 D0          	RET	NC
0553+  EF13 E5          	PUSH	HL
0554+  EF14 DD 7E 04    	LD	A,(IX+#04)
0555+  EF17 DD 96 02    	SUB	(IX+#02)
0556+  EF1A 28 18       	JR	Z,NotInsWord
0557+  EF1C             ;Ввод в	середину текста
0558+  EF1C DD E5       	PUSH	IX
0559+  EF1E E1          	POP	HL
0560+  EF1F 11 0C 00    	LD	DE,LenInpData
0561+  EF22 19          	ADD	HL,DE
0562+  EF23 DD 5E 04    	LD	E,(IX+#04)
0563+  EF26 19          	ADD	HL,DE
0564+  EF27 5D          	LD	E,L
0565+  EF28 54          	LD	D,H
0566+  EF29 06 00       	LD	B,#00
0567+  EF2B 09          	ADD	HL,BC
0568+  EF2C EB          	EX	DE,HL
0569+  EF2D 2B          	DEC	HL
0570+  EF2E 1B          	DEC	DE
0571+  EF2F C5          	PUSH	BC
0572+  EF30 4F          	LD	C,A
0573+  EF31 ED B8       	LDDR 
0574+  EF33 C1          	POP	BC
0575+  EF34             NotInsWord
0576+  EF34 DD E5       	PUSH	IX
0577+  EF36 E1          	POP	HL
0578+  EF37 11 0C 00    	LD	DE,LenInpData
0579+  EF3A 19          	ADD	HL,DE
0580+  EF3B DD 5E 02    	LD	E,(IX+#02)
0581+  EF3E 19          	ADD	HL,DE
0582+  EF3F EB          	EX	DE,HL
0583+  EF40 E1          	POP	HL
0584+  EF41 C5          	PUSH	BC
0585+  EF42 06 00       	LD	B,#00
0586+  EF44 ED B0       	LDIR 
0587+  EF46 C1          	POP	BC
0588+  EF47 DD 7E 04    	LD	A,(IX+#04)
0589+  EF4A 81          	ADD	A,C
0590+  EF4B DD 77 04    	LD	(IX+#04),A
0591+  EF4E DD 7E 02    	LD	A,(IX+#02)
0592+  EF51 81          	ADD	A,C
0593+  EF52 DD 77 02    	LD	(IX+#02),A
0594+  EF55 CD CF 94    	CALL	PrintInpLn
0595+  EF58 C9          	RET 
0596+  EF59             InsHistory
0597+  EF59 CD 1C ED    	CALL	GetDOShistory
0598+  EF5C CD CF 94    	CALL	PrintInpLn
0599+  EF5F C9          	RET 
0600+  EF60             ;[]----------------------------------------------------------[]
0601+  EF60             DOSstr
0602+  EF60 80 00       	DEFB	#80,#00
0603+  EF62 00          DOSposX	DEFB	#00
0604+  EF63 00          DOSaddX	DEFB	#00
0605+  EF64 00          DOSslen	DEFB	#00
0606+  EF65 00 01 E7 00 	DEFW	#0100,#00E7
0607+  EF69 78 01       	DEFW	#0178
0608+  EF6B 9A          	DEFB	PanelCol*#10+FileCol
0609+  EF6C 00          DOSinp	DEFS	#081,0
0610+  EFED             
0611+  EFED             HistSpace
0612+  EFED 00 02       	DEFW	#200
0613+  EFEF             HistCount
0614+  EFEF 00          	DEFB	#00
0615+  EFF0             HistCurrent
0616+  EFF0 00          	DEFB	#00
0617+  EFF1             ;[]----------------------------------------------------------[]
0618+  EFF1             
0619+  EFF1             
0620+  EFF1             
0277   EFF1             	include "fntab.z80"
0001+  EFF1             
0002+  EFF1             ;[]==========================================================[]
0003+  EFF1             ;Формат	таблицы
0004+  EFF1             ;	+00  2	Xmin
0005+  EFF1             ;	+02  2	Xmax
0006+  EFF1             ;	+04  2	Ymin
0007+  EFF1             ;	+06  2	Ymax
0008+  EFF1             ;	+08  2	0 - простой об'ект
0009+  EFF1             ;		бит 0 -	кнопка
0010+  EFF1             ;		бит 1 -	рабочая	кнопка
0011+  EFF1             ;		бит 2 -	инверт 1
0012+  EFF1             ;		бит 3 -	статичный инверт
0013+  EFF1             ;		бит 4 -	программа запускается без адреса возвр.
0014+  EFF1             ;			и без огня
0015+  EFF1             ;		бит 5 -	программа запускается без адреса возвр.
0016+  EFF1             ;			по левой кнопке	огня
0017+  EFF1             ;		бит 6 -	программа запускается без адреса возвр.
0018+  EFF1             ;			по правой кнопке огня
0019+  EFF1             ;		бит 7 -	вызвать	функцию	закрытия окна перед
0020+  EFF1             ;			запуском программы без огня
0021+  EFF1             ;		бит 8 -	вызвать	функцию	закрытия окна перед
0022+  EFF1             ;			запуском программы по левой кнопке
0023+  EFF1             ;		бит 9 -	вызвать	функцию	закрытия окна перед
0024+  EFF1             ;			запуском программы по правой кнопке
0025+  EFF1             ;		бит15 -	это переключатель (инверт при огне не
0026+  EFF1             ;			убирать)
0027+  EFF1             ;	+0A  2	Адрес обработчика при не нажатом огне
0028+  EFF1             ;	+0C  2	Адрес обработчика при нажатом огне (лев)
0029+  EFF1             ;	+0E  2	Адрес обработчика при нажатом огне (прав)
0030+  EFF1             MainCoordsL
0031+  EFF1             	DEFW #0006,#0028,#000F,#001A,#00,#0000,MenuFile,#0000
0031+  EFF1 060028000F001A00000000001BD30000
0032+  F001             	DEFW #0028,#0054,#000F,#001A,#00,#0000,MenuSelect,#0000
0032+  F001 280054000F001A0000000000A1D30000
0033+  F011             	DEFW #0054,#008A,#000F,#001A,#00,#0000,MenuOption,#0000
0033+  F011 54008A000F001A000000000062D40000
0034+  F021             	DEFW #008A,#00AE,#000F,#001A,#00,#0000,MenuView,#0000
0034+  F021 8A00AE000F001A0000000000F6D40000
0035+  F031             	DEFW #00AE,#00DE,#000F,#001A,#00,#0000,MenuConfig,#0000
0035+  F031 AE00DE000F001A000000000053D70000
0036+  F041             	DEFW #00DE,#0106,#000F,#001A,#00,#0000,MenuAbout,#0000
0036+  F041 DE0006010F001A000000000092D70000
0037+  F051             	DEFW #0144,#027C,#002C,#00E1,#00,#0000,ChPanel,#0000
0037+  F051 44017C022C00E10000000000D7C70000
0038+  F061             PanelPlaceL
0039+  F061             	DEFW #0000,#0000,#0000,#0000,#00,#0000,#0000,#0000
0039+  F061 00000000000000000000000000000000
0040+  F071             	DEFW #0000,#0000,#0000,#0000,#00,#0000,#0000,#0000
0040+  F071 00000000000000000000000000000000
0041+  F081             	DEFW #0000,#0000,#0000,#0000,#00,#0000,#0000,#0000
0041+  F081 00000000000000000000000000000000
0042+  F091             	DEFW #0000,#0000,#0000,#0000,#00,#0000,#0000,#0000
0042+  F091 00000000000000000000000000000000
0043+  F0A1             	DEFW #0000,#0000,#0000,#0000,#00,#0000,#0000,#0000
0043+  F0A1 00000000000000000000000000000000
0044+  F0B1             
0045+  F0B1             	DEFW #00FE,#027A,#00E5,#00EF,#00,#0000,DOSloop,#0000
0045+  F0B1 FE007A02E500EF000000000059EB0000
0046+  F0C1             
0047+  F0C1             	DEFW #0000,#0050,#00F2,#0100,#01,#0000,Help,#0000
0047+  F0C1 00005000F200000101000000A3CE0000
0048+  F0D1             	DEFW #0050,#00A0,#00F2,#0100,#01,#0000,ViewFile,#0000
0048+  F0D1 5000A000F2000001010000007CCF0000
0049+  F0E1             	DEFW #00A0,#00F0,#00F2,#0100,#01,#0000,EditFile,#0000
0049+  F0E1 A000F000F200000101000000DED00000
0050+  F0F1             	DEFW #00F0,#0140,#00F2,#0100,#01,#0000,CopyFiles,#0000
0050+  F0F1 F0004001F2000001010000007AD10000
0051+  F101             	DEFW #0140,#0190,#00F2,#0100,#01,#0000,ReName,#0000
0051+  F101 40019001F20000010100000086D10000
0052+  F111             	DEFW #0190,#01E0,#00F2,#0100,#01,#0000,MakeDIR,#0000
0052+  F111 9001E001F20000010100000092D10000
0053+  F121             	DEFW #01E0,#0230,#00F2,#0100,#01,#0000,DeleteFiles,#0000
0053+  F121 E0013002F2000001010000009ED10000
0054+  F131             	DEFW #0230,#0280,#00F2,#0100,#01,#0000,Quit,#0000
0054+  F131 30028002F200000101000000AAD10000
0055+  F141             BgDISKl
0056+  F141                    DEFW #0006,#0022,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0056+  F141 060022001E002A000100000087C80000
0057+  F151                    DEFW #0146,#0162,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0057+  F151 460162011E002A00010000008DC80000
0058+  F161                    DEFW #0022,#003E,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0058+  F161 22003E001E002A000100000087C80000
0059+  F171                    DEFW #0162,#017E,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0059+  F171 62017E011E002A00010000008DC80000
0060+  F181                    DEFW #003E,#005A,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0060+  F181 3E005A001E002A000100000087C80000
0061+  F191                    DEFW #017E,#019A,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0061+  F191 7E019A011E002A00010000008DC80000
0062+  F1A1                    DEFW #005A,#0076,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0062+  F1A1 5A0076001E002A000100000087C80000
0063+  F1B1                    DEFW #019A,#01B6,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0063+  F1B1 9A01B6011E002A00010000008DC80000
0064+  F1C1                    DEFW #0076,#0092,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0064+  F1C1 760092001E002A000100000087C80000
0065+  F1D1                    DEFW #01B6,#01D2,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0065+  F1D1 B601D2011E002A00010000008DC80000
0066+  F1E1                    DEFW #0092,#00AE,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0066+  F1E1 9200AE001E002A000100000087C80000
0067+  F1F1                    DEFW #01D2,#01EE,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0067+  F1F1 D201EE011E002A00010000008DC80000
0068+  F201                    DEFW #00AE,#00CA,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0068+  F201 AE00CA001E002A000100000087C80000
0069+  F211                    DEFW #01EE,#020A,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0069+  F211 EE010A021E002A00010000008DC80000
0070+  F221                    DEFW #00CA,#00E6,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0070+  F221 CA00E6001E002A000100000087C80000
0071+  F231                    DEFW #020A,#0226,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0071+  F231 0A0226021E002A00010000008DC80000
0072+  F241                    DEFW #00E6,#0102,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0072+  F241 E60002011E002A000100000087C80000
0073+  F251                    DEFW #0226,#0242,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0073+  F251 260242021E002A00010000008DC80000
0074+  F261                    DEFW #0102,#011E,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0074+  F261 02011E011E002A000100000087C80000
0075+  F271                    DEFW #0242,#025E,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0075+  F271 42025E021E002A00010000008DC80000
0076+  F281                    DEFW #011E,#013A,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0076+  F281 1E013A011E002A000100000087C80000
0077+  F291                    DEFW #025E,#027A,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0077+  F291 5E027A021E002A00010000008DC80000
0078+  F2A1 00 80              DEFW #8000
0079+  F2A3             ;[]==========================================================[]
0080+  F2A3             MainCoordsR
0081+  F2A3             	DEFW #0006,#0028,#000F,#001A,#00,#0000,MenuFile,#0000
0081+  F2A3 060028000F001A00000000001BD30000
0082+  F2B3             	DEFW #0028,#0054,#000F,#001A,#00,#0000,MenuSelect,#0000
0082+  F2B3 280054000F001A0000000000A1D30000
0083+  F2C3             	DEFW #0054,#008A,#000F,#001A,#00,#0000,MenuOption,#0000
0083+  F2C3 54008A000F001A000000000062D40000
0084+  F2D3             	DEFW #008A,#00AE,#000F,#001A,#00,#0000,MenuView,#0000
0084+  F2D3 8A00AE000F001A0000000000F6D40000
0085+  F2E3             	DEFW #00AE,#00DE,#000F,#001A,#00,#0000,MenuConfig,#0000
0085+  F2E3 AE00DE000F001A000000000053D70000
0086+  F2F3             	DEFW #00DE,#0106,#000F,#001A,#00,#0000,MenuAbout,#0000
0086+  F2F3 DE0006010F001A000000000092D70000
0087+  F303             	DEFW #0004,#013C,#002C,#00E1,#00,#0000,ChPanel,#0000
0087+  F303 04003C012C00E10000000000D7C70000
0088+  F313             PanelPlaceR
0089+  F313             	DEFW #0000,#0000,#0000,#0000,#00,#0000,#0000,#0000
0089+  F313 00000000000000000000000000000000
0090+  F323             	DEFW #0000,#0000,#0000,#0000,#00,#0000,#0000,#0000
0090+  F323 00000000000000000000000000000000
0091+  F333             	DEFW #0000,#0000,#0000,#0000,#00,#0000,#0000,#0000
0091+  F333 00000000000000000000000000000000
0092+  F343             	DEFW #0000,#0000,#0000,#0000,#00,#0000,#0000,#0000
0092+  F343 00000000000000000000000000000000
0093+  F353             	DEFW #0000,#0000,#0000,#0000,#00,#0000,#0000,#0000
0093+  F353 00000000000000000000000000000000
0094+  F363             
0095+  F363             	DEFW #00FE,#027A,#00E5,#00EF,#00,#0000,DOSloop,#0000
0095+  F363 FE007A02E500EF000000000059EB0000
0096+  F373             
0097+  F373             	DEFW #0000,#0050,#00F2,#0100,#01,#0000,Help,#0000
0097+  F373 00005000F200000101000000A3CE0000
0098+  F383             	DEFW #0050,#00A0,#00F2,#0100,#01,#0000,ViewFile,#0000
0098+  F383 5000A000F2000001010000007CCF0000
0099+  F393             	DEFW #00A0,#00F0,#00F2,#0100,#01,#0000,EditFile,#0000
0099+  F393 A000F000F200000101000000DED00000
0100+  F3A3             	DEFW #00F0,#0140,#00F2,#0100,#01,#0000,CopyFiles,#0000
0100+  F3A3 F0004001F2000001010000007AD10000
0101+  F3B3             	DEFW #0140,#0190,#00F2,#0100,#01,#0000,ReName,#0000
0101+  F3B3 40019001F20000010100000086D10000
0102+  F3C3             	DEFW #0190,#01E0,#00F2,#0100,#01,#0000,MakeDIR,#0000
0102+  F3C3 9001E001F20000010100000092D10000
0103+  F3D3             	DEFW #01E0,#0230,#00F2,#0100,#01,#0000,DeleteFiles,#0000
0103+  F3D3 E0013002F2000001010000009ED10000
0104+  F3E3             	DEFW #0230,#0280,#00F2,#0100,#01,#0000,Quit,#0000
0104+  F3E3 30028002F200000101000000AAD10000
0105+  F3F3             BgDISKr
0106+  F3F3                    DEFW #0006,#0022,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0106+  F3F3 060022001E002A000100000087C80000
0107+  F403                    DEFW #0146,#0162,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0107+  F403 460162011E002A00010000008DC80000
0108+  F413                    DEFW #0022,#003E,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0108+  F413 22003E001E002A000100000087C80000
0109+  F423                    DEFW #0162,#017E,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0109+  F423 62017E011E002A00010000008DC80000
0110+  F433                    DEFW #003E,#005A,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0110+  F433 3E005A001E002A000100000087C80000
0111+  F443                    DEFW #017E,#019A,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0111+  F443 7E019A011E002A00010000008DC80000
0112+  F453                    DEFW #005A,#0076,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0112+  F453 5A0076001E002A000100000087C80000
0113+  F463                    DEFW #019A,#01B6,#001E,#002A,#01,#0000,ChangeDriveR,#0800
0113+  F463 9A01B6011E002A00010000008DC80008
0114+  F473                    DEFW #0076,#0092,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0114+  F473 760092001E002A000100000087C80000
0115+  F483                    DEFW #01B6,#01D2,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0115+  F483 B601D2011E002A00010000008DC80000
0116+  F493                    DEFW #0092,#00AE,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0116+  F493 9200AE001E002A000100000087C80000
0117+  F4A3                    DEFW #01D2,#01EE,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0117+  F4A3 D201EE011E002A00010000008DC80000
0118+  F4B3                    DEFW #00AE,#00CA,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0118+  F4B3 AE00CA001E002A000100000087C80000
0119+  F4C3                    DEFW #01EE,#020A,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0119+  F4C3 EE010A021E002A00010000008DC80000
0120+  F4D3                    DEFW #00CA,#00E6,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0120+  F4D3 CA00E6001E002A000100000087C80000
0121+  F4E3                    DEFW #020A,#0226,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0121+  F4E3 0A0226021E002A00010000008DC80000
0122+  F4F3                    DEFW #00E6,#0102,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0122+  F4F3 E60002011E002A000100000087C80000
0123+  F503                    DEFW #0226,#0242,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0123+  F503 260242021E002A00010000008DC80000
0124+  F513                    DEFW #0102,#011E,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0124+  F513 02011E011E002A000100000087C80000
0125+  F523                    DEFW #0242,#025E,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0125+  F523 42025E021E002A00010000008DC80000
0126+  F533                    DEFW #011E,#013A,#001E,#002A,#01,#0000,ChangeDriveL,#0000
0126+  F533 1E013A011E002A000100000087C80000
0127+  F543                    DEFW #025E,#027A,#001E,#002A,#01,#0000,ChangeDriveR,#0000
0127+  F543 5E027A021E002A00010000008DC80000
0128+  F553 00 80              DEFW #8000
0129+  F555             ;[]==========================================================[]
0130+  F555             FileTab
0131+  F555              DEFW #0008,#00A0,#001D,#002B,#0124,#0000,FileInfo+3,#0000
0131+  F555 0800A0001D002B0024010000CFD10000
0132+  F565              DEFW #0008,#00A0,#002B,#0039,#0124,#0000,PrintFile+3,#0000
0132+  F565 0800A0002B00390024010000E2D10000
0133+  F575              DEFW #0008,#00A0,#003F,#004D,#0124,#0000,Quit+3,#0000
0133+  F575 0800A0003F004D0024010000ADD10000
0134+  F585             
0135+  F585              DEFW #0006,#0028,#000F,#001A,#0128,#0000,MenuExit,#0000
0135+  F585 060028000F001A002801000064D80000
0136+  F595              DEFW #0028,#0054,#000F,#001A,#0090,MenuSelect+3,#0000,#0000
0136+  F595 280054000F001A009000A4D300000000
0137+  F5A5              DEFW #0054,#008A,#000F,#001A,#0090,MenuOption+3,#0000,#0000
0137+  F5A5 54008A000F001A00900065D400000000
0138+  F5B5              DEFW #008A,#00AE,#000F,#001A,#0090,MenuView+3,#0000,#0000
0138+  F5B5 8A00AE000F001A009000F9D400000000
0139+  F5C5              DEFW #00AE,#00DE,#000F,#001A,#0090,MenuConfig+3,#0000,#0000
0139+  F5C5 AE00DE000F001A00900056D700000000
0140+  F5D5              DEFW #00DE,#0106,#000F,#001A,#0090,MenuAbout+3,#0000,#0000
0140+  F5D5 DE0006010F001A00900095D700000000
0141+  F5E5             
0142+  F5E5                 DEFW #0000,#0280,#0000,#001A,#0120,#0000,MenuExit,#0000
0142+  F5E5 0000800200001A002001000064D80000
0143+  F5F5                 DEFW #0000,#0280,#0050,#0100,#0120,#0000,MenuExit,#0000
0143+  F5F5 00008002500000012001000064D80000
0144+  F605                 DEFW #0000,#0004,#0000,#0100,#0120,#0000,MenuExit,#0000
0144+  F605 00000400000000012001000064D80000
0145+  F615                 DEFW #00A4,#0280,#0000,#0100,#0120,#0000,MenuExit,#0000
0145+  F615 A4008002000000012001000064D80000
0146+  F625 00 80           DEFW #8000
0147+  F627             
0148+  F627             
0149+  F627             SelectTab
0150+  F627                 DEFW #002C,#00C4,#001D,#002B,#0124,#0000,MarkGroup+3,#0000
0150+  F627 2C00C4001D002B002401000053E00000
0151+  F637                 DEFW #002C,#00C4,#002B,#0039,#0124,#0000,UnMarkGroup+3,#0000
0151+  F637 2C00C4002B0039002401000049E00000
0152+  F647                 DEFW #002C,#00C4,#0039,#0047,#0124,#0000,SelectAll+3,#0000
0152+  F647 2C00C40039004700240100007FE20000
0153+  F657                 DEFW #002C,#00C4,#0047,#0055,#0124,#0000,UnSelectAll+3,#0000
0153+  F657 2C00C400470055002401000009E30000
0154+  F667                DEFW	#002C,#00C4,#0055,#0063,#0124,#0000,InvertSelect+3,#0000
0154+  F667 2C00C400550063002401000063E30000
0155+  F677             
0156+  F677              DEFW #0006,#0028,#000F,#001A,#0090,MenuFile+3,#0000,#0000
0156+  F677 060028000F001A0090001ED300000000
0157+  F687              DEFW #0028,#0054,#000F,#001A,#0128,#0000,MenuExit,#0000
0157+  F687 280054000F001A002801000064D80000
0158+  F697              DEFW #0054,#008A,#000F,#001A,#0090,MenuOption+3,#0000,#0000
0158+  F697 54008A000F001A00900065D400000000
0159+  F6A7              DEFW #008A,#00AE,#000F,#001A,#0090,MenuView+3,#0000,#0000
0159+  F6A7 8A00AE000F001A009000F9D400000000
0160+  F6B7              DEFW #00AE,#00DE,#000F,#001A,#0090,MenuConfig+3,#0000,#0000
0160+  F6B7 AE00DE000F001A00900056D700000000
0161+  F6C7              DEFW #00DE,#0106,#000F,#001A,#0090,MenuAbout+3,#0000,#0000
0161+  F6C7 DE0006010F001A00900095D700000000
0162+  F6D7             
0163+  F6D7              DEFW #0000,#0280,#0000,#001A,#0120,#0000,MenuExit,#0000
0163+  F6D7 0000800200001A002001000064D80000
0164+  F6E7              DEFW #0000,#0280,#0066,#0100,#0120,#0000,MenuExit,#0000
0164+  F6E7 00008002660000012001000064D80000
0165+  F6F7              DEFW #0000,#0028,#0000,#0100,#0120,#0000,MenuExit,#0000
0165+  F6F7 00002800000000012001000064D80000
0166+  F707              DEFW #00C8,#0280,#0000,#0100,#0120,#0000,MenuExit,#0000
0166+  F707 C8008002000000012001000064D80000
0167+  F717 00 80        DEFW #8000
0168+  F719             
0169+  F719             
0170+  F719             OptionTab
0171+  F719                 DEFW #0058,#0120,#001D,#002B,#0124,#0000,RefreshTree,#0000
0171+  F719 580020011D002B00240100002DDB0000
0172+  F729                 DEFW #0058,#0120,#002B,#0039,#0124,#0000,DiskInfo+3,#0000
0172+  F729 580020012B00390024010000F5D10000
0173+  F739                 DEFW #0058,#0120,#003F,#004D,#0124,#0000,SystemInfo,#0000
0173+  F739 580020013F004D002401000001D20000
0174+  F749             
0175+  F749              DEFW #0006,#0028,#000F,#001A,#0090,MenuFile+3,#0000,#0000
0175+  F749 060028000F001A0090001ED300000000
0176+  F759              DEFW #0028,#0054,#000F,#001A,#0090,MenuSelect+3,#0000,#0000
0176+  F759 280054000F001A009000A4D300000000
0177+  F769              DEFW #0054,#008A,#000F,#001A,#0128,#0000,MenuExit,#0000
0177+  F769 54008A000F001A002801000064D80000
0178+  F779              DEFW #008A,#00AE,#000F,#001A,#0090,MenuView+3,#0000,#0000
0178+  F779 8A00AE000F001A009000F9D400000000
0179+  F789              DEFW #00AE,#00DE,#000F,#001A,#0090,MenuConfig+3,#0000,#0000
0179+  F789 AE00DE000F001A00900056D700000000
0180+  F799              DEFW #00DE,#0106,#000F,#001A,#0090,MenuAbout+3,#0000,#0000
0180+  F799 DE0006010F001A00900095D700000000
0181+  F7A9             
0182+  F7A9                 DEFW #0000,#0280,#0000,#001A,#0120,#0000,MenuExit,#0000
0182+  F7A9 0000800200001A002001000064D80000
0183+  F7B9                 DEFW #0000,#0280,#0050,#0100,#0120,#0000,MenuExit,#0000
0183+  F7B9 00008002500000012001000064D80000
0184+  F7C9                 DEFW #0000,#0054,#0000,#0100,#0120,#0000,MenuExit,#0000
0184+  F7C9 00005400000000012001000064D80000
0185+  F7D9                 DEFW #0124,#0280,#0000,#0100,#0120,#0000,MenuExit,#0000
0185+  F7D9 24018002000000012001000064D80000
0186+  F7E9 00 80           DEFW #8000
0187+  F7EB             
0188+  F7EB             
0189+  F7EB             ViewTab
0190+  F7EB                 DEFW #008E,#0144,#001D,#002B,#0124,#0000,ChView1,#0000
0190+  F7EB 8E0044011D002B00240100006AD90000
0191+  F7FB                 DEFW #008E,#0144,#002B,#0039,#0124,#0000,ChView2,#0000
0191+  F7FB 8E0044012B0039002401000075D90000
0192+  F80B                 DEFW #008E,#0144,#0039,#0047,#0124,#0000,ChView3,#0000
0192+  F80B 8E004401390047002401000080D90000
0193+  F81B                 DEFW #008E,#0144,#004D,#005B,#0124,#0000,ChFilt1,#0000
0193+  F81B 8E0044014D005B002401000092D90000
0194+  F82B                 DEFW #008E,#0144,#005B,#0069,#0124,#0000,ChFilt2,#0000
0194+  F82B 8E0044015B00690024010000A4D90000
0195+  F83B                 DEFW #008E,#0144,#0069,#0077,#0124,#0000,ChFilt3,#0000
0195+  F83B 8E0044016900770024010000B6D90000
0196+  F84B                 DEFW #008E,#0144,#0077,#0085,#0124,#0000,NewFilter+3,#0000
0196+  F84B 8E004401770085002401000074DB0000
0197+  F85B                 DEFW #008E,#0144,#008B,#0099,#0124,#0000,ChSort1,#0000
0197+  F85B 8E0044018B00990024010000C8D90000
0198+  F86B                 DEFW #008E,#0144,#0099,#00A7,#0124,#0000,ChSort2,#0000
0198+  F86B 8E0044019900A70024010000E2D90000
0199+  F87B                 DEFW #008E,#0144,#00A7,#00B5,#0124,#0000,ChSort3,#0000
0199+  F87B 8E004401A700B50024010000FCD90000
0200+  F88B                 DEFW #008E,#0144,#00B5,#00C3,#0124,#0000,ChSort4,#0000
0200+  F88B 8E004401B500C3002401000016DA0000
0201+  F89B                 DEFW #008E,#0144,#00C3,#00D1,#0124,#0000,ChSort5,#0000
0201+  F89B 8E004401C300D1002401000030DA0000
0202+  F8AB             
0203+  F8AB              DEFW #0006,#0028,#000F,#001A,#0090,MenuFile+3,#0000,#0000
0203+  F8AB 060028000F001A0090001ED300000000
0204+  F8BB              DEFW #0028,#0054,#000F,#001A,#0090,MenuSelect+3,#0000,#0000
0204+  F8BB 280054000F001A009000A4D300000000
0205+  F8CB              DEFW #0054,#008A,#000F,#001A,#0090,MenuOption+3,#0000,#0000
0205+  F8CB 54008A000F001A00900065D400000000
0206+  F8DB              DEFW #008A,#00AE,#000F,#001A,#0128,#0000,MenuExit,#0000
0206+  F8DB 8A00AE000F001A002801000064D80000
0207+  F8EB              DEFW #00AE,#00DE,#000F,#001A,#0090,MenuConfig+3,#0000,#0000
0207+  F8EB AE00DE000F001A00900056D700000000
0208+  F8FB              DEFW #00DE,#0106,#000F,#001A,#0090,MenuAbout+3,#0000,#0000
0208+  F8FB DE0006010F001A00900095D700000000
0209+  F90B             
0210+  F90B                 DEFW #0000,#0280,#0000,#001A,#0160,#0000,MenuExit,#0000
0210+  F90B 0000800200001A006001000064D80000
0211+  F91B                 DEFW #0000,#0280,#00B8,#0100,#0160,#0000,MenuExit,#0000
0211+  F91B 00008002B80000016001000064D80000
0212+  F92B                 DEFW #0000,#008A,#0000,#0100,#0160,#0000,MenuExit,#0000
0212+  F92B 00008A00000000016001000064D80000
0213+  F93B                 DEFW #014A,#0280,#0000,#0100,#0160,#0000,MenuExit,#0000
0213+  F93B 4A018002000000016001000064D80000
0214+  F94B 00 80           DEFW #8000
0215+  F94D             
0216+  F94D             
0217+  F94D             ConfigTab
0218+  F94D                 DEFW #00B2,#010A,#001D,#002B,#0124,#0000,Setup,#0000
0218+  F94D B2000A011D002B0024010000C0D10000
0219+  F95D             
0220+  F95D              DEFW #0006,#0028,#000F,#001A,#0090,MenuFile+3,#0000,#0000
0220+  F95D 060028000F001A0090001ED300000000
0221+  F96D              DEFW #0028,#0054,#000F,#001A,#0090,MenuSelect+3,#0000,#0000
0221+  F96D 280054000F001A009000A4D300000000
0222+  F97D              DEFW #0054,#008A,#000F,#001A,#0090,MenuOption+3,#0000,#0000
0222+  F97D 54008A000F001A00900065D400000000
0223+  F98D              DEFW #008A,#00AE,#000F,#001A,#0090,MenuView+3,#0000,#0000
0223+  F98D 8A00AE000F001A009000F9D400000000
0224+  F99D              DEFW #00AE,#00DE,#000F,#001A,#0128,#0000,MenuExit,#0000
0224+  F99D AE00DE000F001A002801000064D80000
0225+  F9AD              DEFW #00DE,#0106,#000F,#001A,#0090,MenuAbout+3,#0000,#0000
0225+  F9AD DE0006010F001A00900095D700000000
0226+  F9BD             
0227+  F9BD                 DEFW #0000,#0280,#0000,#001A,#0120,#0000,MenuExit,#0000
0227+  F9BD 0000800200001A002001000064D80000
0228+  F9CD                 DEFW #0000,#0280,#002E,#0100,#0120,#0000,MenuExit,#0000
0228+  F9CD 000080022E0000012001000064D80000
0229+  F9DD                 DEFW #0000,#00AE,#0000,#0100,#0120,#0000,MenuExit,#0000
0229+  F9DD 0000AE00000000012001000064D80000
0230+  F9ED                 DEFW #010E,#0280,#0000,#0100,#0120,#0000,MenuExit,#0000
0230+  F9ED 0E018002000000012001000064D80000
0231+  F9FD 00 80           DEFW #8000
0232+  F9FF             
0233+  F9FF             AboutTab
0234+  F9FF                 DEFW #00E2,#014A,#001D,#002B,#0124,#0000,Version,#0000
0234+  F9FF E2004A011D002B00240100000DD20000
0235+  FA0F             
0236+  FA0F              DEFW #0006,#0028,#000F,#001A,#0090,MenuFile+3,#0000,#0000
0236+  FA0F 060028000F001A0090001ED300000000
0237+  FA1F              DEFW #0028,#0054,#000F,#001A,#0090,MenuSelect+3,#0000,#0000
0237+  FA1F 280054000F001A009000A4D300000000
0238+  FA2F              DEFW #0054,#008A,#000F,#001A,#0090,MenuOption+3,#0000,#0000
0238+  FA2F 54008A000F001A00900065D400000000
0239+  FA3F              DEFW #008A,#00AE,#000F,#001A,#0090,MenuView+3,#0000,#0000
0239+  FA3F 8A00AE000F001A009000F9D400000000
0240+  FA4F              DEFW #00AE,#00DE,#000F,#001A,#0090,MenuConfig+3,#0000,#0000
0240+  FA4F AE00DE000F001A00900056D700000000
0241+  FA5F              DEFW #00DE,#0106,#000F,#001A,#0128,#0000,MenuExit,#0000
0241+  FA5F DE0006010F001A002801000064D80000
0242+  FA6F             
0243+  FA6F                 DEFW #0000,#0280,#0000,#001A,#0120,#0000,MenuExit,#0000
0243+  FA6F 0000800200001A002001000064D80000
0244+  FA7F                 DEFW #0000,#0280,#002E,#0100,#0120,#0000,MenuExit,#0000
0244+  FA7F 000080022E0000012001000064D80000
0245+  FA8F                 DEFW #0000,#00DE,#0000,#0100,#0120,#0000,MenuExit,#0000
0245+  FA8F 0000DE00000000012001000064D80000
0246+  FA9F                 DEFW #014E,#0280,#0000,#0100,#0120,#0000,MenuExit,#0000
0246+  FA9F 4E018002000000012001000064D80000
0247+  FAAF 00 80           DEFW #8000
0248+  FAB1             
0249+  FAB1             
0250+  FAB1             PullTab
0251+  FAB1                 DEFW #0006,#0028,#000F,#001A,#20,#0000,MFile,#0000
0251+  FAB1 060028000F001A0020000000F7D20000
0252+  FAC1                 DEFW #0028,#0054,#000F,#001A,#20,#0000,MSelect,#0000
0252+  FAC1 280054000F001A0020000000FDD20000
0253+  FAD1                 DEFW #0054,#008A,#000F,#001A,#20,#0000,MOption,#0000
0253+  FAD1 54008A000F001A002000000003D30000
0254+  FAE1                 DEFW #008A,#00AE,#000F,#001A,#20,#0000,MView,#0000
0254+  FAE1 8A00AE000F001A002000000009D30000
0255+  FAF1                 DEFW #00AE,#00DE,#000F,#001A,#20,#0000,MConfig,#0000
0255+  FAF1 AE00DE000F001A00200000000FD30000
0256+  FB01                 DEFW #00DE,#0106,#000F,#001A,#20,#0000,MAbout,#0000
0256+  FB01 DE0006010F001A002000000015D30000
0257+  FB11                 DEFW #0000,#0280,#0000,#000F,#20,#0000,PullExit+1,#0000
0257+  FB11 0000800200000F00200000005DD20000
0258+  FB21                 DEFW #0000,#0280,#001A,#0100,#20,#0000,PullExit+1,#0000
0258+  FB21 000080021A000001200000005DD20000
0259+  FB31                 DEFW #0000,#0006,#0000,#0100,#20,#0000,PullExit+1,#0000
0259+  FB31 0000060000000001200000005DD20000
0260+  FB41                 DEFW #00DE,#0280,#0000,#0100,#20,#0000,PullExit+1,#0000
0260+  FB41 DE00800200000001200000005DD20000
0261+  FB51 00 80           DEFW #8000
0262+  FB53             ;[]==========================================================[]
0263+  FB53             
0264+  FB53             FilterTab
0265+  FB53             	DEFW #00F0,#0138,#007B,#0089,#01,#0000,InpLnExtN,#0000
0265+  FB53 F00038017B008900010000000E920000
0266+  FB63             	DEFW #0148,#0190,#007B,#0089,#01,#0000,InpLnExtC,#0000
0266+  FB63 480190017B0089000100000018920000
0267+  FB73             	DEFW #0000,#00D0,#0000,#0100,#00,#0000,InpLnExtC,#0000
0267+  FB73 0000D000000000010000000018920000
0268+  FB83             	DEFW #01B0,#0280,#0000,#0100,#00,#0000,InpLnExtC,#0000
0268+  FB83 B0018002000000010000000018920000
0269+  FB93             	DEFW #0000,#0280,#0000,#0051,#00,#0000,InpLnExtC,#0000
0269+  FB93 00008002000051000000000018920000
0270+  FBA3             	DEFW #0000,#0280,#008F,#0100,#00,#0000,InpLnExtC,#0000
0270+  FBA3 000080028F0000010000000018920000
0271+  FBB3 00 80       	DEFW #8000
0272+  FBB5             
0273+  FBB5             
0274+  FBB5             SMaskTab
0275+  FBB5             	DEFW #00F0,#0138,#007B,#0089,#01,#0000,InpLnExtN,#0000
0275+  FBB5 F00038017B008900010000000E920000
0276+  FBC5             	DEFW #0148,#0190,#007B,#0089,#01,#0000,InpLnExtC,#0000
0276+  FBC5 480190017B0089000100000018920000
0277+  FBD5             	DEFW #0000,#00D0,#0000,#0100,#00,#0000,InpLnExtC,#0000
0277+  FBD5 0000D000000000010000000018920000
0278+  FBE5             	DEFW #01B0,#0280,#0000,#0100,#00,#0000,InpLnExtC,#0000
0278+  FBE5 B0018002000000010000000018920000
0279+  FBF5             	DEFW #0000,#0280,#0000,#0051,#00,#0000,InpLnExtC,#0000
0279+  FBF5 00008002000051000000000018920000
0280+  FC05             	DEFW #0000,#0280,#008F,#0100,#00,#0000,InpLnExtC,#0000
0280+  FC05 000080028F0000010000000018920000
0281+  FC15 00 80       	DEFW #8000
0282+  FC17             
0283+  FC17             
0284+  FC17             DOSTab
0285+  FC17             	DEFW #0000,#0100,#0000,#0100,#00,#0000,DOSLnExtC,#0000
0285+  FC17 0000000100000001000000002BEE0000
0286+  FC27             	DEFW #027C,#0280,#0000,#0100,#00,#0000,DOSLnExtC,#0000
0286+  FC27 7C02800200000001000000002BEE0000
0287+  FC37             	DEFW #0000,#0280,#0000,#00E5,#00,#0000,DOSLnExtC,#0000
0287+  FC37 000080020000E500000000002BEE0000
0288+  FC47             	DEFW #0000,#0280,#00EF,#0100,#00,#0000,DOSLnExtC,#0000
0288+  FC47 00008002EF000001000000002BEE0000
0289+  FC57 00 80       	DEFW #8000
0290+  FC59             
0291+  FC59             ViewEditTab
0292+  FC59             	DEFW #00F0,#0138,#007B,#0089,#01,#0000,InpLnExtN,#0000
0292+  FC59 F00038017B008900010000000E920000
0293+  FC69             	DEFW #0148,#0190,#007B,#0089,#01,#0000,InpLnExtC,#0000
0293+  FC69 480190017B0089000100000018920000
0294+  FC79             	DEFW #0000,#00C8,#0000,#0100,#00,#0000,InpLnExtC,#0000
0294+  FC79 0000C800000000010000000018920000
0295+  FC89             	DEFW #01B8,#0280,#0000,#0100,#00,#0000,InpLnExtC,#0000
0295+  FC89 B8018002000000010000000018920000
0296+  FC99             	DEFW #0000,#0280,#0000,#0051,#00,#0000,InpLnExtC,#0000
0296+  FC99 00008002000051000000000018920000
0297+  FCA9             	DEFW #0000,#0280,#008F,#0100,#00,#0000,InpLnExtC,#0000
0297+  FCA9 000080028F0000010000000018920000
0298+  FCB9 00 80       	DEFW #8000
0299+  FCBB             ;[]==========================================================[]
0300+  FCBB             DriveTab
0301+  FCBB                 DEFW #0000,#0000,#0000,#0000,#20,#0000,DriveExit,#0000
0301+  FCBB 000000000000000020000000DEDD0000
0302+  FCCB                 DEFW #0000,#0000,#0000,#0000,#20,#0000,DriveExit,#0000
0302+  FCCB 000000000000000020000000DEDD0000
0303+  FCDB                 DEFW #0000,#0280,#0000,#005C,#20,#0000,DriveExit,#0000
0303+  FCDB 0000800200005C0020000000DEDD0000
0304+  FCEB                 DEFW #0000,#0280,#0080,#0100,#20,#0000,DriveExit,#0000
0304+  FCEB 000080028000000120000000DEDD0000
0305+  FCFB             BegDrive
0306+  FCFB                 DEFW #0000,#0000,#006E,#0079,#20,#0000,DriveMouse,#0000
0306+  FCFB 000000006E007900200000001FDE0000
0307+  FD0B                 DEFW #0000,#0000,#006E,#0079,#20,#0000,DriveMouse,#0000
0307+  FD0B 000000006E007900200000001FDE0000
0308+  FD1B                 DEFW #0000,#0000,#006E,#0079,#20,#0000,DriveMouse,#0000
0308+  FD1B 000000006E007900200000001FDE0000
0309+  FD2B                 DEFW #0000,#0000,#006E,#0079,#20,#0000,DriveMouse,#0000
0309+  FD2B 000000006E007900200000001FDE0000
0310+  FD3B                 DEFW #0000,#0000,#006E,#0079,#20,#0000,DriveMouse,#0000
0310+  FD3B 000000006E007900200000001FDE0000
0311+  FD4B                 DEFW #0000,#0000,#006E,#0079,#20,#0000,DriveMouse,#0000
0311+  FD4B 000000006E007900200000001FDE0000
0312+  FD5B                 DEFW #0000,#0000,#006E,#0079,#20,#0000,DriveMouse,#0000
0312+  FD5B 000000006E007900200000001FDE0000
0313+  FD6B                 DEFW #0000,#0000,#006E,#0079,#20,#0000,DriveMouse,#0000
0313+  FD6B 000000006E007900200000001FDE0000
0314+  FD7B                 DEFW #0000,#0000,#006E,#0079,#20,#0000,DriveMouse,#0000
0314+  FD7B 000000006E007900200000001FDE0000
0315+  FD8B                 DEFW #0000,#0000,#006E,#0079,#20,#0000,DriveMouse,#0000
0315+  FD8B 000000006E007900200000001FDE0000
0316+  FD9B                 DEFW #0000,#0000,#006E,#0079,#20,#0000,DriveMouse,#0000
0316+  FD9B 000000006E007900200000001FDE0000
0317+  FDAB 00 80           DEFW #8000
0318+  FDAD             ;[]==========================================================[]
0319+  FDAD             ;Формат	таблицы
0320+  FDAD             ;	+00  2	ASCII +	SCANCOD
0321+  FDAD             ;	+02  2	Execute	program
0322+  FDAD             ASCIIKeys
0323+  FDAD 09 0F D7 C7 	DEFW	#0F09,ChPanel
0324+  FDB1 00 58 91 BE 	DEFW	#5800,CursUp
0325+  FDB5 00 52 4C C1 	DEFW	#5200,CursDown
0326+  FDB9 00 54 25 C4 	DEFW	#5400,CursLeft
0327+  FDBD 00 56 48 C4 	DEFW	#5600,CursRight
0328+  FDC1 00 59 BB C4 	DEFW	#5900,PageUp
0329+  FDC5 00 53 E8 C4 	DEFW	#5300,PageDown
0330+  FDC9 00 57 5D C5 	DEFW	#5700,Home
0331+  FDCD 00 51 96 C5 	DEFW	#5100,End
0332+  FDD1 00 43 25 D2 	DEFW	#4300,PullDown
0333+  FDD5 2B 4D 50 E0 	DEFW	#4D2B,MarkGroup
0334+  FDD9 2D 4C 46 E0 	DEFW	#4C2D,UnMarkGroup
0335+  FDDD 2A 4B 60 E3 	DEFW	#4B2A,InvertSelect
0336+  FDE1 00 50 AE DE 	DEFW	#5000,MarkFile
0337+  FDE5 00 3B A3 CE 	DEFW	#3B00,Help
0338+  FDE9 00 3D 7C CF 	DEFW	#3D00,ViewFile
0339+  FDED 00 3E DE D0 	DEFW	#3E00,EditFile
0340+  FDF1 00 3F 7A D1 	DEFW	#3F00,CopyFiles
0341+  FDF5 00 40 86 D1 	DEFW	#4000,ReName
0342+  FDF9 00 41 92 D1 	DEFW	#4100,MakeDIR
0343+  FDFD 00 42 9E D1 	DEFW	#4200,DeleteFiles
0344+  FE01 00 44 AA D1 	DEFW	#4400,Quit
0345+  FE05 FF          	DEFB	#FF
0346+  FE06             SHIFTKeys
0347+  FE06 00 3D AF CE 	DEFW	#3D00,ViewFileSH
0348+  FE0A 00 3E 18 D0 	DEFW	#3E00,EditFileSH
0349+  FE0E FF          	DEFB	#FF
0350+  FE0F             CTRLKeys
0351+  FE0F 00 43 DF D1 	DEFW	#4300,PrintFile
0352+  FE13 00 4D 7C E2 	DEFW	#4D00,SelectAll
0353+  FE17 00 4C 06 E3 	DEFW	#4C00,UnSelectAll
0354+  FE1B 00 25 F2 D1 	DEFW	#2500,DiskInfo
0355+  FE1F 00 3B 42 DA 	DEFW	#3B00,Brief
0356+  FE23 00 3C 53 DA 	DEFW	#3C00,Full
0357+  FE27 00 42 63 DA 	DEFW	#4200,Tree
0358+  FE2B 00 44 78 DA 	DEFW	#4400,AllFiles
0359+  FE2F 00 45 8E DA 	DEFW	#4500,ExeFiles
0360+  FE33 00 46 71 DB 	DEFW	#4600,NewFilter
0361+  FE37 00 3D A3 DA 	DEFW	#3D00,NameS
0362+  FE3B 00 3E C0 DA 	DEFW	#3E00,Extention
0363+  FE3F 00 3F DD DA 	DEFW	#3F00,Data
0364+  FE43 00 40 FA DA 	DEFW	#4000,Size
0365+  FE47 00 41 17 DB 	DEFW	#4100,UnSort
0366+  FE4B 00 16 DD C8 	DEFW	#1600,ReplacePanels
0367+  FE4F 00 18 2C C9 	DEFW	#1800,ShowDOSscreen
0368+  FE53 00 35 3C BC 	DEFW	#3500,BegDIRECTORY
0369+  FE57 FF          	DEFB	#FF
0370+  FE58             ALTKeys
0371+  FE58 00 01 3C A5 	DEFW	#0100,MouseOnOff
0372+  FE5C 00 28 CC D1 	DEFW	#2800,FileInfo
0373+  FE60 00 3B 66 DC 	DEFW	#3B00,LeftDrive
0374+  FE64 00 3C C6 DC 	DEFW	#3C00,RightDrive
0375+  FE68 00 3D 7F CF 	DEFW	#3D00,StViewFile
0376+  FE6C 00 3E E1 D0 	DEFW	#3E00,StEditFile
0377+  FE70 00 44 2D DB 	DEFW	#4400,RefreshTree
0378+  FE74 FF          	DEFB	#FF
0379+  FE75             
0380+  FE75             
0381+  FE75             
0278   FE75             end1: 
0279   FE75             
0280   FE75             EndOfFN
0281   FE75             	savebin	"bin\fnmain.bin",StartOfFN,EndOfFN-StartOfFN
0282   FE75             ;[]=======================================================================[]
0283   FE75             	org	0x4000
0284   4000             ;	section	.text
0285   4000             StartOfFunc
0286   4000             	include "fnfunct.z80"
0001+  4000             
0002+  4000             ;[]==========================================================[]
0003+  4000             CopyFilesR
0004+  4000 FD 7E 13    	LD	A,(IY+PanelEFl)
0005+  4003 FD B6 14    	OR	(IY+PanelEFh)
0006+  4006 C8          	RET	Z
0007+  4007 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0008+  400B C0          	RET	NZ
0009+  400C 3E C0       	LD	A,#C0
0010+  400E D3 89       	OUT	(YPORT),A
0011+  4010 FD 7E 19    	LD	A,(IY+PanelMFl)
0012+  4013 FD B6 1A    	OR	(IY+PanelMFh)
0013+  4016 20 5E       	JR	NZ,CopyMark
0014+  4018 DB E2       	IN	A,(PAGE3)
0015+  401A F5          	PUSH	AF
0016+  401B FD CB 00 46 	BIT	0,(IY+PanelFlg)
0017+  401F 3A EE A7    	LD	A,(DIRpage1)
0018+  4022 28 03       	JR	Z,$+5
0019+  4024 3A EF A7    	LD	A,(DIRpage2)
0020+  4027 D3 E2       	OUT	(PAGE3),A
0021+  4029 DD 21 00 80 	LD	IX,WorkBuffer
0022+  402D FD 6E 15    	LD	L,(IY+PanelFFl)
0023+  4030 FD 66 16    	LD	H,(IY+PanelFFh)
0024+  4033 FD 5E 17    	LD	E,(IY+PanelCFl)
0025+  4036 FD 56 18    	LD	D,(IY+PanelCFh)
0026+  4039 19          	ADD	HL,DE
0027+  403A 29          	ADD	HL,HL
0028+  403B 29          	ADD	HL,HL
0029+  403C 29          	ADD	HL,HL
0030+  403D 5D          	LD	E,L
0031+  403E 54          	LD	D,H
0032+  403F 29          	ADD	HL,HL
0033+  4040 19          	ADD	HL,DE
0034+  4041 7C          	LD	A,H
0035+  4042 F6 C0       	OR	#C0
0036+  4044 67          	LD	H,A
0037+  4045 22 90 46    	LD	(AdrCopyFile),HL
0038+  4048 11 00 80    	LD	DE,WorkBuffer
0039+  404B 01 18 00    	LD	BC,#0018
0040+  404E ED B0       	LDIR 
0041+  4050 F1          	POP	AF
0042+  4051 D3 E2       	OUT	(PAGE3),A
0043+  4053 DD CB 0E 66 	BIT	4,(IX+#0E)
0044+  4057 C0          	RET	NZ
0045+  4058 21 00 00    	LD	HL,#0000
0046+  405B 22 96 46    	LD	(ECopyFiles),HL
0047+  405E DD 6E 0F    	LD	L,(IX+#0F)
0048+  4061 DD 66 10    	LD	H,(IX+#10)
0049+  4064 22 98 46    	LD	(ECopyBytes),HL
0050+  4067 DD 5E 11    	LD	E,(IX+#11)
0051+  406A DD 56 12    	LD	D,(IX+#12)
0052+  406D ED 53 9A 46 	LD	(ECopyBytes+2),DE
0053+  4071 CD AA 46    	CALL	ConvLenToBank
0054+  4074 18 71       	JR	CopyNxt
0055+  4076             CopyMark
0056+  4076 FD 6E 19    	LD	L,(IY+PanelMFl)
0057+  4079 FD 66 1A    	LD	H,(IY+PanelMFh)
0058+  407C 22 96 46    	LD	(ECopyFiles),HL
0059+  407F FD 6E 1B    	LD	L,(IY+PanelMBl1)
0060+  4082 FD 66 1C    	LD	H,(IY+PanelMBh1)
0061+  4085 22 98 46    	LD	(ECopyBytes),HL
0062+  4088 FD 6E 1D    	LD	L,(IY+PanelMBl2)
0063+  408B FD 66 1E    	LD	H,(IY+PanelMBh2)
0064+  408E 22 9A 46    	LD	(ECopyBytes+2),HL
0065+  4091 DB E2       	IN	A,(PAGE3)
0066+  4093 F5          	PUSH	AF
0067+  4094 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0068+  4098 3A EE A7    	LD	A,(DIRpage1)
0069+  409B 28 03       	JR	Z,$+5
0070+  409D 3A EF A7    	LD	A,(DIRpage2)
0071+  40A0 D3 E2       	OUT	(PAGE3),A
0072+  40A2 21 E8 BF    	LD	HL,#C000-#18
0073+  40A5 01 18 00    	LD	BC,#0018
0074+  40A8 09          	ADD	HL,BC
0075+  40A9 CB 46       	BIT	0,(HL)
0076+  40AB 28 FB       	JR	Z,$-3
0077+  40AD 22 90 46    	LD	(AdrCopyFile),HL
0078+  40B0 E5          	PUSH	HL
0079+  40B1 DD E1       	POP	IX
0080+  40B3 97          	SUB	A
0081+  40B4 6F          	LD	L,A
0082+  40B5 67          	LD	H,A
0083+  40B6 5D          	LD	E,L
0084+  40B7 54          	LD	D,H
0085+  40B8 DD CB 00 46 CopyLp0	BIT	0,(IX+#00)
0086+  40BC 28 1E       	JR	Z,CopyNx2
0087+  40BE C5          	PUSH	BC
0088+  40BF D5          	PUSH	DE
0089+  40C0 E5          	PUSH	HL
0090+  40C1 DD 6E 0F    	LD	L,(IX+#0F)
0091+  40C4 DD 66 10    	LD	H,(IX+#10)
0092+  40C7 DD 5E 11    	LD	E,(IX+#11)
0093+  40CA DD 56 12    	LD	D,(IX+#12)
0094+  40CD CD AA 46    	CALL	ConvLenToBank
0095+  40D0 4D          	LD	C,L
0096+  40D1 44          	LD	B,H
0097+  40D2 E1          	POP	HL
0098+  40D3 09          	ADD	HL,BC
0099+  40D4 4B          	LD	C,E
0100+  40D5 42          	LD	B,D
0101+  40D6 D1          	POP	DE
0102+  40D7 EB          	EX	DE,HL
0103+  40D8 ED 4A       	ADC	HL,BC
0104+  40DA EB          	EX	DE,HL
0105+  40DB C1          	POP	BC
0106+  40DC DD 09       CopyNx2	ADD	IX,BC
0107+  40DE DD 7E 01    	LD	A,(IX+#01)
0108+  40E1 B7          	OR	A
0109+  40E2 20 D4       	JR	NZ,CopyLp0
0110+  40E4 F1          	POP	AF
0111+  40E5 D3 E2       	OUT	(PAGE3),A
0112+  40E7 DD 21 7F 47 CopyNxt	LD	IX,ProcessAll
0113+  40EB 29          	ADD	HL,HL
0114+  40EC EB          	EX	DE,HL
0115+  40ED ED 6A       	ADC	HL,HL
0116+  40EF EB          	EX	DE,HL
0117+  40F0 DD 75 0A    	LD	(IX+ProcMAXl1),L
0118+  40F3 DD 74 0B    	LD	(IX+ProcMAXh1),H
0119+  40F6 DD 73 0C    	LD	(IX+ProcMAXl2),E
0120+  40F9 DD 72 0D    	LD	(IX+ProcMAXh2),D
0121+  40FC CD E6 99    	CALL	InitProcess
0122+  40FF CD F9 BA    	CALL	ResInvert
0123+  4102 21 EA BA    	LD	HL,SetInvert
0124+  4105 E5          	PUSH	HL
0125+  4106 CD F0 86    	CALL	MakeWindow
0126+  4109 01          	DEFB	#01
0127+  410A 60 00 51 00 	DEFW	#0060,#0051
0128+  410E C0 01 3E 00 	DEFW	#01C0,#003E
0129+  4112 02          	DEFB	#02	;Head place
0130+  4113 04 00 02 00 	DEFW	#0004,#0002
0131+  4117 B8 01 0A 00 	DEFW	#01B8,#000A
0132+  411B 00          	DEFB	#00
0133+  411C 01          	DEFB	#01	;Text Line
0134+  411D D2 00 03 00 	DEFW	#00D2,#0003
0135+  4121 0F          	DEFB	#0F
0136+  4122 436F707900  	DEFB	"Copy",0
0137+  4127 04          	DEFB	#04	;UpRectan
0138+  4128 90 00 2A 00 	DEFW	#0090,#002A
0139+  412C 48 00 0E 00 	DEFW	#0048,#000E
0140+  4130 01          	DEFB	#01	;Text Line
0141+  4131 AC 00 2D 00 	DEFW	#00AC,#002D
0142+  4135 80          	DEFB	#80
0143+  4136 4F 6B 00    	DEFB	"Ok",0
0144+  4139 04          	DEFB	#04	;UpRectan
0145+  413A E8 00 2A 00 	DEFW	#00E8,#002A
0146+  413E 48 00 0E 00 	DEFW	#0048,#000E
0147+  4142 01          	DEFB	#01	;Text Line
0148+  4143 FC 00 2D 00 	DEFW	#00FC,#002D
0149+  4147 80          	DEFB	#80
0150+  4148             	DEFB	"Cancel",0
0150+  4148 43616E63656C00
0151+  414F 01          	DEFB	#01	;Text Line
0152+  4150 16 00 19 00 	DEFW	#0016,#0019
0153+  4154 80          	DEFB	#80
0154+  4155             	DEFB	"Copy to:",0
0154+  4155 436F707920746F3A00
0155+  415E 03          	DEFB	#03	;Углубление
0156+  415F 46 00 16 00 	DEFW	#0046,#0016
0157+  4163 4C 01 0C 00 	DEFW	#014C,#000C
0158+  4167 02          	DEFB	#02	;Head place
0159+  4168 48 00 17 00 	DEFW	#0048,#0017
0160+  416C 48 01 0A 00 	DEFW	#0148,#000A
0161+  4170 0F          	DEFB	#0F
0162+  4171 00          	DEFB	#00
0163+  4172 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0164+  4176 21 8A A5    	LD	HL,LeftPanel
0165+  4179 20 03       	JR	NZ,$+5
0166+  417B 21 B6 A6    	LD	HL,RightPanel
0167+  417E 11 2C 00    	LD	DE,BegPath
0168+  4181 19          	ADD	HL,DE
0169+  4182 11 B1 47    	LD	DE,CurPath
0170+  4185 97          	SUB	A
0171+  4186 4F          	LD	C,A
0172+  4187 ED A0       	LDI 
0173+  4189 BE          	CP	(HL)
0174+  418A 20 FB       	JR	NZ,$-3
0175+  418C 12          	LD	(DE),A
0176+  418D 97          	SUB	A
0177+  418E 91          	SUB	C
0178+  418F 32 A9 47    	LD	(PathLen),A
0179+  4192 DD 21 A5 47 	LD	IX,PathStr
0180+  4196 21 C4 71    	LD	HL,PathTab
0181+  4199 CD 68 91    	CALL	InputLine
0182+  419C CD F0 86    	CALL	MakeWindow
0183+  419F 7F          	DEFB	#7F
0184+  41A0 00          	DEFB	#00
0185+  41A1 D8          	RET	C
0186+  41A2 3A A9 47    	LD	A,(PathLen)
0187+  41A5 B7          	OR	A
0188+  41A6 C8          	RET	Z
0189+  41A7 0E 3C       	LD	C,#3C
0190+  41A9 FD E5       	PUSH	IY
0191+  41AB D7          	RST	#10
0192+  41AC FD E1       	POP	IY
0193+  41AE ED 43 9D 46 	LD	(FreeBanks),BC
0194+  41B2 78          	LD	A,B
0195+  41B3 B1          	OR	C
0196+  41B4 3E 1E       	LD	A,#1E
0197+  41B6 CA A8 86    	JP	Z,DOSError	;!!!!!!!!!!!! Нет памяти
0198+  41B9 CD F0 86    	CALL	MakeWindow
0199+  41BC 01          	DEFB	#01
0200+  41BD A0 00 51 00 	DEFW	#00A0,#0051
0201+  41C1 40 01 4E 00 	DEFW	#0140,#004E
0202+  41C5 02          	DEFB	#02	;Head place
0203+  41C6 04 00 02 00 	DEFW	#0004,#0002
0204+  41CA 38 01 0A 00 	DEFW	#0138,#000A
0205+  41CE 00          	DEFB	#00
0206+  41CF 01          	DEFB	#01	;Text Line
0207+  41D0 94 00 03 00 	DEFW	#0094,#0003
0208+  41D4 0F          	DEFB	#0F
0209+  41D5 436F707900  	DEFB	"Copy",0
0210+  41DA 01          	DEFB	#01	;Text Line
0211+  41DB 08 00 10 00 	DEFW	#0008,#0010
0212+  41DF 80          	DEFB	#80
0213+  41E0             	DEFB	"From:",0
0213+  41E0 46726F6D3A00
0214+  41E6 01          	DEFB	#01	;Text Line
0215+  41E7 16 00 1A 00 	DEFW	#0016,#001A
0216+  41EB 80          	DEFB	#80
0217+  41EC 74 6F 3A 00 	DEFB	"to:",0
0218+  41F0 03          	DEFB	#03	;Углубление
0219+  41F1 10 00 26 00 	DEFW	#0010,#0026
0220+  41F5 20 01 0C 00 	DEFW	#0120,#000C
0221+  41F9 02          	DEFB	#02	;Head place
0222+  41FA 12 00 27 00 	DEFW	#0012,#0027
0223+  41FE 1C 01 0A 00 	DEFW	#011C,#000A
0224+  4202 0F          	DEFB	#0F
0225+  4203 03          	DEFB	#03	;Углубление
0226+  4204 10 00 38 00 	DEFW	#0010,#0038
0227+  4208 20 01 0C 00 	DEFW	#0120,#000C
0228+  420C 02          	DEFB	#02	;Head place
0229+  420D 12 00 39 00 	DEFW	#0012,#0039
0230+  4211 1C 01 0A 00 	DEFW	#011C,#000A
0231+  4215 0F          	DEFB	#0F
0232+  4216 00          	DEFB	#00
0233+  4217 97          	SUB	A
0234+  4218 32 9C 46    	LD	(OverWriteFlg),A
0235+  421B 21 8A A5    	LD	HL,LeftPanel
0236+  421E FD CB 00 46 	BIT	0,(IY+PanelFlg)
0237+  4222 28 03       	JR	Z,$+5
0238+  4224 21 B6 A6    	LD	HL,RightPanel
0239+  4227 01 2C 00    	LD	BC,BegPath
0240+  422A 09          	ADD	HL,BC
0241+  422B 22 92 46    	LD	(CopyFrom),HL
0242+  422E 21 B1 47    	LD	HL,CurPath
0243+  4231 22 94 46    	LD	(CopyTo),HL
0244+  4234             
0245+  4234 CD 9C A0    	CALL	SetClock
0246+  4237 FD E5       	PUSH	IY
0247+  4239 DB E2       	IN	A,(PAGE3)
0248+  423B F5          	PUSH	AF
0249+  423C FD CB 00 46 	BIT	0,(IY+PanelFlg)
0250+  4240 3A EE A7    	LD	A,(DIRpage1)
0251+  4243 28 03       	JR	Z,$+5
0252+  4245 3A EF A7    	LD	A,(DIRpage2)
0253+  4248 D3 E2       	OUT	(PAGE3),A
0254+  424A             CopyNextFile
0255+  424A CD CA 46    	CALL	PrnFromTo
0256+  424D DD 2A 90 46 	LD	IX,(AdrCopyFile)
0257+  4251 DD 6E 0F    	LD	L,(IX+#0F)
0258+  4254 DD 66 10    	LD	H,(IX+#10)
0259+  4257 DD 5E 11    	LD	E,(IX+#11)
0260+  425A DD 56 12    	LD	D,(IX+#12)
0261+  425D 22 9F 46    	LD	(ReadLen),HL
0262+  4260 ED 53 A1 46 	LD	(ReadLen+2),DE
0263+  4264 22 A3 46    	LD	(WriteLen),HL
0264+  4267 ED 53 A5 46 	LD	(WriteLen+2),DE
0265+  426B CD AA 46    	CALL	ConvLenToBank
0266+  426E 22 9B 42    	LD	(FileBnL+1),HL
0267+  4271 ED 53 94 42 	LD	(FileBnH+1),DE
0268+  4275             
0269+  4275 DD 21 92 47 	LD	IX,ProcessOne
0270+  4279 29          	ADD	HL,HL
0271+  427A EB          	EX	DE,HL
0272+  427B ED 6A       	ADC	HL,HL
0273+  427D EB          	EX	DE,HL
0274+  427E DD 75 0A    	LD	(IX+ProcMAXl1),L
0275+  4281 DD 74 0B    	LD	(IX+ProcMAXh1),H
0276+  4284 DD 73 0C    	LD	(IX+ProcMAXl2),E
0277+  4287 DD 72 0D    	LD	(IX+ProcMAXh2),D
0278+  428A CD E6 99    	CALL	InitProcess
0279+  428D CD 45 9A    	CALL	PrnProcess
0280+  4290             
0281+  4290 2A 9D 46    	LD	HL,(FreeBanks)
0282+  4293 11 00 00    FileBnH	LD	DE,#0000
0283+  4296 7A          	LD	A,D
0284+  4297 B3          	OR	E
0285+  4298 20 09       	JR	NZ,CopyLp1
0286+  429A 11 00 00    FileBnL	LD	DE,#0000
0287+  429D B7          	OR	A
0288+  429E ED 52       	SBC	HL,DE
0289+  42A0 30 02       	JR	NC,$+4
0290+  42A2 19          	ADD	HL,DE
0291+  42A3 EB          CopyLp1	EX	DE,HL
0292+  42A4 43          	LD	B,E
0293+  42A5 0E 3D       	LD	C,#3D
0294+  42A7 D7          	RST	#10
0295+  42A8 32 A9 46    	LD	(MemIndef),A
0296+  42AB 21 00 84    	LD	HL,PagesList
0297+  42AE 0E C5       	LD	C,#C5
0298+  42B0 CF          	RST	#08
0299+  42B1             
0300+  42B1 2A 92 46    	LD	HL,(CopyFrom)	;Открываем файл	источник
0301+  42B4 0E 1D       	LD	C,#1D
0302+  42B6 D7          	RST	#10
0303+  42B7 DA C0 44    	JP	C,CopyError1
0304+  42BA             
0305+  42BA 2A 90 46    	LD	HL,(AdrCopyFile)
0306+  42BD 23          	INC	HL
0307+  42BE 11 00 80    	LD	DE,WorkBuffer
0308+  42C1 D5          	PUSH	DE
0309+  42C2 CD 6A BE    	CALL	MakeDOSname
0310+  42C5 E1          	POP	HL
0311+  42C6 3E 01       	LD	A,#01
0312+  42C8 0E 11       	LD	C,#11
0313+  42CA D7          	RST	#10
0314+  42CB DA C0 44    	JP	C,CopyError1
0315+  42CE 32 A7 46    	LD	(FHandle1),A
0316+  42D1             
0317+  42D1 2A 94 46    	LD	HL,(CopyTo)	;Открываем файл	приемник
0318+  42D4 0E 1D       	LD	C,#1D
0319+  42D6 D7          	RST	#10
0320+  42D7 DA B8 44    	JP	C,CopyError2
0321+  42DA DD 2A 90 46 	LD	IX,(AdrCopyFile)
0322+  42DE 2A 90 46    	LD	HL,(AdrCopyFile)
0323+  42E1 23          	INC	HL
0324+  42E2 11 00 80    	LD	DE,WorkBuffer
0325+  42E5 D5          	PUSH	DE
0326+  42E6 CD 6A BE    	CALL	MakeDOSname
0327+  42E9 E1          	POP	HL
0328+  42EA 3A 9C 46    	LD	A,(OverWriteFlg)
0329+  42ED B7          	OR	A
0330+  42EE 0E 0B       	LD	C,#0B
0331+  42F0 28 02       	JR	Z,$+4
0332+  42F2 0E 0A       	LD	C,#0A
0333+  42F4 DD 7E 0E    	LD	A,(IX+#0E)
0334+  42F7 D7          	RST	#10
0335+  42F8 30 08       	JR	NC,CopyLp2
0336+  42FA FE 07       	CP	#07
0337+  42FC C2 B8 44    	JP	NZ,CopyError2
0338+  42FF CD 01 45    	CALL	OverWrite
0339+  4302 32 A8 46    CopyLp2	LD	(FHandle2),A
0340+  4305             
0341+  4305 2A 9F 46    	LD	HL,(ReadLen)
0342+  4308 7C          	LD	A,H
0343+  4309 B5          	OR	L
0344+  430A 2A A1 46    	LD	HL,(ReadLen+2)
0345+  430D B4          	OR	H
0346+  430E B5          	OR	L
0347+  430F CA ED 43    	JP	Z,CloseFiles
0348+  4312             
0349+  4312             ReadFile
0350+  4312 DB E2       	IN	A,(PAGE3)
0351+  4314 F5          	PUSH	AF
0352+  4315 21 00 84    	LD	HL,PagesList
0353+  4318 7E          	LD	A,(HL)
0354+  4319 23          ReadLp1	INC	HL
0355+  431A E5          	PUSH	HL
0356+  431B D3 E2       	OUT	(PAGE3),A
0357+  431D 0E 31       	LD	C,#31
0358+  431F D7          	RST	#10
0359+  4320 21 1B 01    	LD	HL,#011B
0360+  4323 B7          	OR	A
0361+  4324 ED 52       	SBC	HL,DE
0362+  4326 CA CE 44    	JP	Z,CopyBreak
0363+  4329 2A 9F 46    	LD	HL,(ReadLen)
0364+  432C ED 5B A1 46 	LD	DE,(ReadLen+2)
0365+  4330 01 00 40    	LD	BC,#4000
0366+  4333 B7          	OR	A
0367+  4334 ED 42       	SBC	HL,BC
0368+  4336 06 00       	LD	B,#00
0369+  4338 EB          	EX	DE,HL
0370+  4339 ED 42       	SBC	HL,BC
0371+  433B EB          	EX	DE,HL
0372+  433C 38 21       	JR	C,ReadEnd
0373+  433E 22 9F 46    	LD	(ReadLen),HL
0374+  4341 ED 53 A1 46 	LD	(ReadLen+2),DE
0375+  4345 21 00 C0    	LD	HL,#C000
0376+  4348 11 00 40    	LD	DE,#4000
0377+  434B 3A A7 46    	LD	A,(FHandle1)
0378+  434E 0E 13       	LD	C,#13
0379+  4350 D7          	RST	#10
0380+  4351 CD 34 47    	CALL	NextProcess
0381+  4354 E1          	POP	HL
0382+  4355 7E          	LD	A,(HL)
0383+  4356 FE FF       	CP	#FF
0384+  4358 20 BF       	JR	NZ,ReadLp1
0385+  435A F1          	POP	AF
0386+  435B D3 E2       	OUT	(PAGE3),A
0387+  435D 18 1A       	JR	WriteFile
0388+  435F             ReadEnd
0389+  435F 21 00 C0    	LD	HL,#C000
0390+  4362 ED 5B 9F 46 	LD	DE,(ReadLen)
0391+  4366 7A          	LD	A,D
0392+  4367 B3          	OR	E
0393+  4368 3A A7 46    	LD	A,(FHandle1)
0394+  436B 0E 13       	LD	C,#13
0395+  436D F5          	PUSH	AF
0396+  436E C4 10 00    	CALL	NZ,#0010
0397+  4371 F1          	POP	AF
0398+  4372 C4 34 47    	CALL	NZ,NextProcess
0399+  4375 E1          	POP	HL
0400+  4376 F1          	POP	AF
0401+  4377 D3 E2       	OUT	(PAGE3),A
0402+  4379             
0403+  4379             WriteFile
0404+  4379 DB E2       	IN	A,(PAGE3)
0405+  437B F5          	PUSH	AF
0406+  437C 21 00 84    	LD	HL,PagesList
0407+  437F 7E          	LD	A,(HL)
0408+  4380 23          WriteL1	INC	HL
0409+  4381 E5          	PUSH	HL
0410+  4382 D3 E2       	OUT	(PAGE3),A
0411+  4384 0E 31       	LD	C,#31
0412+  4386 D7          	RST	#10
0413+  4387 21 1B 01    	LD	HL,#011B
0414+  438A B7          	OR	A
0415+  438B ED 52       	SBC	HL,DE
0416+  438D CA CE 44    	JP	Z,CopyBreak
0417+  4390 2A A3 46    	LD	HL,(WriteLen)
0418+  4393 ED 5B A5 46 	LD	DE,(WriteLen+2)
0419+  4397 01 00 40    	LD	BC,#4000
0420+  439A B7          	OR	A
0421+  439B ED 42       	SBC	HL,BC
0422+  439D 06 00       	LD	B,#00
0423+  439F EB          	EX	DE,HL
0424+  43A0 ED 42       	SBC	HL,BC
0425+  43A2 EB          	EX	DE,HL
0426+  43A3 38 2E       	JR	C,WriteEnd
0427+  43A5 22 A3 46    	LD	(WriteLen),HL
0428+  43A8 ED 53 A5 46 	LD	(WriteLen+2),DE
0429+  43AC 21 00 C0    	LD	HL,#C000
0430+  43AF 11 00 40    	LD	DE,#4000
0431+  43B2 3A A8 46    	LD	A,(FHandle2)
0432+  43B5 0E 14       	LD	C,#14
0433+  43B7 D7          	RST	#10
0434+  43B8 CD 34 47    	CALL	NextProcess
0435+  43BB E1          	POP	HL
0436+  43BC 7E          	LD	A,(HL)
0437+  43BD FE FF       	CP	#FF
0438+  43BF 20 BF       	JR	NZ,WriteL1
0439+  43C1 F1          	POP	AF
0440+  43C2 D3 E2       	OUT	(PAGE3),A
0441+  43C4 2A 9F 46    	LD	HL,(ReadLen)
0442+  43C7 7C          	LD	A,H
0443+  43C8 B5          	OR	L
0444+  43C9 2A A1 46    	LD	HL,(ReadLen+2)
0445+  43CC B4          	OR	H
0446+  43CD B5          	OR	L
0447+  43CE 28 1D       	JR	Z,CloseFiles
0448+  43D0 C3 12 43    	JP	ReadFile
0449+  43D3             WriteEnd
0450+  43D3 21 00 C0    	LD	HL,#C000
0451+  43D6 ED 5B A3 46 	LD	DE,(WriteLen)
0452+  43DA 7A          	LD	A,D
0453+  43DB B3          	OR	E
0454+  43DC 3A A8 46    	LD	A,(FHandle2)
0455+  43DF 0E 14       	LD	C,#14
0456+  43E1 F5          	PUSH	AF
0457+  43E2 C4 10 00    	CALL	NZ,#0010
0458+  43E5 F1          	POP	AF
0459+  43E6 C4 34 47    	CALL	NZ,NextProcess
0460+  43E9 E1          	POP	HL
0461+  43EA F1          	POP	AF
0462+  43EB D3 E2       	OUT	(PAGE3),A
0463+  43ED             
0464+  43ED             CloseFiles
0465+  43ED 3A A7 46    	LD	A,(FHandle1)
0466+  43F0 0E 17       	LD	C,#17
0467+  43F2 D7          	RST	#10
0468+  43F3 3A A8 46    	LD	A,(FHandle2)
0469+  43F6 0E 18       	LD	C,#18
0470+  43F8 D7          	RST	#10
0471+  43F9             
0472+  43F9 3A A8 46    	LD	A,(FHandle2)
0473+  43FC 0E 12       	LD	C,#12
0474+  43FE D7          	RST	#10
0475+  43FF             CloseFile1
0476+  43FF 3A A7 46    	LD	A,(FHandle1)
0477+  4402 0E 12       	LD	C,#12
0478+  4404 D7          	RST	#10
0479+  4405 3A A9 46    	LD	A,(MemIndef)
0480+  4408 0E 3E       	LD	C,#3E
0481+  440A D7          	RST	#10
0482+  440B             
0483+  440B DD 2A 90 46 	LD	IX,(AdrCopyFile)
0484+  440F DD CB 00 86 	RES	0,(IX+#00)
0485+  4413 2A 98 46    	LD	HL,(ECopyBytes)
0486+  4416 DD 5E 0F    	LD	E,(IX+#0F)
0487+  4419 DD 56 10    	LD	D,(IX+#10)
0488+  441C B7          	OR	A
0489+  441D ED 52       	SBC	HL,DE
0490+  441F 22 98 46    	LD	(ECopyBytes),HL
0491+  4422 2A 9A 46    	LD	HL,(ECopyBytes+2)
0492+  4425 DD 5E 11    	LD	E,(IX+#11)
0493+  4428 DD 56 12    	LD	D,(IX+#12)
0494+  442B ED 52       	SBC	HL,DE
0495+  442D 22 9A 46    	LD	(ECopyBytes+2),HL
0496+  4430 2A 96 46    	LD	HL,(ECopyFiles)
0497+  4433 7C          	LD	A,H
0498+  4434 B5          	OR	L
0499+  4435 28 19       	JR	Z,CopyEnd
0500+  4437 2B          	DEC	HL
0501+  4438 22 96 46    	LD	(ECopyFiles),HL
0502+  443B 7C          	LD	A,H
0503+  443C B5          	OR	L
0504+  443D 28 11       	JR	Z,CopyEnd
0505+  443F 2A 90 46    	LD	HL,(AdrCopyFile)
0506+  4442 11 18 00    	LD	DE,#0018
0507+  4445 19          	ADD	HL,DE
0508+  4446 CB 46       	BIT	0,(HL)
0509+  4448 28 FB       	JR	Z,$-3
0510+  444A 22 90 46    	LD	(AdrCopyFile),HL
0511+  444D C3 4A 42    	JP	CopyNextFile
0512+  4450             
0513+  4450 F1          CopyEnd	POP	AF
0514+  4451 D3 E2       	OUT	(PAGE3),A
0515+  4453 FD E1       	POP	IY
0516+  4455 CD F0 86    	CALL	MakeWindow
0517+  4458 7F          	DEFB	#7F
0518+  4459 00          	DEFB	#00
0519+  445A 2A 96 46    	LD	HL,(ECopyFiles)
0520+  445D FD 75 19    	LD	(IY+PanelMFl),L
0521+  4460 FD 74 1A    	LD	(IY+PanelMFh),H
0522+  4463 2A 98 46    	LD	HL,(ECopyBytes)
0523+  4466 FD 75 1B    	LD	(IY+PanelMBl1),L
0524+  4469 FD 74 1C    	LD	(IY+PanelMBh1),H
0525+  446C 2A 9A 46    	LD	HL,(ECopyBytes+2)
0526+  446F FD 75 1D    	LD	(IY+PanelMBl2),L
0527+  4472 FD 74 1E    	LD	(IY+PanelMBh2),H
0528+  4475 FD E5       	PUSH	IY
0529+  4477 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0530+  447B FD 21 B6 A6 	LD	IY,RightPanel
0531+  447F 28 04       	JR	Z,$+6
0532+  4481 FD 21 8A A5 	LD	IY,LeftPanel
0533+  4485 FD E5       	PUSH	IY
0534+  4487 E1          	POP	HL
0535+  4488 11 2C 00    	LD	DE,BegPath
0536+  448B 19          	ADD	HL,DE
0537+  448C 0E 1D       	LD	C,#1D
0538+  448E FD E5       	PUSH	IY
0539+  4490 D7          	RST	#10
0540+  4491 FD E1       	POP	IY
0541+  4493 F5          	PUSH	AF
0542+  4494 DC A8 86    	CALL	C,DOSError
0543+  4497 F1          	POP	AF
0544+  4498 D4 FD BC    	CALL	NC,RefreshDIR
0545+  449B FD E1       	POP	IY
0546+  449D FD E5       	PUSH	IY
0547+  449F E1          	POP	HL
0548+  44A0 11 2C 00    	LD	DE,BegPath
0549+  44A3 19          	ADD	HL,DE
0550+  44A4 0E 1D       	LD	C,#1D
0551+  44A6 FD E5       	PUSH	IY
0552+  44A8 D7          	RST	#10
0553+  44A9 FD E1       	POP	IY
0554+  44AB DA 3C BC    	JP	C,BegDIRECTORY
0555+  44AE CD 45 B5    	CALL	PrintDIR
0556+  44B1 CD EE B2    	CALL	PrnFileInfo
0557+  44B4 CD 3C A1    	CALL	SetMouse
0558+  44B7 C9          	RET 
0559+  44B8             CopyError2
0560+  44B8 F5          	PUSH	AF
0561+  44B9 3A A7 46    	LD	A,(FHandle1)
0562+  44BC 0E 12       	LD	C,#12
0563+  44BE D7          	RST	#10
0564+  44BF F1          	POP	AF
0565+  44C0             CopyError1
0566+  44C0 F5          	PUSH	AF
0567+  44C1 3A A9 46    	LD	A,(MemIndef)
0568+  44C4 0E 3E       	LD	C,#3E
0569+  44C6 D7          	RST	#10
0570+  44C7 F1          	POP	AF
0571+  44C8 CD A8 86    	CALL	DOSError
0572+  44CB C3 50 44    	JP	CopyEnd
0573+  44CE             CopyBreak
0574+  44CE E1          	POP	HL
0575+  44CF F1          	POP	AF
0576+  44D0 D3 E2       	OUT	(PAGE3),A
0577+  44D2 3A A8 46    	LD	A,(FHandle2)
0578+  44D5 0E 12       	LD	C,#12
0579+  44D7 D7          	RST	#10
0580+  44D8 3A A7 46    	LD	A,(FHandle1)
0581+  44DB 0E 12       	LD	C,#12
0582+  44DD D7          	RST	#10
0583+  44DE 3A A9 46    	LD	A,(MemIndef)
0584+  44E1 0E 3E       	LD	C,#3E
0585+  44E3 D7          	RST	#10
0586+  44E4 DD 2A 90 46 	LD	IX,(AdrCopyFile)
0587+  44E8 2A 90 46    	LD	HL,(AdrCopyFile)
0588+  44EB 23          	INC	HL
0589+  44EC 11 00 80    	LD	DE,WorkBuffer
0590+  44EF D5          	PUSH	DE
0591+  44F0 CD 6A BE    	CALL	MakeDOSname
0592+  44F3 E1          	POP	HL
0593+  44F4 DD 7E 0E    	LD	A,(IX+#0E)
0594+  44F7 0E 0E       	LD	C,#0E		;DELETE
0595+  44F9 FD E5       	PUSH	IY
0596+  44FB D7          	RST	#10
0597+  44FC FD E1       	POP	IY
0598+  44FE C3 50 44    	JP	CopyEnd
0599+  4501             ;--------------------------------------------------------------
0600+  4501             OverWrite
0601+  4501 CD 3C A1    	CALL	SetMouse
0602+  4504 CD F0 86    	CALL	MakeWindow
0603+  4507 01          	DEFB	#01
0604+  4508 B4 00 58 00 	DEFW	#00B4,#0058
0605+  450C 18 01 38 00 	DEFW	#0118,#0038
0606+  4510 02          	DEFB	#02	;Head place
0607+  4511 04 00 02 00 	DEFW	#0004,#0002
0608+  4515 10 01 0A 00 	DEFW	#0110,#000A
0609+  4519 02          	DEFB	#02
0610+  451A 01          	DEFB	#01	;Text Line
0611+  451B 74 00 03 00 	DEFW	#0074,#0003
0612+  451F 2F          	DEFB	#2F
0613+  4520             	DEFB	"Message",0
0613+  4520 4D65737361676500
0614+  4528 01          	DEFB	#01	;Text Line
0615+  4529 50 00 10 00 	DEFW	#0050,#0010
0616+  452D 80          	DEFB	#80
0617+  452E             	DEFB	"The following file EXISTS:",0
0617+  452E 54686520666F6C6C6F77696E672066696C65204558495354533A00
0618+  4549 04          	DEFB	#04	;UpRectan
0619+  454A 10 00 26 00 	DEFW	#0010,#0026
0620+  454E 38 00 0E 00 	DEFW	#0038,#000E
0621+  4552 01          	DEFB	#01	;Text Line
0622+  4553 16 00 29 00 	DEFW	#0016,#0029
0623+  4557 80          	DEFB	#80
0624+  4558             	DEFB	"OverWrite",0
0624+  4558 4F766572577269746500
0625+  4562 04          	DEFB	#04	;UpRectan
0626+  4563 50 00 26 00 	DEFW	#0050,#0026
0627+  4567 38 00 0E 00 	DEFW	#0038,#000E
0628+  456B 01          	DEFB	#01	;Text Line
0629+  456C 66 00 29 00 	DEFW	#0066,#0029
0630+  4570 80          	DEFB	#80
0631+  4571 41 6C 6C 00 	DEFB	"All",0
0632+  4575 04          	DEFB	#04	;UpRectan
0633+  4576 90 00 26 00 	DEFW	#0090,#0026
0634+  457A 38 00 0E 00 	DEFW	#0038,#000E
0635+  457E 01          	DEFB	#01	;Text Line
0636+  457F A2 00 29 00 	DEFW	#00A2,#0029
0637+  4583 80          	DEFB	#80
0638+  4584 536B697000  	DEFB	"Skip",0
0639+  4589 04          	DEFB	#04	;UpRectan
0640+  458A D0 00 26 00 	DEFW	#00D0,#0026
0641+  458E 38 00 0E 00 	DEFW	#0038,#000E
0642+  4592 01          	DEFB	#01	;Text Line
0643+  4593 DC 00 29 00 	DEFW	#00DC,#0029
0644+  4597 80          	DEFB	#80
0645+  4598             	DEFB	"Cancel",0
0645+  4598 43616E63656C00
0646+  459F 00          	DEFB	#00
0647+  45A0 2A 94 46    	LD	HL,(CopyTo)
0648+  45A3 11 00 80    	LD	DE,WorkBuffer
0649+  45A6 97          	SUB	A
0650+  45A7 ED A0       	LDI 
0651+  45A9 BE          	CP	(HL)
0652+  45AA 20 FB       	JR	NZ,$-3
0653+  45AC 2B          	DEC	HL
0654+  45AD 3E 5C       	LD	A,"\\"
0655+  45AF BE          	CP	(HL)
0656+  45B0 28 02       	JR	Z,$+4
0657+  45B2 12          	LD	(DE),A
0658+  45B3 13          	INC	DE
0659+  45B4 2A 90 46    	LD	HL,(AdrCopyFile)
0660+  45B7 23          	INC	HL
0661+  45B8 CD 6A BE    	CALL	MakeDOSname
0662+  45BB DD 21 F8 00 	LD	IX,#00F8
0663+  45BF 21 00 80    	LD	HL,WorkBuffer
0664+  45C2 11 40 01    	LD	DE,#0140
0665+  45C5 01 72 00    	LD	BC,#0072
0666+  45C8 3E 80       	LD	A,#80
0667+  45CA CD 39 8F    	CALL	PrnRangPathC
0668+  45CD DD 21 26 72 OvWrtLp	LD	IX,OverWrtTab
0669+  45D1 CD 1C 9B    	CALL	TestCoords
0670+  45D4 0E 31       	LD	C,#31
0671+  45D6 D7          	RST	#10
0672+  45D7 28 F4       	JR	Z,OvWrtLp
0673+  45D9 78          	LD	A,B
0674+  45DA B7          	OR	A
0675+  45DB 20 F0       	JR	NZ,OvWrtLp
0676+  45DD 7B          	LD	A,E
0677+  45DE FE 1B       	CP	#1B
0678+  45E0 21 72 46    	LD	HL,OverExit
0679+  45E3 28 25       	JR	Z,OvrJump
0680+  45E5 FE 0D       	CP	#0D
0681+  45E7 21 15 46    	LD	HL,OverWrtFile
0682+  45EA 28 1E       	JR	Z,OvrJump
0683+  45EC CB AF       	RES	5,A
0684+  45EE FE 4F       	CP	"O"
0685+  45F0 21 15 46    	LD	HL,OverWrtFile
0686+  45F3 28 15       	JR	Z,OvrJump
0687+  45F5 FE 41       	CP	"A"
0688+  45F7 21 10 46    	LD	HL,OverWrtAll
0689+  45FA 28 0E       	JR	Z,OvrJump
0690+  45FC FE 53       	CP	"S"
0691+  45FE 21 2F 46    	LD	HL,OverSkip
0692+  4601 28 07       	JR	Z,OvrJump
0693+  4603 FE 43       	CP	"C"
0694+  4605 20 C6       	JR	NZ,OvWrtLp
0695+  4607 21 72 46    	LD	HL,OverExit
0696+  460A CD F0 86    OvrJump	CALL	MakeWindow
0697+  460D 7F          	DEFB	#7F
0698+  460E 00          	DEFB	#00
0699+  460F E9          	JP	(HL)
0700+  4610             OverWrtAll
0701+  4610 3E 01       	LD	A,#01
0702+  4612 32 9C 46    	LD	(OverWriteFlg),A
0703+  4615             OverWrtFile
0704+  4615 CD 9C A0    	CALL	SetClock
0705+  4618 DD 2A 90 46 	LD	IX,(AdrCopyFile)
0706+  461C 2A 90 46    	LD	HL,(AdrCopyFile)
0707+  461F 23          	INC	HL
0708+  4620 11 00 80    	LD	DE,WorkBuffer
0709+  4623 D5          	PUSH	DE
0710+  4624 CD 6A BE    	CALL	MakeDOSname
0711+  4627 E1          	POP	HL
0712+  4628 DD 7E 0E    	LD	A,(IX+#0E)
0713+  462B 0E 0A       	LD	C,#0A
0714+  462D D7          	RST	#10
0715+  462E C9          	RET 
0716+  462F             OverSkip
0717+  462F CD 9C A0    	CALL	SetClock
0718+  4632 DD 2A 90 46 	LD	IX,(AdrCopyFile)
0719+  4636 DD 6E 0F    	LD	L,(IX+#0F)
0720+  4639 DD 66 10    	LD	H,(IX+#10)
0721+  463C DD 5E 11    	LD	E,(IX+#11)
0722+  463F DD 56 12    	LD	D,(IX+#12)
0723+  4642 CD AA 46    	CALL	ConvLenToBank
0724+  4645 29          	ADD	HL,HL
0725+  4646 EB          	EX	DE,HL
0726+  4647 ED 6A       	ADC	HL,HL
0727+  4649 EB          	EX	DE,HL
0728+  464A DD 21 7F 47 	LD	IX,ProcessAll
0729+  464E DD 4E 0E    	LD	C,(IX+ProcCURl1)
0730+  4651 DD 46 0F    	LD	B,(IX+ProcCURh1)
0731+  4654 09          	ADD	HL,BC
0732+  4655 DD 75 0E    	LD	(IX+ProcCURl1),L
0733+  4658 DD 74 0F    	LD	(IX+ProcCURh1),H
0734+  465B DD 4E 10    	LD	C,(IX+ProcCURl2)
0735+  465E DD 46 11    	LD	B,(IX+ProcCURh2)
0736+  4661 EB          	EX	DE,HL
0737+  4662 ED 4A       	ADC	HL,BC
0738+  4664 DD 75 10    	LD	(IX+ProcCURl2),L
0739+  4667 DD 74 11    	LD	(IX+ProcCURh2),H
0740+  466A CD 45 9A    	CALL	PrnProcess
0741+  466D 21 FF 43    	LD	HL,CloseFile1
0742+  4670 E3          	EX	(SP),HL
0743+  4671 C9          	RET 
0744+  4672             OverExit
0745+  4672 33          	INC	SP
0746+  4673 33          	INC	SP
0747+  4674 DD 2A 90 46 	LD	IX,(AdrCopyFile)
0748+  4678 DD CB 00 46 	BIT	0,(IX+#00)
0749+  467C CA FF 43    	JP	Z,CloseFile1
0750+  467F 3A A7 46    	LD	A,(FHandle1)
0751+  4682 0E 12       	LD	C,#12
0752+  4684 D7          	RST	#10
0753+  4685 3A A9 46    	LD	A,(MemIndef)
0754+  4688 0E 3E       	LD	C,#3E
0755+  468A D7          	RST	#10
0756+  468B FD E1       	POP	IY
0757+  468D C3 50 44    	JP	CopyEnd
0758+  4690             ;--------------------------------------------------------------
0759+  4690             AdrCopyFile
0760+  4690 00 00       	DEFW	#0000		;Адрес описателя текущего файла
0761+  4692             CopyFrom
0762+  4692 00 00       	DEFW	#0000		;Адрес пути откуда
0763+  4694             CopyTo
0764+  4694 00 00       	DEFW	#0000		;Адрес пути куда
0765+  4696             ECopyFiles
0766+  4696 00 00       	DEFW	#0000		;Кол-во	копируемых файлов
0767+  4698             ECopyBytes
0768+  4698 00          	DEFS	4,0		;Кол-во	копируемых байтов
0769+  469C             OverWriteFlg
0770+  469C 00          	DEFB	#00		;Флаг перезаписи файлов
0771+  469D             FreeBanks
0772+  469D 00 00       	DEFW	#0000		;Кол-во	свободных банков
0773+  469F             ReadLen
0774+  469F 00          	DEFS	4,0		;Длина читаемого файла
0775+  46A3             WriteLen
0776+  46A3 00          	DEFS	4,0		;Длина записываемого файла
0777+  46A7             FHandle1
0778+  46A7 00          	DEFB	#00		;Файл источник
0779+  46A8             FHandle2
0780+  46A8 00          	DEFB	#00		;Файл приемник
0781+  46A9             MemIndef
0782+  46A9 00          	DEFB	#00		;Индефик.памяти	под копирование
0783+  46AA             ;--------------------------------------------------------------
0784+  46AA             ConvLenToBank
0785+  46AA 7C          	LD	A,H
0786+  46AB 65          	LD	H,L
0787+  46AC 2E 00       	LD	L,#00
0788+  46AE CB 27       	SLA	A
0789+  46B0 CB 13       	RL	E
0790+  46B2 CB 12       	RL	D
0791+  46B4 CB 15       	RL	L
0792+  46B6 CB 27       	SLA	A
0793+  46B8 CB 13       	RL	E
0794+  46BA CB 12       	RL	D
0795+  46BC CB 15       	RL	L
0796+  46BE B4          	OR	H
0797+  46BF 26 00       	LD	H,#00
0798+  46C1 EB          	EX	DE,HL
0799+  46C2 28 01       	JR	Z,$+3
0800+  46C4 23          	INC	HL
0801+  46C5 7C          	LD	A,H
0802+  46C6 B5          	OR	L
0803+  46C7 C0          	RET	NZ
0804+  46C8 13          	INC	DE
0805+  46C9 C9          	RET 
0806+  46CA             PrnFromTo
0807+  46CA 2A 92 46    	LD	HL,(CopyFrom)
0808+  46CD 11 00 80    	LD	DE,WorkBuffer
0809+  46D0 97          	SUB	A
0810+  46D1 ED A0       	LDI 
0811+  46D3 BE          	CP	(HL)
0812+  46D4 20 FB       	JR	NZ,$-3
0813+  46D6 2B          	DEC	HL
0814+  46D7 3E 5C       	LD	A,"\\"
0815+  46D9 BE          	CP	(HL)
0816+  46DA 28 02       	JR	Z,$+4
0817+  46DC 12          	LD	(DE),A
0818+  46DD 13          	INC	DE
0819+  46DE 2A 90 46    	LD	HL,(AdrCopyFile)
0820+  46E1 23          	INC	HL
0821+  46E2 CD 6A BE    	CALL	MakeDOSname
0822+  46E5 2A 94 46    	LD	HL,(CopyTo)
0823+  46E8 11 00 81    	LD	DE,WorkBuffer+#100
0824+  46EB 97          	SUB	A
0825+  46EC ED A0       	LDI 
0826+  46EE BE          	CP	(HL)
0827+  46EF 20 FB       	JR	NZ,$-3
0828+  46F1 2B          	DEC	HL
0829+  46F2 3E 5C       	LD	A,"\\"
0830+  46F4 BE          	CP	(HL)
0831+  46F5 28 02       	JR	Z,$+4
0832+  46F7 12          	LD	(DE),A
0833+  46F8 13          	INC	DE
0834+  46F9 2A 90 46    	LD	HL,(AdrCopyFile)
0835+  46FC 23          	INC	HL
0836+  46FD CD 6A BE    	CALL	MakeDOSname
0837+  4700 CD F0 86    	CALL	MakeWindow
0838+  4703 80          	DEFB	#80
0839+  4704 02          	DEFB	#02
0840+  4705 CC 00 61 00 	DEFW	#00CC,#0061
0841+  4709 00 01 12 00 	DEFW	#0100,#0012
0842+  470D 08          	DEFB	#08
0843+  470E 00          	DEFB	#00
0844+  470F DD 21 00 01 	LD	IX,#0100
0845+  4713 21 00 80    	LD	HL,WorkBuffer
0846+  4716 11 CC 00    	LD	DE,#00CC
0847+  4719 01 61 00    	LD	BC,#0061
0848+  471C 3E 80       	LD	A,#80
0849+  471E CD 4B 8E    	CALL	PrnRangPathL
0850+  4721 DD 21 00 01 	LD	IX,#0100
0851+  4725 21 00 81    	LD	HL,WorkBuffer+#100
0852+  4728 11 CC 00    	LD	DE,#00CC
0853+  472B 01 6B 00    	LD	BC,#006B
0854+  472E 3E 80       	LD	A,#80
0855+  4730 CD 4B 8E    	CALL	PrnRangPathL
0856+  4733 C9          	RET 
0857+  4734             NextProcess
0858+  4734 DD 21 7F 47 	LD	IX,ProcessAll
0859+  4738 DD 6E 0E    	LD	L,(IX+ProcCURl1)
0860+  473B DD 66 0F    	LD	H,(IX+ProcCURh1)
0861+  473E 23          	INC	HL
0862+  473F DD 75 0E    	LD	(IX+ProcCURl1),L
0863+  4742 DD 74 0F    	LD	(IX+ProcCURh1),H
0864+  4745 7C          	LD	A,H
0865+  4746 B5          	OR	L
0866+  4747 20 0D       	JR	NZ,NextPr1
0867+  4749 DD 6E 10    	LD	L,(IX+ProcCURl2)
0868+  474C DD 66 11    	LD	H,(IX+ProcCURh2)
0869+  474F 23          	INC	HL
0870+  4750 DD 75 10    	LD	(IX+ProcCURl2),L
0871+  4753 DD 74 11    	LD	(IX+ProcCURh2),H
0872+  4756 CD 45 9A    NextPr1	CALL	PrnProcess
0873+  4759 DD 21 92 47 	LD	IX,ProcessOne
0874+  475D DD 6E 0E    	LD	L,(IX+ProcCURl1)
0875+  4760 DD 66 0F    	LD	H,(IX+ProcCURh1)
0876+  4763 23          	INC	HL
0877+  4764 DD 75 0E    	LD	(IX+ProcCURl1),L
0878+  4767 DD 74 0F    	LD	(IX+ProcCURh1),H
0879+  476A 7C          	LD	A,H
0880+  476B B5          	OR	L
0881+  476C 20 0D       	JR	NZ,NextPr2
0882+  476E DD 6E 10    	LD	L,(IX+ProcCURl2)
0883+  4771 DD 66 11    	LD	H,(IX+ProcCURh2)
0884+  4774 23          	INC	HL
0885+  4775 DD 75 10    	LD	(IX+ProcCURl2),L
0886+  4778 DD 74 11    	LD	(IX+ProcCURh2),H
0887+  477B CD 45 9A    NextPr2	CALL	PrnProcess
0888+  477E C9          	RET 
0889+  477F             ProcessAll
0890+  477F B2 00       	DEFW	#00B2		;X позиция
0891+  4781 8A 00       	DEFW	#008A		;Y позиция
0892+  4783 1C 01       	DEFW	#011C		;Длина X
0893+  4785 00 00       	DEFW	#0000		;Коэффициент для процесса
0894+  4787 00 00       	DEFW	#0000		;Коррекция коэфициента
0895+  4789 00 00       	DEFW	#0000		;Максимум
0896+  478B 00 00       	DEFW	#0000
0897+  478D 00 00       	DEFW	#0000		;Текущее
0898+  478F 00 00       	DEFW	#0000
0899+  4791 4F          	DEFB	#4F
0900+  4792             ProcessOne
0901+  4792 B2 00       	DEFW	#00B2		;X позиция
0902+  4794 78 00       	DEFW	#0078		;Y позиция
0903+  4796 1C 01       	DEFW	#011C		;Длина X
0904+  4798 00 00       	DEFW	#0000		;Коэффициент для процесса
0905+  479A 00 00       	DEFW	#0000		;Коррекция коэфициента
0906+  479C 00 00       	DEFW	#0000		;Максимум
0907+  479E 00 00       	DEFW	#0000
0908+  47A0 00 00       	DEFW	#0000		;Текущее
0909+  47A2 00 00       	DEFW	#0000
0910+  47A4 4F          	DEFB	#4F
0911+  47A5             PathStr
0912+  47A5 80 00 00 00 	DEFB	#80,#00,#00,#00
0913+  47A9 00          PathLen	DEFB	#00
0914+  47AA AA 00 6A 00 	DEFW	#00AA,#006A
0915+  47AE 44 01       	DEFW	#0144
0916+  47B0 F0          	DEFB	#F0
0917+  47B1 00          CurPath	DEFS	#81,0
0918+  4832             ;[]==========================================================[]
0919+  4832             ReNameR
0920+  4832 FD 7E 13    	LD	A,(IY+PanelEFl)
0921+  4835 FD B6 14    	OR	(IY+PanelEFh)
0922+  4838 C8          	RET	Z
0923+  4839 3E C0       	LD	A,#C0
0924+  483B D3 89       	OUT	(YPORT),A
0925+  483D DB E2       	IN	A,(PAGE3)
0926+  483F F5          	PUSH	AF
0927+  4840 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0928+  4844 3A EE A7    	LD	A,(DIRpage1)
0929+  4847 28 03       	JR	Z,$+5
0930+  4849 3A EF A7    	LD	A,(DIRpage2)
0931+  484C D3 E2       	OUT	(PAGE3),A
0932+  484E FD 6E 15    	LD	L,(IY+PanelFFl)
0933+  4851 FD 66 16    	LD	H,(IY+PanelFFh)
0934+  4854 FD 5E 17    	LD	E,(IY+PanelCFl)
0935+  4857 FD 56 18    	LD	D,(IY+PanelCFh)
0936+  485A 19          	ADD	HL,DE
0937+  485B FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0938+  485F 28 19       	JR	Z,ReNameNr
0939+  4861 29          	ADD	HL,HL
0940+  4862 29          	ADD	HL,HL
0941+  4863 29          	ADD	HL,HL
0942+  4864 29          	ADD	HL,HL
0943+  4865 7C          	LD	A,H
0944+  4866 F6 C0       	OR	#C0
0945+  4868 67          	LD	H,A
0946+  4869 23          	INC	HL
0947+  486A 23          	INC	HL
0948+  486B 11 5F 4C    	LD	DE,CurName
0949+  486E 01 0D 00    	LD	BC,#000D
0950+  4871 ED B0       	LDIR 
0951+  4873 3E 10       	LD	A,#10
0952+  4875 32 5E 4C    	LD	(CurAttrib),A
0953+  4878 18 1C       	JR	ReNameN
0954+  487A             ReNameNr
0955+  487A 29          	ADD	HL,HL
0956+  487B 29          	ADD	HL,HL
0957+  487C 29          	ADD	HL,HL
0958+  487D 5D          	LD	E,L
0959+  487E 54          	LD	D,H
0960+  487F 29          	ADD	HL,HL
0961+  4880 19          	ADD	HL,DE
0962+  4881 7C          	LD	A,H
0963+  4882 F6 C0       	OR	#C0
0964+  4884 67          	LD	H,A
0965+  4885 E5          	PUSH	HL
0966+  4886 23          	INC	HL
0967+  4887 11 5F 4C    	LD	DE,CurName
0968+  488A CD 6A BE    	CALL	MakeDOSname
0969+  488D E1          	POP	HL
0970+  488E 01 0E 00    	LD	BC,#000E
0971+  4891 09          	ADD	HL,BC
0972+  4892 7E          	LD	A,(HL)
0973+  4893 32 5E 4C    	LD	(CurAttrib),A
0974+  4896 F1          ReNameN	POP	AF
0975+  4897 D3 E2       	OUT	(PAGE3),A
0976+  4899 21 5F 4C    	LD	HL,CurName
0977+  489C 7E          	LD	A,(HL)
0978+  489D FE 2E       	CP	"."
0979+  489F C8          	RET	Z
0980+  48A0 FE 5C       	CP	"\\"
0981+  48A2 C8          	RET	Z
0982+  48A3 11 78 4C    	LD	DE,Name
0983+  48A6 0E 00       	LD	C,#00
0984+  48A8 3E 20       	LD	A,#20
0985+  48AA ED A0       	LDI 
0986+  48AC BE          	CP	(HL)
0987+  48AD 38 FB       	JR	C,$-3
0988+  48AF 79          	LD	A,C
0989+  48B0 ED 44       	NEG 
0990+  48B2 32 70 4C    	LD	(NameLen),A
0991+  48B5 CD F9 BA    	CALL	ResInvert
0992+  48B8 21 EA BA    	LD	HL,SetInvert
0993+  48BB E5          	PUSH	HL
0994+  48BC 21 5F 4C    	LD	HL,CurName
0995+  48BF 11 2E 49    	LD	DE,RNfile
0996+  48C2 0E 0C       	LD	C,#0C
0997+  48C4 97          	SUB	A
0998+  48C5 ED A0       	LDI 
0999+  48C7 BE          	CP	(HL)
1000+  48C8 20 FB       	JR	NZ,$-3
1001+  48CA B1          	OR	C
1002+  48CB 28 07       	JR	Z,RNnxt
1003+  48CD 41          	LD	B,C
1004+  48CE 3E 20       	LD	A,#20
1005+  48D0 12          	LD	(DE),A
1006+  48D1 13          	INC	DE
1007+  48D2 10 FC       	DJNZ	$-2
1008+  48D4 CD F0 86    RNnxt	CALL	MakeWindow
1009+  48D7 01          	DEFB	#01
1010+  48D8 D0 00 51 00 	DEFW	#00D0,#0051
1011+  48DC E0 00 3E 00 	DEFW	#00E0,#003E
1012+  48E0 02          	DEFB	#02	;Head place
1013+  48E1 04 00 02 00 	DEFW	#0004,#0002
1014+  48E5 D8 00 0A 00 	DEFW	#00D8,#000A
1015+  48E9 00          	DEFB	#00
1016+  48EA 01          	DEFB	#01	;Text Line
1017+  48EB 5E 00 03 00 	DEFW	#005E,#0003
1018+  48EF 0F          	DEFB	#0F
1019+  48F0             	DEFB	"Rename",0
1019+  48F0 52656E616D6500
1020+  48F7 04          	DEFB	#04	;UpRectan
1021+  48F8 20 00 2A 00 	DEFW	#0020,#002A
1022+  48FC 48 00 0E 00 	DEFW	#0048,#000E
1023+  4900 01          	DEFB	#01	;Text Line
1024+  4901 3C 00 2D 00 	DEFW	#003C,#002D
1025+  4905 80          	DEFB	#80
1026+  4906 4F 6B 00    	DEFB	"Ok",0
1027+  4909 04          	DEFB	#04	;UpRectan
1028+  490A 78 00 2A 00 	DEFW	#0078,#002A
1029+  490E 48 00 0E 00 	DEFW	#0048,#000E
1030+  4912 01          	DEFB	#01	;Text Line
1031+  4913 8C 00 2D 00 	DEFW	#008C,#002D
1032+  4917 80          	DEFB	#80
1033+  4918             	DEFB	"Cancel",0
1033+  4918 43616E63656C00
1034+  491F 01          	DEFB	#01	;Text Line
1035+  4920 0E 00 11 00 	DEFW	#000E,#0011
1036+  4924 80          	DEFB	#80
1037+  4925             	DEFB	"Rename:  "
1037+  4925 52656E616D653A2020
1038+  492E             RNfile	DEFB	"            ",0
1038+  492E 20202020202020202020202000
1039+  493B 01          	DEFB	#01	;Text Line
1040+  493C 28 00 1D 00 	DEFW	#0028,#001D
1041+  4940 80          	DEFB	#80
1042+  4941 54 6F 3A 00 	DEFB	"To:",0
1043+  4945 03          	DEFB	#03	;Углубление
1044+  4946 3C 00 1A 00 	DEFW	#003C,#001A
1045+  494A 86 00 0C 00 	DEFW	#0086,#000C
1046+  494E 02          	DEFB	#02	;Head place
1047+  494F 3E 00 1B 00 	DEFW	#003E,#001B
1048+  4953 82 00 0A 00 	DEFW	#0082,#000A
1049+  4957 0F          	DEFB	#0F
1050+  4958 00          	DEFB	#00
1051+  4959 DD 21 6C 4C 	LD	IX,NameStr
1052+  495D 21 A8 72    	LD	HL,ReNameTab
1053+  4960 CD 68 91    	CALL	InputLine
1054+  4963 CD F0 86    	CALL	MakeWindow
1055+  4966 7F          	DEFB	#7F
1056+  4967 00          	DEFB	#00
1057+  4968 D8          	RET	C
1058+  4969 3A 70 4C    	LD	A,(NameLen)
1059+  496C B7          	OR	A
1060+  496D C8          	RET	Z
1061+  496E CD 9C A0    	CALL	SetClock
1062+  4971 21 3C A1    	LD	HL,SetMouse
1063+  4974 E3          	EX	(SP),HL
1064+  4975 E5          	PUSH	HL
1065+  4976 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1066+  497A 28 29       	JR	Z,ReName0
1067+  497C FD E5       	PUSH	IY
1068+  497E E1          	POP	HL
1069+  497F 11 2C 00    	LD	DE,BegPath
1070+  4982 19          	ADD	HL,DE
1071+  4983 11 00 80    	LD	DE,WorkBuffer
1072+  4986 D5          	PUSH	DE
1073+  4987 97          	SUB	A
1074+  4988 ED A0       	LDI 
1075+  498A BE          	CP	(HL)
1076+  498B 20 FB       	JR	NZ,$-3
1077+  498D EB          	EX	DE,HL
1078+  498E 3E 5C       	LD	A,"\\"
1079+  4990 2B          	DEC	HL
1080+  4991 BE          	CP	(HL)
1081+  4992 20 FC       	JR	NZ,$-2
1082+  4994 23          	INC	HL
1083+  4995 36 00       	LD	(HL),#00
1084+  4997 E1          	POP	HL
1085+  4998 0E 1D       	LD	C,#1D
1086+  499A FD E5       	PUSH	IY
1087+  499C D7          	RST	#10
1088+  499D FD E1       	POP	IY
1089+  499F F5          	PUSH	AF
1090+  49A0 DC A8 86    	CALL	C,DOSError
1091+  49A3 F1          	POP	AF
1092+  49A4 D8          	RET	C
1093+  49A5 21 5F 4C    ReName0	LD	HL,CurName
1094+  49A8 11 78 4C    	LD	DE,Name
1095+  49AB 0E 10       	LD	C,#10
1096+  49AD FD E5       	PUSH	IY
1097+  49AF D7          	RST	#10
1098+  49B0 FD E1       	POP	IY
1099+  49B2 F5          	PUSH	AF
1100+  49B3 DC A8 86    	CALL	C,DOSError
1101+  49B6 F1          	POP	AF
1102+  49B7 D8          	RET	C
1103+  49B8 3A 5E 4C    	LD	A,(CurAttrib)
1104+  49BB CB 67       	BIT	4,A
1105+  49BD C2 4D 4A    	JP	NZ,ReNameDIR
1106+  49C0 21 78 4C    	LD	HL,Name
1107+  49C3 11 CD BD    	LD	DE,PrevFile
1108+  49C6 3A 70 4C    	LD	A,(NameLen)
1109+  49C9 47          	LD	B,A
1110+  49CA 7E          	LD	A,(HL)
1111+  49CB CD 57 AA    	CALL	CorrBigChar
1112+  49CE 12          	LD	(DE),A
1113+  49CF 23          	INC	HL
1114+  49D0 13          	INC	DE
1115+  49D1 10 F7       	DJNZ	$-7
1116+  49D3 97          	SUB	A
1117+  49D4 12          	LD	(DE),A
1118+  49D5 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1119+  49D9 20 25       	JR	NZ,ReName1
1120+  49DB CD F5 A7    	CALL	ReadDIR
1121+  49DE CD 72 BD    	CALL	FindPrevFile
1122+  49E1 CD 45 B5    	CALL	PrintDIR
1123+  49E4 CD EE B2    	CALL	PrnFileInfo
1124+  49E7 FD E5       	PUSH	IY
1125+  49E9 DD E1       	POP	IX
1126+  49EB 11 05 00    	LD	DE,BegPBar
1127+  49EE DD 19       	ADD	IX,DE
1128+  49F0 CD F7 96    	CALL	InitScrBar
1129+  49F3 FD 7E 01    	LD	A,(IY+ViewFlg)
1130+  49F6 E6 03       	AND	#03
1131+  49F8 F5          	PUSH	AF
1132+  49F9 CC 35 97    	CALL	Z,PrnHScrBar
1133+  49FC F1          	POP	AF
1134+  49FD C4 8E 98    	CALL	NZ,PrnVScrBar
1135+  4A00 21 B6 A5    ReName1	LD	HL,LeftPanel+BegPath
1136+  4A03 11 E2 A6    	LD	DE,RightPanel+BegPath
1137+  4A06 1A          ReName2	LD	A,(DE)
1138+  4A07 BE          	CP	(HL)
1139+  4A08 C0          	RET	NZ
1140+  4A09 23          	INC	HL
1141+  4A0A 13          	INC	DE
1142+  4A0B 7E          	LD	A,(HL)
1143+  4A0C B7          	OR	A
1144+  4A0D 20 F7       	JR	NZ,ReName2
1145+  4A0F 1A          	LD	A,(DE)
1146+  4A10 B7          	OR	A
1147+  4A11 C0          	RET	NZ
1148+  4A12 FD E5       	PUSH	IY
1149+  4A14 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1150+  4A18 FD 21 B6 A6 	LD	IY,RightPanel
1151+  4A1C 28 04       	JR	Z,$+6
1152+  4A1E FD 21 8A A5 	LD	IY,LeftPanel
1153+  4A22 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1154+  4A26 20 22       	JR	NZ,ReNameE
1155+  4A28 CD F5 A7    	CALL	ReadDIR
1156+  4A2B CD 45 B5    	CALL	PrintDIR
1157+  4A2E CD EE B2    	CALL	PrnFileInfo
1158+  4A31 FD E5       	PUSH	IY
1159+  4A33 DD E1       	POP	IX
1160+  4A35 11 05 00    	LD	DE,BegPBar
1161+  4A38 DD 19       	ADD	IX,DE
1162+  4A3A CD F7 96    	CALL	InitScrBar
1163+  4A3D FD 7E 01    	LD	A,(IY+ViewFlg)
1164+  4A40 E6 03       	AND	#03
1165+  4A42 F5          	PUSH	AF
1166+  4A43 CC 35 97    	CALL	Z,PrnHScrBar
1167+  4A46 F1          	POP	AF
1168+  4A47 C4 8E 98    	CALL	NZ,PrnVScrBar
1169+  4A4A FD E1       ReNameE	POP	IY
1170+  4A4C C9          	RET 
1171+  4A4D             ReNameDIR
1172+  4A4D 21 78 4C    	LD	HL,Name
1173+  4A50 11 5D BE    	LD	DE,PrevDIR
1174+  4A53 3A 70 4C    	LD	A,(NameLen)
1175+  4A56 47          	LD	B,A
1176+  4A57 7E          	LD	A,(HL)
1177+  4A58 CD 6F AA    	CALL	CorrSmallChar
1178+  4A5B 77          	LD	(HL),A
1179+  4A5C 12          	LD	(DE),A
1180+  4A5D 23          	INC	HL
1181+  4A5E 13          	INC	DE
1182+  4A5F 10 F6       	DJNZ	$-8
1183+  4A61 97          	SUB	A
1184+  4A62 12          	LD	(DE),A
1185+  4A63 3A E3 A7    	LD	A,(TreeFlag)
1186+  4A66 B7          	OR	A
1187+  4A67 CA EC 4B    	JP	Z,ReNameExit
1188+  4A6A FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1189+  4A6E 08          	EX	AF,AF'
1190+  4A6F FD E5       	PUSH	IY
1191+  4A71 DB E2       	IN	A,(PAGE3)
1192+  4A73 F5          	PUSH	AF
1193+  4A74 FD 21 8A A5 	LD	IY,LeftPanel
1194+  4A78 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1195+  4A7C 20 04       	JR	NZ,$+6
1196+  4A7E FD 21 B6 A6 	LD	IY,RightPanel
1197+  4A82 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1198+  4A86 3A EE A7    	LD	A,(DIRpage1)
1199+  4A89 28 03       	JR	Z,$+5
1200+  4A8B 3A EF A7    	LD	A,(DIRpage2)
1201+  4A8E D3 E2       	OUT	(PAGE3),A
1202+  4A90 08          	EX	AF,AF'
1203+  4A91 28 18       	JR	Z,ReNameTree
1204+  4A93 FD 6E 15    	LD	L,(IY+PanelFFl)
1205+  4A96 FD 66 16    	LD	H,(IY+PanelFFh)
1206+  4A99 FD 5E 17    	LD	E,(IY+PanelCFl)
1207+  4A9C FD 56 18    	LD	D,(IY+PanelCFh)
1208+  4A9F 19          	ADD	HL,DE
1209+  4AA0 29          	ADD	HL,HL
1210+  4AA1 29          	ADD	HL,HL
1211+  4AA2 29          	ADD	HL,HL
1212+  4AA3 29          	ADD	HL,HL
1213+  4AA4 7C          	LD	A,H
1214+  4AA5 F6 C0       	OR	#C0
1215+  4AA7 67          	LD	H,A
1216+  4AA8 EB          	EX	DE,HL
1217+  4AA9 18 43       	JR	ReNameEx
1218+  4AAB             ReNameTree
1219+  4AAB FD CB 00 46 	BIT	0,(IY+PanelFlg)
1220+  4AAF 21 8A A5    	LD	HL,LeftPanel
1221+  4AB2 20 03       	JR	NZ,$+5
1222+  4AB4 21 B6 A6    	LD	HL,RightPanel
1223+  4AB7 11 2C 00    	LD	DE,BegPath
1224+  4ABA 19          	ADD	HL,DE
1225+  4ABB 23          	INC	HL
1226+  4ABC 23          	INC	HL
1227+  4ABD CD F0 B0    	CALL	FindTreeDIR
1228+  4AC0 DA 52 4B    	JP	C,ReNameT
1229+  4AC3 21 F1 BF    	LD	HL,#C001-#10
1230+  4AC6 01 10 00    	LD	BC,#0010
1231+  4AC9 09          	ADD	HL,BC
1232+  4ACA CB 46       	BIT	0,(HL)
1233+  4ACC 28 FB       	JR	Z,$-3
1234+  4ACE 09          	ADD	HL,BC
1235+  4ACF 2B          	DEC	HL
1236+  4AD0 E5          FRName1	PUSH	HL
1237+  4AD1 11 5F 4C    	LD	DE,CurName
1238+  4AD4 23          	INC	HL
1239+  4AD5 23          	INC	HL
1240+  4AD6 1A          FRName2	LD	A,(DE)
1241+  4AD7 B7          	OR	A
1242+  4AD8 28 0F       	JR	Z,FRName4
1243+  4ADA BE          	CP	(HL)
1244+  4ADB 20 04       	JR	NZ,FRName3
1245+  4ADD 23          	INC	HL
1246+  4ADE 13          	INC	DE
1247+  4ADF 18 F5       	JR	FRName2
1248+  4AE1 E1          FRName3	POP	HL
1249+  4AE2 CB 7E       	BIT	7,(HL)
1250+  4AE4 20 6C       	JR	NZ,ReNameT
1251+  4AE6 09          	ADD	HL,BC
1252+  4AE7 18 E7       	JR	FRName1
1253+  4AE9             FRName4
1254+  4AE9 7E          	LD	A,(HL)
1255+  4AEA B7          	OR	A
1256+  4AEB 20 F4       	JR	NZ,FRName3
1257+  4AED D1          	POP	DE
1258+  4AEE             ReNameEx
1259+  4AEE 21 78 4C    	LD	HL,Name
1260+  4AF1 13          	INC	DE
1261+  4AF2 13          	INC	DE
1262+  4AF3 0E 0D       	LD	C,#0D
1263+  4AF5 97          	SUB	A
1264+  4AF6 ED A0       	LDI 
1265+  4AF8 BE          	CP	(HL)
1266+  4AF9 20 FB       	JR	NZ,$-3
1267+  4AFB 41          	LD	B,C
1268+  4AFC 12          	LD	(DE),A
1269+  4AFD 13          	INC	DE
1270+  4AFE 10 FC       	DJNZ	$-2
1271+  4B00 21 00 80    	LD	HL,WorkBuffer
1272+  4B03 0E 1E       	LD	C,#1E
1273+  4B05 FD E5       	PUSH	IY
1274+  4B07 D7          	RST	#10
1275+  4B08 FD E1       	POP	IY
1276+  4B0A 21 21 AF    	LD	HL,BegDIR
1277+  4B0D 0E 1D       	LD	C,#1D
1278+  4B0F FD E5       	PUSH	IY
1279+  4B11 D7          	RST	#10
1280+  4B12 FD E1       	POP	IY
1281+  4B14 38 36       	JR	C,ReNameC
1282+  4B16 21 04 AF    	LD	HL,TreeName
1283+  4B19 11 00 81    	LD	DE,WorkBuffer+#100
1284+  4B1C 01 19 00    	LD	BC,#0019
1285+  4B1F 3A 7F A8    	LD	A,(FileAtribut)
1286+  4B22 FD E5       	PUSH	IY
1287+  4B24 D7          	RST	#10
1288+  4B25 FD E1       	POP	IY
1289+  4B27 38 23       	JR	C,ReNameC
1290+  4B29 21 04 AF    	LD	HL,TreeName
1291+  4B2C 97          	SUB	A
1292+  4B2D 0E 0A       	LD	C,#0A
1293+  4B2F FD E5       	PUSH	IY
1294+  4B31 D7          	RST	#10
1295+  4B32 FD E1       	POP	IY
1296+  4B34 38 16       	JR	C,ReNameC
1297+  4B36 FD 6E 13    	LD	L,(IY+PanelEFl)
1298+  4B39 FD 66 14    	LD	H,(IY+PanelEFh)
1299+  4B3C 29          	ADD	HL,HL
1300+  4B3D 29          	ADD	HL,HL
1301+  4B3E 29          	ADD	HL,HL
1302+  4B3F 29          	ADD	HL,HL
1303+  4B40 EB          	EX	DE,HL
1304+  4B41 21 00 C0    	LD	HL,#C000
1305+  4B44 0E 14       	LD	C,#14
1306+  4B46 F5          	PUSH	AF
1307+  4B47 D7          	RST	#10
1308+  4B48 F1          	POP	AF
1309+  4B49 0E 12       	LD	C,#12
1310+  4B4B D7          	RST	#10
1311+  4B4C 21 00 80    ReNameC	LD	HL,WorkBuffer
1312+  4B4F 0E 1D       	LD	C,#1D
1313+  4B51 D7          	RST	#10
1314+  4B52 F1          ReNameT	POP	AF
1315+  4B53 D3 E2       	OUT	(PAGE3),A
1316+  4B55 FD E1       	POP	IY
1317+  4B57 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1318+  4B5B 20 4A       	JR	NZ,ReNameExt1
1319+  4B5D CD F5 A7    	CALL	ReadDIR
1320+  4B60 CD DA BD    	CALL	FindPrevDIR
1321+  4B63 CD 45 B5    	CALL	PrintDIR
1322+  4B66 CD EE B2    	CALL	PrnFileInfo
1323+  4B69 FD E5       	PUSH	IY
1324+  4B6B DD E1       	POP	IX
1325+  4B6D 11 05 00    	LD	DE,BegPBar
1326+  4B70 DD 19       	ADD	IX,DE
1327+  4B72 CD F7 96    	CALL	InitScrBar
1328+  4B75 FD 7E 01    	LD	A,(IY+ViewFlg)
1329+  4B78 E6 03       	AND	#03
1330+  4B7A F5          	PUSH	AF
1331+  4B7B CC 35 97    	CALL	Z,PrnHScrBar
1332+  4B7E F1          	POP	AF
1333+  4B7F C4 8E 98    	CALL	NZ,PrnVScrBar
1334+  4B82 FD E5       	PUSH	IY
1335+  4B84 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1336+  4B88 FD 21 B6 A6 	LD	IY,RightPanel
1337+  4B8C 28 04       	JR	Z,$+6
1338+  4B8E FD 21 8A A5 	LD	IY,LeftPanel
1339+  4B92 CD 45 B5    	CALL	PrintDIR
1340+  4B95 CD EE B2    	CALL	PrnFileInfo
1341+  4B98 FD E5       	PUSH	IY
1342+  4B9A DD E1       	POP	IX
1343+  4B9C 11 05 00    	LD	DE,BegPBar
1344+  4B9F DD 19       	ADD	IX,DE
1345+  4BA1 CD 8E 98    	CALL	PrnVScrBar
1346+  4BA4 FD E1       	POP	IY
1347+  4BA6 C9          	RET 
1348+  4BA7             ReNameExt1
1349+  4BA7 33          	INC	SP
1350+  4BA8 33          	INC	SP
1351+  4BA9 CD 45 B5    	CALL	PrintDIR
1352+  4BAC CD EE B2    	CALL	PrnFileInfo
1353+  4BAF CD EA BA    	CALL	SetInvert
1354+  4BB2 FD E5       	PUSH	IY
1355+  4BB4 DD E1       	POP	IX
1356+  4BB6 11 05 00    	LD	DE,BegPBar
1357+  4BB9 DD 19       	ADD	IX,DE
1358+  4BBB CD 8E 98    	CALL	PrnVScrBar
1359+  4BBE CD 28 B0    	CALL	TestTreeBeg
1360+  4BC1 FD E5       	PUSH	IY
1361+  4BC3 CD 8A B0    	CALL	MakeTreePath
1362+  4BC6 EB          	EX	DE,HL
1363+  4BC7 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1364+  4BCB FD 21 B6 A6 	LD	IY,RightPanel
1365+  4BCF 28 04       	JR	Z,$+6
1366+  4BD1 FD 21 8A A5 	LD	IY,LeftPanel
1367+  4BD5 FD E5       	PUSH	IY
1368+  4BD7 E1          	POP	HL
1369+  4BD8 01 2C 00    	LD	BC,BegPath
1370+  4BDB 09          	ADD	HL,BC
1371+  4BDC 23          	INC	HL
1372+  4BDD 23          	INC	HL
1373+  4BDE EB          	EX	DE,HL
1374+  4BDF 97          	SUB	A
1375+  4BE0 ED A0       	LDI 
1376+  4BE2 BE          	CP	(HL)
1377+  4BE3 20 FB       	JR	NZ,$-3
1378+  4BE5 12          	LD	(DE),A
1379+  4BE6 CD 38 B2    	CALL	PrintPath
1380+  4BE9 FD E1       	POP	IY
1381+  4BEB C9          	RET 
1382+  4BEC             ReNameExit
1383+  4BEC CD F5 A7    	CALL	ReadDIR
1384+  4BEF CD DA BD    	CALL	FindPrevDIR
1385+  4BF2 CD 45 B5    	CALL	PrintDIR
1386+  4BF5 CD EE B2    	CALL	PrnFileInfo
1387+  4BF8 FD E5       	PUSH	IY
1388+  4BFA DD E1       	POP	IX
1389+  4BFC 11 05 00    	LD	DE,BegPBar
1390+  4BFF DD 19       	ADD	IX,DE
1391+  4C01 CD F7 96    	CALL	InitScrBar
1392+  4C04 FD 7E 01    	LD	A,(IY+ViewFlg)
1393+  4C07 E6 03       	AND	#03
1394+  4C09 F5          	PUSH	AF
1395+  4C0A CC 35 97    	CALL	Z,PrnHScrBar
1396+  4C0D F1          	POP	AF
1397+  4C0E C4 8E 98    	CALL	NZ,PrnVScrBar
1398+  4C11 21 B6 A5    	LD	HL,LeftPanel+BegPath
1399+  4C14 11 E2 A6    	LD	DE,RightPanel+BegPath
1400+  4C17 1A          RNameE1	LD	A,(DE)
1401+  4C18 BE          	CP	(HL)
1402+  4C19 C0          	RET	NZ
1403+  4C1A 23          	INC	HL
1404+  4C1B 13          	INC	DE
1405+  4C1C 7E          	LD	A,(HL)
1406+  4C1D B7          	OR	A
1407+  4C1E 20 F7       	JR	NZ,RNameE1
1408+  4C20 1A          	LD	A,(DE)
1409+  4C21 B7          	OR	A
1410+  4C22 C0          	RET	NZ
1411+  4C23 FD E5       	PUSH	IY
1412+  4C25 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1413+  4C29 FD 21 B6 A6 	LD	IY,RightPanel
1414+  4C2D 28 04       	JR	Z,$+6
1415+  4C2F FD 21 8A A5 	LD	IY,LeftPanel
1416+  4C33 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1417+  4C37 20 22       	JR	NZ,RNameE2
1418+  4C39 CD F5 A7    	CALL	ReadDIR
1419+  4C3C CD 45 B5    	CALL	PrintDIR
1420+  4C3F CD EE B2    	CALL	PrnFileInfo
1421+  4C42 FD E5       	PUSH	IY
1422+  4C44 DD E1       	POP	IX
1423+  4C46 11 05 00    	LD	DE,BegPBar
1424+  4C49 DD 19       	ADD	IX,DE
1425+  4C4B CD F7 96    	CALL	InitScrBar
1426+  4C4E FD 7E 01    	LD	A,(IY+ViewFlg)
1427+  4C51 E6 03       	AND	#03
1428+  4C53 F5          	PUSH	AF
1429+  4C54 CC 35 97    	CALL	Z,PrnHScrBar
1430+  4C57 F1          	POP	AF
1431+  4C58 C4 8E 98    	CALL	NZ,PrnVScrBar
1432+  4C5B FD E1       RNameE2	POP	IY
1433+  4C5D C9          	RET 
1434+  4C5E             CurAttrib
1435+  4C5E 00          	DEFB	#00
1436+  4C5F             CurName
1437+  4C5F 00          	DEFS	#0D,#00
1438+  4C6C             NameStr
1439+  4C6C 0C 00 00 00 	DEFB	#0C,#00,#00,#00
1440+  4C70 00          NameLen	DEFB	#00
1441+  4C71 10 01 6E 00 	DEFW	#0110,#006E
1442+  4C75 68 00       	DEFW	#0068
1443+  4C77 F0          	DEFB	#F0
1444+  4C78 00          Name	DEFS	#0D,#00
1445+  4C85             
1446+  4C85             
1447+  4C85             
1448+  4C85             ;[]==========================================================[]
1449+  4C85             MakeDIRR
1450+  4C85 CD F9 BA    	CALL	ResInvert
1451+  4C88 21 EA BA    	LD	HL,SetInvert
1452+  4C8B E5          	PUSH	HL
1453+  4C8C 3E C0       	LD	A,#C0
1454+  4C8E D3 89       	OUT	(YPORT),A
1455+  4C90 CD F0 86    	CALL	MakeWindow
1456+  4C93 01          	DEFB	#01
1457+  4C94 C8 00 51 00 	DEFW	#00C8,#0051
1458+  4C98 F0 00 3E 00 	DEFW	#00F0,#003E
1459+  4C9C 02          	DEFB	#02	;Head place
1460+  4C9D 04 00 02 00 	DEFW	#0004,#0002
1461+  4CA1 E8 00 0A 00 	DEFW	#00E8,#000A
1462+  4CA5 00          	DEFB	#00
1463+  4CA6 01          	DEFB	#01	;Text Line
1464+  4CA7 54 00 03 00 	DEFW	#0054,#0003
1465+  4CAB 0F          	DEFB	#0F
1466+  4CAC             	DEFB	"Make directory",0
1466+  4CAC 4D616B65206469726563746F727900
1467+  4CBB 04          	DEFB	#04	;UpRectan
1468+  4CBC 28 00 2A 00 	DEFW	#0028,#002A
1469+  4CC0 48 00 0E 00 	DEFW	#0048,#000E
1470+  4CC4 01          	DEFB	#01	;Text Line
1471+  4CC5 44 00 2D 00 	DEFW	#0044,#002D
1472+  4CC9 80          	DEFB	#80
1473+  4CCA 4F 6B 00    	DEFB	"Ok",0
1474+  4CCD 04          	DEFB	#04	;UpRectan
1475+  4CCE 80 00 2A 00 	DEFW	#0080,#002A
1476+  4CD2 48 00 0E 00 	DEFW	#0048,#000E
1477+  4CD6 01          	DEFB	#01	;Text Line
1478+  4CD7 94 00 2D 00 	DEFW	#0094,#002D
1479+  4CDB 80          	DEFB	#80
1480+  4CDC             	DEFB	"Cancel",0
1480+  4CDC 43616E63656C00
1481+  4CE3 01          	DEFB	#01	;Text Line
1482+  4CE4 0C 00 19 00 	DEFW	#000C,#0019
1483+  4CE8 80          	DEFB	#80
1484+  4CE9             	DEFB	"New directory:",0
1484+  4CE9 4E6577206469726563746F72793A00
1485+  4CF8 03          	DEFB	#03	;Углубление
1486+  4CF9 56 00 16 00 	DEFW	#0056,#0016
1487+  4CFD 86 00 0C 00 	DEFW	#0086,#000C
1488+  4D01 02          	DEFB	#02	;Head place
1489+  4D02 58 00 17 00 	DEFW	#0058,#0017
1490+  4D06 82 00 0A 00 	DEFW	#0082,#000A
1491+  4D0A 0F          	DEFB	#0F
1492+  4D0B 00          	DEFB	#00
1493+  4D0C DD 21 4B 4F 	LD	IX,MakeDIRStr
1494+  4D10 21 0A 73    	LD	HL,MakeDIRTab
1495+  4D13 CD 68 91    	CALL	InputLine
1496+  4D16 CD F0 86    	CALL	MakeWindow
1497+  4D19 7F          	DEFB	#7F
1498+  4D1A 00          	DEFB	#00
1499+  4D1B D8          	RET	C
1500+  4D1C 3A 4F 4F    	LD	A,(MDIRLen)
1501+  4D1F B7          	OR	A
1502+  4D20 C8          	RET	Z
1503+  4D21 21 57 4F    	LD	HL,NewDIR
1504+  4D24 47          	LD	B,A
1505+  4D25 7E          MkDIRlp	LD	A,(HL)
1506+  4D26 23          	INC	HL
1507+  4D27 FE 3A       	CP	":"
1508+  4D29 C8          	RET	Z
1509+  4D2A FE 5C       	CP	"\\"
1510+  4D2C C8          	RET	Z
1511+  4D2D 10 F6       	DJNZ	MkDIRlp
1512+  4D2F CD 9C A0    	CALL	SetClock
1513+  4D32 21 3C A1    	LD	HL,SetMouse
1514+  4D35 E5          	PUSH	HL
1515+  4D36 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1516+  4D3A 28 14       	JR	Z,MkDIR0
1517+  4D3C FD E5       	PUSH	IY
1518+  4D3E E1          	POP	HL
1519+  4D3F 11 2C 00    	LD	DE,BegPath
1520+  4D42 19          	ADD	HL,DE
1521+  4D43 0E 1D       	LD	C,#1D
1522+  4D45 FD E5       	PUSH	IY
1523+  4D47 D7          	RST	#10
1524+  4D48 FD E1       	POP	IY
1525+  4D4A F5          	PUSH	AF
1526+  4D4B DC A8 86    	CALL	C,DOSError
1527+  4D4E F1          	POP	AF
1528+  4D4F D8          	RET	C
1529+  4D50 21 57 4F    MkDIR0	LD	HL,NewDIR
1530+  4D53 0E 1B       	LD	C,#1B
1531+  4D55 FD E5       	PUSH	IY
1532+  4D57 D7          	RST	#10
1533+  4D58 FD E1       	POP	IY
1534+  4D5A F5          	PUSH	AF
1535+  4D5B DC A8 86    	CALL	C,DOSError
1536+  4D5E F1          	POP	AF
1537+  4D5F D8          	RET	C
1538+  4D60 21 57 4F    	LD	HL,NewDIR
1539+  4D63 11 5D BE    	LD	DE,PrevDIR
1540+  4D66 3A 4F 4F    	LD	A,(MDIRLen)
1541+  4D69 47          	LD	B,A
1542+  4D6A 7E          	LD	A,(HL)
1543+  4D6B CD 6F AA    	CALL	CorrSmallChar
1544+  4D6E 77          	LD	(HL),A
1545+  4D6F 12          	LD	(DE),A
1546+  4D70 23          	INC	HL
1547+  4D71 13          	INC	DE
1548+  4D72 10 F6       	DJNZ	$-8
1549+  4D74 97          	SUB	A
1550+  4D75 12          	LD	(DE),A
1551+  4D76 3A E3 A7    	LD	A,(TreeFlag)
1552+  4D79 B7          	OR	A
1553+  4D7A CA D7 4E    	JP	Z,MkDIRnxt1
1554+  4D7D FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1555+  4D81 08          	EX	AF,AF'
1556+  4D82 FD E5       	PUSH	IY
1557+  4D84 FD 21 8A A5 	LD	IY,LeftPanel
1558+  4D88 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1559+  4D8C 20 04       	JR	NZ,$+6
1560+  4D8E FD 21 B6 A6 	LD	IY,RightPanel
1561+  4D92 FD 7E 14    	LD	A,(IY+PanelEFh)
1562+  4D95 CB 57       	BIT	2,A
1563+  4D97 C2 CF 4E    	JP	NZ,MkDIRn0
1564+  4D9A DB E2       	IN	A,(PAGE3)
1565+  4D9C F5          	PUSH	AF
1566+  4D9D FD CB 00 46 	BIT	0,(IY+PanelFlg)
1567+  4DA1 3A EE A7    	LD	A,(DIRpage1)
1568+  4DA4 28 03       	JR	Z,$+5
1569+  4DA6 3A EF A7    	LD	A,(DIRpage2)
1570+  4DA9 D3 E2       	OUT	(PAGE3),A
1571+  4DAB 08          	EX	AF,AF'
1572+  4DAC 20 26       	JR	NZ,FnTree1
1573+  4DAE FD CB 00 46 	BIT	0,(IY+PanelFlg)
1574+  4DB2 21 8A A5    	LD	HL,LeftPanel
1575+  4DB5 20 03       	JR	NZ,$+5
1576+  4DB7 21 B6 A6    	LD	HL,RightPanel
1577+  4DBA 11 2C 00    	LD	DE,BegPath
1578+  4DBD 19          	ADD	HL,DE
1579+  4DBE 23          	INC	HL
1580+  4DBF 23          	INC	HL
1581+  4DC0 CD F0 B0    	CALL	FindTreeDIR
1582+  4DC3 DA CC 4E    	JP	C,MkDIRn
1583+  4DC6 21 F1 BF    	LD	HL,#C001-#10
1584+  4DC9 01 10 00    	LD	BC,#0010
1585+  4DCC 09          	ADD	HL,BC
1586+  4DCD CB 46       	BIT	0,(HL)
1587+  4DCF 28 FB       	JR	Z,$-3
1588+  4DD1 2B          	DEC	HL
1589+  4DD2 18 15       	JR	FnTree2
1590+  4DD4 FD 6E 15    FnTree1	LD	L,(IY+PanelFFl)
1591+  4DD7 FD 66 16    	LD	H,(IY+PanelFFh)
1592+  4DDA FD 5E 17    	LD	E,(IY+PanelCFl)
1593+  4DDD FD 56 18    	LD	D,(IY+PanelCFh)
1594+  4DE0 19          	ADD	HL,DE
1595+  4DE1 29          	ADD	HL,HL
1596+  4DE2 29          	ADD	HL,HL
1597+  4DE3 29          	ADD	HL,HL
1598+  4DE4 29          	ADD	HL,HL
1599+  4DE5 7C          	LD	A,H
1600+  4DE6 F6 C0       	OR	#C0
1601+  4DE8 67          	LD	H,A
1602+  4DE9 5E          FnTree2	LD	E,(HL)
1603+  4DEA 01 0F 00    	LD	BC,#000F
1604+  4DED 09          	ADD	HL,BC
1605+  4DEE 56          	LD	D,(HL)
1606+  4DEF 70          	LD	(HL),B
1607+  4DF0 23          	INC	HL
1608+  4DF1 1C          	INC	E
1609+  4DF2 7A          	LD	A,D
1610+  4DF3 3C          	INC	A
1611+  4DF4 28 31       	JR	Z,MkDIRend
1612+  4DF6 7B          	LD	A,E
1613+  4DF7 E6 7F       	AND	#7F
1614+  4DF9 DD 6F       	LD	LX,A
1615+  4DFB 7E          	LD	A,(HL)
1616+  4DFC E6 7F       	AND	#7F
1617+  4DFE DD BD       	CP	LX
1618+  4E00 20 25       	JR	NZ,MkDIRend
1619+  4E02 7E          MkDIR10	LD	A,(HL)
1620+  4E03 E6 7F       	AND	#7F
1621+  4E05 DD BD       	CP	LX
1622+  4E07 28 04       	JR	Z,MkDIR11
1623+  4E09 09          	ADD	HL,BC
1624+  4E0A 23          	INC	HL
1625+  4E0B 18 F5       	JR	MkDIR10
1626+  4E0D 7E          MkDIR11	LD	A,(HL)
1627+  4E0E CB BE       	RES	7,(HL)
1628+  4E10 09          	ADD	HL,BC
1629+  4E11 56          	LD	D,(HL)
1630+  4E12 70          	LD	(HL),B
1631+  4E13 23          	INC	HL
1632+  4E14 CB 7F       	BIT	7,A
1633+  4E16 28 EA       	JR	Z,MkDIR10
1634+  4E18 7E          MkDIR12	LD	A,(HL)
1635+  4E19 E6 7F       	AND	#7F
1636+  4E1B DD BD       	CP	LX
1637+  4E1D 38 08       	JR	C,MkDIRend
1638+  4E1F 09          	ADD	HL,BC
1639+  4E20 56          	LD	D,(HL)
1640+  4E21 70          	LD	(HL),B
1641+  4E22 23          	INC	HL
1642+  4E23 7A          	LD	A,D
1643+  4E24 3C          	INC	A
1644+  4E25 20 F1       	JR	NZ,MkDIR12
1645+  4E27             MkDIRend
1646+  4E27 E5          	PUSH	HL
1647+  4E28 D5          	PUSH	DE
1648+  4E29 4D          	LD	C,L
1649+  4E2A 44          	LD	B,H
1650+  4E2B FD 6E 13    	LD	L,(IY+PanelEFl)
1651+  4E2E FD 66 14    	LD	H,(IY+PanelEFh)
1652+  4E31 29          	ADD	HL,HL
1653+  4E32 29          	ADD	HL,HL
1654+  4E33 29          	ADD	HL,HL
1655+  4E34 29          	ADD	HL,HL
1656+  4E35 7C          	LD	A,H
1657+  4E36 F6 C0       	OR	#C0
1658+  4E38 67          	LD	H,A
1659+  4E39 E5          	PUSH	HL
1660+  4E3A B7          	OR	A
1661+  4E3B ED 42       	SBC	HL,BC
1662+  4E3D 4D          	LD	C,L
1663+  4E3E 44          	LD	B,H
1664+  4E3F E1          	POP	HL
1665+  4E40 7D          	LD	A,L
1666+  4E41 54          	LD	D,H
1667+  4E42 C6 10       	ADD	A,#10
1668+  4E44 5F          	LD	E,A
1669+  4E45 30 01       	JR	NC,$+3
1670+  4E47 14          	INC	D
1671+  4E48 78          	LD	A,B
1672+  4E49 B1          	OR	C
1673+  4E4A 28 04       	JR	Z,$+6
1674+  4E4C 2B          	DEC	HL
1675+  4E4D 1B          	DEC	DE
1676+  4E4E ED B8       	LDDR 
1677+  4E50 C1          	POP	BC
1678+  4E51 D1          	POP	DE
1679+  4E52 78          	LD	A,B
1680+  4E53 08          	EX	AF,AF'
1681+  4E54 79          	LD	A,C
1682+  4E55 CB FF       	SET	7,A
1683+  4E57 12          	LD	(DE),A
1684+  4E58 13          	INC	DE
1685+  4E59 97          	SUB	A
1686+  4E5A 12          	LD	(DE),A
1687+  4E5B 13          	INC	DE
1688+  4E5C 21 57 4F    	LD	HL,NewDIR
1689+  4E5F 0E 0D       	LD	C,#0D
1690+  4E61 ED A0       	LDI 
1691+  4E63 BE          	CP	(HL)
1692+  4E64 20 FB       	JR	NZ,$-3
1693+  4E66 41          	LD	B,C
1694+  4E67 12          	LD	(DE),A
1695+  4E68 13          	INC	DE
1696+  4E69 10 FC       	DJNZ	$-2
1697+  4E6B 08          	EX	AF,AF'
1698+  4E6C 12          	LD	(DE),A
1699+  4E6D FD 6E 13    	LD	L,(IY+PanelEFl)
1700+  4E70 FD 66 14    	LD	H,(IY+PanelEFh)
1701+  4E73 23          	INC	HL
1702+  4E74 FD 75 13    	LD	(IY+PanelEFl),L
1703+  4E77 FD 74 14    	LD	(IY+PanelEFh),H
1704+  4E7A 21 00 80    	LD	HL,WorkBuffer
1705+  4E7D 0E 1E       	LD	C,#1E
1706+  4E7F FD E5       	PUSH	IY
1707+  4E81 D7          	RST	#10
1708+  4E82 FD E1       	POP	IY
1709+  4E84 21 21 AF    	LD	HL,BegDIR
1710+  4E87 0E 1D       	LD	C,#1D
1711+  4E89 FD E5       	PUSH	IY
1712+  4E8B D7          	RST	#10
1713+  4E8C FD E1       	POP	IY
1714+  4E8E 38 36       	JR	C,MkDIR2
1715+  4E90 21 04 AF    	LD	HL,TreeName
1716+  4E93 11 00 81    	LD	DE,WorkBuffer+#100
1717+  4E96 01 19 00    	LD	BC,#0019
1718+  4E99 3A 7F A8    	LD	A,(FileAtribut)
1719+  4E9C FD E5       	PUSH	IY
1720+  4E9E D7          	RST	#10
1721+  4E9F FD E1       	POP	IY
1722+  4EA1 38 23       	JR	C,MkDIR2
1723+  4EA3 21 04 AF    	LD	HL,TreeName
1724+  4EA6 97          	SUB	A
1725+  4EA7 0E 0A       	LD	C,#0A
1726+  4EA9 FD E5       	PUSH	IY
1727+  4EAB D7          	RST	#10
1728+  4EAC FD E1       	POP	IY
1729+  4EAE 38 16       	JR	C,MkDIR2
1730+  4EB0 FD 6E 13    	LD	L,(IY+PanelEFl)
1731+  4EB3 FD 66 14    	LD	H,(IY+PanelEFh)
1732+  4EB6 29          	ADD	HL,HL
1733+  4EB7 29          	ADD	HL,HL
1734+  4EB8 29          	ADD	HL,HL
1735+  4EB9 29          	ADD	HL,HL
1736+  4EBA EB          	EX	DE,HL
1737+  4EBB 21 00 C0    	LD	HL,#C000
1738+  4EBE 0E 14       	LD	C,#14
1739+  4EC0 F5          	PUSH	AF
1740+  4EC1 D7          	RST	#10
1741+  4EC2 F1          	POP	AF
1742+  4EC3 0E 12       	LD	C,#12
1743+  4EC5 D7          	RST	#10
1744+  4EC6 21 00 80    MkDIR2	LD	HL,WorkBuffer
1745+  4EC9 0E 1D       	LD	C,#1D
1746+  4ECB D7          	RST	#10
1747+  4ECC F1          MkDIRn	POP	AF
1748+  4ECD D3 E2       	OUT	(PAGE3),A
1749+  4ECF FD E1       MkDIRn0	POP	IY
1750+  4ED1 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1751+  4ED5 20 06       	JR	NZ,MkDIRn1
1752+  4ED7             MkDIRnxt1
1753+  4ED7 CD F5 A7    	CALL	ReadDIR
1754+  4EDA CD DA BD    	CALL	FindPrevDIR
1755+  4EDD CD 45 B5    MkDIRn1	CALL	PrintDIR
1756+  4EE0 CD EE B2    	CALL	PrnFileInfo
1757+  4EE3 FD E5       	PUSH	IY
1758+  4EE5 DD E1       	POP	IX
1759+  4EE7 11 05 00    	LD	DE,BegPBar
1760+  4EEA DD 19       	ADD	IX,DE
1761+  4EEC CD F7 96    	CALL	InitScrBar
1762+  4EEF FD 7E 01    	LD	A,(IY+ViewFlg)
1763+  4EF2 E6 03       	AND	#03
1764+  4EF4 F5          	PUSH	AF
1765+  4EF5 CC 35 97    	CALL	Z,PrnHScrBar
1766+  4EF8 F1          	POP	AF
1767+  4EF9 C4 8E 98    	CALL	NZ,PrnVScrBar
1768+  4EFC FD E5       	PUSH	IY
1769+  4EFE FD CB 00 46 	BIT	0,(IY+PanelFlg)
1770+  4F02 FD 21 B6 A6 	LD	IY,RightPanel
1771+  4F06 28 04       	JR	Z,$+6
1772+  4F08 FD 21 8A A5 	LD	IY,LeftPanel
1773+  4F0C FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1774+  4F10 20 17       	JR	NZ,MkDIRn2
1775+  4F12 21 B6 A5    	LD	HL,LeftPanel+BegPath
1776+  4F15 11 E2 A6    	LD	DE,RightPanel+BegPath
1777+  4F18 1A          MkDIRrf	LD	A,(DE)
1778+  4F19 BE          	CP	(HL)
1779+  4F1A 20 2C       	JR	NZ,MkDIRex
1780+  4F1C 23          	INC	HL
1781+  4F1D 13          	INC	DE
1782+  4F1E 7E          	LD	A,(HL)
1783+  4F1F B7          	OR	A
1784+  4F20 20 F6       	JR	NZ,MkDIRrf
1785+  4F22 1A          	LD	A,(DE)
1786+  4F23 B7          	OR	A
1787+  4F24 20 22       	JR	NZ,MkDIRex
1788+  4F26 CD F5 A7    	CALL	ReadDIR
1789+  4F29 CD 45 B5    MkDIRn2	CALL	PrintDIR
1790+  4F2C CD EE B2    	CALL	PrnFileInfo
1791+  4F2F FD E5       	PUSH	IY
1792+  4F31 DD E1       	POP	IX
1793+  4F33 11 05 00    	LD	DE,BegPBar
1794+  4F36 DD 19       	ADD	IX,DE
1795+  4F38 CD F7 96    	CALL	InitScrBar
1796+  4F3B FD 7E 01    	LD	A,(IY+ViewFlg)
1797+  4F3E E6 03       	AND	#03
1798+  4F40 F5          	PUSH	AF
1799+  4F41 CC 35 97    	CALL	Z,PrnHScrBar
1800+  4F44 F1          	POP	AF
1801+  4F45 C4 8E 98    	CALL	NZ,PrnVScrBar
1802+  4F48 FD E1       MkDIRex	POP	IY
1803+  4F4A C9          	RET 
1804+  4F4B             MakeDIRStr
1805+  4F4B 0C 00 00 00 	DEFB	#0C,#00,#00,#00
1806+  4F4F 00          MDIRLen	DEFB	#00
1807+  4F50 22 01 6A 00 	DEFW	#0122,#006A
1808+  4F54 68 00       	DEFW	#0068
1809+  4F56 F0          	DEFB	#F0
1810+  4F57 00          NewDIR	DEFS	#0D,#00
1811+  4F64             ;[]==========================================================[]
1812+  4F64             DeleteFilesR
1813+  4F64 FD 7E 13    	LD	A,(IY+PanelEFl)
1814+  4F67 FD B6 14    	OR	(IY+PanelEFh)
1815+  4F6A C8          	RET	Z
1816+  4F6B 3E C0       	LD	A,#C0
1817+  4F6D D3 89       	OUT	(YPORT),A
1818+  4F6F FD 7E 19    	LD	A,(IY+PanelMFl)
1819+  4F72 FD B6 1A    	OR	(IY+PanelMFh)
1820+  4F75 20 4E       	JR	NZ,DeleteMark
1821+  4F77 DB E2       	IN	A,(PAGE3)
1822+  4F79 F5          	PUSH	AF
1823+  4F7A FD CB 00 46 	BIT	0,(IY+PanelFlg)
1824+  4F7E 3A EE A7    	LD	A,(DIRpage1)
1825+  4F81 28 03       	JR	Z,$+5
1826+  4F83 3A EF A7    	LD	A,(DIRpage2)
1827+  4F86 D3 E2       	OUT	(PAGE3),A
1828+  4F88 FD 6E 15    	LD	L,(IY+PanelFFl)
1829+  4F8B FD 66 16    	LD	H,(IY+PanelFFh)
1830+  4F8E FD 5E 17    	LD	E,(IY+PanelCFl)
1831+  4F91 FD 56 18    	LD	D,(IY+PanelCFh)
1832+  4F94 19          	ADD	HL,DE
1833+  4F95 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1834+  4F99 28 0E       	JR	Z,DelFile
1835+  4F9B 29          	ADD	HL,HL
1836+  4F9C 29          	ADD	HL,HL
1837+  4F9D 29          	ADD	HL,HL
1838+  4F9E 29          	ADD	HL,HL
1839+  4F9F 7C          	LD	A,H
1840+  4FA0 F6 C0       	OR	#C0
1841+  4FA2 67          	LD	H,A
1842+  4FA3 22 20 51    	LD	(AdrDelFile),HL
1843+  4FA6 23          	INC	HL
1844+  4FA7 18 0E       	JR	DelFil1
1845+  4FA9 29          DelFile	ADD	HL,HL
1846+  4FAA 29          	ADD	HL,HL
1847+  4FAB 29          	ADD	HL,HL
1848+  4FAC 5D          	LD	E,L
1849+  4FAD 54          	LD	D,H
1850+  4FAE 29          	ADD	HL,HL
1851+  4FAF 19          	ADD	HL,DE
1852+  4FB0 7C          	LD	A,H
1853+  4FB1 F6 C0       	OR	#C0
1854+  4FB3 67          	LD	H,A
1855+  4FB4 22 20 51    	LD	(AdrDelFile),HL
1856+  4FB7 23          DelFil1	INC	HL
1857+  4FB8 5E          	LD	E,(HL)
1858+  4FB9 F1          	POP	AF
1859+  4FBA D3 E2       	OUT	(PAGE3),A
1860+  4FBC 7B          	LD	A,E
1861+  4FBD FE 2E       	CP	"."
1862+  4FBF C8          	RET	Z
1863+  4FC0 FE 5C       	CP	"\\"
1864+  4FC2 C8          	RET	Z
1865+  4FC3 18 22       	JR	DelNext
1866+  4FC5             DeleteMark
1867+  4FC5 DB E2       	IN	A,(PAGE3)
1868+  4FC7 F5          	PUSH	AF
1869+  4FC8 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1870+  4FCC 3A EE A7    	LD	A,(DIRpage1)
1871+  4FCF 28 03       	JR	Z,$+5
1872+  4FD1 3A EF A7    	LD	A,(DIRpage2)
1873+  4FD4 D3 E2       	OUT	(PAGE3),A
1874+  4FD6 21 E8 BF    	LD	HL,#C000-#18
1875+  4FD9 01 18 00    	LD	BC,#0018
1876+  4FDC 09          	ADD	HL,BC
1877+  4FDD CB 46       	BIT	0,(HL)
1878+  4FDF 28 FB       	JR	Z,$-3
1879+  4FE1 22 20 51    	LD	(AdrDelFile),HL
1880+  4FE4 F1          	POP	AF
1881+  4FE5 D3 E2       	OUT	(PAGE3),A
1882+  4FE7 CD F9 BA    DelNext	CALL	ResInvert
1883+  4FEA 21 EA BA    	LD	HL,SetInvert
1884+  4FED E5          	PUSH	HL
1885+  4FEE             
1886+  4FEE DB E2       	IN	A,(PAGE3)
1887+  4FF0 F5          	PUSH	AF
1888+  4FF1 FD CB 00 46 	BIT	0,(IY+PanelFlg)
1889+  4FF5 3A EE A7    	LD	A,(DIRpage1)
1890+  4FF8 28 03       	JR	Z,$+5
1891+  4FFA 3A EF A7    	LD	A,(DIRpage2)
1892+  4FFD D3 E2       	OUT	(PAGE3),A
1893+  4FFF 97          	SUB	A
1894+  5000 32 22 51    	LD	(DeleteFlag),A
1895+  5003             DeleteMain
1896+  5003 CD F0 86    	CALL	MakeWindow
1897+  5006 01          	DEFB	#01
1898+  5007 B4 00 50 00 	DEFW	#00B4,#0050
1899+  500B 18 01 38 00 	DEFW	#0118,#0038
1900+  500F 02          	DEFB	#02	;Head place
1901+  5010 04 00 02 00 	DEFW	#0004,#0002
1902+  5014 10 01 0A 00 	DEFW	#0110,#000A
1903+  5018 00          	DEFB	#00
1904+  5019 01          	DEFB	#01	;Text Line
1905+  501A 74 00 03 00 	DEFW	#0074,#0003
1906+  501E 0F          	DEFB	#0F
1907+  501F             	DEFB	"Delete file",0
1907+  501F 44656C6574652066696C6500
1908+  502B 01          	DEFB	#01	;Text Line
1909+  502C 38 00 10 00 	DEFW	#0038,#0010
1910+  5030 80          	DEFB	#80
1911+  5031             	DEFB	"The following file will be DELETED:",0
1911+  5031 54686520666F6C6C6F77696E672066696C652077696C6C2062652044454C4554
1911+  5051 45443A00
1912+  5055 04          	DEFB	#04	;UpRectan
1913+  5056 10 00 26 00 	DEFW	#0010,#0026
1914+  505A 38 00 0E 00 	DEFW	#0038,#000E
1915+  505E 01          	DEFB	#01	;Text Line
1916+  505F 1C 00 29 00 	DEFW	#001C,#0029
1917+  5063 80          	DEFB	#80
1918+  5064             	DEFB	"Delete",0
1918+  5064 44656C65746500
1919+  506B 04          	DEFB	#04	;UpRectan
1920+  506C 50 00 26 00 	DEFW	#0050,#0026
1921+  5070 38 00 0E 00 	DEFW	#0038,#000E
1922+  5074 01          	DEFB	#01	;Text Line
1923+  5075 66 00 29 00 	DEFW	#0066,#0029
1924+  5079 80          	DEFB	#80
1925+  507A 41 6C 6C 00 	DEFB	"All",0
1926+  507E 04          	DEFB	#04	;UpRectan
1927+  507F 90 00 26 00 	DEFW	#0090,#0026
1928+  5083 38 00 0E 00 	DEFW	#0038,#000E
1929+  5087 01          	DEFB	#01	;Text Line
1930+  5088 A2 00 29 00 	DEFW	#00A2,#0029
1931+  508C 80          	DEFB	#80
1932+  508D 536B697000  	DEFB	"Skip",0
1933+  5092 04          	DEFB	#04	;UpRectan
1934+  5093 D0 00 26 00 	DEFW	#00D0,#0026
1935+  5097 38 00 0E 00 	DEFW	#0038,#000E
1936+  509B 01          	DEFB	#01	;Text Line
1937+  509C DC 00 29 00 	DEFW	#00DC,#0029
1938+  50A0 80          	DEFB	#80
1939+  50A1             	DEFB	"Cancel",0
1939+  50A1 43616E63656C00
1940+  50A8 00          	DEFB	#00
1941+  50A9 FD E5       	PUSH	IY
1942+  50AB E1          	POP	HL
1943+  50AC 11 2C 00    	LD	DE,BegPath
1944+  50AF 19          	ADD	HL,DE
1945+  50B0 11 00 80    	LD	DE,WorkBuffer
1946+  50B3 97          	SUB	A
1947+  50B4 ED A0       	LDI 
1948+  50B6 BE          	CP	(HL)
1949+  50B7 20 FB       	JR	NZ,$-3
1950+  50B9 12          	LD	(DE),A
1951+  50BA FD CB 01 4E 	BIT	1,(IY+ViewFlg)
1952+  50BE 20 0B       	JR	NZ,DelLp0
1953+  50C0 2B          	DEC	HL
1954+  50C1 3E 5C       	LD	A,"\\"
1955+  50C3 BE          	CP	(HL)
1956+  50C4 28 02       	JR	Z,$+4
1957+  50C6 12          	LD	(DE),A
1958+  50C7 13          	INC	DE
1959+  50C8 CD 23 51    	CALL	MakeDELname
1960+  50CB DD 21 F8 00 DelLp0	LD	IX,#00F8
1961+  50CF 21 00 80    	LD	HL,WorkBuffer
1962+  50D2 11 40 01    	LD	DE,#0140
1963+  50D5 01 6A 00    	LD	BC,#006A
1964+  50D8 3E 80       	LD	A,#80
1965+  50DA CD 39 8F    	CALL	PrnRangPathC
1966+  50DD DD 21 6C 73 DelLoop	LD	IX,DeleteTab
1967+  50E1 CD 1C 9B    	CALL	TestCoords
1968+  50E4 0E 31       	LD	C,#31
1969+  50E6 D7          	RST	#10
1970+  50E7 28 F4       	JR	Z,DelLoop
1971+  50E9 78          	LD	A,B
1972+  50EA B7          	OR	A
1973+  50EB 20 F0       	JR	NZ,DelLoop
1974+  50ED 7B          	LD	A,E
1975+  50EE FE 1B       	CP	#1B
1976+  50F0 21 77 53    	LD	HL,DelExit
1977+  50F3 28 25       	JR	Z,DelJump
1978+  50F5 FE 0D       	CP	#0D
1979+  50F7 21 96 51    	LD	HL,DelDelete
1980+  50FA 28 1E       	JR	Z,DelJump
1981+  50FC CB AF       	RES	5,A
1982+  50FE FE 44       	CP	"D"
1983+  5100 21 96 51    	LD	HL,DelDelete
1984+  5103 28 15       	JR	Z,DelJump
1985+  5105 FE 41       	CP	"A"
1986+  5107 21 03 52    	LD	HL,DelAll
1987+  510A 28 0E       	JR	Z,DelJump
1988+  510C FE 53       	CP	"S"
1989+  510E 21 3A 51    	LD	HL,DelSkip
1990+  5111 28 07       	JR	Z,DelJump
1991+  5113 FE 43       	CP	"C"
1992+  5115 20 C6       	JR	NZ,DelLoop
1993+  5117 21 77 53    	LD	HL,DelExit
1994+  511A CD F0 86    DelJump	CALL	MakeWindow
1995+  511D 7F          	DEFB	#7F
1996+  511E 00          	DEFB	#00
1997+  511F E9          	JP	(HL)
1998+  5120             AdrDelFile
1999+  5120 00 00       	DEFW	#0000
2000+  5122             DeleteFlag
2001+  5122 00          	DEFB	#00
2002+  5123             MakeDELname
2003+  5123 2A 20 51    	LD	HL,(AdrDelFile)
2004+  5126 23          	INC	HL
2005+  5127 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
2006+  512B 20 04       	JR	NZ,MakeDELn1
2007+  512D CD 6A BE    	CALL	MakeDOSname
2008+  5130 C9          	RET 
2009+  5131             MakeDELn1
2010+  5131 23          	INC	HL
2011+  5132 97          	SUB	A
2012+  5133 ED A0       	LDI 
2013+  5135 BE          	CP	(HL)
2014+  5136 20 FB       	JR	NZ,$-3
2015+  5138 12          	LD	(DE),A
2016+  5139 C9          	RET 
2017+  513A             ;--------------------------------------------------------------
2018+  513A             DelSkip
2019+  513A FD 4E 19    	LD	C,(IY+PanelMFl)
2020+  513D FD 46 1A    	LD	B,(IY+PanelMFh)
2021+  5140 78          	LD	A,B
2022+  5141 B1          	OR	C
2023+  5142 CA 77 53    	JP	Z,DelExit
2024+  5145 DD 2A 20 51 	LD	IX,(AdrDelFile)
2025+  5149 DD CB 00 86 	RES	0,(IX+#00)
2026+  514D FD 6E 1B    	LD	L,(IY+PanelMBl1)
2027+  5150 FD 66 1C    	LD	H,(IY+PanelMBh1)
2028+  5153 DD 5E 0F    	LD	E,(IX+#0F)
2029+  5156 DD 56 10    	LD	D,(IX+#10)
2030+  5159 B7          	OR	A
2031+  515A ED 52       	SBC	HL,DE
2032+  515C FD 75 1B    	LD	(IY+PanelMBl1),L
2033+  515F FD 74 1C    	LD	(IY+PanelMBh1),H
2034+  5162 FD 6E 1D    	LD	L,(IY+PanelMBl2)
2035+  5165 FD 66 1E    	LD	H,(IY+PanelMBh2)
2036+  5168 DD 5E 11    	LD	E,(IX+#11)
2037+  516B DD 56 12    	LD	D,(IX+#12)
2038+  516E ED 52       	SBC	HL,DE
2039+  5170 FD 75 1D    	LD	(IY+PanelMBl2),L
2040+  5173 FD 74 1E    	LD	(IY+PanelMBh2),H
2041+  5176 0B          	DEC	BC
2042+  5177 FD 71 19    	LD	(IY+PanelMFl),C
2043+  517A FD 70 1A    	LD	(IY+PanelMFh),B
2044+  517D 78          	LD	A,B
2045+  517E B1          	OR	C
2046+  517F CA 77 53    	JP	Z,DelExit
2047+  5182 2A 20 51    	LD	HL,(AdrDelFile)
2048+  5185 11 18 00    	LD	DE,#0018
2049+  5188 19          	ADD	HL,DE
2050+  5189 CB 46       	BIT	0,(HL)
2051+  518B 28 FB       	JR	Z,$-3
2052+  518D 22 20 51    	LD	(AdrDelFile),HL
2053+  5190 CD 45 B5    	CALL	PrintDIR
2054+  5193 C3 03 50    	JP	DeleteMain
2055+  5196             DelDelete
2056+  5196 CD 9C A0    	CALL	SetClock
2057+  5199 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
2058+  519D 28 2B       	JR	Z,DelDel0
2059+  519F FD E5       	PUSH	IY
2060+  51A1 E1          	POP	HL
2061+  51A2 11 2C 00    	LD	DE,BegPath
2062+  51A5 19          	ADD	HL,DE
2063+  51A6 11 00 80    	LD	DE,WorkBuffer
2064+  51A9 D5          	PUSH	DE
2065+  51AA 97          	SUB	A
2066+  51AB ED A0       	LDI 
2067+  51AD BE          	CP	(HL)
2068+  51AE 20 FB       	JR	NZ,$-3
2069+  51B0 EB          	EX	DE,HL
2070+  51B1 3E 5C       	LD	A,"\\"
2071+  51B3 2B          	DEC	HL
2072+  51B4 BE          	CP	(HL)
2073+  51B5 20 FC       	JR	NZ,$-2
2074+  51B7 23          	INC	HL
2075+  51B8 36 00       	LD	(HL),#00
2076+  51BA E1          	POP	HL
2077+  51BB 0E 1D       	LD	C,#1D
2078+  51BD FD E5       	PUSH	IY
2079+  51BF D7          	RST	#10
2080+  51C0 FD E1       	POP	IY
2081+  51C2 F5          	PUSH	AF
2082+  51C3 DC A8 86    	CALL	C,DOSError
2083+  51C6 F1          	POP	AF
2084+  51C7 DA 77 53    	JP	C,DelExit
2085+  51CA DD 2A 20 51 DelDel0	LD	IX,(AdrDelFile)
2086+  51CE 11 00 80    	LD	DE,WorkBuffer
2087+  51D1 D5          	PUSH	DE
2088+  51D2 CD 23 51    	CALL	MakeDELname
2089+  51D5 E1          	POP	HL
2090+  51D6 0E 1C       	LD	C,#1C		;RMDIR
2091+  51D8 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
2092+  51DC 20 09       	JR	NZ,DelDel1
2093+  51DE DD 7E 0E    	LD	A,(IX+#0E)
2094+  51E1 CB 67       	BIT	4,A
2095+  51E3 20 02       	JR	NZ,DelDel1
2096+  51E5 0E 0E       	LD	C,#0E		;DELETE
2097+  51E7 FD E5       DelDel1	PUSH	IY
2098+  51E9 D7          	RST	#10
2099+  51EA FD E1       	POP	IY
2100+  51EC 30 0A       	JR	NC,DelDel2
2101+  51EE CD A8 86    	CALL	DOSError
2102+  51F1 B7          	OR	A
2103+  51F2 C4 3C BC    	CALL	NZ,BegDIRECTORY
2104+  51F5 C3 77 53    	JP	DelExit
2105+  51F8 3E 01       DelDel2	LD	A,#01
2106+  51FA 32 22 51    	LD	(DeleteFlag),A
2107+  51FD CD 3C A1    	CALL	SetMouse
2108+  5200 C3 3A 51    	JP	DelSkip
2109+  5203             DelAll
2110+  5203 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
2111+  5207 20 8D       	JR	NZ,DelDelete
2112+  5209 3E 01       	LD	A,#01
2113+  520B 32 22 51    	LD	(DeleteFlag),A
2114+  520E CD 9C A0    	CALL	SetClock
2115+  5211 CD F0 86    	CALL	MakeWindow
2116+  5214 01          	DEFB	#01
2117+  5215 A0 00 58 00 	DEFW	#00A0,#0058
2118+  5219 40 01 30 00 	DEFW	#0140,#0030
2119+  521D 02          	DEFB	#02	;Head place
2120+  521E 04 00 02 00 	DEFW	#0004,#0002
2121+  5222 38 01 0A 00 	DEFW	#0138,#000A
2122+  5226 00          	DEFB	#00
2123+  5227 01          	DEFB	#01	;Text Line
2124+  5228 84 00 03 00 	DEFW	#0084,#0003
2125+  522C 0F          	DEFB	#0F
2126+  522D             	DEFB	"Delete files",0
2126+  522D 44656C6574652066696C657300
2127+  523A 01          	DEFB	#01	;Text Line
2128+  523B 08 00 10 00 	DEFW	#0008,#0010
2129+  523F 80          	DEFB	#80
2130+  5240             	DEFB	"Delete:",0
2130+  5240 44656C6574653A00
2131+  5248 03          	DEFB	#03	;Углубление
2132+  5249 10 00 1C 00 	DEFW	#0010,#001C
2133+  524D 20 01 0C 00 	DEFW	#0120,#000C
2134+  5251 02          	DEFB	#02	;Head place
2135+  5252 12 00 1D 00 	DEFW	#0012,#001D
2136+  5256 1C 01 0A 00 	DEFW	#011C,#000A
2137+  525A 0F          	DEFB	#0F
2138+  525B 00          	DEFB	#00
2139+  525C FD E5       	PUSH	IY
2140+  525E E1          	POP	HL
2141+  525F 11 2C 00    	LD	DE,BegPath
2142+  5262 19          	ADD	HL,DE
2143+  5263 22 86 52    	LD	(DelFrom+1),HL
2144+  5266 DD 21 5E 53 	LD	IX,ProcessDel
2145+  526A FD 6E 19    	LD	L,(IY+PanelMFl)
2146+  526D FD 66 1A    	LD	H,(IY+PanelMFh)
2147+  5270 7C          	LD	A,H
2148+  5271 B5          	OR	L
2149+  5272 20 01       	JR	NZ,$+3
2150+  5274 23          	INC	HL
2151+  5275 DD 75 0A    	LD	(IX+ProcMAXl1),L
2152+  5278 DD 74 0B    	LD	(IX+ProcMAXh1),H
2153+  527B 97          	SUB	A
2154+  527C DD 77 0C    	LD	(IX+ProcMAXl2),A
2155+  527F DD 77 0D    	LD	(IX+ProcMAXh2),A
2156+  5282 CD E6 99    	CALL	InitProcess
2157+  5285             DeleteAllLp
2158+  5285 21 00 00    DelFrom	LD	HL,#0000
2159+  5288 11 00 80    	LD	DE,WorkBuffer
2160+  528B 97          	SUB	A
2161+  528C ED A0       	LDI 
2162+  528E BE          	CP	(HL)
2163+  528F 20 FB       	JR	NZ,$-3
2164+  5291 2B          	DEC	HL
2165+  5292 3E 5C       	LD	A,"\\"
2166+  5294 BE          	CP	(HL)
2167+  5295 28 02       	JR	Z,$+4
2168+  5297 12          	LD	(DE),A
2169+  5298 13          	INC	DE
2170+  5299 CD 23 51    	CALL	MakeDELname
2171+  529C CD F0 86    	CALL	MakeWindow
2172+  529F 80          	DEFB	#80
2173+  52A0 02          	DEFB	#02
2174+  52A1 D0 00 68 00 	DEFW	#00D0,#0068
2175+  52A5 00 01 08 00 	DEFW	#0100,#0008
2176+  52A9 08          	DEFB	#08
2177+  52AA 00          	DEFB	#00
2178+  52AB DD 21 00 01 	LD	IX,#0100
2179+  52AF 21 00 80    	LD	HL,WorkBuffer
2180+  52B2 11 D0 00    	LD	DE,#00D0
2181+  52B5 01 68 00    	LD	BC,#0068
2182+  52B8 3E 80       	LD	A,#80
2183+  52BA CD 4B 8E    	CALL	PrnRangPathL
2184+  52BD 0E 31       	LD	C,#31
2185+  52BF D7          	RST	#10
2186+  52C0 21 1B 01    	LD	HL,#011B
2187+  52C3 B7          	OR	A
2188+  52C4 ED 52       	SBC	HL,DE
2189+  52C6 CA 71 53    	JP	Z,DelAllExit
2190+  52C9 DD 2A 20 51 	LD	IX,(AdrDelFile)
2191+  52CD 11 00 80    	LD	DE,WorkBuffer
2192+  52D0 D5          	PUSH	DE
2193+  52D1 CD 23 51    	CALL	MakeDELname
2194+  52D4 E1          	POP	HL
2195+  52D5 DD 7E 0E    	LD	A,(IX+#0E)
2196+  52D8 CB 67       	BIT	4,A
2197+  52DA 0E 0E       	LD	C,#0E		;DELETE
2198+  52DC 28 02       	JR	Z,$+4
2199+  52DE 0E 1C       	LD	C,#1C		;RMDIR
2200+  52E0 FD E5       	PUSH	IY
2201+  52E2 D7          	RST	#10
2202+  52E3 FD E1       	POP	IY
2203+  52E5 30 0A       	JR	NC,DelA1
2204+  52E7 CD A8 86    	CALL	DOSError
2205+  52EA B7          	OR	A
2206+  52EB C4 3C BC    	CALL	NZ,BegDIRECTORY
2207+  52EE C3 71 53    	JP	DelAllExit
2208+  52F1 DD 21 5E 53 DelA1	LD	IX,ProcessDel
2209+  52F5 DD 6E 0E    	LD	L,(IX+ProcCURl1)
2210+  52F8 DD 66 0F    	LD	H,(IX+ProcCURh1)
2211+  52FB 23          	INC	HL
2212+  52FC DD 75 0E    	LD	(IX+ProcCURl1),L
2213+  52FF DD 74 0F    	LD	(IX+ProcCURh1),H
2214+  5302 CD 45 9A    	CALL	PrnProcess
2215+  5305 FD 4E 19    	LD	C,(IY+PanelMFl)
2216+  5308 FD 46 1A    	LD	B,(IY+PanelMFh)
2217+  530B 78          	LD	A,B
2218+  530C B1          	OR	C
2219+  530D CA 71 53    	JP	Z,DelAllExit
2220+  5310 DD 2A 20 51 	LD	IX,(AdrDelFile)
2221+  5314 DD CB 00 86 	RES	0,(IX+#00)
2222+  5318 FD 6E 1B    	LD	L,(IY+PanelMBl1)
2223+  531B FD 66 1C    	LD	H,(IY+PanelMBh1)
2224+  531E DD 5E 0F    	LD	E,(IX+#0F)
2225+  5321 DD 56 10    	LD	D,(IX+#10)
2226+  5324 B7          	OR	A
2227+  5325 ED 52       	SBC	HL,DE
2228+  5327 FD 75 1B    	LD	(IY+PanelMBl1),L
2229+  532A FD 74 1C    	LD	(IY+PanelMBh1),H
2230+  532D FD 6E 1D    	LD	L,(IY+PanelMBl2)
2231+  5330 FD 66 1E    	LD	H,(IY+PanelMBh2)
2232+  5333 DD 5E 11    	LD	E,(IX+#11)
2233+  5336 DD 56 12    	LD	D,(IX+#12)
2234+  5339 ED 52       	SBC	HL,DE
2235+  533B FD 75 1D    	LD	(IY+PanelMBl2),L
2236+  533E FD 74 1E    	LD	(IY+PanelMBh2),H
2237+  5341 0B          	DEC	BC
2238+  5342 FD 71 19    	LD	(IY+PanelMFl),C
2239+  5345 FD 70 1A    	LD	(IY+PanelMFh),B
2240+  5348 78          	LD	A,B
2241+  5349 B1          	OR	C
2242+  534A CA 71 53    	JP	Z,DelAllExit
2243+  534D 2A 20 51    	LD	HL,(AdrDelFile)
2244+  5350 11 18 00    	LD	DE,#0018
2245+  5353 19          	ADD	HL,DE
2246+  5354 CB 46       	BIT	0,(HL)
2247+  5356 28 FB       	JR	Z,$-3
2248+  5358 22 20 51    	LD	(AdrDelFile),HL
2249+  535B C3 85 52    	JP	DeleteAllLp
2250+  535E             ProcessDel
2251+  535E B2 00       	DEFW	#00B2
2252+  5360 75 00       	DEFW	#0075
2253+  5362 1C 01       	DEFW	#011C
2254+  5364 00 00       	DEFW	#0000
2255+  5366 00 00       	DEFW	#0000
2256+  5368 00 00       	DEFW	#0000
2257+  536A 00 00       	DEFW	#0000
2258+  536C 00 00       	DEFW	#0000
2259+  536E 00 00       	DEFW	#0000
2260+  5370 4F          	DEFB	#4F
2261+  5371             
2262+  5371             DelAllExit
2263+  5371 76          	HALT 
2264+  5372 CD F0 86    	CALL	MakeWindow
2265+  5375 7F          	DEFB	#7F
2266+  5376 00          	DEFB	#00
2267+  5377             DelExit
2268+  5377 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
2269+  537B 20 25       	JR	NZ,DelTreeDIR1
2270+  537D DD 2A 20 51 	LD	IX,(AdrDelFile)
2271+  5381 DD CB 0E 66 	BIT	4,(IX+#0E)
2272+  5385 20 15       	JR	NZ,DelTreeDIR
2273+  5387 F1          DelExt1	POP	AF
2274+  5388 D3 E2       	OUT	(PAGE3),A
2275+  538A 21 3C A1    	LD	HL,SetMouse
2276+  538D E5          	PUSH	HL
2277+  538E 3A 22 51    	LD	A,(DeleteFlag)
2278+  5391 B7          	OR	A
2279+  5392 C2 FD BC    	JP	NZ,RefreshDIR
2280+  5395 CD 45 B5    	CALL	PrintDIR
2281+  5398 CD EE B2    	CALL	PrnFileInfo
2282+  539B C9          	RET 
2283+  539C             DelTreeDIR
2284+  539C 3A E3 A7    	LD	A,(TreeFlag)
2285+  539F B7          	OR	A
2286+  53A0 28 E5       	JR	Z,DelExt1
2287+  53A2             DelTreeDIR1
2288+  53A2 3A 22 51    	LD	A,(DeleteFlag)
2289+  53A5 B7          	OR	A
2290+  53A6 28 DF       	JR	Z,DelExt1
2291+  53A8 11 B2 55    	LD	DE,DelName
2292+  53AB CD 23 51    	CALL	MakeDELname
2293+  53AE F1          	POP	AF
2294+  53AF D3 E2       	OUT	(PAGE3),A
2295+  53B1 CD 9C A0    	CALL	SetClock
2296+  53B4 21 3C A1    	LD	HL,SetMouse
2297+  53B7 E3          	EX	(SP),HL
2298+  53B8 E5          	PUSH	HL
2299+  53B9 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
2300+  53BD 08          	EX	AF,AF'
2301+  53BE FD E5       	PUSH	IY
2302+  53C0 DB E2       	IN	A,(PAGE3)
2303+  53C2 F5          	PUSH	AF
2304+  53C3 FD 21 8A A5 	LD	IY,LeftPanel
2305+  53C7 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
2306+  53CB 20 04       	JR	NZ,$+6
2307+  53CD FD 21 B6 A6 	LD	IY,RightPanel
2308+  53D1 FD CB 00 46 	BIT	0,(IY+PanelFlg)
2309+  53D5 3A EE A7    	LD	A,(DIRpage1)
2310+  53D8 28 03       	JR	Z,$+5
2311+  53DA 3A EF A7    	LD	A,(DIRpage2)
2312+  53DD D3 E2       	OUT	(PAGE3),A
2313+  53DF 08          	EX	AF,AF'
2314+  53E0 20 53       	JR	NZ,DelTree1
2315+  53E2 FD CB 00 46 	BIT	0,(IY+PanelFlg)
2316+  53E6 21 8A A5    	LD	HL,LeftPanel
2317+  53E9 20 03       	JR	NZ,$+5
2318+  53EB 21 B6 A6    	LD	HL,RightPanel
2319+  53EE 11 2C 00    	LD	DE,BegPath
2320+  53F1 19          	ADD	HL,DE
2321+  53F2 23          	INC	HL
2322+  53F3 23          	INC	HL
2323+  53F4 CD F0 B0    	CALL	FindTreeDIR
2324+  53F7 DA 2D 55    	JP	C,DelDIRn
2325+  53FA 21 F1 BF    	LD	HL,#C001-#10
2326+  53FD 01 10 00    	LD	BC,#0010
2327+  5400 09          	ADD	HL,BC
2328+  5401 CB 46       	BIT	0,(HL)
2329+  5403 28 FB       	JR	Z,$-3
2330+  5405 2B          	DEC	HL
2331+  5406 7E          	LD	A,(HL)
2332+  5407 E6 7F       	AND	#7F
2333+  5409 3C          	INC	A
2334+  540A DD 6F       	LD	LX,A
2335+  540C 09          	ADD	HL,BC
2336+  540D 7E          DlTree1	LD	A,(HL)
2337+  540E E6 7F       	AND	#7F
2338+  5410 DD BD       	CP	LX
2339+  5412 20 17       	JR	NZ,DlTr31
2340+  5414 E5          	PUSH	HL
2341+  5415 11 B2 55    	LD	DE,DelName
2342+  5418 23          	INC	HL
2343+  5419 23          	INC	HL
2344+  541A 1A          DlTree2	LD	A,(DE)
2345+  541B B7          	OR	A
2346+  541C 28 10       	JR	Z,DlTree4
2347+  541E BE          	CP	(HL)
2348+  541F 20 04       	JR	NZ,DlTree3
2349+  5421 23          	INC	HL
2350+  5422 13          	INC	DE
2351+  5423 18 F5       	JR	DlTree2
2352+  5425 E1          DlTree3	POP	HL
2353+  5426 CB 7E       	BIT	7,(HL)
2354+  5428 C2 2D 55    	JP	NZ,DelDIRn
2355+  542B 09          DlTr31	ADD	HL,BC
2356+  542C 18 DF       	JR	DlTree1
2357+  542E             DlTree4
2358+  542E 7E          	LD	A,(HL)
2359+  542F B7          	OR	A
2360+  5430 20 F3       	JR	NZ,DlTree3
2361+  5432 E1          	POP	HL
2362+  5433 18 15       	JR	DelTree2
2363+  5435             DelTree1
2364+  5435 FD 6E 15    	LD	L,(IY+PanelFFl)
2365+  5438 FD 66 16    	LD	H,(IY+PanelFFh)
2366+  543B FD 5E 17    	LD	E,(IY+PanelCFl)
2367+  543E FD 56 18    	LD	D,(IY+PanelCFh)
2368+  5441 19          	ADD	HL,DE
2369+  5442 29          	ADD	HL,HL
2370+  5443 29          	ADD	HL,HL
2371+  5444 29          	ADD	HL,HL
2372+  5445 29          	ADD	HL,HL
2373+  5446 7C          	LD	A,H
2374+  5447 F6 C0       	OR	#C0
2375+  5449 67          	LD	H,A
2376+  544A             DelTree2
2377+  544A 5E          	LD	E,(HL)
2378+  544B 23          	INC	HL
2379+  544C 7E          	LD	A,(HL)
2380+  544D 01 0E 00    	LD	BC,#000E
2381+  5450 09          	ADD	HL,BC
2382+  5451 56          	LD	D,(HL)
2383+  5452 23          	INC	HL
2384+  5453 08          	EX	AF,AF'
2385+  5454 D5          	PUSH	DE
2386+  5455 E5          	PUSH	HL
2387+  5456 4D          	LD	C,L
2388+  5457 44          	LD	B,H
2389+  5458 FD 6E 13    	LD	L,(IY+PanelEFl)
2390+  545B FD 66 14    	LD	H,(IY+PanelEFh)
2391+  545E 29          	ADD	HL,HL
2392+  545F 29          	ADD	HL,HL
2393+  5460 29          	ADD	HL,HL
2394+  5461 29          	ADD	HL,HL
2395+  5462 7C          	LD	A,H
2396+  5463 F6 C0       	OR	#C0
2397+  5465 67          	LD	H,A
2398+  5466 B7          	OR	A
2399+  5467 ED 42       	SBC	HL,BC
2400+  5469 4D          	LD	C,L
2401+  546A 44          	LD	B,H
2402+  546B E1          	POP	HL
2403+  546C 54          	LD	D,H
2404+  546D 7D          	LD	A,L
2405+  546E D6 10       	SUB	#10
2406+  5470 5F          	LD	E,A
2407+  5471 30 01       	JR	NC,$+3
2408+  5473 15          	DEC	D
2409+  5474 D5          	PUSH	DE
2410+  5475 78          	LD	A,B
2411+  5476 B1          	OR	C
2412+  5477 28 02       	JR	Z,$+4
2413+  5479 ED B0       	LDIR 
2414+  547B E1          	POP	HL
2415+  547C D1          	POP	DE
2416+  547D 2B          	DEC	HL
2417+  547E 72          	LD	(HL),D
2418+  547F 7D          	LD	A,L
2419+  5480 D6 0E       	SUB	#0E
2420+  5482 6F          	LD	L,A
2421+  5483 30 01       	JR	NC,$+3
2422+  5485 25          	DEC	H
2423+  5486 08          	EX	AF,AF'
2424+  5487 B7          	OR	A
2425+  5488 28 01       	JR	Z,$+3
2426+  548A 77          	LD	(HL),A
2427+  548B 2B          	DEC	HL
2428+  548C CB 7B       	BIT	7,E
2429+  548E 28 14       	JR	Z,DelTree3
2430+  5490 CB BB       	RES	7,E
2431+  5492 01 10 00    	LD	BC,#0010
2432+  5495 09          	ADD	HL,BC
2433+  5496 ED 42       DelTr1	SBC	HL,BC
2434+  5498 7E          	LD	A,(HL)
2435+  5499 E6 7F       	AND	#7F
2436+  549B BB          	CP	E
2437+  549C 38 06       	JR	C,DelTree3
2438+  549E 28 02       	JR	Z,$+4
2439+  54A0 18 F4       	JR	DelTr1
2440+  54A2 CB FE       	SET	7,(HL)
2441+  54A4             DelTree3
2442+  54A4 FD 6E 13    	LD	L,(IY+PanelEFl)
2443+  54A7 FD 66 14    	LD	H,(IY+PanelEFh)
2444+  54AA 2B          	DEC	HL
2445+  54AB FD 75 13    	LD	(IY+PanelEFl),L
2446+  54AE FD 74 14    	LD	(IY+PanelEFh),H
2447+  54B1 FD 6E 15    	LD	L,(IY+PanelFFl)
2448+  54B4 FD 66 16    	LD	H,(IY+PanelFFh)
2449+  54B7 FD 5E 17    	LD	E,(IY+PanelCFl)
2450+  54BA FD 56 18    	LD	D,(IY+PanelCFh)
2451+  54BD 7C          	LD	A,H
2452+  54BE B5          	OR	L
2453+  54BF 28 14       	JR	Z,DelTree4
2454+  54C1 2B          	DEC	HL
2455+  54C2 FD 75 15    	LD	(IY+PanelFFl),L
2456+  54C5 FD 74 16    	LD	(IY+PanelFFh),H
2457+  54C8 19          	ADD	HL,DE
2458+  54C9 FD 4E 13    	LD	C,(IY+PanelEFl)
2459+  54CC FD 46 14    	LD	B,(IY+PanelEFh)
2460+  54CF 23          	INC	HL
2461+  54D0 ED 42       	SBC	HL,BC
2462+  54D2 30 01       	JR	NC,DelTree4
2463+  54D4 13          	INC	DE
2464+  54D5             DelTree4
2465+  54D5 FD 73 17    	LD	(IY+PanelCFl),E
2466+  54D8 FD 72 18    	LD	(IY+PanelCFh),D
2467+  54DB             
2468+  54DB 21 00 80    	LD	HL,WorkBuffer
2469+  54DE 0E 1E       	LD	C,#1E
2470+  54E0 FD E5       	PUSH	IY
2471+  54E2 D7          	RST	#10
2472+  54E3 FD E1       	POP	IY
2473+  54E5 21 21 AF    	LD	HL,BegDIR
2474+  54E8 0E 1D       	LD	C,#1D
2475+  54EA FD E5       	PUSH	IY
2476+  54EC D7          	RST	#10
2477+  54ED FD E1       	POP	IY
2478+  54EF 38 36       	JR	C,DelDIR2
2479+  54F1 21 04 AF    	LD	HL,TreeName
2480+  54F4 11 00 81    	LD	DE,WorkBuffer+#100
2481+  54F7 01 19 00    	LD	BC,#0019
2482+  54FA 3A 7F A8    	LD	A,(FileAtribut)
2483+  54FD FD E5       	PUSH	IY
2484+  54FF D7          	RST	#10
2485+  5500 FD E1       	POP	IY
2486+  5502 38 23       	JR	C,DelDIR2
2487+  5504 21 04 AF    	LD	HL,TreeName
2488+  5507 97          	SUB	A
2489+  5508 0E 0A       	LD	C,#0A
2490+  550A FD E5       	PUSH	IY
2491+  550C D7          	RST	#10
2492+  550D FD E1       	POP	IY
2493+  550F 38 16       	JR	C,DelDIR2
2494+  5511 FD 6E 13    	LD	L,(IY+PanelEFl)
2495+  5514 FD 66 14    	LD	H,(IY+PanelEFh)
2496+  5517 29          	ADD	HL,HL
2497+  5518 29          	ADD	HL,HL
2498+  5519 29          	ADD	HL,HL
2499+  551A 29          	ADD	HL,HL
2500+  551B EB          	EX	DE,HL
2501+  551C 21 00 C0    	LD	HL,#C000
2502+  551F 0E 14       	LD	C,#14
2503+  5521 F5          	PUSH	AF
2504+  5522 D7          	RST	#10
2505+  5523 F1          	POP	AF
2506+  5524 0E 12       	LD	C,#12
2507+  5526 D7          	RST	#10
2508+  5527 21 00 80    DelDIR2	LD	HL,WorkBuffer
2509+  552A 0E 1D       	LD	C,#1D
2510+  552C D7          	RST	#10
2511+  552D F1          DelDIRn	POP	AF
2512+  552E D3 E2       	OUT	(PAGE3),A
2513+  5530 FD E1       	POP	IY
2514+  5532 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
2515+  5536 20 47       	JR	NZ,DeleteExt1
2516+  5538 CD F5 A7    	CALL	ReadDIR
2517+  553B CD 45 B5    	CALL	PrintDIR
2518+  553E CD EE B2    	CALL	PrnFileInfo
2519+  5541 FD E5       	PUSH	IY
2520+  5543 DD E1       	POP	IX
2521+  5545 11 05 00    	LD	DE,BegPBar
2522+  5548 DD 19       	ADD	IX,DE
2523+  554A CD F7 96    	CALL	InitScrBar
2524+  554D FD 7E 01    	LD	A,(IY+ViewFlg)
2525+  5550 E6 03       	AND	#03
2526+  5552 F5          	PUSH	AF
2527+  5553 CC 35 97    	CALL	Z,PrnHScrBar
2528+  5556 F1          	POP	AF
2529+  5557 C4 8E 98    	CALL	NZ,PrnVScrBar
2530+  555A FD E5       	PUSH	IY
2531+  555C FD CB 00 46 	BIT	0,(IY+PanelFlg)
2532+  5560 FD 21 B6 A6 	LD	IY,RightPanel
2533+  5564 28 04       	JR	Z,$+6
2534+  5566 FD 21 8A A5 	LD	IY,LeftPanel
2535+  556A CD 45 B5    	CALL	PrintDIR
2536+  556D CD EE B2    	CALL	PrnFileInfo
2537+  5570 FD E5       	PUSH	IY
2538+  5572 DD E1       	POP	IX
2539+  5574 11 05 00    	LD	DE,BegPBar
2540+  5577 DD 19       	ADD	IX,DE
2541+  5579 CD 8E 98    	CALL	PrnVScrBar
2542+  557C FD E1       	POP	IY
2543+  557E C9          	RET 
2544+  557F             DeleteExt1
2545+  557F 33          	INC	SP
2546+  5580 33          	INC	SP
2547+  5581 CD 45 B5    	CALL	PrintDIR
2548+  5584 CD EE B2    	CALL	PrnFileInfo
2549+  5587 CD EA BA    	CALL	SetInvert
2550+  558A FD E5       	PUSH	IY
2551+  558C DD E1       	POP	IX
2552+  558E 11 05 00    	LD	DE,BegPBar
2553+  5591 DD 19       	ADD	IX,DE
2554+  5593 CD F7 96    	CALL	InitScrBar
2555+  5596 CD 8E 98    	CALL	PrnVScrBar
2556+  5599 CD 8A B0    	CALL	MakeTreePath
2557+  559C FD E5       	PUSH	IY
2558+  559E FD CB 00 46 	BIT	0,(IY+PanelFlg)
2559+  55A2 FD 21 B6 A6 	LD	IY,RightPanel
2560+  55A6 28 04       	JR	Z,$+6
2561+  55A8 FD 21 8A A5 	LD	IY,LeftPanel
2562+  55AC CD 3F BC    	CALL	NewDIRECTORY
2563+  55AF FD E1       	POP	IY
2564+  55B1 C9          	RET 
2565+  55B2             DelName
2566+  55B2 00          	DEFS	13,0
2567+  55BF             ;[]==========================================================[]
2568+  55BF             QuitR
2569+  55BF CD F0 86    	CALL	MakeWindow
2570+  55C2 01          	DEFB	#01
2571+  55C3 D0 00 58 00 	DEFW	#00D0,#0058
2572+  55C7 E0 00 32 00 	DEFW	#00E0,#0032
2573+  55CB 02          	DEFB	#02	;Head place
2574+  55CC 04 00 02 00 	DEFW	#0004,#0002
2575+  55D0 D8 00 0A 00 	DEFW	#00D8,#000A
2576+  55D4 00          	DEFB	#00
2577+  55D5 01          	DEFB	#01	;Text Line
2578+  55D6 68 00 03 00 	DEFW	#0068,#0003
2579+  55DA 0F          	DEFB	#0F
2580+  55DB 5175697400  	DEFB	"Quit",0
2581+  55E0 01          	DEFB	#01	;Text Line
2582+  55E1 1C 00 13 00 	DEFW	#001C,#0013
2583+  55E5 80          	DEFB	#80
2584+  55E6             	DEFB	"Do you want quit Flex Navigator ?",0
2584+  55E6 446F20796F752077616E74207175697420466C6578204E6176696761746F7220
2584+  5606 3F00
2585+  5608 04          	DEFB	#04	;UpRectan
2586+  5609 20 00 20 00 	DEFW	#0020,#0020
2587+  560D 48 00 0E 00 	DEFW	#0048,#000E
2588+  5611 01          	DEFB	#01	;Text Line
2589+  5612 3A 00 23 00 	DEFW	#003A,#0023
2590+  5616 80          	DEFB	#80
2591+  5617 59 65 73 00 	DEFB	"Yes",0
2592+  561B 04          	DEFB	#04	;UpRectan
2593+  561C 78 00 20 00 	DEFW	#0078,#0020
2594+  5620 48 00 0E 00 	DEFW	#0048,#000E
2595+  5624 01          	DEFB	#01	;Text Line
2596+  5625 96 00 23 00 	DEFW	#0096,#0023
2597+  5629 80          	DEFB	#80
2598+  562A 4E 6F 00    	DEFB	"No",0
2599+  562D 00          	DEFB	#00
2600+  562E             QuitLoop
2601+  562E DD 21 EE 73 	LD	IX,QuitTab
2602+  5632 CD 1C 9B    	CALL	TestCoords
2603+  5635 0E 31       	LD	C,#31
2604+  5637 D7          	RST	#10
2605+  5638 28 F4       	JR	Z,QuitLoop
2606+  563A 78          	LD	A,B
2607+  563B B7          	OR	A
2608+  563C 20 F0       	JR	NZ,QuitLoop
2609+  563E 7B          	LD	A,E
2610+  563F FE 1B       	CP	#1B
2611+  5641 28 0E       	JR	Z,QuitAbort
2612+  5643 FE 0D       	CP	#0D
2613+  5645 28 11       	JR	Z,QuitOkey
2614+  5647 CB AF       	RES	5,A
2615+  5649 FE 59       	CP	"Y"
2616+  564B 28 0B       	JR	Z,QuitOkey
2617+  564D FE 4E       	CP	"N"
2618+  564F 20 DD       	JR	NZ,QuitLoop
2619+  5651             QuitAbort
2620+  5651 CD F0 86    	CALL	MakeWindow
2621+  5654 7F          	DEFB	#7F
2622+  5655 00          	DEFB	#00
2623+  5656 37          	SCF 
2624+  5657 C9          	RET 
2625+  5658             QuitOkey
2626+  5658 CD F0 86    	CALL	MakeWindow
2627+  565B 7F          	DEFB	#7F
2628+  565C 00          	DEFB	#00
2629+  565D B7          	OR	A
2630+  565E C9          	RET 
2631+  565F             
2632+  565F             
2633+  565F             
0287   565F             	include "fnmisc.z80"
0001+  565F             
0002+  565F             ;[]==========================================================[]
0003+  565F             FileInfoR
0004+  565F FD 7E 13    	LD	A,(IY+PanelEFl)
0005+  5662 FD B6 14    	OR	(IY+PanelEFh)
0006+  5665 C8          	RET	Z
0007+  5666 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0008+  566A C0          	RET	NZ
0009+  566B 3E C0       	LD	A,#C0
0010+  566D D3 89       	OUT	(YPORT),A
0011+  566F DB E2       	IN	A,(PAGE3)
0012+  5671 F5          	PUSH	AF
0013+  5672 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0014+  5676 3A EE A7    	LD	A,(DIRpage1)
0015+  5679 28 03       	JR	Z,$+5
0016+  567B 3A EF A7    	LD	A,(DIRpage2)
0017+  567E D3 E2       	OUT	(PAGE3),A
0018+  5680 FD 6E 15    	LD	L,(IY+PanelFFl)
0019+  5683 FD 66 16    	LD	H,(IY+PanelFFh)
0020+  5686 FD 5E 17    	LD	E,(IY+PanelCFl)
0021+  5689 FD 56 18    	LD	D,(IY+PanelCFh)
0022+  568C 19          	ADD	HL,DE
0023+  568D 29          	ADD	HL,HL
0024+  568E 29          	ADD	HL,HL
0025+  568F 29          	ADD	HL,HL
0026+  5690 5D          	LD	E,L
0027+  5691 54          	LD	D,H
0028+  5692 29          	ADD	HL,HL
0029+  5693 19          	ADD	HL,DE
0030+  5694 7C          	LD	A,H
0031+  5695 F6 C0       	OR	#C0
0032+  5697 67          	LD	H,A
0033+  5698 11 00 80    	LD	DE,WorkBuffer
0034+  569B 01 18 00    	LD	BC,#0018
0035+  569E ED B0       	LDIR 
0036+  56A0 F1          	POP	AF
0037+  56A1 D3 E2       	OUT	(PAGE3),A
0038+  56A3 DD 21 00 80 	LD	IX,WorkBuffer
0039+  56A7 21 01 80    	LD	HL,WorkBuffer+1
0040+  56AA 11 20 80    	LD	DE,WorkBuffer+#20
0041+  56AD 7E          	LD	A,(HL)
0042+  56AE FE 2E       	CP	"."
0043+  56B0 C8          	RET	Z
0044+  56B1 CD 9C A0    	CALL	SetClock
0045+  56B4 D5          	PUSH	DE
0046+  56B5 CD 6A BE    	CALL	MakeDOSname
0047+  56B8 E1          	POP	HL
0048+  56B9 11 8A 57    	LD	DE,FName
0049+  56BC 0E 0C       	LD	C,12
0050+  56BE 97          	SUB	A
0051+  56BF ED A0       	LDI 
0052+  56C1 BE          	CP	(HL)
0053+  56C2 20 FB       	JR	NZ,$-3
0054+  56C4 79          	LD	A,C
0055+  56C5 B7          	OR	A
0056+  56C6 28 07       	JR	Z,FInfo1
0057+  56C8 47          	LD	B,A
0058+  56C9 3E 20       	LD	A,#20
0059+  56CB 12          	LD	(DE),A
0060+  56CC 13          	INC	DE
0061+  56CD 10 FC       	DJNZ	$-2
0062+  56CF 21 45 58    FInfo1	LD	HL,FAtributs
0063+  56D2 11 AA 57    	LD	DE,FAttrib
0064+  56D5 DD 4E 0E    	LD	C,(IX+#0E)
0065+  56D8 06 08       	LD	B,#08
0066+  56DA CB 11       FInfo2	RL	C
0067+  56DC 3E 2D       	LD	A,"-"
0068+  56DE 30 01       	JR	NC,$+3
0069+  56E0 7E          	LD	A,(HL)
0070+  56E1 12          	LD	(DE),A
0071+  56E2 23          	INC	HL
0072+  56E3 13          	INC	DE
0073+  56E4 10 F4       	DJNZ	FInfo2
0074+  56E6 21 BF 57    	LD	HL,FLen
0075+  56E9 06 10       	LD	B,#10
0076+  56EB 3E 20       	LD	A,#20
0077+  56ED 77          	LD	(HL),A
0078+  56EE 23          	INC	HL
0079+  56EF 10 FC       	DJNZ	$-2
0080+  56F1 11 BF 57    	LD	DE,FLen
0081+  56F4 DD CB 0E 66 	BIT	4,(IX+#0E)
0082+  56F8 28 0A       	JR	Z,FInfo3
0083+  56FA 21 5D B4    	LD	HL,DirText
0084+  56FD 01 0A 00    	LD	BC,#000A
0085+  5700 ED B0       	LDIR 
0086+  5702 18 1B       	JR	FInfo4
0087+  5704 DD 6E 0F    FInfo3	LD	L,(IX+#0F)
0088+  5707 DD 66 10    	LD	H,(IX+#10)
0089+  570A DD 4E 11    	LD	C,(IX+#11)
0090+  570D DD 46 12    	LD	B,(IX+#12)
0091+  5710 CD E2 A2    	CALL	ConvNumTxt32
0092+  5713 3E 20       	LD	A,#20
0093+  5715 12          	LD	(DE),A
0094+  5716 13          	INC	DE
0095+  5717 21 B5 5C    	LD	HL,Bytes
0096+  571A 01 05 00    	LD	BC,#0005
0097+  571D ED B0       	LDIR 
0098+  571F 11 DD 57    FInfo4	LD	DE,FData
0099+  5722 CD 67 B4    	CALL	GetData
0100+  5725 11 E8 57    	LD	DE,FTime
0101+  5728 CD 82 B4    	CALL	GetTime
0102+  572B 21 20 80    	LD	HL,WorkBuffer+#20
0103+  572E 11 30 80    	LD	DE,WorkBuffer+#30
0104+  5731 01 19 00    	LD	BC,#0019
0105+  5734 3A 7F A8    	LD	A,(FileAtribut)
0106+  5737 FD E5       	PUSH	IY
0107+  5739 D7          	RST	#10
0108+  573A FD E1       	POP	IY
0109+  573C DA 3C A1    	JP	C,SetMouse
0110+  573F 21 04 58    	LD	HL,FClast
0111+  5742 06 05       	LD	B,#05
0112+  5744 3E 20       	LD	A,#20
0113+  5746 77          	LD	(HL),A
0114+  5747 23          	INC	HL
0115+  5748 10 FC       	DJNZ	$-2
0116+  574A 21 4A 80    	LD	HL,WorkBuffer+#30+26
0117+  574D 5E          	LD	E,(HL)
0118+  574E 23          	INC	HL
0119+  574F 56          	LD	D,(HL)
0120+  5750 EB          	EX	DE,HL
0121+  5751 11 04 58    	LD	DE,FClast
0122+  5754 CD 4C A3    	CALL	ConvNumTxt16
0123+  5757 CD F0 86    	CALL	MakeWindow
0124+  575A 01          	DEFB	#01
0125+  575B F0 00 50 00 	DEFW	#00F0,#0050
0126+  575F A0 00 62 00 	DEFW	#00A0,#0062
0127+  5763 02          	DEFB	#02	;Head place
0128+  5764 04 00 02 00 	DEFW	#0004,#0002
0129+  5768 98 00 0A 00 	DEFW	#0098,#000A
0130+  576C 00          	DEFB	#00
0131+  576D 01          	DEFB	#01	;Text Line
0132+  576E 38 00 03 00 	DEFW	#0038,#0003
0133+  5772 0F          	DEFB	#0F
0134+  5773             	DEFB	"File info",0
0134+  5773 46696C6520696E666F00
0135+  577D 01          	DEFB	#01	;Text Line
0136+  577E 0A 00 14 00 	DEFW	#000A,#0014
0137+  5782 80          	DEFB	#80
0138+  5783             	DEFB	"Name:  "
0138+  5783 4E616D653A2020
0139+  578A             FName	DEFB	"            ",0
0139+  578A 20202020202020202020202000
0140+  5797 01          	DEFB	#01	;Text Line
0141+  5798 0A 00 20 00 	DEFW	#000A,#0020
0142+  579C 80          	DEFB	#80
0143+  579D             	DEFB	"Attributes:  "
0143+  579D 417474726962757465733A2020
0144+  57AA             FAttrib	DEFB	"        ",0
0144+  57AA 202020202020202000
0145+  57B3 01          	DEFB	#01	;Text Line
0146+  57B4 0A 00 2C 00 	DEFW	#000A,#002C
0147+  57B8 80          	DEFB	#80
0148+  57B9             	DEFB	"Len:  "
0148+  57B9 4C656E3A2020
0149+  57BF             FLen	DEFB	"                ",#00
0149+  57BF 2020202020202020202020202020202000
0150+  57D0 01          	DEFB	#01	;Text Line
0151+  57D1 0A 00 38 00 	DEFW	#000A,#0038
0152+  57D5 80          	DEFB	#80
0153+  57D6             	DEFB	"Data:  "
0153+  57D6 446174613A2020
0154+  57DD             FData	DEFB	"           "
0154+  57DD 2020202020202020202020
0155+  57E8             FTime	DEFB	"     ",0
0155+  57E8 202020202000
0156+  57EE 01          	DEFB	#01	;Text Line
0157+  57EF 0A 00 44 00 	DEFW	#000A,#0044
0158+  57F3 80          	DEFB	#80
0159+  57F4             	DEFB	"First Claster:  "
0159+  57F4 466972737420436C61737465723A2020
0160+  5804             FClast	DEFB	"     ",0
0160+  5804 202020202000
0161+  580A 04          	DEFB	#04	;UpRectan
0162+  580B 2C 00 50 00 	DEFW	#002C,#0050
0163+  580F 48 00 0E 00 	DEFW	#0048,#000E
0164+  5813 01          	DEFB	#01	;Text Line
0165+  5814 48 00 53 00 	DEFW	#0048,#0053
0166+  5818 80          	DEFB	#80
0167+  5819 4F 6B 00    	DEFB	"Ok",0
0168+  581C 00          	DEFB	#00
0169+  581D CD 3C A1    	CALL	SetMouse
0170+  5820             FileInfoLoop
0171+  5820 DD 21 6A 70 	LD	IX,FileInfoTab
0172+  5824 CD 1C 9B    	CALL	TestCoords
0173+  5827 0E 31       	LD	C,#31
0174+  5829 D7          	RST	#10
0175+  582A 28 F4       	JR	Z,FileInfoLoop
0176+  582C 78          	LD	A,B
0177+  582D B7          	OR	A
0178+  582E 20 F0       	JR	NZ,FileInfoLoop
0179+  5830 7B          	LD	A,E
0180+  5831 FE 1B       	CP	#1B
0181+  5833 28 0A       	JR	Z,FileInfoExt
0182+  5835 FE 0D       	CP	#0D
0183+  5837 28 06       	JR	Z,FileInfoExt
0184+  5839 CB AF       	RES	5,A
0185+  583B FE 4F       	CP	"O"
0186+  583D 20 E1       	JR	NZ,FileInfoLoop
0187+  583F             FileInfoExt
0188+  583F CD F0 86    	CALL	MakeWindow
0189+  5842 7F          	DEFB	#7F
0190+  5843 00          	DEFB	#00
0191+  5844 C9          	RET 
0192+  5845             FAtributs
0193+  5845             	DEFB	"--ad-shr"
0193+  5845 2D2D61642D736872
0194+  584D             ;[]==========================================================[]
0195+  584D             PrintFileR
0196+  584D FD 7E 13    	LD	A,(IY+PanelEFl)
0197+  5850 FD B6 14    	OR	(IY+PanelEFh)
0198+  5853 C8          	RET	Z
0199+  5854 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0200+  5858 C0          	RET	NZ
0201+  5859 3E C0       	LD	A,#C0
0202+  585B D3 89       	OUT	(YPORT),A
0203+  585D DB E2       	IN	A,(PAGE3)
0204+  585F F5          	PUSH	AF
0205+  5860 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0206+  5864 3A EE A7    	LD	A,(DIRpage1)
0207+  5867 28 03       	JR	Z,$+5
0208+  5869 3A EF A7    	LD	A,(DIRpage2)
0209+  586C D3 E2       	OUT	(PAGE3),A
0210+  586E FD 6E 15    	LD	L,(IY+PanelFFl)
0211+  5871 FD 66 16    	LD	H,(IY+PanelFFh)
0212+  5874 FD 5E 17    	LD	E,(IY+PanelCFl)
0213+  5877 FD 56 18    	LD	D,(IY+PanelCFh)
0214+  587A 19          	ADD	HL,DE
0215+  587B 29          	ADD	HL,HL
0216+  587C 29          	ADD	HL,HL
0217+  587D 29          	ADD	HL,HL
0218+  587E 5D          	LD	E,L
0219+  587F 54          	LD	D,H
0220+  5880 29          	ADD	HL,HL
0221+  5881 19          	ADD	HL,DE
0222+  5882 7C          	LD	A,H
0223+  5883 F6 C0       	OR	#C0
0224+  5885 67          	LD	H,A
0225+  5886 11 00 80    	LD	DE,WorkBuffer
0226+  5889 01 18 00    	LD	BC,#0018
0227+  588C ED B0       	LDIR 
0228+  588E F1          	POP	AF
0229+  588F D3 E2       	OUT	(PAGE3),A
0230+  5891 DD 21 00 80 	LD	IX,WorkBuffer
0231+  5895 DD CB 0E 66 	BIT	4,(IX+#0E)
0232+  5899 C0          	RET	NZ
0233+  589A 21 01 80    	LD	HL,WorkBuffer+1
0234+  589D 11 B9 5A    	LD	DE,PrnFileName
0235+  58A0 CD 6A BE    	CALL	MakeDOSname
0236+  58A3 DD 6E 0F    	LD	L,(IX+#0F)
0237+  58A6 DD 66 10    	LD	H,(IX+#10)
0238+  58A9 22 C6 5A    	LD	(PrnFileLen),HL
0239+  58AC DD 5E 11    	LD	E,(IX+#11)
0240+  58AF DD 56 12    	LD	D,(IX+#12)
0241+  58B2 ED 53 C8 5A 	LD	(PrnFileLen+2),DE
0242+  58B6 7C          	LD	A,H
0243+  58B7 B5          	OR	L
0244+  58B8 B2          	OR	D
0245+  58B9 B3          	OR	E
0246+  58BA C8          	RET	Z
0247+  58BB 01 3D 01    	LD	BC,#013D
0248+  58BE FD E5       	PUSH	IY
0249+  58C0 D7          	RST	#10
0250+  58C1 FD E1       	POP	IY
0251+  58C3 F5          	PUSH	AF
0252+  58C4 DC A8 86    	CALL	C,DOSError
0253+  58C7 F1          	POP	AF
0254+  58C8 D8          	RET	C
0255+  58C9 32 CA 5A    	LD	(PrnMIndef),A
0256+  58CC FD E5       	PUSH	IY
0257+  58CE 21 00 84    	LD	HL,PagesList
0258+  58D1 0E C5       	LD	C,#C5
0259+  58D3 CF          	RST	#08
0260+  58D4 CD F0 86    	CALL	MakeWindow
0261+  58D7 01          	DEFB	#01
0262+  58D8 A8 00 54 00 	DEFW	#00A8,#0054
0263+  58DC 30 01 3E 00 	DEFW	#0130,#003E
0264+  58E0 02          	DEFB	#02	;Head place
0265+  58E1 04 00 02 00 	DEFW	#0004,#0002
0266+  58E5 28 01 0A 00 	DEFW	#0128,#000A
0267+  58E9 00          	DEFB	#00
0268+  58EA 01          	DEFB	#01	;Text Line
0269+  58EB 8E 00 03 00 	DEFW	#008E,#0003
0270+  58EF 0F          	DEFB	#0F
0271+  58F0             	DEFB	"Print",0
0271+  58F0 5072696E7400
0272+  58F6 01          	DEFB	#01	;Text Line
0273+  58F7 10 00 10 00 	DEFW	#0010,#0010
0274+  58FB 80          	DEFB	#80
0275+  58FC             	DEFB	"Printing file:",0
0275+  58FC 5072696E74696E672066696C653A00
0276+  590B 03          	DEFB	#03	;Углубление
0277+  590C 10 00 1C 00 	DEFW	#0010,#001C
0278+  5910 10 01 0C 00 	DEFW	#0110,#000C
0279+  5914 02          	DEFB	#02	;Head place
0280+  5915 12 00 1D 00 	DEFW	#0012,#001D
0281+  5919 0C 01 0A 00 	DEFW	#010C,#000A
0282+  591D 0F          	DEFB	#0F
0283+  591E 04          	DEFB	#04	;UpRectan
0284+  591F 74 00 2C 00 	DEFW	#0074,#002C
0285+  5923 48 00 0E 00 	DEFW	#0048,#000E
0286+  5927 01          	DEFB	#01	;Text Line
0287+  5928 8C 00 2F 00 	DEFW	#008C,#002F
0288+  592C 80          	DEFB	#80
0289+  592D 53746F7000  	DEFB	"Stop",0
0290+  5932 00          	DEFB	#00
0291+  5933 FD E5       	PUSH	IY
0292+  5935 E1          	POP	HL
0293+  5936 11 2C 00    	LD	DE,BegPath
0294+  5939 19          	ADD	HL,DE
0295+  593A 11 00 80    	LD	DE,WorkBuffer
0296+  593D 97          	SUB	A
0297+  593E ED A0       	LDI 
0298+  5940 BE          	CP	(HL)
0299+  5941 20 FB       	JR	NZ,$-3
0300+  5943 2B          	DEC	HL
0301+  5944 3E 5C       	LD	A,"\\"
0302+  5946 BE          	CP	(HL)
0303+  5947 28 02       	JR	Z,$+4
0304+  5949 12          	LD	(DE),A
0305+  594A 13          	INC	DE
0306+  594B 21 B9 5A    	LD	HL,PrnFileName
0307+  594E 97          	SUB	A
0308+  594F ED A0       	LDI 
0309+  5951 BE          	CP	(HL)
0310+  5952 20 FB       	JR	NZ,$-3
0311+  5954 12          	LD	(DE),A
0312+  5955 DD 21 D0 00 	LD	IX,#00D0
0313+  5959 21 00 80    	LD	HL,WorkBuffer
0314+  595C 11 F8 00    	LD	DE,#00F8
0315+  595F 01 64 00    	LD	BC,#0064
0316+  5962 3E 80       	LD	A,#80
0317+  5964 CD 4B 8E    	CALL	PrnRangPathL
0318+  5967             
0319+  5967 DD 21 BC 70 	LD	IX,PrintFTab
0320+  596B CD 1C 9B    	CALL	TestCoords
0321+  596E DD 21 A6 5A 	LD	IX,ProcessFPrn
0322+  5972 2A C6 5A    	LD	HL,(PrnFileLen)
0323+  5975 ED 5B C8 5A 	LD	DE,(PrnFileLen+2)
0324+  5979 7D          	LD	A,L
0325+  597A 6C          	LD	L,H
0326+  597B 63          	LD	H,E
0327+  597C 5A          	LD	E,D
0328+  597D B7          	OR	A
0329+  597E 28 06       	JR	Z,InitPrn
0330+  5980 23          	INC	HL
0331+  5981 7C          	LD	A,H
0332+  5982 B5          	OR	L
0333+  5983 20 01       	JR	NZ,InitPrn
0334+  5985 1C          	INC	E
0335+  5986 DD 75 0A    InitPrn	LD	(IX+ProcMAXl1),L
0336+  5989 DD 74 0B    	LD	(IX+ProcMAXh1),H
0337+  598C DD 73 0C    	LD	(IX+ProcMAXl2),E
0338+  598F DD 36 0D 00 	LD	(IX+ProcMAXh2),#00
0339+  5993 CD E6 99    	CALL	InitProcess
0340+  5996             
0341+  5996 21 B9 5A    	LD	HL,PrnFileName
0342+  5999 3E 01       	LD	A,#01
0343+  599B 0E 11       	LD	C,#11
0344+  599D D7          	RST	#10
0345+  599E F5          	PUSH	AF
0346+  599F DC A8 86    	CALL	C,DOSError
0347+  59A2 F1          	POP	AF
0348+  59A3 DA 20 5A    	JP	C,PrnError
0349+  59A6 32 CB 5A    	LD	(PrnFHandle),A
0350+  59A9             
0351+  59A9 DB E2       	IN	A,(PAGE3)
0352+  59AB F5          	PUSH	AF
0353+  59AC 21 00 84    	LD	HL,PagesList
0354+  59AF 7E          	LD	A,(HL)
0355+  59B0 23          ReadPr1	INC	HL
0356+  59B1 E5          	PUSH	HL
0357+  59B2 D3 E2       	OUT	(PAGE3),A
0358+  59B4 2A C6 5A    	LD	HL,(PrnFileLen)
0359+  59B7 ED 5B C8 5A 	LD	DE,(PrnFileLen+2)
0360+  59BB 01 00 40    	LD	BC,#4000
0361+  59BE B7          	OR	A
0362+  59BF ED 42       	SBC	HL,BC
0363+  59C1 06 00       	LD	B,#00
0364+  59C3 EB          	EX	DE,HL
0365+  59C4 ED 42       	SBC	HL,BC
0366+  59C6 EB          	EX	DE,HL
0367+  59C7 38 2C       	JR	C,ReadPrnEnd
0368+  59C9 22 C6 5A    	LD	(PrnFileLen),HL
0369+  59CC ED 53 C8 5A 	LD	(PrnFileLen+2),DE
0370+  59D0 CD 9C A0    	CALL	SetClock
0371+  59D3 21 00 C0    	LD	HL,#C000
0372+  59D6 11 00 40    	LD	DE,#4000
0373+  59D9 3A CB 5A    	LD	A,(PrnFHandle)
0374+  59DC 0E 13       	LD	C,#13
0375+  59DE D7          	RST	#10
0376+  59DF CD 3C A1    	CALL	SetMouse
0377+  59E2 01 00 40    	LD	BC,#4000
0378+  59E5 CD 30 5A    	CALL	PrintBlock
0379+  59E8 E1          	POP	HL
0380+  59E9 38 05       	JR	C,PrnEsc
0381+  59EB 7E          	LD	A,(HL)
0382+  59EC FE FF       	CP	#FF
0383+  59EE 20 C0       	JR	NZ,ReadPr1
0384+  59F0 F1          PrnEsc	POP	AF
0385+  59F1 D3 E2       	OUT	(PAGE3),A
0386+  59F3 18 25       	JR	PrnFileExit
0387+  59F5             ReadPrnEnd
0388+  59F5 21 00 C0    	LD	HL,#C000
0389+  59F8 ED 5B C6 5A 	LD	DE,(PrnFileLen)
0390+  59FC 7A          	LD	A,D
0391+  59FD B3          	OR	E
0392+  59FE 28 13       	JR	Z,ReadPrE
0393+  5A00 CD 9C A0    	CALL	SetClock
0394+  5A03 3A CB 5A    	LD	A,(PrnFHandle)
0395+  5A06 0E 13       	LD	C,#13
0396+  5A08 D5          	PUSH	DE
0397+  5A09 D7          	RST	#10
0398+  5A0A C1          	POP	BC
0399+  5A0B CD 3C A1    	CALL	SetMouse
0400+  5A0E CD 30 5A    	CALL	PrintBlock
0401+  5A11 38 03       	JR	C,$+5
0402+  5A13 CD 79 5A    ReadPrE	CALL	NxtPrnProc
0403+  5A16 E1          	POP	HL
0404+  5A17 F1          	POP	AF
0405+  5A18 D3 E2       	OUT	(PAGE3),A
0406+  5A1A             PrnFileExit
0407+  5A1A 3A CB 5A    	LD	A,(PrnFHandle)
0408+  5A1D 0E 12       	LD	C,#12
0409+  5A1F D7          	RST	#10
0410+  5A20             PrnError
0411+  5A20 3A CA 5A    	LD	A,(PrnMIndef)
0412+  5A23 0E 3E       	LD	C,#3E
0413+  5A25 D7          	RST	#10
0414+  5A26 FD E1       	POP	IY
0415+  5A28 76          	HALT 
0416+  5A29 76          	HALT 
0417+  5A2A CD F0 86    	CALL	MakeWindow
0418+  5A2D 7F          	DEFB	#7F
0419+  5A2E 00          	DEFB	#00
0420+  5A2F C9          	RET 
0421+  5A30             ;[]----------------------------------------------------------[]
0422+  5A30             PrintBlock
0423+  5A30 11 00 C0    	LD	DE,#C000
0424+  5A33             PrnBlockLp
0425+  5A33 1A          	LD	A,(DE)
0426+  5A34 13          	INC	DE
0427+  5A35 CD 42 5A    	CALL	PrintCHAR
0428+  5A38 D8          	RET	C
0429+  5A39 CD 79 5A    	CALL	NxtPrnProc
0430+  5A3C 0B          	DEC	BC
0431+  5A3D 78          	LD	A,B
0432+  5A3E B1          	OR	C
0433+  5A3F 20 F2       	JR	NZ,PrnBlockLp
0434+  5A41 C9          	RET 
0435+  5A42             PrintCHAR
0436+  5A42 6F          	LD	L,A
0437+  5A43 E5          	PUSH	HL
0438+  5A44 D5          	PUSH	DE
0439+  5A45 C5          	PUSH	BC
0440+  5A46 0E 03       	LD	C,#03
0441+  5A48 F7          	RST	#30
0442+  5A49 CB 47       	BIT	0,A
0443+  5A4B 28 09       	JR	Z,PrnCH1
0444+  5A4D DD 21 BC 70 	LD	IX,PrintFTab
0445+  5A51 CD 1C 9B    	CALL	TestCoords
0446+  5A54 38 04       	JR	C,PrnCH2
0447+  5A56 0E 31       PrnCH1	LD	C,#31
0448+  5A58 D7          	RST	#10
0449+  5A59 7B          	LD	A,E
0450+  5A5A C1          PrnCH2	POP	BC
0451+  5A5B D1          	POP	DE
0452+  5A5C E1          	POP	HL
0453+  5A5D D8          	RET	C
0454+  5A5E 28 0C       	JR	Z,PrnCHAR
0455+  5A60 FE 1B       	CP	#1B
0456+  5A62 37          	SCF 
0457+  5A63 C8          	RET	Z
0458+  5A64 CB AF       	RES	5,A
0459+  5A66 FE 53       	CP	"S"
0460+  5A68 20 02       	JR	NZ,PrnCHAR
0461+  5A6A             StopPrint
0462+  5A6A 37          	SCF 
0463+  5A6B C9          	RET 
0464+  5A6C D5          PrnCHAR	PUSH	DE
0465+  5A6D C5          	PUSH	BC
0466+  5A6E 7D          	LD	A,L
0467+  5A6F 0E 5F       	LD	C,#5F
0468+  5A71 D7          	RST	#10
0469+  5A72 78          	LD	A,B
0470+  5A73 C1          	POP	BC
0471+  5A74 D1          	POP	DE
0472+  5A75 D0          	RET	NC
0473+  5A76 76          	HALT 
0474+  5A77 18 C9       	JR	PrintCHAR
0475+  5A79             ;[]----------------------------------------------------------[]
0476+  5A79             NxtPrnProc
0477+  5A79 7B          	LD	A,E
0478+  5A7A B7          	OR	A
0479+  5A7B C0          	RET	NZ
0480+  5A7C D5          	PUSH	DE
0481+  5A7D C5          	PUSH	BC
0482+  5A7E DD 21 A6 5A 	LD	IX,ProcessFPrn
0483+  5A82 DD 6E 0E    	LD	L,(IX+ProcCURl1)
0484+  5A85 DD 66 0F    	LD	H,(IX+ProcCURh1)
0485+  5A88 23          	INC	HL
0486+  5A89 DD 75 0E    	LD	(IX+ProcCURl1),L
0487+  5A8C DD 74 0F    	LD	(IX+ProcCURh1),H
0488+  5A8F 7C          	LD	A,H
0489+  5A90 B5          	OR	L
0490+  5A91 20 0D       	JR	NZ,NxtProc
0491+  5A93 DD 6E 10    	LD	L,(IX+ProcCURl2)
0492+  5A96 DD 66 11    	LD	H,(IX+ProcCURh2)
0493+  5A99 23          	INC	HL
0494+  5A9A DD 75 10    	LD	(IX+ProcCURl2),L
0495+  5A9D DD 74 11    	LD	(IX+ProcCURh2),H
0496+  5AA0 CD 45 9A    NxtProc	CALL	PrnProcess
0497+  5AA3 C1          	POP	BC
0498+  5AA4 D1          	POP	DE
0499+  5AA5 C9          	RET 
0500+  5AA6             ProcessFPrn
0501+  5AA6 BA 00       	DEFW	#00BA
0502+  5AA8 71 00       	DEFW	#0071
0503+  5AAA 0C 01       	DEFW	#010C
0504+  5AAC 00 00       	DEFW	#0000
0505+  5AAE 00 00       	DEFW	#0000
0506+  5AB0 00 00       	DEFW	#0000
0507+  5AB2 00 00       	DEFW	#0000
0508+  5AB4 00 00       	DEFW	#0000
0509+  5AB6 00 00       	DEFW	#0000
0510+  5AB8 4F          	DEFB	#4F
0511+  5AB9             PrnFileName
0512+  5AB9 00          	DEFS	13,0
0513+  5AC6             PrnFileLen
0514+  5AC6 00          	DEFS	4,0
0515+  5ACA             PrnMIndef
0516+  5ACA 00          	DEFB	#00
0517+  5ACB             PrnFHandle
0518+  5ACB 00          	DEFB	#00
0519+  5ACC             ;[]==========================================================[]
0520+  5ACC             SystemInfoR
0521+  5ACC 3E C0       	LD	A,#C0
0522+  5ACE D3 89       	OUT	(YPORT),A
0523+  5AD0 21 EA BA    	LD	HL,SetInvert
0524+  5AD3 E5          	PUSH	HL
0525+  5AD4 21 15 5C    	LD	HL,DOSvers
0526+  5AD7 11 FB 5B    	LD	DE,BIOSver
0527+  5ADA 06 05       	LD	B,#05
0528+  5ADC 3E 20       	LD	A,#20
0529+  5ADE 77          	LD	(HL),A
0530+  5ADF 23          	INC	HL
0531+  5AE0 12          	LD	(DE),A
0532+  5AE1 13          	INC	DE
0533+  5AE2 10 FA       	DJNZ	$-4
0534+  5AE4 0E 00       	LD	C,#00
0535+  5AE6 FD E5       	PUSH	IY
0536+  5AE8 D7          	RST	#10
0537+  5AE9 FD E1       	POP	IY
0538+  5AEB EB          	EX	DE,HL
0539+  5AEC 11 15 5C    	LD	DE,DOSvers
0540+  5AEF 7C          	LD	A,H
0541+  5AF0 CD 78 A3    	CALL	ConvNumTxt8
0542+  5AF3 3E 2E       	LD	A,"."
0543+  5AF5 12          	LD	(DE),A
0544+  5AF6 13          	INC	DE
0545+  5AF7 7D          	LD	A,L
0546+  5AF8 CD 78 A3    	CALL	ConvNumTxt8
0547+  5AFB 21 00 80    	LD	HL,WorkBuffer
0548+  5AFE 0E EF       	LD	C,#EF
0549+  5B00 CF          	RST	#08
0550+  5B01 97          	SUB	A
0551+  5B02 23          	INC	HL
0552+  5B03 BE          	CP	(HL)
0553+  5B04 20 FC       	JR	NZ,$-2
0554+  5B06 3E 20       	LD	A,#20
0555+  5B08 2B          	DEC	HL
0556+  5B09 BE          	CP	(HL)
0557+  5B0A 20 FC       	JR	NZ,$-2
0558+  5B0C 23          	INC	HL
0559+  5B0D 11 FB 5B    	LD	DE,BIOSver
0560+  5B10 97          	SUB	A
0561+  5B11 ED A0       	LDI 
0562+  5B13 BE          	CP	(HL)
0563+  5B14 20 FB       	JR	NZ,$-3
0564+  5B16 21 BA 5C    	LD	HL,Present
0565+  5B19 3A E4 A7    	LD	A,(CMOSFlag)
0566+  5B1C B7          	OR	A
0567+  5B1D 20 03       	JR	NZ,$+5
0568+  5B1F 21 C5 5C    	LD	HL,NotPresent
0569+  5B22 11 28 5C    	LD	DE,CMOS
0570+  5B25 01 0B 00    	LD	BC,#000B
0571+  5B28 ED B0       	LDIR 
0572+  5B2A 21 49 5C    	LD	HL,TotMem
0573+  5B2D 11 6D 5C    	LD	DE,FreeMem
0574+  5B30 06 0F       	LD	B,#0F
0575+  5B32 3E 20       	LD	A,#20
0576+  5B34 77          	LD	(HL),A
0577+  5B35 23          	INC	HL
0578+  5B36 12          	LD	(DE),A
0579+  5B37 13          	INC	DE
0580+  5B38 10 FA       	DJNZ	$-4
0581+  5B3A 0E 3C       	LD	C,#3C
0582+  5B3C FD E5       	PUSH	IY
0583+  5B3E D7          	RST	#10
0584+  5B3F FD E1       	POP	IY
0585+  5B41 C5          	PUSH	BC
0586+  5B42 44          	LD	B,H
0587+  5B43 4D          	LD	C,L
0588+  5B44 21 00 00    	LD	HL,#0000
0589+  5B47 11 00 80    	LD	DE,WorkBuffer
0590+  5B4A CB 38       	SRL	B
0591+  5B4C CB 19       	RR	C
0592+  5B4E CB 1C       	RR	H
0593+  5B50 CB 1D       	RR	L
0594+  5B52 CB 38       	SRL	B
0595+  5B54 CB 19       	RR	C
0596+  5B56 CB 1C       	RR	H
0597+  5B58 CB 1D       	RR	L
0598+  5B5A D5          	PUSH	DE
0599+  5B5B CD E2 A2    	CALL	ConvNumTxt32
0600+  5B5E 97          	SUB	A
0601+  5B5F 12          	LD	(DE),A
0602+  5B60 E1          	POP	HL
0603+  5B61 11 49 5C    	LD	DE,TotMem
0604+  5B64 CD DF 5E    	CALL	CorrBigNum
0605+  5B67 13          	INC	DE
0606+  5B68 21 B5 5C    	LD	HL,Bytes
0607+  5B6B 01 05 00    	LD	BC,#0005
0608+  5B6E ED B0       	LDIR 
0609+  5B70 E1          	POP	HL
0610+  5B71 44          	LD	B,H
0611+  5B72 4D          	LD	C,L
0612+  5B73 21 00 00    	LD	HL,#0000
0613+  5B76 11 00 80    	LD	DE,WorkBuffer
0614+  5B79 CB 38       	SRL	B
0615+  5B7B CB 19       	RR	C
0616+  5B7D CB 1C       	RR	H
0617+  5B7F CB 1D       	RR	L
0618+  5B81 CB 38       	SRL	B
0619+  5B83 CB 19       	RR	C
0620+  5B85 CB 1C       	RR	H
0621+  5B87 CB 1D       	RR	L
0622+  5B89 D5          	PUSH	DE
0623+  5B8A CD E2 A2    	CALL	ConvNumTxt32
0624+  5B8D 97          	SUB	A
0625+  5B8E 12          	LD	(DE),A
0626+  5B8F E1          	POP	HL
0627+  5B90 11 6D 5C    	LD	DE,FreeMem
0628+  5B93 CD DF 5E    	CALL	CorrBigNum
0629+  5B96 13          	INC	DE
0630+  5B97 21 B5 5C    	LD	HL,Bytes
0631+  5B9A 01 05 00    	LD	BC,#0005
0632+  5B9D ED B0       	LDIR 
0633+  5B9F CD F0 86    	CALL	MakeWindow
0634+  5BA2 01          	DEFB	#01
0635+  5BA3 E0 00 40 00 	DEFW	#00E0,#0040
0636+  5BA7 C0 00 72 00 	DEFW	#00C0,#0072
0637+  5BAB 02          	DEFB	#02	;Head place
0638+  5BAC 04 00 02 00 	DEFW	#0004,#0002
0639+  5BB0 B8 00 0A 00 	DEFW	#00B8,#000A
0640+  5BB4 00          	DEFB	#00
0641+  5BB5 01          	DEFB	#01	;Text Line
0642+  5BB6 30 00 03 00 	DEFW	#0030,#0003
0643+  5BBA 0F          	DEFB	#0F
0644+  5BBB             	DEFB	"System information",0
0644+  5BBB 53797374656D20696E666F726D6174696F6E00
0645+  5BCE 01          	DEFB	#01	;Text Line
0646+  5BCF 0A 00 14 00 	DEFW	#000A,#0014
0647+  5BD3 80          	DEFB	#80
0648+  5BD4             	DEFB	"FN version:  1.10",0
0648+  5BD4 464E2076657273696F6E3A2020312E313000
0649+  5BE6 01          	DEFB	#01	;Text Line
0650+  5BE7 0A 00 20 00 	DEFW	#000A,#0020
0651+  5BEB 80          	DEFB	#80
0652+  5BEC             	DEFB	"BIOS version:  "
0652+  5BEC 42494F532076657273696F6E3A2020
0653+  5BFB             BIOSver	DEFB	"     ",#00
0653+  5BFB 202020202000
0654+  5C01 01          	DEFB	#01	;Text Line
0655+  5C02 0A 00 2C 00 	DEFW	#000A,#002C
0656+  5C06 80          	DEFB	#80
0657+  5C07             	DEFB	"DOS version:  "
0657+  5C07 444F532076657273696F6E3A2020
0658+  5C15             DOSvers	DEFB	"     ",0
0658+  5C15 202020202000
0659+  5C1B 01          	DEFB	#01	;Text Line
0660+  5C1C 0A 00 38 00 	DEFW	#000A,#0038
0661+  5C20 80          	DEFB	#80
0662+  5C21             	DEFB	"CMOS:  "
0662+  5C21 434D4F533A2020
0663+  5C28             CMOS	DEFB	"           ",0
0663+  5C28 202020202020202020202000
0664+  5C34 01          	DEFB	#01	;Text Line
0665+  5C35 0A 00 46 00 	DEFW	#000A,#0046
0666+  5C39 80          	DEFB	#80
0667+  5C3A             	DEFB	"Total memory:  "
0667+  5C3A 546F74616C206D656D6F72793A2020
0668+  5C49             TotMem	DEFB	"               ",0
0668+  5C49 20202020202020202020202020202000
0669+  5C59 01          	DEFB	#01	;Text Line
0670+  5C5A 0A 00 52 00 	DEFW	#000A,#0052
0671+  5C5E 80          	DEFB	#80
0672+  5C5F             	DEFB	"Free memory:  "
0672+  5C5F 46726565206D656D6F72793A2020
0673+  5C6D             FreeMem	DEFB	"               ",0
0673+  5C6D 20202020202020202020202020202000
0674+  5C7D 04          	DEFB	#04	;UpRectan
0675+  5C7E 3C 00 60 00 	DEFW	#003C,#0060
0676+  5C82 48 00 0E 00 	DEFW	#0048,#000E
0677+  5C86 01          	DEFB	#01	;Text Line
0678+  5C87 58 00 63 00 	DEFW	#0058,#0063
0679+  5C8B 80          	DEFB	#80
0680+  5C8C 4F 6B 00    	DEFB	"Ok",0
0681+  5C8F 00          	DEFB	#00
0682+  5C90             SysInfoLoop
0683+  5C90 DD 21 CE 70 	LD	IX,SysInfoTab
0684+  5C94 CD 1C 9B    	CALL	TestCoords
0685+  5C97 0E 31       	LD	C,#31
0686+  5C99 D7          	RST	#10
0687+  5C9A 28 F4       	JR	Z,SysInfoLoop
0688+  5C9C 78          	LD	A,B
0689+  5C9D B7          	OR	A
0690+  5C9E 20 F0       	JR	NZ,SysInfoLoop
0691+  5CA0 7B          	LD	A,E
0692+  5CA1 FE 1B       	CP	#1B
0693+  5CA3 28 0A       	JR	Z,SysInfoExt
0694+  5CA5 FE 0D       	CP	#0D
0695+  5CA7 28 06       	JR	Z,SysInfoExt
0696+  5CA9 CB AF       	RES	5,A
0697+  5CAB FE 4F       	CP	"O"
0698+  5CAD 20 E1       	JR	NZ,SysInfoLoop
0699+  5CAF             SysInfoExt
0700+  5CAF CD F0 86    	CALL	MakeWindow
0701+  5CB2 7F          	DEFB	#7F
0702+  5CB3 00          	DEFB	#00
0703+  5CB4 C9          	RET 
0704+  5CB5             
0705+  5CB5 6279746573  Bytes	DEFB	"bytes"
0706+  5CBA             Present
0707+  5CBA             	DEFB	"Present    "
0707+  5CBA 50726573656E7420202020
0708+  5CC5             NotPresent
0709+  5CC5             	DEFB	"Not present"
0709+  5CC5 4E6F742070726573656E74
0710+  5CD0             ;[]==========================================================[]
0711+  5CD0             DiskInfoR
0712+  5CD0 21 EA BA    	LD	HL,SetInvert
0713+  5CD3 E5          	PUSH	HL
0714+  5CD4 3E C0       	LD	A,#C0
0715+  5CD6 D3 89       	OUT	(YPORT),A
0716+  5CD8 CD 9C A0    	CALL	SetClock
0717+  5CDB 0E 02       	LD	C,#02
0718+  5CDD FD E5       	PUSH	IY
0719+  5CDF D7          	RST	#10
0720+  5CE0 FD E1       	POP	IY
0721+  5CE2 C6 41       	ADD	A,"A"
0722+  5CE4 32 7A 5D    	LD	(CrDrive),A
0723+  5CE7 DD 21 00 00 	LD	IX,#0000
0724+  5CEB 21 00 00    	LD	HL,#0000
0725+  5CEE 11 00 80    	LD	DE,WorkBuffer
0726+  5CF1 01 05 01    	LD	BC,#0105
0727+  5CF4 D6 41       	SUB	"A"
0728+  5CF6 FD E5       	PUSH	IY
0729+  5CF8 DF          	RST	#18
0730+  5CF9 FD E1       	POP	IY
0731+  5CFB DA 3C A1    	JP	C,SetMouse
0732+  5CFE 21 2B 80    	LD	HL,WorkBuffer+#2B
0733+  5D01 11 B5 5E    	LD	DE,NoLabel
0734+  5D04 06 0B       	LD	B,11
0735+  5D06 97          DiskI0	SUB	A
0736+  5D07 BE          	CP	(HL)
0737+  5D08 28 0D       	JR	Z,DiskI2
0738+  5D0A 1A          	LD	A,(DE)
0739+  5D0B BE          	CP	(HL)
0740+  5D0C 20 04       	JR	NZ,DiskI1
0741+  5D0E 23          	INC	HL
0742+  5D0F 13          	INC	DE
0743+  5D10 10 F4       	DJNZ	DiskI0
0744+  5D12 21 2B 80    DiskI1	LD	HL,WorkBuffer+#2B
0745+  5D15 20 03       	JR	NZ,$+5
0746+  5D17 21 C0 5E    DiskI2	LD	HL,NoLabelT
0747+  5D1A 11 C3 5D    	LD	DE,Dlabel
0748+  5D1D 01 0B 00    	LD	BC,#000B
0749+  5D20 ED B0       	LDIR 
0750+  5D22 11 EC 5D    	LD	DE,SerialN
0751+  5D25 3A 2A 80    	LD	A,(WorkBuffer+#2A)
0752+  5D28 CD CB 5E    	CALL	ConvHexTxt
0753+  5D2B 3A 29 80    	LD	A,(WorkBuffer+#29)
0754+  5D2E CD CB 5E    	CALL	ConvHexTxt
0755+  5D31 13          	INC	DE
0756+  5D32 3A 28 80    	LD	A,(WorkBuffer+#28)
0757+  5D35 CD CB 5E    	CALL	ConvHexTxt
0758+  5D38 3A 27 80    	LD	A,(WorkBuffer+#27)
0759+  5D3B CD CB 5E    	CALL	ConvHexTxt
0760+  5D3E CD F0 86    	CALL	MakeWindow
0761+  5D41 01          	DEFB	#01
0762+  5D42 C0 00 50 00 	DEFW	#00C0,#0050
0763+  5D46 00 01 62 00 	DEFW	#0100,#0062
0764+  5D4A 02          	DEFB	#02	;Head place
0765+  5D4B 04 00 02 00 	DEFW	#0004,#0002
0766+  5D4F F8 00 0A 00 	DEFW	#00F8,#000A
0767+  5D53 00          	DEFB	#00
0768+  5D54 01          	DEFB	#01	;Text Line
0769+  5D55 6A 00 03 00 	DEFW	#006A,#0003
0770+  5D59 0F          	DEFB	#0F
0771+  5D5A             	DEFB	"Disk info",0
0771+  5D5A 4469736B20696E666F00
0772+  5D64 01          	DEFB	#01	;Text Line
0773+  5D65 0A 00 14 00 	DEFW	#000A,#0014
0774+  5D69 80          	DEFB	#80
0775+  5D6A             	DEFB	"Current drive:  "
0775+  5D6A 43757272656E742064726976653A2020
0776+  5D7A 20 00       CrDrive	DEFB	" ",#00
0777+  5D7C 01          	DEFB	#01	;Text Line
0778+  5D7D 0A 00 20 00 	DEFW	#000A,#0020
0779+  5D81 80          	DEFB	#80
0780+  5D82             	DEFB	"Total disk space:",0
0780+  5D82 546F74616C206469736B2073706163653A00
0781+  5D94 01          	DEFB	#01	;Text Line
0782+  5D95 0A 00 2C 00 	DEFW	#000A,#002C
0783+  5D99 80          	DEFB	#80
0784+  5D9A             	DEFB	"Avaliable disk space:",0
0784+  5D9A 4176616C6961626C65206469736B2073706163653A00
0785+  5DB0 01          	DEFB	#01	;Text Line
0786+  5DB1 0A 00 38 00 	DEFW	#000A,#0038
0787+  5DB5 80          	DEFB	#80
0788+  5DB6             	DEFB	"Disk label:  "
0788+  5DB6 4469736B206C6162656C3A2020
0789+  5DC3             Dlabel	DEFB	"           ",0
0789+  5DC3 202020202020202020202000
0790+  5DCF 01          	DEFB	#01	;Text Line
0791+  5DD0 0A 00 44 00 	DEFW	#000A,#0044
0792+  5DD4 80          	DEFB	#80
0793+  5DD5             	DEFB	"Serial volume number:  "
0793+  5DD5 53657269616C20766F6C756D65206E756D6265723A2020
0794+  5DEC             SerialN	DEFB	"    -    ",0
0794+  5DEC 202020202D2020202000
0795+  5DF6 04          	DEFB	#04	;UpRectan
0796+  5DF7 5C 00 50 00 	DEFW	#005C,#0050
0797+  5DFB 48 00 0E 00 	DEFW	#0048,#000E
0798+  5DFF 01          	DEFB	#01	;Text Line
0799+  5E00 78 00 53 00 	DEFW	#0078,#0053
0800+  5E04 80          	DEFB	#80
0801+  5E05 4F 6B 00    	DEFB	"Ok",0
0802+  5E08 00          	DEFB	#00
0803+  5E09 3E FF       	LD	A,#FF
0804+  5E0B 0E 03       	LD	C,#03
0805+  5E0D FD E5       	PUSH	IY
0806+  5E0F D7          	RST	#10
0807+  5E10 FD E1       	POP	IY
0808+  5E12 D5          	PUSH	DE
0809+  5E13 E5          	PUSH	HL
0810+  5E14 5F          	LD	E,A
0811+  5E15 16 00       	LD	D,#00
0812+  5E17 CD 0F A2    	CALL	Mult16X16
0813+  5E1A ED 53 4B 5E 	LD	(ClastS2+1),DE
0814+  5E1E 22 48 5E    	LD	(ClastS1+1),HL
0815+  5E21 C1          	POP	BC
0816+  5E22 CD 34 A2    	CALL	Mult32
0817+  5E25 EB          	EX	DE,HL
0818+  5E26 4B          	LD	C,E
0819+  5E27 42          	LD	B,D
0820+  5E28 11 00 80    	LD	DE,WorkBuffer
0821+  5E2B D5          	PUSH	DE
0822+  5E2C CD E2 A2    	CALL	ConvNumTxt32
0823+  5E2F 97          	SUB	A
0824+  5E30 12          	LD	(DE),A
0825+  5E31 E1          	POP	HL
0826+  5E32 11 00 81    	LD	DE,WorkBuffer+#100
0827+  5E35 CD DF 5E    	CALL	CorrBigNum
0828+  5E38 3E 20       	LD	A,#20
0829+  5E3A 12          	LD	(DE),A
0830+  5E3B 13          	INC	DE
0831+  5E3C 21 B5 5C    	LD	HL,Bytes
0832+  5E3F 01 05 00    	LD	BC,#0005
0833+  5E42 ED B0       	LDIR 
0834+  5E44 97          	SUB	A
0835+  5E45 12          	LD	(DE),A
0836+  5E46 C1          	POP	BC
0837+  5E47 21 00 00    ClastS1	LD	HL,#0000
0838+  5E4A 11 00 00    ClastS2	LD	DE,#0000
0839+  5E4D CD 34 A2    	CALL	Mult32
0840+  5E50 EB          	EX	DE,HL
0841+  5E51 4B          	LD	C,E
0842+  5E52 42          	LD	B,D
0843+  5E53 11 80 80    	LD	DE,WorkBuffer+#80
0844+  5E56 D5          	PUSH	DE
0845+  5E57 CD E2 A2    	CALL	ConvNumTxt32
0846+  5E5A 97          	SUB	A
0847+  5E5B 12          	LD	(DE),A
0848+  5E5C E1          	POP	HL
0849+  5E5D 11 80 81    	LD	DE,WorkBuffer+#180
0850+  5E60 CD DF 5E    	CALL	CorrBigNum
0851+  5E63 3E 20       	LD	A,#20
0852+  5E65 12          	LD	(DE),A
0853+  5E66 13          	INC	DE
0854+  5E67 21 B5 5C    	LD	HL,Bytes
0855+  5E6A 01 05 00    	LD	BC,#0005
0856+  5E6D ED B0       	LDIR 
0857+  5E6F 97          	SUB	A
0858+  5E70 12          	LD	(DE),A
0859+  5E71 21 00 81    	LD	HL,WorkBuffer+#100
0860+  5E74 11 28 01    	LD	DE,#00128
0861+  5E77 01 70 00    	LD	BC,#0070
0862+  5E7A 3E 80       	LD	A,#80
0863+  5E7C CD B3 8F    	CALL	PrnTxtLnIFF
0864+  5E7F 21 80 81    	LD	HL,WorkBuffer+#180
0865+  5E82 11 3A 01    	LD	DE,#0013A
0866+  5E85 01 7C 00    	LD	BC,#007C
0867+  5E88 3E 80       	LD	A,#80
0868+  5E8A CD B3 8F    	CALL	PrnTxtLnIFF
0869+  5E8D CD 3C A1    	CALL	SetMouse
0870+  5E90             DiskInfoLoop
0871+  5E90 DD 21 20 71 	LD	IX,DiskInfoTab
0872+  5E94 CD 1C 9B    	CALL	TestCoords
0873+  5E97 0E 31       	LD	C,#31
0874+  5E99 D7          	RST	#10
0875+  5E9A 28 F4       	JR	Z,DiskInfoLoop
0876+  5E9C 78          	LD	A,B
0877+  5E9D B7          	OR	A
0878+  5E9E 20 F0       	JR	NZ,DiskInfoLoop
0879+  5EA0 7B          	LD	A,E
0880+  5EA1 FE 1B       	CP	#1B
0881+  5EA3 28 0A       	JR	Z,DiskInfoExt
0882+  5EA5 FE 0D       	CP	#0D
0883+  5EA7 28 06       	JR	Z,DiskInfoExt
0884+  5EA9 CB AF       	RES	5,A
0885+  5EAB FE 4F       	CP	"O"
0886+  5EAD 20 E1       	JR	NZ,DiskInfoLoop
0887+  5EAF             DiskInfoExt
0888+  5EAF CD F0 86    	CALL	MakeWindow
0889+  5EB2 7F          	DEFB	#7F
0890+  5EB3 00          	DEFB	#00
0891+  5EB4 C9          	RET 
0892+  5EB5             NoLabel
0893+  5EB5             	DEFB	"NO NAME    "
0893+  5EB5 4E4F204E414D4520202020
0894+  5EC0             NoLabelT
0895+  5EC0             	DEFB	"no label   "
0895+  5EC0 6E6F206C6162656C202020
0896+  5ECB             ConvHexTxt
0897+  5ECB F5          	PUSH	AF
0898+  5ECC 0F          	RRCA 
0899+  5ECD 0F          	RRCA 
0900+  5ECE 0F          	RRCA 
0901+  5ECF 0F          	RRCA 
0902+  5ED0 CD D4 5E    	CALL	ConvHexT1
0903+  5ED3 F1          	POP	AF
0904+  5ED4             ConvHexT1
0905+  5ED4 E6 0F       	AND	#0F
0906+  5ED6 C6 90       	ADD	A,#90
0907+  5ED8 27          	DAA 
0908+  5ED9 CE 40       	ADC	A,#40
0909+  5EDB 27          	DAA 
0910+  5EDC 12          	LD	(DE),A
0911+  5EDD 13          	INC	DE
0912+  5EDE C9          	RET 
0913+  5EDF             CorrBigNum
0914+  5EDF E5          	PUSH	HL
0915+  5EE0 97          	SUB	A
0916+  5EE1 4F          	LD	C,A
0917+  5EE2 0C          	INC	C
0918+  5EE3 23          	INC	HL
0919+  5EE4 BE          	CP	(HL)
0920+  5EE5 20 FB       	JR	NZ,$-3
0921+  5EE7 E1          	POP	HL
0922+  5EE8 79          	LD	A,C
0923+  5EE9 D6 03       	SUB	#03
0924+  5EEB 28 12       	JR	Z,CBigNm2
0925+  5EED 30 FA       	JR	NC,$-4
0926+  5EEF C6 03       	ADD	A,#03
0927+  5EF1 47          	LD	B,A
0928+  5EF2 7E          	LD	A,(HL)
0929+  5EF3 12          	LD	(DE),A
0930+  5EF4 23          	INC	HL
0931+  5EF5 13          	INC	DE
0932+  5EF6 10 FA       	DJNZ	$-4
0933+  5EF8 7E          CBigNm1	LD	A,(HL)
0934+  5EF9 B7          	OR	A
0935+  5EFA C8          	RET	Z
0936+  5EFB 3E 20       	LD	A," "
0937+  5EFD 12          	LD	(DE),A
0938+  5EFE 13          	INC	DE
0939+  5EFF ED A0       CBigNm2	LDI 
0940+  5F01 ED A0       	LDI 
0941+  5F03 ED A0       	LDI 
0942+  5F05 18 F1       	JR	CBigNm1
0943+  5F07             ;[]==========================================================[]
0944+  5F07             VersionR
0945+  5F07 3E C0       	LD	A,#C0
0946+  5F09 D3 89       	OUT	(YPORT),A
0947+  5F0B 21 EA BA    	LD	HL,SetInvert
0948+  5F0E E5          	PUSH	HL
0949+  5F0F CD F0 86    	CALL	MakeWindow
0950+  5F12 01          	DEFB	#01
0951+  5F13 C0 00 40 00 	DEFW	#00C0,#0040
0952+  5F17 00 01 70 00 	DEFW	#0100,#0070
0953+  5F1B 02          	DEFB	#02	;Head place
0954+  5F1C 04 00 02 00 	DEFW	#0004,#0002
0955+  5F20 F8 00 0A 00 	DEFW	#00F8,#000A
0956+  5F24 00          	DEFB	#00
0957+  5F25 01          	DEFB	#01	;Text Line
0958+  5F26 6E 00 03 00 	DEFW	#006E,#0003
0959+  5F2A 0F          	DEFB	#0F
0960+  5F2B             	DEFB	"Version",0
0960+  5F2B 56657273696F6E00
0961+  5F33 01          	DEFB	#01	;Text Line
0962+  5F34 5A 00 14 00 	DEFW	#005A,#0014
0963+  5F38 80          	DEFB	#80
0964+  5F39             	DEFB	"Flex Navigator",0
0964+  5F39 466C6578204E6176696761746F7200
0965+  5F48 01          	DEFB	#01	;Text Line
0966+  5F49 5E 00 26 00 	DEFW	#005E,#0026
0967+  5F4D 80          	DEFB	#80
0968+  5F4E             	DEFB	"Version 1.10",0
0968+  5F4E 56657273696F6E20312E313000
0969+  5F5B 01          	DEFB	#01	;Text Line
0970+  5F5C 54 00 30 00 	DEFW	#0054,#0030
0971+  5F60 80          	DEFB	#80
0972+  5F61             	DEFB	"Februar, 3 2000",0
0972+  5F61 466562727561722C2033203230303000
0973+  5F71 01          	DEFB	#01	;Text Line
0974+  5F72 50 00 42 00 	DEFW	#0050,#0042
0975+  5F76 80          	DEFB	#80
0976+  5F77             	DEFB	"Copyright (C) 2000",0
0976+  5F77 436F7079726967687420284329203230303000
0977+  5F8A 01          	DEFB	#01	;Text Line
0978+  5F8B 3C 00 4C 00 	DEFW	#003C,#004C
0979+  5F8F 80          	DEFB	#80
0980+  5F90             	DEFB	"Enin Anton, St-Petersburg",0
0980+  5F90 456E696E20416E746F6E2C2053742D5065746572736275726700
0981+  5FAA 04          	DEFB	#04	;UpRectan
0982+  5FAB 5C 00 5D 00 	DEFW	#005C,#005D
0983+  5FAF 48 00 0E 00 	DEFW	#0048,#000E
0984+  5FB3 01          	DEFB	#01	;Text Line
0985+  5FB4 78 00 60 00 	DEFW	#0078,#0060
0986+  5FB8 80          	DEFB	#80
0987+  5FB9 4F 6B 00    	DEFB	"Ok",0
0988+  5FBC 00          	DEFB	#00
0989+  5FBD CD 0D 9B    	CALL	ResFire
0990+  5FC0             VersionLoop
0991+  5FC0 DD 21 72 71 	LD	IX,VersionTab
0992+  5FC4 CD 1C 9B    	CALL	TestCoords
0993+  5FC7 0E 31       	LD	C,#31
0994+  5FC9 D7          	RST	#10
0995+  5FCA 28 F4       	JR	Z,VersionLoop
0996+  5FCC 78          	LD	A,B
0997+  5FCD B7          	OR	A
0998+  5FCE 20 F0       	JR	NZ,VersionLoop
0999+  5FD0 7B          	LD	A,E
1000+  5FD1 FE 1B       	CP	#1B
1001+  5FD3 28 04       	JR	Z,VersionExt
1002+  5FD5 FE 0D       	CP	#0D
1003+  5FD7 20 E7       	JR	NZ,VersionLoop
1004+  5FD9             VersionExt
1005+  5FD9 CD F0 86    	CALL	MakeWindow
1006+  5FDC 7F          	DEFB	#7F
1007+  5FDD 00          	DEFB	#00
1008+  5FDE C9          	RET 
1009+  5FDF             
1010+  5FDF             
1011+  5FDF             
0288   5FDF             	include "fnsearch.z80"
0001+  5FDF             
0002+  5FDF             ;[]==========================================================[]
0003+  5FDF             QSearchR
0004+  5FDF FD 7E 13    	LD	A,(IY+PanelEFl)
0005+  5FE2 FD B6 14    	OR	(IY+PanelEFh)
0006+  5FE5 C8          	RET	Z
0007+  5FE6 3E C0       	LD	A,#C0
0008+  5FE8 D3 89       	OUT	(YPORT),A
0009+  5FEA 21 C6 61    	LD	HL,SearchN
0010+  5FED 06 0C       	LD	B,#0C
0011+  5FEF 97          	SUB	A
0012+  5FF0 77          	LD	(HL),A
0013+  5FF1 23          	INC	HL
0014+  5FF2 10 FC       	DJNZ	$-2
0015+  5FF4 32 BE 61    	LD	(SrchLen),A
0016+  5FF7 FD 6E 03    	LD	L,(IY+PanelXl)
0017+  5FFA FD 66 04    	LD	H,(IY+PanelXh)
0018+  5FFD 11 0A 00    	LD	DE,#000A
0019+  6000 19          	ADD	HL,DE
0020+  6001 22 25 60    	LD	(SrchX1),HL
0021+  6004 11 34 00    	LD	DE,#0034
0022+  6007 19          	ADD	HL,DE
0023+  6008 22 BF 61    	LD	(SrchX2),HL
0024+  600B 21 E0 00    	LD	HL,#00E0
0025+  600E FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0026+  6012 28 03       	JR	Z,$+5
0027+  6014 21 D0 00    	LD	HL,#00D0
0028+  6017 22 27 60    	LD	(SrchY1),HL
0029+  601A 11 07 00    	LD	DE,#0007
0030+  601D 19          	ADD	HL,DE
0031+  601E 22 C1 61    	LD	(SrchY2),HL
0032+  6021 CD F0 86    	CALL	MakeWindow
0033+  6024 01          	DEFB	#01
0034+  6025 00 00       SrchX1	DEFW	#0000
0035+  6027 00 00       SrchY1	DEFW	#0000
0036+  6029 A6 00 14 00 	DEFW	#00A6,#0014
0037+  602D 01          	DEFB	#01	;Text Line
0038+  602E 08 00 07 00 	DEFW	#0008,#0007
0039+  6032 80          	DEFB	#80
0040+  6033             	DEFB	"Search:",0
0040+  6033 5365617263683A00
0041+  603B 03          	DEFB	#03	;Углубление
0042+  603C 30 00 04 00 	DEFW	#0030,#0004
0043+  6040 6C 00 0C 00 	DEFW	#006C,#000C
0044+  6044 02          	DEFB	#02	;Head place
0045+  6045 32 00 05 00 	DEFW	#0032,#0005
0046+  6049 68 00 0A 00 	DEFW	#0068,#000A
0047+  604D 0F          	DEFB	#0F
0048+  604E 00          	DEFB	#00
0049+  604F DD 21 BA 61 	LD	IX,SearchStr
0050+  6053 DD 22 44 92 	LD	(InpLnData),IX
0051+  6057 97          	SUB	A
0052+  6058 DD 77 02    	LD	(IX+#02),A
0053+  605B DD 77 03    	LD	(IX+#03),A
0054+  605E DD 77 04    	LD	(IX+#04),A
0055+  6061 CD 97 94    	CALL	InsInpLnCol
0056+  6064 CD D2 94    	CALL	PrintInpLn+3
0057+  6067             SearchInpLp
0058+  6067 76          	HALT 
0059+  6068 CD D2 96    	CALL	ChCursor
0060+  606B CD 05 9F    	CALL	TestCMOS
0061+  606E 0E 03       	LD	C,#03
0062+  6070 F7          	RST	#30
0063+  6071 B7          	OR	A
0064+  6072 C2 E0 62    	JP	NZ,SearchExit
0065+  6075 0E 31       	LD	C,#31
0066+  6077 D7          	RST	#10
0067+  6078 28 ED       	JR	Z,SearchInpLp
0068+  607A             
0069+  607A CB BA       	RES	7,D
0070+  607C CB 68       	BIT	5,B		;Ctrl
0071+  607E 20 E7       	JR	NZ,SearchInpLp
0072+  6080             
0073+  6080 DD 21 D3 60 	LD	IX,SearchTab
0074+  6084 CB 60       	BIT	4,B		;Alt
0075+  6086 28 18       	JR	Z,Search1
0076+  6088 7A          	LD	A,D
0077+  6089 B7          	OR	A
0078+  608A 28 DB       	JR	Z,SearchInpLp
0079+  608C FE 36       	CP	#36
0080+  608E 30 D7       	JR	NC,SearchInpLp
0081+  6090             
0082+  6090 21 D3 61    	LD	HL,AltTable
0083+  6093 3D          	DEC	A
0084+  6094 85          	ADD	A,L
0085+  6095 6F          	LD	L,A
0086+  6096 30 01       	JR	NC,$+3
0087+  6098 24          	INC	H
0088+  6099 7E          	LD	A,(HL)
0089+  609A CB 41       	BIT	0,C
0090+  609C C4 6F AA    	CALL	NZ,CorrSmallChar
0091+  609F 5F          	LD	E,A
0092+  60A0             
0093+  60A0 DD 7E 00    Search1	LD	A,(IX+#00)
0094+  60A3 DD 23       	INC	IX
0095+  60A5 FE FF       	CP	#FF
0096+  60A7 28 1F       	JR	Z,SearchInpLp1
0097+  60A9 6F          	LD	L,A
0098+  60AA DD 66 00    	LD	H,(IX+#00)
0099+  60AD DD 23       	INC	IX
0100+  60AF DD 4E 00    	LD	C,(IX+#00)
0101+  60B2 DD 23       	INC	IX
0102+  60B4 DD 46 00    	LD	B,(IX+#00)
0103+  60B7 DD 23       	INC	IX
0104+  60B9 B7          	OR	A
0105+  60BA ED 52       	SBC	HL,DE
0106+  60BC 20 E2       	JR	NZ,Search1
0107+  60BE DD 2A 44 92 	LD	IX,(InpLnData)
0108+  60C2 21 67 60    	LD	HL,SearchInpLp
0109+  60C5 E5          	PUSH	HL
0110+  60C6 C5          	PUSH	BC
0111+  60C7 C9          	RET 
0112+  60C8             SearchInpLp1
0113+  60C8 DD 2A 44 92 	LD	IX,(InpLnData)
0114+  60CC 21 67 60    	LD	HL,SearchInpLp
0115+  60CF E5          	PUSH	HL
0116+  60D0 7B          	LD	A,E
0117+  60D1 18 0D       	JR	InsSymbolSrch
0118+  60D3             SearchTab
0119+  60D3 1B 01 DF 62 	DEFW	#011B,SrchExit
0120+  60D7 0D 28 DF 62 	DEFW	#280D,SrchExit
0121+  60DB 08 0E 88 61 	DEFW	#0E08,QSdelet
0122+  60DF FF          	DEFB	#FF
0123+  60E0             InsSymbolSrch
0124+  60E0 FE 20       	CP	#20
0125+  60E2 D8          	RET	C
0126+  60E3 08          	EX	AF,AF'
0127+  60E4 DD 7E 04    	LD	A,(IX+#04)	;InpytSymb
0128+  60E7 DD 96 00    	SUB	(IX+#00)	;Max len
0129+  60EA D0          	RET	NC
0130+  60EB DD 7E 04    	LD	A,(IX+#04)
0131+  60EE DD 96 02    	SUB	(IX+#02)
0132+  60F1 28 13       	JR	Z,NotInsSrch
0133+  60F3 4F          	LD	C,A
0134+  60F4 06 00       	LD	B,#00
0135+  60F6 DD E5       	PUSH	IX
0136+  60F8 E1          	POP	HL
0137+  60F9 11 0C 00    	LD	DE,LenInpData
0138+  60FC 19          	ADD	HL,DE
0139+  60FD DD 5E 04    	LD	E,(IX+#04)
0140+  6100 19          	ADD	HL,DE
0141+  6101 5D          	LD	E,L
0142+  6102 54          	LD	D,H
0143+  6103 2B          	DEC	HL
0144+  6104 ED B8       	LDDR 
0145+  6106             NotInsSrch
0146+  6106 DD E5       	PUSH	IX
0147+  6108 E1          	POP	HL
0148+  6109 11 0C 00    	LD	DE,LenInpData
0149+  610C 19          	ADD	HL,DE
0150+  610D DD 5E 02    	LD	E,(IX+#02)
0151+  6110 19          	ADD	HL,DE
0152+  6111 08          	EX	AF,AF'
0153+  6112 77          	LD	(HL),A
0154+  6113 DD 34 04    	INC	(IX+#04)
0155+  6116 DD 34 02    	INC	(IX+#02)
0156+  6119 CD 08 62    	CALL	SearchFile
0157+  611C DA FE 92    	JP	C,ILdelet
0158+  611F             FoundSFile
0159+  611F E5          	PUSH	HL
0160+  6120 CD CF 94    	CALL	PrintInpLn
0161+  6123 E1          	POP	HL
0162+  6124 EB          	EX	DE,HL
0163+  6125 FD 6E 17    	LD	L,(IY+PanelCFl)
0164+  6128 FD 66 18    	LD	H,(IY+PanelCFh)
0165+  612B FD 4E 15    	LD	C,(IY+PanelFFl)
0166+  612E FD 46 16    	LD	B,(IY+PanelFFh)
0167+  6131 09          	ADD	HL,BC
0168+  6132 ED 52       	SBC	HL,DE
0169+  6134 EB          	EX	DE,HL
0170+  6135 C8          	RET	Z
0171+  6136 E5          	PUSH	HL
0172+  6137 CD F9 BA    	CALL	ResInvert
0173+  613A E1          	POP	HL
0174+  613B FD 4E 11    	LD	C,(IY+PanelFPl)
0175+  613E FD 46 12    	LD	B,(IY+PanelFPh)
0176+  6141 11 00 00    	LD	DE,#0000
0177+  6144 EB          	EX	DE,HL
0178+  6145 B7          	OR	A
0179+  6146 ED 42       	SBC	HL,BC
0180+  6148 EB          	EX	DE,HL
0181+  6149 EB          	EX	DE,HL
0182+  614A 09          	ADD	HL,BC
0183+  614B EB          	EX	DE,HL
0184+  614C B7          	OR	A
0185+  614D ED 42       	SBC	HL,BC
0186+  614F 30 F8       	JR	NC,$-6
0187+  6151 09          	ADD	HL,BC
0188+  6152 FD 75 17    	LD	(IY+PanelCFl),L
0189+  6155 FD 74 18    	LD	(IY+PanelCFh),H
0190+  6158 FD 4E 15    	LD	C,(IY+PanelFFl)
0191+  615B FD 46 16    	LD	B,(IY+PanelFFh)
0192+  615E FD 73 15    	LD	(IY+PanelFFl),E
0193+  6161 FD 72 16    	LD	(IY+PanelFFh),D
0194+  6164 EB          	EX	DE,HL
0195+  6165 B7          	OR	A
0196+  6166 ED 42       	SBC	HL,BC
0197+  6168 C4 45 B5    	CALL	NZ,PrintDIR
0198+  616B CD EA BA    	CALL	SetInvert
0199+  616E CD EE B2    	CALL	PrnFileInfo
0200+  6171 FD E5       	PUSH	IY
0201+  6173 DD E1       	POP	IX
0202+  6175 11 05 00    	LD	DE,BegPBar
0203+  6178 DD 19       	ADD	IX,DE
0204+  617A FD 7E 01    	LD	A,(IY+ViewFlg)
0205+  617D E6 03       	AND	#03
0206+  617F F5          	PUSH	AF
0207+  6180 CC 35 97    	CALL	Z,PrnHScrBar
0208+  6183 F1          	POP	AF
0209+  6184 C4 8E 98    	CALL	NZ,PrnVScrBar
0210+  6187 C9          	RET 
0211+  6188             
0212+  6188 DD 7E 02    QSdelet	LD	A,(IX+#02)
0213+  618B B7          	OR	A
0214+  618C C8          	RET	Z
0215+  618D DD E5       	PUSH	IX
0216+  618F E1          	POP	HL
0217+  6190 11 0C 00    	LD	DE,LenInpData
0218+  6193 19          	ADD	HL,DE
0219+  6194 DD 5E 02    	LD	E,(IX+#02)
0220+  6197 19          	ADD	HL,DE
0221+  6198 5D          	LD	E,L
0222+  6199 54          	LD	D,H
0223+  619A 1B          	DEC	DE
0224+  619B DD 7E 04    	LD	A,(IX+#04)
0225+  619E DD 96 02    	SUB	(IX+#02)
0226+  61A1 28 06       	JR	Z,QSDel1
0227+  61A3 4F          	LD	C,A
0228+  61A4 06 00       	LD	B,#00
0229+  61A6 ED B0       	LDIR 
0230+  61A8 97          	SUB	A
0231+  61A9 12          QSDel1	LD	(DE),A
0232+  61AA DD 35 02    	DEC	(IX+#02)
0233+  61AD DD 35 04    	DEC	(IX+#04)
0234+  61B0 CD 08 62    	CALL	SearchFile
0235+  61B3 D2 1F 61    	JP	NC,FoundSFile
0236+  61B6 CD CF 94    	CALL	PrintInpLn
0237+  61B9 C9          	RET 
0238+  61BA             
0239+  61BA             SearchStr
0240+  61BA 0C 00 00 00 	DEFB	#0C,#00,#00,#00
0241+  61BE 03          SrchLen	DEFB	#03
0242+  61BF 00 00       SrchX2	DEFW	#0000
0243+  61C1 00 00       SrchY2	DEFW	#0000
0244+  61C3 64 00       	DEFW	#0064
0245+  61C5 F0          	DEFB	#F0
0246+  61C6 00          SearchN	DEFS	13,0
0247+  61D3             
0248+  61D3             AltTable
0249+  61D3             	DEFB	#1B,"1234567890-=",#08,#09,"qwertyuiop[]"
0249+  61D3 1B313233343536373839302D3D080971776572747975696F705B5D
0250+  61EE             	DEFB	#00,"asdfghjkl;'",#0D,#00,"zxcvbnm,./",#00,"\\"
0250+  61EE 006173646667686A6B6C3B270D007A786376626E6D2C2E2F005C
0251+  6208             
0252+  6208             SearchFile
0253+  6208 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0254+  620C C2 7C 62    	JP	NZ,SearchFileT		;Tree
0255+  620F DD E5       	PUSH	IX
0256+  6211 DB E2       	IN	A,(PAGE3)
0257+  6213 F5          	PUSH	AF
0258+  6214 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0259+  6218 3A EE A7    	LD	A,(DIRpage1)
0260+  621B 28 03       	JR	Z,$+5
0261+  621D 3A EF A7    	LD	A,(DIRpage2)
0262+  6220 D3 E2       	OUT	(PAGE3),A
0263+  6222 DD 21 00 00 	LD	IX,#0000
0264+  6226 21 01 C0    	LD	HL,#C001
0265+  6229 01 18 00    	LD	BC,#0018
0266+  622C             SearchFlp
0267+  622C 11 C6 61    	LD	DE,SearchN
0268+  622F 1A          	LD	A,(DE)
0269+  6230 CD 57 AA    	CALL	CorrBigChar
0270+  6233 BE          	CP	(HL)
0271+  6234 28 06       	JR	Z,SrchF1
0272+  6236 CD 6F AA    	CALL	CorrSmallChar
0273+  6239 BE          	CP	(HL)
0274+  623A 20 26       	JR	NZ,SearchFnxt
0275+  623C E5          SrchF1	PUSH	HL
0276+  623D D5          	PUSH	DE
0277+  623E 11 00 80    	LD	DE,WorkBuffer
0278+  6241 D5          	PUSH	DE
0279+  6242 CD 6A BE    	CALL	MakeDOSname
0280+  6245 E1          	POP	HL
0281+  6246 D1          	POP	DE
0282+  6247 13          SrchF2	INC	DE
0283+  6248 1A          	LD	A,(DE)
0284+  6249 B7          	OR	A
0285+  624A 28 24       	JR	Z,SearchFexit
0286+  624C 23          	INC	HL
0287+  624D 7E          	LD	A,(HL)
0288+  624E B7          	OR	A
0289+  624F 28 0D       	JR	Z,SearchFnx0
0290+  6251 1A          	LD	A,(DE)
0291+  6252 CD 57 AA    	CALL	CorrBigChar
0292+  6255 BE          	CP	(HL)
0293+  6256 28 EF       	JR	Z,SrchF2
0294+  6258 CD 6F AA    	CALL	CorrSmallChar
0295+  625B BE          	CP	(HL)
0296+  625C 28 E9       	JR	Z,SrchF2
0297+  625E             SearchFnx0
0298+  625E E1          	POP	HL
0299+  625F 01 18 00    	LD	BC,#0018
0300+  6262             SearchFnxt
0301+  6262 09          	ADD	HL,BC
0302+  6263 DD 23       	INC	IX
0303+  6265 7E          	LD	A,(HL)
0304+  6266 B7          	OR	A
0305+  6267 20 C3       	JR	NZ,SearchFlp
0306+  6269 F1          	POP	AF
0307+  626A D3 E2       	OUT	(PAGE3),A
0308+  626C DD E1       	POP	IX
0309+  626E 37          	SCF 
0310+  626F C9          	RET 
0311+  6270             SearchFexit
0312+  6270 33          	INC	SP
0313+  6271 33          	INC	SP
0314+  6272 F1          	POP	AF
0315+  6273 D3 E2       	OUT	(PAGE3),A
0316+  6275 DD E5       	PUSH	IX
0317+  6277 E1          	POP	HL
0318+  6278 DD E1       	POP	IX
0319+  627A B7          	OR	A
0320+  627B C9          	RET 
0321+  627C             
0322+  627C             SearchFileT
0323+  627C DD E5       	PUSH	IX
0324+  627E DB E2       	IN	A,(PAGE3)
0325+  6280 F5          	PUSH	AF
0326+  6281 FD CB 00 46 	BIT	0,(IY+PanelFlg)
0327+  6285 3A EE A7    	LD	A,(DIRpage1)
0328+  6288 28 03       	JR	Z,$+5
0329+  628A 3A EF A7    	LD	A,(DIRpage2)
0330+  628D D3 E2       	OUT	(PAGE3),A
0331+  628F DD 21 00 00 	LD	IX,#0000
0332+  6293 21 02 C0    	LD	HL,#C002
0333+  6296 01 0D 00    	LD	BC,#000D
0334+  6299             SearchTlp
0335+  6299 11 C6 61    	LD	DE,SearchN
0336+  629C 1A          	LD	A,(DE)
0337+  629D CD 57 AA    	CALL	CorrBigChar
0338+  62A0 BE          	CP	(HL)
0339+  62A1 28 06       	JR	Z,SrchT1
0340+  62A3 CD 6F AA    	CALL	CorrSmallChar
0341+  62A6 BE          	CP	(HL)
0342+  62A7 20 19       	JR	NZ,SearchTnxt
0343+  62A9 E5          SrchT1	PUSH	HL
0344+  62AA 13          SrchT2	INC	DE
0345+  62AB 1A          	LD	A,(DE)
0346+  62AC B7          	OR	A
0347+  62AD 28 24       	JR	Z,SearchTexit
0348+  62AF 23          	INC	HL
0349+  62B0 7E          	LD	A,(HL)
0350+  62B1 B7          	OR	A
0351+  62B2 28 0D       	JR	Z,SearchTnx0
0352+  62B4 1A          	LD	A,(DE)
0353+  62B5 CD 57 AA    	CALL	CorrBigChar
0354+  62B8 BE          	CP	(HL)
0355+  62B9 28 EF       	JR	Z,SrchT2
0356+  62BB CD 6F AA    	CALL	CorrSmallChar
0357+  62BE BE          	CP	(HL)
0358+  62BF 28 E9       	JR	Z,SrchT2
0359+  62C1             SearchTnx0
0360+  62C1 E1          	POP	HL
0361+  62C2             SearchTnxt
0362+  62C2 09          	ADD	HL,BC
0363+  62C3 DD 23       	INC	IX
0364+  62C5 7E          	LD	A,(HL)
0365+  62C6 23          	INC	HL
0366+  62C7 23          	INC	HL
0367+  62C8 23          	INC	HL
0368+  62C9 3C          	INC	A
0369+  62CA 20 CD       	JR	NZ,SearchTlp
0370+  62CC F1          	POP	AF
0371+  62CD D3 E2       	OUT	(PAGE3),A
0372+  62CF DD E1       	POP	IX
0373+  62D1 37          	SCF 
0374+  62D2 C9          	RET 
0375+  62D3             SearchTexit
0376+  62D3 33          	INC	SP
0377+  62D4 33          	INC	SP
0378+  62D5 F1          	POP	AF
0379+  62D6 D3 E2       	OUT	(PAGE3),A
0380+  62D8 DD E5       	PUSH	IX
0381+  62DA E1          	POP	HL
0382+  62DB DD E1       	POP	IX
0383+  62DD B7          	OR	A
0384+  62DE C9          	RET 
0385+  62DF             
0386+  62DF             SrchExit
0387+  62DF E1          	POP	HL
0388+  62E0             SearchExit
0389+  62E0 CD F0 86    	CALL	MakeWindow
0390+  62E3 7F          	DEFB	#7F
0391+  62E4 00          	DEFB	#00
0392+  62E5 FD CB 01 4E 	BIT	1,(IY+ViewFlg)
0393+  62E9 C4 28 B0    	CALL	NZ,TestTreeBeg
0394+  62EC C9          	RET 
0395+  62ED             
0396+  62ED             
0397+  62ED             
0289   62ED             	include "fnconfig.z80"
0001+  62ED             
0002+  62ED             TempColor EQU	PALETTE+52
0003+  62ED             ;[]==========================================================[]
0004+  62ED             SetupR
0005+  62ED 3E C0       	LD	A,#C0
0006+  62EF D3 89       	OUT	(YPORT),A
0007+  62F1 21 EA BA    	LD	HL,SetInvert
0008+  62F4 E5          	PUSH	HL
0009+  62F5 21 00 85    	LD	HL,PALETTE
0010+  62F8 11 48 68    	LD	DE,TempPALETTE
0011+  62FB 01 40 00    	LD	BC,#0040
0012+  62FE ED B0       	LDIR 
0013+  6300 3A 0B 68    	LD	A,(SavePanels)
0014+  6303 32 3B 66    	LD	(SaveSav+1),A
0015+  6306 B7          	OR	A
0016+  6307 3E FE       	LD	A,#FE
0017+  6309 28 01       	JR	Z,$+3
0018+  630B 3C          	INC	A
0019+  630C 32 43 64    	LD	(SaveFlg),A
0020+  630F 97          	SUB	A
0021+  6310 32 DF 66    	LD	(SaveFlag),A
0022+  6313 CD F0 86    	CALL	MakeWindow
0023+  6316 01          	DEFB	#01
0024+  6317 60 00 40 00 	DEFW	#0060,#0040
0025+  631B C0 01 78 00 	DEFW	#01C0,#0078
0026+  631F 02          	DEFB	#02	;Head place
0027+  6320 04 00 02 00 	DEFW	#0004,#0002
0028+  6324 B8 01 0A 00 	DEFW	#01B8,#000A
0029+  6328 00          	DEFB	#00
0030+  6329 01          	DEFB	#01	;Text Line
0031+  632A D0 00 03 00 	DEFW	#00D0,#0003
0032+  632E 0F          	DEFB	#0F
0033+  632F             	DEFB	"Setup",0
0033+  632F 536574757000
0034+  6335 03          	DEFB	#03		;Углубл
0035+  6336 08 00 12 00 	DEFW	#0008,#0012
0036+  633A 90 00 35 00 	DEFW	#0090,#0035
0037+  633E 02          	DEFB	#02		;Фон
0038+  633F 0A 00 13 00 	DEFW	#000A,#0013
0039+  6343 8C 00 33 00 	DEFW	#008C,#0033
0040+  6347 0F          	DEFB	#0F
0041+  6348 01          	DEFB	#01	;Text Line
0042+  6349 0E 00 15 00 	DEFW	#000E,#0015
0043+  634D F0          	DEFB	#F0
0044+  634E             	DEFB	"Panel",0
0044+  634E 50616E656C00
0045+  6354 01          	DEFB	#01	;Text Line
0046+  6355 0E 00 1D 00 	DEFW	#000E,#001D
0047+  6359 F0          	DEFB	#F0
0048+  635A             	DEFB	"Files",0
0048+  635A 46696C657300
0049+  6360 01          	DEFB	#01	;Text Line
0050+  6361 0E 00 25 00 	DEFW	#000E,#0025
0051+  6365 F0          	DEFB	#F0
0052+  6366             	DEFB	"Selected files",0
0052+  6366 53656C65637465642066696C657300
0053+  6375 01          	DEFB	#01	;Text Line
0054+  6376 0E 00 2D 00 	DEFW	#000E,#002D
0055+  637A F0          	DEFB	#F0
0056+  637B             	DEFB	"Invert background",0
0056+  637B 496E76657274206261636B67726F756E6400
0057+  638D 01          	DEFB	#01	;Text Line
0058+  638E 0E 00 35 00 	DEFW	#000E,#0035
0059+  6392 F0          	DEFB	#F0
0060+  6393             	DEFB	"Invert foreground",0
0060+  6393 496E7665727420666F726567726F756E6400
0061+  63A5 01          	DEFB	#01	;Text Line
0062+  63A6 0E 00 3D 00 	DEFW	#000E,#003D
0063+  63AA F0          	DEFB	#F0
0064+  63AB             	DEFB	"Invert foreground (select)",0
0064+  63AB 496E7665727420666F726567726F756E64202873656C6563742900
0065+  63C6 01          	DEFB	#01	;Text Line
0066+  63C7 A4 00 18 00 	DEFW	#00A4,#0018
0067+  63CB 80          	DEFB	#80
0068+  63CC 52 3A 00    	DEFB	"R:",0
0069+  63CF 03          	DEFB	#03		;Углубл
0070+  63D0 B0 00 16 00 	DEFW	#00B0,#0016
0071+  63D4 A4 00 0A 00 	DEFW	#00A4,#000A
0072+  63D8 08          	DEFB	#08		;Кнопка	SB левая
0073+  63D9 B2 00 17 00 	DEFW	#00B2,#0017
0074+  63DD 09          	DEFB	#09		;Кнопка	SB правая
0075+  63DE 42 01 17 00 	DEFW	#0142,#0017
0076+  63E2 01          	DEFB	#01	;Text Line
0077+  63E3 A4 00 28 00 	DEFW	#00A4,#0028
0078+  63E7 80          	DEFB	#80
0079+  63E8 47 3A 00    	DEFB	"G:",0
0080+  63EB 03          	DEFB	#03		;Углубл
0081+  63EC B0 00 26 00 	DEFW	#00B0,#0026
0082+  63F0 A4 00 0A 00 	DEFW	#00A4,#000A
0083+  63F4 08          	DEFB	#08		;Кнопка	SB левая
0084+  63F5 B2 00 27 00 	DEFW	#00B2,#0027
0085+  63F9 09          	DEFB	#09		;Кнопка	SB правая
0086+  63FA 42 01 27 00 	DEFW	#0142,#0027
0087+  63FE 01          	DEFB	#01	;Text Line
0088+  63FF A4 00 38 00 	DEFW	#00A4,#0038
0089+  6403 80          	DEFB	#80
0090+  6404 42 3A 00    	DEFB	"B:",0
0091+  6407 03          	DEFB	#03		;Углубл
0092+  6408 B0 00 36 00 	DEFW	#00B0,#0036
0093+  640C A4 00 0A 00 	DEFW	#00A4,#000A
0094+  6410 08          	DEFB	#08		;Кнопка	SB левая
0095+  6411 B2 00 37 00 	DEFW	#00B2,#0037
0096+  6415 09          	DEFB	#09		;Кнопка	SB правая
0097+  6416 42 01 37 00 	DEFW	#0142,#0037
0098+  641A 03          	DEFB	#03		;Углубл
0099+  641B 74 01 17 00 	DEFW	#0174,#0017
0100+  641F 40 00 28 00 	DEFW	#0040,#0028
0101+  6423 06          	DEFB	#06	;Horizontal line
0102+  6424 04 00 4B 00 	DEFW	#0004,#004B
0103+  6428 B8 01       	DEFW	#01B8
0104+  642A 03          	DEFB	#03		;Углубл
0105+  642B 10 00 51 00 	DEFW	#0010,#0051
0106+  642F 14 00 0B 00 	DEFW	#0014,#000B
0107+  6433 02          	DEFB	#02	;Head place
0108+  6434 12 00 52 00 	DEFW	#0012,#0052
0109+  6438 10 00 09 00 	DEFW	#0010,#0009
0110+  643C 0F          	DEFB	#0F
0111+  643D 01          	DEFB	#01	;Text Line
0112+  643E 14 00 53 00 	DEFW	#0014,#0053
0113+  6442 F0          	DEFB	#F0
0114+  6443 00 00       SaveFlg	DEFB	#00,#00
0115+  6445 01          	DEFB	#01	;Text Line
0116+  6446 28 00 54 00 	DEFW	#0028,#0054
0117+  644A 80          	DEFB	#80
0118+  644B             	DEFB	"save Information about panels",0
0118+  644B 7361766520496E666F726D6174696F6E2061626F75742070616E656C7300
0119+  6469 04          	DEFB	#04	;UpRectan
0120+  646A 68 01 50 00 	DEFW	#0168,#0050
0121+  646E 48 00 0E 00 	DEFW	#0048,#000E
0122+  6472 01          	DEFB	#01	;Text Line
0123+  6473 80 01 53 00 	DEFW	#0180,#0053
0124+  6477 80          	DEFB	#80
0125+  6478 5361766500  	DEFB	"Save",0
0126+  647D 06          	DEFB	#06	;Horizontal line
0127+  647E 04 00 61 00 	DEFW	#0004,#0061
0128+  6482 B8 01       	DEFW	#01B8
0129+  6484 04          	DEFB	#04	;UpRectan
0130+  6485 10 01 66 00 	DEFW	#0110,#0066
0131+  6489 48 00 0E 00 	DEFW	#0048,#000E
0132+  648D 01          	DEFB	#01	;Text Line
0133+  648E 24 01 69 00 	DEFW	#0124,#0069
0134+  6492 80          	DEFB	#80
0135+  6493             	DEFB	"Cancel",0
0135+  6493 43616E63656C00
0136+  649A 04          	DEFB	#04	;UpRectan
0137+  649B 68 01 66 00 	DEFW	#0168,#0066
0138+  649F 48 00 0E 00 	DEFW	#0048,#000E
0139+  64A3 01          	DEFB	#01	;Text Line
0140+  64A4 86 01 69 00 	DEFW	#0186,#0069
0141+  64A8 80          	DEFB	#80
0142+  64A9 4F 6B 00    	DEFB	"Ok",0
0143+  64AC 00          	DEFB	#00
0144+  64AD 97          	SUB	A
0145+  64AE 32 0A 68    	LD	(CurElement),A
0146+  64B1 CD 8D 68    	CALL	SetSetupInv
0147+  64B4 DD 21 12 68 	LD	IX,BarRed
0148+  64B8 CD F7 96    	CALL	InitScrBar
0149+  64BB DD 21 24 68 	LD	IX,BarGreen
0150+  64BF CD F7 96    	CALL	InitScrBar
0151+  64C2 DD 21 36 68 	LD	IX,BarBlue
0152+  64C6 CD F7 96    	CALL	InitScrBar
0153+  64C9 CD AF 68    	CALL	InitElement
0154+  64CC             SetupLoop
0155+  64CC DD 21 48 6F 	LD	IX,SetupTab
0156+  64D0 CD 1C 9B    	CALL	TestCoords
0157+  64D3 0E 31       	LD	C,#31
0158+  64D5 D7          	RST	#10
0159+  64D6 28 F4       	JR	Z,SetupLoop
0160+  64D8 78          	LD	A,B
0161+  64D9 E6 3F       	AND	#3F
0162+  64DB 28 1F       	JR	Z,SetupLoop0
0163+  64DD CB 60       	BIT	4,B
0164+  64DF 20 EB       	JR	NZ,SetupLoop
0165+  64E1 CB 68       	BIT	5,B
0166+  64E3 28 E7       	JR	Z,SetupLoop
0167+  64E5 21 CC 64    	LD	HL,SetupLoop
0168+  64E8 E5          	PUSH	HL
0169+  64E9 7A          	LD	A,D
0170+  64EA E6 7F       	AND	#7F
0171+  64EC FE 13       	CP	#13
0172+  64EE CA A2 67    	JP	Z,InputRED
0173+  64F1 FE 21       	CP	#21
0174+  64F3 CA AD 67    	JP	Z,InputGREEN
0175+  64F6 FE 2E       	CP	#2E
0176+  64F8 CA B8 67    	JP	Z,InputBLUE
0177+  64FB C9          	RET 
0178+  64FC             SetupLoop0
0179+  64FC 78          	LD	A,B
0180+  64FD E6 C0       	AND	#C0
0181+  64FF 28 17       	JR	Z,SetupLoop1
0182+  6501 21 CC 64    	LD	HL,SetupLoop
0183+  6504 E5          	PUSH	HL
0184+  6505 7B          	LD	A,E
0185+  6506 E6 5F       	AND	#5F
0186+  6508 FE 52       	CP	"R"
0187+  650A CA 42 67    	JP	Z,DecRED
0188+  650D FE 47       	CP	"G"
0189+  650F CA 52 67    	JP	Z,DecGREEN
0190+  6512 FE 42       	CP	"B"
0191+  6514 CA 62 67    	JP	Z,DecBLUE
0192+  6517 C9          	RET 
0193+  6518             SetupLoop1
0194+  6518 7B          	LD	A,E
0195+  6519 CB AF       	RES	5,A
0196+  651B FE 1B       	CP	#1B
0197+  651D CA 35 66    	JP	Z,SetupCancel
0198+  6520 FE 0D       	CP	#0D
0199+  6522 CA 41 66    	JP	Z,SetupOkey
0200+  6525 FE 43       	CP	"C"
0201+  6527 CA 35 66    	JP	Z,SetupCancel
0202+  652A FE 4F       	CP	"O"
0203+  652C CA 41 66    	JP	Z,SetupOkey
0204+  652F 21 CC 64    	LD	HL,SetupLoop
0205+  6532 E5          	PUSH	HL
0206+  6533 FE 53       	CP	"S"
0207+  6535 CA 6E 65    	JP	Z,SaveSetup
0208+  6538 FE 52       	CP	"R"
0209+  653A CA 4A 67    	JP	Z,IncRED
0210+  653D FE 47       	CP	"G"
0211+  653F CA 5A 67    	JP	Z,IncGREEN
0212+  6542 FE 42       	CP	"B"
0213+  6544 CA 6A 67    	JP	Z,IncBLUE
0214+  6547 FE 49       	CP	"I"
0215+  6549 CA 20 67    	JP	Z,ChSavePan
0216+  654C B7          	OR	A
0217+  654D C0          	RET	NZ
0218+  654E 7A          	LD	A,D
0219+  654F FE 58       	CP	#58
0220+  6551 CA E0 66    	JP	Z,BoxUp
0221+  6554 FE 52       	CP	#52
0222+  6556 CA E7 66    	JP	Z,BoxDown
0223+  6559 FE 57       	CP	#57
0224+  655B CA F0 66    	JP	Z,BoxHome
0225+  655E FE 51       	CP	#51
0226+  6560 CA F8 66    	JP	Z,BoxEnd
0227+  6563 FE 59       	CP	#59
0228+  6565 CA F0 66    	JP	Z,BoxHome
0229+  6568 FE 53       	CP	#53
0230+  656A CA F8 66    	JP	Z,BoxEnd
0231+  656D C9          	RET 
0232+  656E             ;[]----------------------------------------------------------[]
0233+  656E             SaveSetup
0234+  656E CD 9C A0    	CALL	SetClock
0235+  6571 0E 02       	LD	C,#02
0236+  6573 FD E5       	PUSH	IY
0237+  6575 D7          	RST	#10
0238+  6576 FD E1       	POP	IY
0239+  6578 21 00 80    	LD	HL,WorkBuffer
0240+  657B C6 41       	ADD	A,"A"
0241+  657D 77          	LD	(HL),A
0242+  657E 23          	INC	HL
0243+  657F 36 3A       	LD	(HL),":"
0244+  6581 23          	INC	HL
0245+  6582 0E 1E       	LD	C,#1E
0246+  6584 FD E5       	PUSH	IY
0247+  6586 D7          	RST	#10
0248+  6587 FD E1       	POP	IY
0249+  6589 21 62 74    	LD	HL,FlexDIRECTORY
0250+  658C 0E 1D       	LD	C,#1D
0251+  658E FD E5       	PUSH	IY
0252+  6590 D7          	RST	#10
0253+  6591 FD E1       	POP	IY
0254+  6593 F5          	PUSH	AF
0255+  6594 DC A8 86    	CALL	C,DOSError
0256+  6597 F1          	POP	AF
0257+  6598 38 7B       	JR	C,SetupSaveEx
0258+  659A 21 2E 66    	LD	HL,SetupName
0259+  659D 97          	SUB	A
0260+  659E 0E 0A       	LD	C,#0A
0261+  65A0 FD E5       	PUSH	IY
0262+  65A2 D7          	RST	#10
0263+  65A3 FD E1       	POP	IY
0264+  65A5 F5          	PUSH	AF
0265+  65A6 DC A8 86    	CALL	C,DOSError
0266+  65A9 F1          	POP	AF
0267+  65AA 38 69       	JR	C,SetupSaveEx
0268+  65AC 08          	EX	AF,AF'
0269+  65AD 21 23 66    	LD	HL,SetupHead
0270+  65B0 11 00 81    	LD	DE,WorkBuffer+#100
0271+  65B3 01 0B 00    	LD	BC,11
0272+  65B6 ED B0       	LDIR 
0273+  65B8 21 48 68    	LD	HL,TempPALETTE
0274+  65BB 01 40 00    	LD	BC,#0040
0275+  65BE ED B0       	LDIR 
0276+  65C0 3A 0B 68    	LD	A,(SavePanels)
0277+  65C3 12          	LD	(DE),A
0278+  65C4 13          	INC	DE
0279+  65C5 B7          	OR	A
0280+  65C6 28 33       	JR	Z,SvSetup
0281+  65C8 3A E5 A7    	LD	A,(MouseFlag)
0282+  65CB 12          	LD	(DE),A
0283+  65CC 13          	INC	DE
0284+  65CD 21 8A A5    	LD	HL,LeftPanel
0285+  65D0 E5          	PUSH	HL
0286+  65D1 ED A0       	LDI 
0287+  65D3 ED A0       	LDI 
0288+  65D5 ED A0       	LDI 
0289+  65D7 E1          	POP	HL
0290+  65D8 01 1F 00    	LD	BC,BegMask
0291+  65DB 09          	ADD	HL,BC
0292+  65DC 97          	SUB	A
0293+  65DD ED A0       	LDI 
0294+  65DF BE          	CP	(HL)
0295+  65E0 20 FB       	JR	NZ,$-3
0296+  65E2 12          	LD	(DE),A
0297+  65E3 13          	INC	DE
0298+  65E4 21 B6 A6    	LD	HL,RightPanel
0299+  65E7 E5          	PUSH	HL
0300+  65E8 ED A0       	LDI 
0301+  65EA ED A0       	LDI 
0302+  65EC ED A0       	LDI 
0303+  65EE E1          	POP	HL
0304+  65EF 01 1F 00    	LD	BC,BegMask
0305+  65F2 09          	ADD	HL,BC
0306+  65F3 97          	SUB	A
0307+  65F4 ED A0       	LDI 
0308+  65F6 BE          	CP	(HL)
0309+  65F7 20 FB       	JR	NZ,$-3
0310+  65F9 12          	LD	(DE),A
0311+  65FA 13          	INC	DE
0312+  65FB 21 00 81    SvSetup	LD	HL,WorkBuffer+#100
0313+  65FE B7          	OR	A
0314+  65FF EB          	EX	DE,HL
0315+  6600 ED 52       	SBC	HL,DE
0316+  6602 EB          	EX	DE,HL
0317+  6603 0E 14       	LD	C,#14
0318+  6605 08          	EX	AF,AF'
0319+  6606 FD E5       	PUSH	IY
0320+  6608 F5          	PUSH	AF
0321+  6609 D7          	RST	#10
0322+  660A F1          	POP	AF
0323+  660B 0E 12       	LD	C,#12
0324+  660D D7          	RST	#10
0325+  660E FD E1       	POP	IY
0326+  6610 3E 01       	LD	A,#01
0327+  6612 32 DF 66    	LD	(SaveFlag),A
0328+  6615             SetupSaveEx
0329+  6615 21 00 80    	LD	HL,WorkBuffer
0330+  6618 0E 1D       	LD	C,#1D
0331+  661A FD E5       	PUSH	IY
0332+  661C D7          	RST	#10
0333+  661D FD E1       	POP	IY
0334+  661F CD 3C A1    	CALL	SetMouse
0335+  6622 C9          	RET 
0336+  6623             SetupHead
0337+  6623             	DEFB	#AE,"FlexSetup",0
0337+  6623 AE466C6578536574757000
0338+  662E             SetupName
0339+  662E             	DEFB	"fn.ini",0
0339+  662E 666E2E696E6900
0340+  6635             ;--------------------------------------------------------------
0341+  6635             SetupCancel
0342+  6635 CD F0 86    	CALL	MakeWindow
0343+  6638 7F          	DEFB	#7F
0344+  6639 00          	DEFB	#00
0345+  663A 3E 00       SaveSav	LD	A,#00
0346+  663C 32 0B 68    	LD	(SavePanels),A
0347+  663F 18 1A       	JR	SetupExit
0348+  6641             SetupOkey
0349+  6641 CD F0 86    	CALL	MakeWindow
0350+  6644 7F          	DEFB	#7F
0351+  6645 00          	DEFB	#00
0352+  6646 21 48 68    	LD	HL,TempPALETTE
0353+  6649 11 00 85    	LD	DE,PALETTE
0354+  664C 01 40 00    	LD	BC,#0040
0355+  664F D5          	PUSH	DE
0356+  6650 ED B0       	LDIR 
0357+  6652 E1          	POP	HL
0358+  6653 11 00 10    	LD	DE,#1000
0359+  6656 01 A4 FF    	LD	BC,#FFA4
0360+  6659 97          	SUB	A
0361+  665A CF          	RST	#08
0362+  665B             SetupExit
0363+  665B 3A DF 66    	LD	A,(SaveFlag)
0364+  665E B7          	OR	A
0365+  665F C8          	RET	Z
0366+  6660 DD 21 8A A5 	LD	IX,LeftPanel
0367+  6664 21 B6 A5    	LD	HL,LeftPanel+BegPath
0368+  6667 11 62 74    	LD	DE,FlexDIRECTORY
0369+  666A 1A          	LD	A,(DE)
0370+  666B BE          SetRef1	CP	(HL)
0371+  666C 20 0A       	JR	NZ,SetRef2
0372+  666E 23          	INC	HL
0373+  666F 13          	INC	DE
0374+  6670 1A          	LD	A,(DE)
0375+  6671 B7          	OR	A
0376+  6672 20 F7       	JR	NZ,SetRef1
0377+  6674 BE          	CP	(HL)
0378+  6675 CC 9F 66    	CALL	Z,RefreshSetup
0379+  6678 DD 21 B6 A6 SetRef2	LD	IX,RightPanel
0380+  667C 21 E2 A6    	LD	HL,RightPanel+BegPath
0381+  667F 11 62 74    	LD	DE,FlexDIRECTORY
0382+  6682 1A          	LD	A,(DE)
0383+  6683 BE          SetRef3	CP	(HL)
0384+  6684 20 0A       	JR	NZ,SetRef4
0385+  6686 23          	INC	HL
0386+  6687 13          	INC	DE
0387+  6688 1A          	LD	A,(DE)
0388+  6689 B7          	OR	A
0389+  668A 20 F7       	JR	NZ,SetRef3
0390+  668C BE          	CP	(HL)
0391+  668D CC 9F 66    	CALL	Z,RefreshSetup
0392+  6690 FD E5       SetRef4	PUSH	IY
0393+  6692 E1          	POP	HL
0394+  6693 11 2C 00    	LD	DE,BegPath
0395+  6696 19          	ADD	HL,DE
0396+  6697 0E 1D       	LD	C,#1D
0397+  6699 FD E5       	PUSH	IY
0398+  669B D7          	RST	#10
0399+  669C FD E1       	POP	IY
0400+  669E C9          	RET 
0401+  669F             RefreshSetup
0402+  669F DD CB 01 4E 	BIT	1,(IX+ViewFlg)
0403+  66A3 C0          	RET	NZ
0404+  66A4 FD E5       	PUSH	IY
0405+  66A6 DD E5       	PUSH	IX
0406+  66A8 FD E1       	POP	IY
0407+  66AA FD E5       	PUSH	IY
0408+  66AC E1          	POP	HL
0409+  66AD 11 2C 00    	LD	DE,BegPath
0410+  66B0 19          	ADD	HL,DE
0411+  66B1 0E 1D       	LD	C,#1D
0412+  66B3 FD E5       	PUSH	IY
0413+  66B5 D7          	RST	#10
0414+  66B6 FD E1       	POP	IY
0415+  66B8 38 22       	JR	C,RefrErr
0416+  66BA CD F5 A7    	CALL	ReadDIR
0417+  66BD CD 45 B5    	CALL	PrintDIR
0418+  66C0 CD EE B2    	CALL	PrnFileInfo
0419+  66C3 FD E5       	PUSH	IY
0420+  66C5 DD E1       	POP	IX
0421+  66C7 11 05 00    	LD	DE,BegPBar
0422+  66CA DD 19       	ADD	IX,DE
0423+  66CC CD F7 96    	CALL	InitScrBar
0424+  66CF FD 7E 01    	LD	A,(IY+ViewFlg)
0425+  66D2 E6 03       	AND	#03
0426+  66D4 F5          	PUSH	AF
0427+  66D5 CC 35 97    	CALL	Z,PrnHScrBar
0428+  66D8 F1          	POP	AF
0429+  66D9 C4 8E 98    	CALL	NZ,PrnVScrBar
0430+  66DC FD E1       RefrErr	POP	IY
0431+  66DE C9          	RET 
0432+  66DF             SaveFlag
0433+  66DF 00          	DEFB	#00
0434+  66E0             ;--------------------------------------------------------------
0435+  66E0             BoxUp
0436+  66E0 3A 0A 68    	LD	A,(CurElement)
0437+  66E3 3D          	DEC	A
0438+  66E4 F8          	RET	M
0439+  66E5 18 2A       	JR	BoxKeyExt
0440+  66E7             BoxDown
0441+  66E7 3A 0A 68    	LD	A,(CurElement)
0442+  66EA 3C          	INC	A
0443+  66EB FE 06       	CP	#06
0444+  66ED C8          	RET	Z
0445+  66EE 18 21       	JR	BoxKeyExt
0446+  66F0             BoxHome
0447+  66F0 3A 0A 68    	LD	A,(CurElement)
0448+  66F3 B7          	OR	A
0449+  66F4 C8          	RET	Z
0450+  66F5 97          	SUB	A
0451+  66F6 18 19       	JR	BoxKeyExt
0452+  66F8             BoxEnd
0453+  66F8 3A 0A 68    	LD	A,(CurElement)
0454+  66FB FE 05       	CP	#05
0455+  66FD C8          	RET	Z
0456+  66FE 3E 05       	LD	A,#05
0457+  6700 18 0F       	JR	BoxKeyExt
0458+  6702             NewElement
0459+  6702 3A 0A 68    	LD	A,(CurElement)
0460+  6705 4F          	LD	C,A
0461+  6706 7B          	LD	A,E
0462+  6707 D6 55       	SUB	#55
0463+  6709 CB 3F       	SRL	A
0464+  670B CB 3F       	SRL	A
0465+  670D CB 3F       	SRL	A
0466+  670F B9          	CP	C
0467+  6710 C8          	RET	Z
0468+  6711             BoxKeyExt
0469+  6711 F5          	PUSH	AF
0470+  6712 CD 88 68    	CALL	ResSetupInv
0471+  6715 F1          	POP	AF
0472+  6716 32 0A 68    	LD	(CurElement),A
0473+  6719 CD 8D 68    	CALL	SetSetupInv
0474+  671C CD AF 68    	CALL	InitElement
0475+  671F C9          	RET 
0476+  6720             ;--------------------------------------------------------------
0477+  6720             ChSavePan
0478+  6720 21 40 67    	LD	HL,SavePanTxt
0479+  6723 3A 0B 68    	LD	A,(SavePanels)
0480+  6726 EE 01       	XOR	#01
0481+  6728 32 0B 68    	LD	(SavePanels),A
0482+  672B EE 01       	XOR	#01
0483+  672D 3C          	INC	A
0484+  672E ED 44       	NEG 
0485+  6730 77          	LD	(HL),A
0486+  6731 11 74 00    	LD	DE,#0074
0487+  6734 01 93 00    	LD	BC,#0093
0488+  6737 3E F0       	LD	A,#F0
0489+  6739 CD B3 8F    	CALL	PrnTxtLnIFF
0490+  673C CD 0D 9B    	CALL	ResFire
0491+  673F C9          	RET 
0492+  6740             SavePanTxt
0493+  6740 00 00       	DEFB	#00,#00
0494+  6742             ;--------------------------------------------------------------
0495+  6742             DecRED
0496+  6742 21 36 85    	LD	HL,TempColor+2
0497+  6745 11 DB 68    	LD	DE,PrintRED
0498+  6748 18 28       	JR	DecCOLOR
0499+  674A             IncRED
0500+  674A 21 36 85    	LD	HL,TempColor+2
0501+  674D 11 DB 68    	LD	DE,PrintRED
0502+  6750 18 27       	JR	IncCOLOR
0503+  6752             DecGREEN
0504+  6752 21 35 85    	LD	HL,TempColor+1
0505+  6755 11 10 69    	LD	DE,PrintGREEN
0506+  6758 18 18       	JR	DecCOLOR
0507+  675A             IncGREEN
0508+  675A 21 35 85    	LD	HL,TempColor+1
0509+  675D 11 10 69    	LD	DE,PrintGREEN
0510+  6760 18 17       	JR	IncCOLOR
0511+  6762             DecBLUE
0512+  6762 21 34 85    	LD	HL,TempColor
0513+  6765 11 45 69    	LD	DE,PrintBLUE
0514+  6768 18 08       	JR	DecCOLOR
0515+  676A             IncBLUE
0516+  676A 21 34 85    	LD	HL,TempColor
0517+  676D 11 45 69    	LD	DE,PrintBLUE
0518+  6770 18 07       	JR	IncCOLOR
0519+  6772             
0520+  6772             DecCOLOR
0521+  6772 7E          	LD	A,(HL)
0522+  6773 B7          	OR	A
0523+  6774 C8          	RET	Z
0524+  6775 3D          	DEC	A
0525+  6776 77          	LD	(HL),A
0526+  6777 18 04       	JR	DecIncCOLOR
0527+  6779             IncCOLOR
0528+  6779 7E          	LD	A,(HL)
0529+  677A 3C          	INC	A
0530+  677B C8          	RET	Z
0531+  677C 77          	LD	(HL),A
0532+  677D             DecIncCOLOR
0533+  677D 21 7A 69    	LD	HL,PrnPALETTE
0534+  6780 E5          	PUSH	HL
0535+  6781 D5          	PUSH	DE
0536+  6782 21 0C 68    	LD	HL,ElementColor
0537+  6785 3A 0A 68    	LD	A,(CurElement)
0538+  6788 85          	ADD	A,L
0539+  6789 6F          	LD	L,A
0540+  678A 30 01       	JR	NC,$+3
0541+  678C 24          	INC	H
0542+  678D 7E          	LD	A,(HL)
0543+  678E 87          	ADD	A,A
0544+  678F 87          	ADD	A,A
0545+  6790 11 48 68    	LD	DE,TempPALETTE
0546+  6793 83          	ADD	A,E
0547+  6794 5F          	LD	E,A
0548+  6795 30 01       	JR	NC,$+3
0549+  6797 14          	INC	D
0550+  6798 21 34 85    	LD	HL,TempColor
0551+  679B ED A0       	LDI 
0552+  679D ED A0       	LDI 
0553+  679F ED A0       	LDI 
0554+  67A1 C9          	RET 
0555+  67A2             ;--------------------------------------------------------------
0556+  67A2             InputRED
0557+  67A2 21 36 85    	LD	HL,TempColor+2
0558+  67A5 11 DB 68    	LD	DE,PrintRED
0559+  67A8 01 58 00    	LD	BC,#0058
0560+  67AB 18 14       	JR	InputColor
0561+  67AD             InputGREEN
0562+  67AD 21 35 85    	LD	HL,TempColor+1
0563+  67B0 11 10 69    	LD	DE,PrintGREEN
0564+  67B3 01 68 00    	LD	BC,#0068
0565+  67B6 18 09       	JR	InputColor
0566+  67B8             InputBLUE
0567+  67B8 21 34 85    	LD	HL,TempColor
0568+  67BB 11 45 69    	LD	DE,PrintBLUE
0569+  67BE 01 78 00    	LD	BC,#0078
0570+  67C1             InputColor
0571+  67C1 ED 43 01 68 	LD	(ColorY),BC
0572+  67C5 01 7D 67    	LD	BC,DecIncCOLOR
0573+  67C8 C5          	PUSH	BC
0574+  67C9 E5          	PUSH	HL
0575+  67CA D5          	PUSH	DE
0576+  67CB 11 06 68    	LD	DE,ColText
0577+  67CE 7E          	LD	A,(HL)
0578+  67CF CD 78 A3    	CALL	ConvNumTxt8
0579+  67D2 97          	SUB	A
0580+  67D3 12          	LD	(DE),A
0581+  67D4 7B          	LD	A,E
0582+  67D5 D6 06       	SUB	low ColText
0583+  67D7 32 FE 67    	LD	(ColLen),A
0584+  67DA DD 21 FA 67 InpAg	LD	IX,ColorStr
0585+  67DE 21 50 74    	LD	HL,EmptyTab
0586+  67E1 CD 68 91    	CALL	InputLine
0587+  67E4 D1          	POP	DE
0588+  67E5 E1          	POP	HL
0589+  67E6 D8          	RET	C
0590+  67E7 E5          	PUSH	HL
0591+  67E8 D5          	PUSH	DE
0592+  67E9 11 06 68    	LD	DE,ColText
0593+  67EC CD 23 A4    	CALL	ConvTxtNum16
0594+  67EF 38 E9       	JR	C,InpAg
0595+  67F1 7C          	LD	A,H
0596+  67F2 B7          	OR	A
0597+  67F3 20 E5       	JR	NZ,InpAg
0598+  67F5 7D          	LD	A,L
0599+  67F6 D1          	POP	DE
0600+  67F7 E1          	POP	HL
0601+  67F8 77          	LD	(HL),A
0602+  67F9 C9          	RET 
0603+  67FA             ColorStr
0604+  67FA 03 00 00 00 	DEFB	#03,#00,#00,#00
0605+  67FE 00          ColLen	DEFB	#00
0606+  67FF B8 01       	DEFW	#01B8
0607+  6801 00 00       ColorY	DEFW	#0000
0608+  6803 1A 00       	DEFW	#001A
0609+  6805 80          	DEFB	#80
0610+  6806 00          ColText	DEFS	#04,#00
0611+  680A             ;--------------------------------------------------------------
0612+  680A             CurElement
0613+  680A 00          	DEFB	#00
0614+  680B             SavePanels
0615+  680B 01          	DEFB	#01
0616+  680C             ElementColor
0617+  680C             	DEFB   PanelCol,FileCol,SFileCol,InvPCol,InvICol,InvSCol
0617+  680C 090A0B05060C
0618+  6812             BarRed
0619+  6812 22 01       	DEFW	#0122	;X позиция скролбара
0620+  6814 57 00       	DEFW	#0057	;Y позиция скролбара
0621+  6816 80 00       	DEFW	#0080	;Max длина скролбара
0622+  6818 00 00       	DEFW	#0000	;тек.длина скролбара
0623+  681A 00 00       	DEFW	#0000	;Адрес ячейки BarLeft
0624+  681C 00 00       	DEFW	#0000	;Адрес ячейки BarRight
0625+  681E 98 01       	DEFW	#0198	;Кол-во	файлов на странице
0626+  6820 F0 0F       	DEFW	#0FF0	;Общее кол-во файлов
0627+  6822 00 00       CRed	DEFW	#0000	;Первый	файл на	странице
0628+  6824             BarGreen
0629+  6824 22 01       	DEFW	#0122	;X позиция скролбара
0630+  6826 67 00       	DEFW	#0067	;Y позиция скролбара
0631+  6828 80 00       	DEFW	#0080	;Max длина скролбара
0632+  682A 00 00       	DEFW	#0000	;тек.длина скролбара
0633+  682C 00 00       	DEFW	#0000	;Адрес ячейки BarLeft
0634+  682E 00 00       	DEFW	#0000	;Адрес ячейки BarRight
0635+  6830 98 01       	DEFW	#0198	;Кол-во	файлов на странице
0636+  6832 F0 0F       	DEFW	#0FF0	;Общее кол-во файлов
0637+  6834 00 00       CGreen	DEFW	#0000	;Первый	файл на	странице
0638+  6836             BarBlue
0639+  6836 22 01       	DEFW	#0122	;X позиция скролбара
0640+  6838 77 00       	DEFW	#0077	;Y позиция скролбара
0641+  683A 80 00       	DEFW	#0080	;Max длина скролбара
0642+  683C 00 00       	DEFW	#0000	;тек.длина скролбара
0643+  683E 00 00       	DEFW	#0000	;Адрес ячейки BarLeft
0644+  6840 00 00       	DEFW	#0000	;Адрес ячейки BarRight
0645+  6842 98 01       	DEFW	#0198	;Кол-во	файлов на странице
0646+  6844 F0 0F       	DEFW	#0FF0	;Общее кол-во файлов
0647+  6846 00 00       CBlue	DEFW	#0000	;Первый	файл на	странице
0648+  6848             TempPALETTE
0649+  6848 00          	DEFS	#40,0
0650+  6888             ;--------------------------------------------------------------
0651+  6888             ResSetupInv
0652+  6888 11 F0 4F    	LD	DE,#4FF0
0653+  688B 18 03       	JR	SetupInvert
0654+  688D             SetSetupInv
0655+  688D 11 4F F0    	LD	DE,#F04F
0656+  6890             SetupInvert
0657+  6890 21 55 00    	LD	HL,#0055
0658+  6893 3A 0A 68    	LD	A,(CurElement)
0659+  6896 B7          	OR	A
0660+  6897 28 09       	JR	Z,SetupI1
0661+  6899 47          	LD	B,A
0662+  689A D5          	PUSH	DE
0663+  689B 11 08 00    	LD	DE,#0008
0664+  689E 19          	ADD	HL,DE
0665+  689F 10 FD       	DJNZ	$-1
0666+  68A1 D1          	POP	DE
0667+  68A2 DD 21 46 08 SetupI1	LD	IX,#0846
0668+  68A6 4D          	LD	C,L
0669+  68A7 44          	LD	B,H
0670+  68A8 21 6A 00    	LD	HL,#006A
0671+  68AB CD A3 8D    	CALL	InvertRectan
0672+  68AE C9          	RET 
0673+  68AF             
0674+  68AF             InitElement
0675+  68AF 21 0C 68    	LD	HL,ElementColor
0676+  68B2 3A 0A 68    	LD	A,(CurElement)
0677+  68B5 85          	ADD	A,L
0678+  68B6 6F          	LD	L,A
0679+  68B7 30 01       	JR	NC,$+3
0680+  68B9 24          	INC	H
0681+  68BA 7E          	LD	A,(HL)
0682+  68BB 87          	ADD	A,A
0683+  68BC 87          	ADD	A,A
0684+  68BD 21 00 85    	LD	HL,PALETTE
0685+  68C0 85          	ADD	A,L
0686+  68C1 6F          	LD	L,A
0687+  68C2 30 01       	JR	NC,$+3
0688+  68C4 24          	INC	H
0689+  68C5 11 34 85    	LD	DE,TempColor
0690+  68C8 ED A0       	LDI 
0691+  68CA ED A0       	LDI 
0692+  68CC ED A0       	LDI 
0693+  68CE CD DB 68    	CALL	PrintRED
0694+  68D1 CD 10 69    	CALL	PrintGREEN
0695+  68D4 CD 45 69    	CALL	PrintBLUE
0696+  68D7 CD 7A 69    	CALL	PrnPALETTE
0697+  68DA C9          	RET 
0698+  68DB             PrintRED
0699+  68DB 11 00 80    	LD	DE,WorkBuffer
0700+  68DE 3A 36 85    	LD	A,(TempColor+2)
0701+  68E1 6F          	LD	L,A
0702+  68E2 26 00       	LD	H,#00
0703+  68E4 29          	ADD	HL,HL
0704+  68E5 29          	ADD	HL,HL
0705+  68E6 29          	ADD	HL,HL
0706+  68E7 29          	ADD	HL,HL
0707+  68E8 22 22 68    	LD	(CRed),HL
0708+  68EB CD 78 A3    	CALL	ConvNumTxt8
0709+  68EE 3E 04       	LD	A,#04
0710+  68F0 93          	SUB	E
0711+  68F1 47          	LD	B,A
0712+  68F2 3E 20       	LD	A,#20
0713+  68F4 12          	LD	(DE),A
0714+  68F5 1C          	INC	E
0715+  68F6 10 FC       	DJNZ	$-2
0716+  68F8 97          	SUB	A
0717+  68F9 12          InitEl1	LD	(DE),A
0718+  68FA 21 00 80    	LD	HL,WorkBuffer
0719+  68FD 11 B8 01    	LD	DE,#01B8
0720+  6900 01 58 00    	LD	BC,#0058
0721+  6903 3E 80       	LD	A,#80
0722+  6905 CD B3 8F    	CALL	PrnTxtLnIFF
0723+  6908 DD 21 12 68 	LD	IX,BarRed
0724+  690C CD 35 97    	CALL	PrnHScrBar
0725+  690F C9          	RET 
0726+  6910             PrintGREEN
0727+  6910 11 00 80    	LD	DE,WorkBuffer
0728+  6913 3A 35 85    	LD	A,(TempColor+1)
0729+  6916 6F          	LD	L,A
0730+  6917 26 00       	LD	H,#00
0731+  6919 29          	ADD	HL,HL
0732+  691A 29          	ADD	HL,HL
0733+  691B 29          	ADD	HL,HL
0734+  691C 29          	ADD	HL,HL
0735+  691D 22 34 68    	LD	(CGreen),HL
0736+  6920 CD 78 A3    	CALL	ConvNumTxt8
0737+  6923 3E 04       	LD	A,#04
0738+  6925 93          	SUB	E
0739+  6926 47          	LD	B,A
0740+  6927 3E 20       	LD	A,#20
0741+  6929 12          	LD	(DE),A
0742+  692A 1C          	INC	E
0743+  692B 10 FC       	DJNZ	$-2
0744+  692D 97          	SUB	A
0745+  692E 12          InitEl2	LD	(DE),A
0746+  692F 21 00 80    	LD	HL,WorkBuffer
0747+  6932 11 B8 01    	LD	DE,#01B8
0748+  6935 01 68 00    	LD	BC,#0068
0749+  6938 3E 80       	LD	A,#80
0750+  693A CD B3 8F    	CALL	PrnTxtLnIFF
0751+  693D DD 21 24 68 	LD	IX,BarGreen
0752+  6941 CD 35 97    	CALL	PrnHScrBar
0753+  6944 C9          	RET 
0754+  6945             PrintBLUE
0755+  6945 11 00 80    	LD	DE,WorkBuffer
0756+  6948 3A 34 85    	LD	A,(TempColor)
0757+  694B 6F          	LD	L,A
0758+  694C 26 00       	LD	H,#00
0759+  694E 29          	ADD	HL,HL
0760+  694F 29          	ADD	HL,HL
0761+  6950 29          	ADD	HL,HL
0762+  6951 29          	ADD	HL,HL
0763+  6952 22 46 68    	LD	(CBlue),HL
0764+  6955 CD 78 A3    	CALL	ConvNumTxt8
0765+  6958 3E 04       	LD	A,#04
0766+  695A 93          	SUB	E
0767+  695B 47          	LD	B,A
0768+  695C 3E 20       	LD	A,#20
0769+  695E 12          	LD	(DE),A
0770+  695F 1C          	INC	E
0771+  6960 10 FC       	DJNZ	$-2
0772+  6962 97          	SUB	A
0773+  6963 12          InitEl3	LD	(DE),A
0774+  6964 21 00 80    	LD	HL,WorkBuffer
0775+  6967 11 B8 01    	LD	DE,#01B8
0776+  696A 01 78 00    	LD	BC,#0078
0777+  696D 3E 80       	LD	A,#80
0778+  696F CD B3 8F    	CALL	PrnTxtLnIFF
0779+  6972 DD 21 36 68 	LD	IX,BarBlue
0780+  6976 CD 35 97    	CALL	PrnHScrBar
0781+  6979 C9          	RET 
0782+  697A             PrnPALETTE
0783+  697A 21 00 85    	LD	HL,PALETTE
0784+  697D 11 00 10    	LD	DE,#1000
0785+  6980 01 A4 FF    	LD	BC,#FFA4
0786+  6983 97          	SUB	A
0787+  6984 CF          	RST	#08
0788+  6985 CD F0 86    	CALL	MakeWindow
0789+  6988 80          	DEFB	#80
0790+  6989 02          	DEFB	#02
0791+  698A D6 01 58 00 	DEFW	#01D6,#0058
0792+  698E 3C 00 26 00 	DEFW	#003C,#0026
0793+  6992 0D          	DEFB	#0D
0794+  6993 00          	DEFB	#00
0795+  6994 C9          	RET 
0796+  6995             
0797+  6995             
0798+  6995             
0290   6995             	include "fnerror.z80"
0001+  6995             
0002+  6995             ;[]===========================================================[]
0003+  6995             DOSErrorR
0004+  6995 21 A9 69    	LD	HL,ErrorWins
0005+  6998 87          	ADD	A,A
0006+  6999 85          	ADD	A,L
0007+  699A 6F          	LD	L,A
0008+  699B 30 01       	JR	NC,$+3
0009+  699D 24          	INC	H
0010+  699E 7E          	LD	A,(HL)
0011+  699F 23          	INC	HL
0012+  69A0 66          	LD	H,(HL)
0013+  69A1 6F          	LD	L,A
0014+  69A2 7C          	LD	A,H
0015+  69A3 B5          	OR	L
0016+  69A4 C8          	RET	Z
0017+  69A5 CD 3C A1    	CALL	SetMouse
0018+  69A8 E9          	JP	(HL)
0019+  69A9             ErrorWins
0020+  69A9 00 00       	DEFW	#0000		;00
0021+  69AB 00 00       	DEFW	#0000		;01
0022+  69AD E9 69       	DEFW	InvDrive	;02
0023+  69AF 04 6C       	DEFW	FileNFound	;03
0024+  69B1 70 6B       	DEFW	InvPath		;04
0025+  69B3 00 00       	DEFW	#0000		;05
0026+  69B5 04 6C       	DEFW	FileNFound	;06
0027+  69B7 3E 6D       	DEFW	FILEexists	;07
0028+  69B9 00 00       	DEFW	#0000		;08
0029+  69BB 51 6C       	DEFW	ROOToverflow	;09
0030+  69BD 9D 6C       	DEFW	NoDiskSpace	;0A
0031+  69BF E9 6C       	DEFW	DIRnotEmpty	;0B
0032+  69C1 00 00       	DEFW	#0000		;0C
0033+  69C3 50 6A       	DEFW	InvMedia	;0D
0034+  69C5 00 00       	DEFW	#0000		;0E
0035+  69C7 88 6D       	DEFW	DIRexists	;0F
0036+  69C9 D7 6D       	DEFW	InvName		;10
0037+  69CB 22 6E       	DEFW	InvEXEfile	;11
0038+  69CD 71 6E       	DEFW	InvEXEver	;12
0039+  69CF 00 00       	DEFW	#0000		;13
0040+  69D1 AF 6A       	DEFW	NotReady	;14
0041+  69D3 00 00       	DEFW	#0000		;15
0042+  69D5 00 00       	DEFW	#0000		;16
0043+  69D7 00 00       	DEFW	#0000		;17
0044+  69D9 00 00       	DEFW	#0000		;18
0045+  69DB 00 00       	DEFW	#0000		;19
0046+  69DD 00 00       	DEFW	#0000		;1A
0047+  69DF 00 00       	DEFW	#0000		;1B
0048+  69E1 00 00       	DEFW	#0000		;1C
0049+  69E3 00 00       	DEFW	#0000		;1D
0050+  69E5 C5 6E       	DEFW	NoMemory	;1E
0051+  69E7 00 00       	DEFW	#0000		;1F
0052+  69E9             ;--------------------------------------------------------------
0053+  69E9             InvDrive
0054+  69E9 CD F0 86    	CALL	MakeWindow
0055+  69EC 01          	DEFB	#01
0056+  69ED E0 00 58 00 	DEFW	#00E0,#0058
0057+  69F1 C0 00 30 00 	DEFW	#00C0,#0030
0058+  69F5 02          	DEFB	#02	;Head place
0059+  69F6 04 00 02 00 	DEFW	#0004,#0002
0060+  69FA B8 00 0A 00 	DEFW	#00B8,#000A
0061+  69FE 01          	DEFB	#01
0062+  69FF 01          	DEFB	#01	;Text Line
0063+  6A00 56 00 03 00 	DEFW	#0056,#0003
0064+  6A04 1F          	DEFB	#1F
0065+  6A05             	DEFB	"Error",0
0065+  6A05 4572726F7200
0066+  6A0B 01          	DEFB	#01	;Text Line
0067+  6A0C 18 00 12 00 	DEFW	#0018,#0012
0068+  6A10 80          	DEFB	#80
0069+  6A11             	DEFB	"Invalid drive letter:",0
0069+  6A11 496E76616C6964206472697665206C65747465723A00
0070+  6A27 04          	DEFB	#04	;UpRectan
0071+  6A28 3C 00 1E 00 	DEFW	#003C,#001E
0072+  6A2C 48 00 0E 00 	DEFW	#0048,#000E
0073+  6A30 01          	DEFB	#01	;Text Line
0074+  6A31 58 00 21 00 	DEFW	#0058,#0021
0075+  6A35 80          	DEFB	#80
0076+  6A36 4F 6B 00    	DEFB	"Ok",0
0077+  6A39 03          	DEFB	#03	;Углубление
0078+  6A3A 78 00 0F 00 	DEFW	#0078,#000F
0079+  6A3E 10 00 0C 00 	DEFW	#0010,#000C
0080+  6A42 02          	DEFB	#02	;Head place
0081+  6A43 7A 00 10 00 	DEFW	#007A,#0010
0082+  6A47 0C 00 0A 00 	DEFW	#000C,#000A
0083+  6A4B 0F          	DEFB	#0F
0084+  6A4C 00          	DEFB	#00
0085+  6A4D C3 0E 6B    	JP	InputDrive
0086+  6A50             InvMedia
0087+  6A50 CD F0 86    	CALL	MakeWindow
0088+  6A53 01          	DEFB	#01
0089+  6A54 E0 00 58 00 	DEFW	#00E0,#0058
0090+  6A58 C0 00 30 00 	DEFW	#00C0,#0030
0091+  6A5C 02          	DEFB	#02	;Head place
0092+  6A5D 04 00 02 00 	DEFW	#0004,#0002
0093+  6A61 B8 00 0A 00 	DEFW	#00B8,#000A
0094+  6A65 01          	DEFB	#01
0095+  6A66 01          	DEFB	#01	;Text Line
0096+  6A67 56 00 03 00 	DEFW	#0056,#0003
0097+  6A6B 1F          	DEFB	#1F
0098+  6A6C             	DEFB	"Error",0
0098+  6A6C 4572726F7200
0099+  6A72 01          	DEFB	#01	;Text Line
0100+  6A73 2E 00 12 00 	DEFW	#002E,#0012
0101+  6A77 80          	DEFB	#80
0102+  6A78             	DEFB	"Invalid media:",0
0102+  6A78 496E76616C6964206D656469613A00
0103+  6A87 04          	DEFB	#04	;UpRectan
0104+  6A88 3C 00 1E 00 	DEFW	#003C,#001E
0105+  6A8C 48 00 0E 00 	DEFW	#0048,#000E
0106+  6A90 01          	DEFB	#01	;Text Line
0107+  6A91 58 00 21 00 	DEFW	#0058,#0021
0108+  6A95 80          	DEFB	#80
0109+  6A96 4F 6B 00    	DEFB	"Ok",0
0110+  6A99 03          	DEFB	#03	;Углубление
0111+  6A9A 78 00 0F 00 	DEFW	#0078,#000F
0112+  6A9E 10 00 0C 00 	DEFW	#0010,#000C
0113+  6AA2 02          	DEFB	#02	;Head place
0114+  6AA3 7A 00 10 00 	DEFW	#007A,#0010
0115+  6AA7 0C 00 0A 00 	DEFW	#000C,#000A
0116+  6AAB 0F          	DEFB	#0F
0117+  6AAC 00          	DEFB	#00
0118+  6AAD 18 5F       	JR	InputDrive
0119+  6AAF             NotReady
0120+  6AAF CD F0 86    	CALL	MakeWindow
0121+  6AB2 01          	DEFB	#01
0122+  6AB3 E0 00 58 00 	DEFW	#00E0,#0058
0123+  6AB7 C0 00 30 00 	DEFW	#00C0,#0030
0124+  6ABB 02          	DEFB	#02	;Head place
0125+  6ABC 04 00 02 00 	DEFW	#0004,#0002
0126+  6AC0 B8 00 0A 00 	DEFW	#00B8,#000A
0127+  6AC4 01          	DEFB	#01
0128+  6AC5 01          	DEFB	#01	;Text Line
0129+  6AC6 56 00 03 00 	DEFW	#0056,#0003
0130+  6ACA 1F          	DEFB	#1F
0131+  6ACB             	DEFB	"Error",0
0131+  6ACB 4572726F7200
0132+  6AD1 01          	DEFB	#01	;Text Line
0133+  6AD2 24 00 12 00 	DEFW	#0024,#0012
0134+  6AD6 80          	DEFB	#80
0135+  6AD7             	DEFB	"Drive not ready:",0
0135+  6AD7 4472697665206E6F742072656164793A00
0136+  6AE8 04          	DEFB	#04	;UpRectan
0137+  6AE9 3C 00 1E 00 	DEFW	#003C,#001E
0138+  6AED 48 00 0E 00 	DEFW	#0048,#000E
0139+  6AF1 01          	DEFB	#01	;Text Line
0140+  6AF2 58 00 21 00 	DEFW	#0058,#0021
0141+  6AF6 80          	DEFB	#80
0142+  6AF7 4F 6B 00    	DEFB	"Ok",0
0143+  6AFA 03          	DEFB	#03	;Углубление
0144+  6AFB 78 00 0F 00 	DEFW	#0078,#000F
0145+  6AFF 10 00 0C 00 	DEFW	#0010,#000C
0146+  6B03 02          	DEFB	#02	;Head place
0147+  6B04 7A 00 10 00 	DEFW	#007A,#0010
0148+  6B08 0C 00 0A 00 	DEFW	#000C,#000A
0149+  6B0C 0F          	DEFB	#0F
0150+  6B0D 00          	DEFB	#00
0151+  6B0E             InputDrive
0152+  6B0E 0E 02       	LD	C,#02
0153+  6B10 FD E5       	PUSH	IY
0154+  6B12 D7          	RST	#10
0155+  6B13 FD E1       	POP	IY
0156+  6B15 C6 41       	ADD	A,"A"
0157+  6B17 32 6E 6B    	LD	(CurDrv),A
0158+  6B1A DD 21 62 6B 	LD	IX,DriveStr
0159+  6B1E 21 50 6B    	LD	HL,ErrorTab1
0160+  6B21 CD 68 91    	CALL	InputLine
0161+  6B24 CD F0 86    	CALL	MakeWindow
0162+  6B27 7F          	DEFB	#7F
0163+  6B28 00          	DEFB	#00
0164+  6B29 CD 9C A0    	CALL	SetClock
0165+  6B2C 3A 6E 6B    	LD	A,(CurDrv)
0166+  6B2F CB AF       	RES	5,A
0167+  6B31 D6 41       	SUB	"A"
0168+  6B33 0E 01       	LD	C,#01
0169+  6B35 FD E5       	PUSH	IY
0170+  6B37 D7          	RST	#10
0171+  6B38 FD E1       	POP	IY
0172+  6B3A DA 95 69    	JP	C,DOSErrorR
0173+  6B3D 21 21 AF    	LD	HL,BegDIR
0174+  6B40 0E 1D       	LD	C,#1D
0175+  6B42 FD E5       	PUSH	IY
0176+  6B44 D7          	RST	#10
0177+  6B45 FD E1       	POP	IY
0178+  6B47 DA 95 69    	JP	C,DOSErrorR
0179+  6B4A CD 3C A1    	CALL	SetMouse
0180+  6B4D 3E 01       	LD	A,#01
0181+  6B4F C9          	RET 
0182+  6B50             ErrorTab1
0183+  6B50             	DEFW #011C,#0164,#0076,#0084,#01,#0000,InpLnExtN,#0000
0183+  6B50 1C01640176008400010000000E920000
0184+  6B60 00 80       	DEFW #8000
0185+  6B62             DriveStr
0186+  6B62 01 00 00 00 	DEFB	#01,#00,#00,#00
0187+  6B66 01          	DEFB	#01
0188+  6B67 5C 01 6A 00 	DEFW	#015C,#006A
0189+  6B6B 0A 00       	DEFW	#000A
0190+  6B6D F0          	DEFB	#F0
0191+  6B6E 00          CurDrv	DEFS	#02,#00
0192+  6B70             ;--------------------------------------------------------------
0193+  6B70             InvPath
0194+  6B70 CD F0 86    	CALL	MakeWindow
0195+  6B73 01          	DEFB	#01
0196+  6B74 E0 00 58 00 	DEFW	#00E0,#0058
0197+  6B78 C0 00 30 00 	DEFW	#00C0,#0030
0198+  6B7C 02          	DEFB	#02	;Head place
0199+  6B7D 04 00 02 00 	DEFW	#0004,#0002
0200+  6B81 B8 00 0A 00 	DEFW	#00B8,#000A
0201+  6B85 01          	DEFB	#01
0202+  6B86 01          	DEFB	#01	;Text Line
0203+  6B87 56 00 03 00 	DEFW	#0056,#0003
0204+  6B8B 1F          	DEFB	#1F
0205+  6B8C             	DEFB	"Error",0
0205+  6B8C 4572726F7200
0206+  6B92 01          	DEFB	#01	;Text Line
0207+  6B93 46 00 12 00 	DEFW	#0046,#0012
0208+  6B97 80          	DEFB	#80
0209+  6B98             	DEFB	"Invalid path",0
0209+  6B98 496E76616C6964207061746800
0210+  6BA5 04          	DEFB	#04	;UpRectan
0211+  6BA6 3C 00 1E 00 	DEFW	#003C,#001E
0212+  6BAA 48 00 0E 00 	DEFW	#0048,#000E
0213+  6BAE 01          	DEFB	#01	;Text Line
0214+  6BAF 58 00 21 00 	DEFW	#0058,#0021
0215+  6BB3 80          	DEFB	#80
0216+  6BB4 4F 6B 00    	DEFB	"Ok",0
0217+  6BB7 00          	DEFB	#00
0218+  6BB8             ErrorLp0
0219+  6BB8 DD 21 F2 6B 	LD	IX,ErrorTab2
0220+  6BBC CD 1C 9B    	CALL	TestCoords
0221+  6BBF 0E 31       	LD	C,#31
0222+  6BC1 D7          	RST	#10
0223+  6BC2 28 F4       	JR	Z,ErrorLp0
0224+  6BC4 78          	LD	A,B
0225+  6BC5 B7          	OR	A
0226+  6BC6 20 F0       	JR	NZ,ErrorLp0
0227+  6BC8 7B          	LD	A,E
0228+  6BC9 FE 1B       	CP	#1B
0229+  6BCB 28 0A       	JR	Z,ErrorExt0
0230+  6BCD FE 0D       	CP	#0D
0231+  6BCF 28 06       	JR	Z,ErrorExt0
0232+  6BD1 CB AF       	RES	5,A
0233+  6BD3 FE 4F       	CP	"O"
0234+  6BD5 20 E1       	JR	NZ,ErrorLp0
0235+  6BD7             ErrorExt0
0236+  6BD7 CD F0 86    	CALL	MakeWindow
0237+  6BDA 7F          	DEFB	#7F
0238+  6BDB 00          	DEFB	#00
0239+  6BDC CD 9C A0    	CALL	SetClock
0240+  6BDF 21 21 AF    	LD	HL,BegDIR
0241+  6BE2 0E 1D       	LD	C,#1D
0242+  6BE4 FD E5       	PUSH	IY
0243+  6BE6 D7          	RST	#10
0244+  6BE7 FD E1       	POP	IY
0245+  6BE9 DA 95 69    	JP	C,DOSErrorR
0246+  6BEC CD 3C A1    	CALL	SetMouse
0247+  6BEF 3E 01       	LD	A,#01
0248+  6BF1 C9          	RET 
0249+  6BF2             ErrorTab2
0250+  6BF2             	DEFW #011C,#0164,#0076,#0084,#21,#0000,ErrorExt0,#0000
0250+  6BF2 1C0164017600840021000000D76B0000
0251+  6C02 00 80       	DEFW #8000
0252+  6C04             ;--------------------------------------------------------------
0253+  6C04             FileNFound
0254+  6C04 CD F0 86    	CALL	MakeWindow
0255+  6C07 01          	DEFB	#01
0256+  6C08 E0 00 58 00 	DEFW	#00E0,#0058
0257+  6C0C C0 00 30 00 	DEFW	#00C0,#0030
0258+  6C10 02          	DEFB	#02	;Head place
0259+  6C11 04 00 02 00 	DEFW	#0004,#0002
0260+  6C15 B8 00 0A 00 	DEFW	#00B8,#000A
0261+  6C19 01          	DEFB	#01
0262+  6C1A 01          	DEFB	#01	;Text Line
0263+  6C1B 56 00 03 00 	DEFW	#0056,#0003
0264+  6C1F 1F          	DEFB	#1F
0265+  6C20             	DEFB	"Error",0
0265+  6C20 4572726F7200
0266+  6C26 01          	DEFB	#01	;Text Line
0267+  6C27 3C 00 12 00 	DEFW	#003C,#0012
0268+  6C2B 80          	DEFB	#80
0269+  6C2C             	DEFB	"File not found",0
0269+  6C2C 46696C65206E6F7420666F756E6400
0270+  6C3B 04          	DEFB	#04	;UpRectan
0271+  6C3C 3C 00 1E 00 	DEFW	#003C,#001E
0272+  6C40 48 00 0E 00 	DEFW	#0048,#000E
0273+  6C44 01          	DEFB	#01	;Text Line
0274+  6C45 58 00 21 00 	DEFW	#0058,#0021
0275+  6C49 80          	DEFB	#80
0276+  6C4A 4F 6B 00    	DEFB	"Ok",0
0277+  6C4D 00          	DEFB	#00
0278+  6C4E C3 10 6F    	JP	ErrorLp
0279+  6C51             ROOToverflow
0280+  6C51 CD F0 86    	CALL	MakeWindow
0281+  6C54 01          	DEFB	#01
0282+  6C55 E0 00 58 00 	DEFW	#00E0,#0058
0283+  6C59 C0 00 30 00 	DEFW	#00C0,#0030
0284+  6C5D 02          	DEFB	#02	;Head place
0285+  6C5E 04 00 02 00 	DEFW	#0004,#0002
0286+  6C62 B8 00 0A 00 	DEFW	#00B8,#000A
0287+  6C66 01          	DEFB	#01
0288+  6C67 01          	DEFB	#01	;Text Line
0289+  6C68 56 00 03 00 	DEFW	#0056,#0003
0290+  6C6C 1F          	DEFB	#1F
0291+  6C6D             	DEFB	"Error",0
0291+  6C6D 4572726F7200
0292+  6C73 01          	DEFB	#01	;Text Line
0293+  6C74 40 00 12 00 	DEFW	#0040,#0012
0294+  6C78 80          	DEFB	#80
0295+  6C79             	DEFB	"ROOT overflow",0
0295+  6C79 524F4F54206F766572666C6F7700
0296+  6C87 04          	DEFB	#04	;UpRectan
0297+  6C88 3C 00 1E 00 	DEFW	#003C,#001E
0298+  6C8C 48 00 0E 00 	DEFW	#0048,#000E
0299+  6C90 01          	DEFB	#01	;Text Line
0300+  6C91 58 00 21 00 	DEFW	#0058,#0021
0301+  6C95 80          	DEFB	#80
0302+  6C96 4F 6B 00    	DEFB	"Ok",0
0303+  6C99 00          	DEFB	#00
0304+  6C9A C3 10 6F    	JP	ErrorLp
0305+  6C9D             NoDiskSpace
0306+  6C9D CD F0 86    	CALL	MakeWindow
0307+  6CA0 01          	DEFB	#01
0308+  6CA1 E0 00 58 00 	DEFW	#00E0,#0058
0309+  6CA5 C0 00 30 00 	DEFW	#00C0,#0030
0310+  6CA9 02          	DEFB	#02	;Head place
0311+  6CAA 04 00 02 00 	DEFW	#0004,#0002
0312+  6CAE B8 00 0A 00 	DEFW	#00B8,#000A
0313+  6CB2 01          	DEFB	#01
0314+  6CB3 01          	DEFB	#01	;Text Line
0315+  6CB4 56 00 03 00 	DEFW	#0056,#0003
0316+  6CB8 1F          	DEFB	#1F
0317+  6CB9             	DEFB	"Error",0
0317+  6CB9 4572726F7200
0318+  6CBF 01          	DEFB	#01	;Text Line
0319+  6CC0 3E 00 12 00 	DEFW	#003E,#0012
0320+  6CC4 80          	DEFB	#80
0321+  6CC5             	DEFB	"No disk space",0
0321+  6CC5 4E6F206469736B20737061636500
0322+  6CD3 04          	DEFB	#04	;UpRectan
0323+  6CD4 3C 00 1E 00 	DEFW	#003C,#001E
0324+  6CD8 48 00 0E 00 	DEFW	#0048,#000E
0325+  6CDC 01          	DEFB	#01	;Text Line
0326+  6CDD 58 00 21 00 	DEFW	#0058,#0021
0327+  6CE1 80          	DEFB	#80
0328+  6CE2 4F 6B 00    	DEFB	"Ok",0
0329+  6CE5 00          	DEFB	#00
0330+  6CE6 C3 10 6F    	JP	ErrorLp
0331+  6CE9             DIRnotEmpty
0332+  6CE9 CD F0 86    	CALL	MakeWindow
0333+  6CEC 01          	DEFB	#01
0334+  6CED E0 00 58 00 	DEFW	#00E0,#0058
0335+  6CF1 C0 00 30 00 	DEFW	#00C0,#0030
0336+  6CF5 02          	DEFB	#02	;Head place
0337+  6CF6 04 00 02 00 	DEFW	#0004,#0002
0338+  6CFA B8 00 0A 00 	DEFW	#00B8,#000A
0339+  6CFE 01          	DEFB	#01
0340+  6CFF 01          	DEFB	#01	;Text Line
0341+  6D00 56 00 03 00 	DEFW	#0056,#0003
0342+  6D04 1F          	DEFB	#1F
0343+  6D05             	DEFB	"Error",0
0343+  6D05 4572726F7200
0344+  6D0B 01          	DEFB	#01	;Text Line
0345+  6D0C 28 00 12 00 	DEFW	#0028,#0012
0346+  6D10 80          	DEFB	#80
0347+  6D11             	DEFB	"Directory is not empty",0
0347+  6D11 4469726563746F7279206973206E6F7420656D70747900
0348+  6D28 04          	DEFB	#04	;UpRectan
0349+  6D29 3C 00 1E 00 	DEFW	#003C,#001E
0350+  6D2D 48 00 0E 00 	DEFW	#0048,#000E
0351+  6D31 01          	DEFB	#01	;Text Line
0352+  6D32 58 00 21 00 	DEFW	#0058,#0021
0353+  6D36 80          	DEFB	#80
0354+  6D37 4F 6B 00    	DEFB	"Ok",0
0355+  6D3A 00          	DEFB	#00
0356+  6D3B C3 10 6F    	JP	ErrorLp
0357+  6D3E             FILEexists
0358+  6D3E CD F0 86    	CALL	MakeWindow
0359+  6D41 01          	DEFB	#01
0360+  6D42 E0 00 58 00 	DEFW	#00E0,#0058
0361+  6D46 C0 00 30 00 	DEFW	#00C0,#0030
0362+  6D4A 02          	DEFB	#02	;Head place
0363+  6D4B 04 00 02 00 	DEFW	#0004,#0002
0364+  6D4F B8 00 0A 00 	DEFW	#00B8,#000A
0365+  6D53 01          	DEFB	#01
0366+  6D54 01          	DEFB	#01	;Text Line
0367+  6D55 56 00 03 00 	DEFW	#0056,#0003
0368+  6D59 1F          	DEFB	#1F
0369+  6D5A             	DEFB	"Error",0
0369+  6D5A 4572726F7200
0370+  6D60 01          	DEFB	#01	;Text Line
0371+  6D61 48 00 12 00 	DEFW	#0048,#0012
0372+  6D65 80          	DEFB	#80
0373+  6D66             	DEFB	"File exists",0
0373+  6D66 46696C652065786973747300
0374+  6D72 04          	DEFB	#04	;UpRectan
0375+  6D73 3C 00 1E 00 	DEFW	#003C,#001E
0376+  6D77 48 00 0E 00 	DEFW	#0048,#000E
0377+  6D7B 01          	DEFB	#01	;Text Line
0378+  6D7C 58 00 21 00 	DEFW	#0058,#0021
0379+  6D80 80          	DEFB	#80
0380+  6D81 4F 6B 00    	DEFB	"Ok",0
0381+  6D84 00          	DEFB	#00
0382+  6D85 C3 10 6F    	JP	ErrorLp
0383+  6D88             DIRexists
0384+  6D88 CD F0 86    	CALL	MakeWindow
0385+  6D8B 01          	DEFB	#01
0386+  6D8C E0 00 58 00 	DEFW	#00E0,#0058
0387+  6D90 C0 00 30 00 	DEFW	#00C0,#0030
0388+  6D94 02          	DEFB	#02	;Head place
0389+  6D95 04 00 02 00 	DEFW	#0004,#0002
0390+  6D99 B8 00 0A 00 	DEFW	#00B8,#000A
0391+  6D9D 01          	DEFB	#01
0392+  6D9E 01          	DEFB	#01	;Text Line
0393+  6D9F 56 00 03 00 	DEFW	#0056,#0003
0394+  6DA3 1F          	DEFB	#1F
0395+  6DA4             	DEFB	"Error",0
0395+  6DA4 4572726F7200
0396+  6DAA 01          	DEFB	#01	;Text Line
0397+  6DAB 38 00 12 00 	DEFW	#0038,#0012
0398+  6DAF 80          	DEFB	#80
0399+  6DB0             	DEFB	"Directory exists",0
0399+  6DB0 4469726563746F72792065786973747300
0400+  6DC1 04          	DEFB	#04	;UpRectan
0401+  6DC2 3C 00 1E 00 	DEFW	#003C,#001E
0402+  6DC6 48 00 0E 00 	DEFW	#0048,#000E
0403+  6DCA 01          	DEFB	#01	;Text Line
0404+  6DCB 58 00 21 00 	DEFW	#0058,#0021
0405+  6DCF 80          	DEFB	#80
0406+  6DD0 4F 6B 00    	DEFB	"Ok",0
0407+  6DD3 00          	DEFB	#00
0408+  6DD4 C3 10 6F    	JP	ErrorLp
0409+  6DD7             InvName
0410+  6DD7 CD F0 86    	CALL	MakeWindow
0411+  6DDA 01          	DEFB	#01
0412+  6DDB E0 00 58 00 	DEFW	#00E0,#0058
0413+  6DDF C0 00 30 00 	DEFW	#00C0,#0030
0414+  6DE3 02          	DEFB	#02	;Head place
0415+  6DE4 04 00 02 00 	DEFW	#0004,#0002
0416+  6DE8 B8 00 0A 00 	DEFW	#00B8,#000A
0417+  6DEC 01          	DEFB	#01
0418+  6DED 01          	DEFB	#01	;Text Line
0419+  6DEE 56 00 03 00 	DEFW	#0056,#0003
0420+  6DF2 1F          	DEFB	#1F
0421+  6DF3             	DEFB	"Error",0
0421+  6DF3 4572726F7200
0422+  6DF9 01          	DEFB	#01	;Text Line
0423+  6DFA 42 00 12 00 	DEFW	#0042,#0012
0424+  6DFE 80          	DEFB	#80
0425+  6DFF             	DEFB	"Invalid name",0
0425+  6DFF 496E76616C6964206E616D6500
0426+  6E0C 04          	DEFB	#04	;UpRectan
0427+  6E0D 3C 00 1E 00 	DEFW	#003C,#001E
0428+  6E11 48 00 0E 00 	DEFW	#0048,#000E
0429+  6E15 01          	DEFB	#01	;Text Line
0430+  6E16 58 00 21 00 	DEFW	#0058,#0021
0431+  6E1A 80          	DEFB	#80
0432+  6E1B 4F 6B 00    	DEFB	"Ok",0
0433+  6E1E 00          	DEFB	#00
0434+  6E1F C3 10 6F    	JP	ErrorLp
0435+  6E22             InvEXEfile
0436+  6E22 CD F0 86    	CALL	MakeWindow
0437+  6E25 01          	DEFB	#01
0438+  6E26 E0 00 58 00 	DEFW	#00E0,#0058
0439+  6E2A C0 00 30 00 	DEFW	#00C0,#0030
0440+  6E2E 02          	DEFB	#02	;Head place
0441+  6E2F 04 00 02 00 	DEFW	#0004,#0002
0442+  6E33 B8 00 0A 00 	DEFW	#00B8,#000A
0443+  6E37 01          	DEFB	#01
0444+  6E38 01          	DEFB	#01	;Text Line
0445+  6E39 56 00 03 00 	DEFW	#0056,#0003
0446+  6E3D 1F          	DEFB	#1F
0447+  6E3E             	DEFB	"Error",0
0447+  6E3E 4572726F7200
0448+  6E44 01          	DEFB	#01	;Text Line
0449+  6E45 3C 00 12 00 	DEFW	#003C,#0012
0450+  6E49 80          	DEFB	#80
0451+  6E4A             	DEFB	"Invalid EXE file",0
0451+  6E4A 496E76616C6964204558452066696C6500
0452+  6E5B 04          	DEFB	#04	;UpRectan
0453+  6E5C 3C 00 1E 00 	DEFW	#003C,#001E
0454+  6E60 48 00 0E 00 	DEFW	#0048,#000E
0455+  6E64 01          	DEFB	#01	;Text Line
0456+  6E65 58 00 21 00 	DEFW	#0058,#0021
0457+  6E69 80          	DEFB	#80
0458+  6E6A 4F 6B 00    	DEFB	"Ok",0
0459+  6E6D 00          	DEFB	#00
0460+  6E6E C3 10 6F    	JP	ErrorLp
0461+  6E71             InvEXEver
0462+  6E71 CD F0 86    	CALL	MakeWindow
0463+  6E74 01          	DEFB	#01
0464+  6E75 E0 00 58 00 	DEFW	#00E0,#0058
0465+  6E79 C0 00 30 00 	DEFW	#00C0,#0030
0466+  6E7D 02          	DEFB	#02	;Head place
0467+  6E7E 04 00 02 00 	DEFW	#0004,#0002
0468+  6E82 B8 00 0A 00 	DEFW	#00B8,#000A
0469+  6E86 01          	DEFB	#01
0470+  6E87 01          	DEFB	#01	;Text Line
0471+  6E88 56 00 03 00 	DEFW	#0056,#0003
0472+  6E8C 1F          	DEFB	#1F
0473+  6E8D             	DEFB	"Error",0
0473+  6E8D 4572726F7200
0474+  6E93 01          	DEFB	#01	;Text Line
0475+  6E94 28 00 12 00 	DEFW	#0028,#0012
0476+  6E98 80          	DEFB	#80
0477+  6E99             	DEFB	"Unsupport EXE version",0
0477+  6E99 556E737570706F7274204558452076657273696F6E00
0478+  6EAF 04          	DEFB	#04	;UpRectan
0479+  6EB0 3C 00 1E 00 	DEFW	#003C,#001E
0480+  6EB4 48 00 0E 00 	DEFW	#0048,#000E
0481+  6EB8 01          	DEFB	#01	;Text Line
0482+  6EB9 58 00 21 00 	DEFW	#0058,#0021
0483+  6EBD 80          	DEFB	#80
0484+  6EBE 4F 6B 00    	DEFB	"Ok",0
0485+  6EC1 00          	DEFB	#00
0486+  6EC2 C3 10 6F    	JP	ErrorLp
0487+  6EC5             NoMemory
0488+  6EC5 CD F0 86    	CALL	MakeWindow
0489+  6EC8 01          	DEFB	#01
0490+  6EC9 E0 00 58 00 	DEFW	#00E0,#0058
0491+  6ECD C0 00 30 00 	DEFW	#00C0,#0030
0492+  6ED1 02          	DEFB	#02	;Head place
0493+  6ED2 04 00 02 00 	DEFW	#0004,#0002
0494+  6ED6 B8 00 0A 00 	DEFW	#00B8,#000A
0495+  6EDA 01          	DEFB	#01
0496+  6EDB 01          	DEFB	#01	;Text Line
0497+  6EDC 56 00 03 00 	DEFW	#0056,#0003
0498+  6EE0 1F          	DEFB	#1F
0499+  6EE1             	DEFB	"Error",0
0499+  6EE1 4572726F7200
0500+  6EE7 01          	DEFB	#01	;Text Line
0501+  6EE8 34 00 12 00 	DEFW	#0034,#0012
0502+  6EEC 80          	DEFB	#80
0503+  6EED             	DEFB	"No memory space",0
0503+  6EED 4E6F206D656D6F727920737061636500
0504+  6EFD 04          	DEFB	#04	;UpRectan
0505+  6EFE 3C 00 1E 00 	DEFW	#003C,#001E
0506+  6F02 48 00 0E 00 	DEFW	#0048,#000E
0507+  6F06 01          	DEFB	#01	;Text Line
0508+  6F07 58 00 21 00 	DEFW	#0058,#0021
0509+  6F0B 80          	DEFB	#80
0510+  6F0C 4F 6B 00    	DEFB	"Ok",0
0511+  6F0F 00          	DEFB	#00
0512+  6F10             ErrorLp
0513+  6F10 DD 21 36 6F 	LD	IX,ErrorTab3
0514+  6F14 CD 1C 9B    	CALL	TestCoords
0515+  6F17 0E 31       	LD	C,#31
0516+  6F19 D7          	RST	#10
0517+  6F1A 28 F4       	JR	Z,ErrorLp
0518+  6F1C 78          	LD	A,B
0519+  6F1D B7          	OR	A
0520+  6F1E 20 F0       	JR	NZ,ErrorLp
0521+  6F20 7B          	LD	A,E
0522+  6F21 FE 1B       	CP	#1B
0523+  6F23 28 0A       	JR	Z,ErrorExt
0524+  6F25 FE 0D       	CP	#0D
0525+  6F27 28 06       	JR	Z,ErrorExt
0526+  6F29 CB AF       	RES	5,A
0527+  6F2B FE 4F       	CP	"O"
0528+  6F2D 20 E1       	JR	NZ,ErrorLp
0529+  6F2F             ErrorExt
0530+  6F2F CD F0 86    	CALL	MakeWindow
0531+  6F32 7F          	DEFB	#7F
0532+  6F33 00          	DEFB	#00
0533+  6F34 97          	SUB	A
0534+  6F35 C9          	RET 
0535+  6F36             ErrorTab3
0536+  6F36             	DEFW #011C,#0164,#0076,#0084,#21,#0000,ErrorExt,#0000
0536+  6F36 1C01640176008400210000002F6F0000
0537+  6F46 00 80       	DEFW #8000
0538+  6F48             
0539+  6F48             
0540+  6F48             
0291   6F48             	include "fntab1.z80"
0001+  6F48             
0002+  6F48             ;[]==========================================================[]
0003+  6F48             ;Формат	таблицы
0004+  6F48             ;	+00  2	Xmin
0005+  6F48             ;	+02  2	Xmax
0006+  6F48             ;	+04  2	Ymin
0007+  6F48             ;	+06  2	Ymax
0008+  6F48             ;	+08  2	0 - простой об'ект
0009+  6F48             ;		бит 0 -	кнопка
0010+  6F48             ;		бит 1 -	рабочая	кнопка
0011+  6F48             ;		бит 2 -	инверт 1
0012+  6F48             ;		бит 3 -	статичный инверт
0013+  6F48             ;		бит 4 -	программа запускается без адреса возвр.
0014+  6F48             ;			и без огня
0015+  6F48             ;		бит 5 -	программа запускается без адреса возвр.
0016+  6F48             ;			по левой кнопке	огня
0017+  6F48             ;		бит 6 -	программа запускается без адреса возвр.
0018+  6F48             ;			по правой кнопке огня
0019+  6F48             ;		бит 7 -	вызвать	функцию	закрытия окна перед
0020+  6F48             ;			запуском программы без огня
0021+  6F48             ;		бит 8 -	вызвать	функцию	закрытия окна перед
0022+  6F48             ;			запуском программы по левой кнопке
0023+  6F48             ;		бит 9 -	вызвать	функцию	закрытия окна перед
0024+  6F48             ;			запуском программы по правой кнопке
0025+  6F48             ;		бит15 -	это переключатель (инверт при огне не
0026+  6F48             ;			убирать)
0027+  6F48             ;	+0A  2	Адрес обработчика при не нажатом огне
0028+  6F48             ;	+0C  2	Адрес обработчика при нажатом огне (лев)
0029+  6F48             ;	+0E  2	Адрес обработчика при нажатом огне (прав)
0030+  6F48             
0031+  6F48             ;[]==========================================================[]
0032+  6F48             SetupTab
0033+  6F48                  DEFW #006A,#00F6,#0055,#0085,#0000,#0000,NewElement,#0000
0033+  6F48 6A00F600550085000000000002670000
0034+  6F58             
0035+  6F58                  DEFW #0072,#0082,#0092,#009B,#0000,#0000,ChSavePan,#0000
0035+  6F58 7200820092009B000000000020670000
0036+  6F68             
0037+  6F68                  DEFW #0112,#0122,#0057,#005F,#0003,#0000,DecRED,#0000
0037+  6F68 1201220157005F000300000042670000
0038+  6F78                  DEFW #01A2,#01B2,#0057,#005F,#0003,#0000,IncRED,#0000
0038+  6F78 A201B20157005F00030000004A670000
0039+  6F88                  DEFW #01B8,#01D0,#0057,#005F,#0000,#0000,InputRED,#0000
0039+  6F88 B801D00157005F0000000000A2670000
0040+  6F98                  DEFW #0112,#0122,#0067,#006F,#0003,#0000,DecGREEN,#0000
0040+  6F98 1201220167006F000300000052670000
0041+  6FA8                  DEFW #01A2,#01B2,#0067,#006F,#0003,#0000,IncGREEN,#0000
0041+  6FA8 A201B20167006F00030000005A670000
0042+  6FB8                  DEFW #01B8,#01D0,#0067,#006F,#0000,#0000,InputGREEN,#0000
0042+  6FB8 B801D00167006F0000000000AD670000
0043+  6FC8                  DEFW #0112,#0122,#0077,#007F,#0003,#0000,DecBLUE,#0000
0043+  6FC8 1201220177007F000300000062670000
0044+  6FD8                  DEFW #01A2,#01B2,#0077,#007F,#0003,#0000,IncBLUE,#0000
0044+  6FD8 A201B20177007F00030000006A670000
0045+  6FE8                  DEFW #01B8,#01D0,#0077,#007F,#0000,#0000,InputBLUE,#0000
0045+  6FE8 B801D00177007F0000000000B8670000
0046+  6FF8             
0047+  6FF8                  DEFW #01C8,#0210,#0090,#009E,#0001,#0000,SaveSetup,#0000
0047+  6FF8 C801100290009E00010000006E650000
0048+  7008                  DEFW #0170,#01B8,#00A6,#00B4,#0021,#0000,SetupCancel,#0000
0048+  7008 7001B801A600B4002100000035660000
0049+  7018                  DEFW #01C8,#0210,#00A6,#00B4,#0021,#0000,SetupOkey,#0000
0049+  7018 C8011002A600B4002100000041660000
0050+  7028             
0051+  7028                  DEFW #0000,#0060,#0000,#0100,#0020,#0000,SetupCancel,#0000
0051+  7028 00006000000000012000000035660000
0052+  7038                  DEFW #0220,#0280,#0000,#0100,#0020,#0000,SetupCancel,#0000
0052+  7038 20028002000000012000000035660000
0053+  7048                  DEFW #0000,#0280,#0000,#0040,#0020,#0000,SetupCancel,#0000
0053+  7048 00008002000040002000000035660000
0054+  7058                  DEFW #0000,#0280,#00B8,#0100,#0020,#0000,SetupCancel,#0000
0054+  7058 00008002B80000012000000035660000
0055+  7068 00 80            DEFW #8000
0056+  706A             ;[]==========================================================[]
0057+  706A             FileInfoTab
0058+  706A             	DEFW #011C,#0164,#00A0,#00AE,#21,#0000,FileInfoExt,#0000
0058+  706A 1C016401A000AE00210000003F580000
0059+  707A             	DEFW #0000,#00F0,#0000,#0100,#20,#0000,FileInfoExt,#0000
0059+  707A 0000F00000000001200000003F580000
0060+  708A             	DEFW #0190,#0280,#0000,#0100,#20,#0000,FileInfoExt,#0000
0060+  708A 9001800200000001200000003F580000
0061+  709A             	DEFW #0000,#0280,#0000,#0050,#20,#0000,FileInfoExt,#0000
0061+  709A 0000800200005000200000003F580000
0062+  70AA             	DEFW #0000,#0280,#00B2,#0100,#20,#0000,FileInfoExt,#0000
0062+  70AA 00008002B2000001200000003F580000
0063+  70BA 00 80       	DEFW #8000
0064+  70BC             
0065+  70BC             ;[]==========================================================[]
0066+  70BC             PrintFTab
0067+  70BC             	DEFW #011C,#0164,#0080,#008E,#01,#0000,StopPrint,#0000
0067+  70BC 1C01640180008E00010000006A5A0000
0068+  70CC 00 80       	DEFW #8000
0069+  70CE             ;[]==========================================================[]
0070+  70CE             SysInfoTab
0071+  70CE             	DEFW #011C,#0164,#00A0,#00AE,#21,#0000,SysInfoExt,#0000
0071+  70CE 1C016401A000AE0021000000AF5C0000
0072+  70DE             	DEFW #0000,#00E0,#0000,#0100,#20,#0000,SysInfoExt,#0000
0072+  70DE 0000E0000000000120000000AF5C0000
0073+  70EE             	DEFW #01A0,#0280,#0000,#0100,#20,#0000,SysInfoExt,#0000
0073+  70EE A00180020000000120000000AF5C0000
0074+  70FE             	DEFW #0000,#0280,#0000,#0040,#20,#0000,SysInfoExt,#0000
0074+  70FE 000080020000400020000000AF5C0000
0075+  710E             	DEFW #0000,#0280,#00B2,#0100,#20,#0000,SysInfoExt,#0000
0075+  710E 00008002B200000120000000AF5C0000
0076+  711E 00 80       	DEFW #8000
0077+  7120             
0078+  7120             ;[]==========================================================[]
0079+  7120             DiskInfoTab
0080+  7120             	DEFW #011C,#0164,#00A0,#00AE,#21,#0000,DiskInfoExt,#0000
0080+  7120 1C016401A000AE0021000000AF5E0000
0081+  7130             	DEFW #0000,#00C0,#0000,#0100,#20,#0000,DiskInfoExt,#0000
0081+  7130 0000C0000000000120000000AF5E0000
0082+  7140             	DEFW #01C0,#0280,#0000,#0100,#20,#0000,DiskInfoExt,#0000
0082+  7140 C00180020000000120000000AF5E0000
0083+  7150             	DEFW #0000,#0280,#0000,#0050,#20,#0000,DiskInfoExt,#0000
0083+  7150 000080020000500020000000AF5E0000
0084+  7160             	DEFW #0000,#0280,#00B2,#0100,#20,#0000,DiskInfoExt,#0000
0084+  7160 00008002B200000120000000AF5E0000
0085+  7170 00 80       	DEFW #8000
0086+  7172             ;[]==========================================================[]
0087+  7172             VersionTab
0088+  7172             	DEFW #011C,#0164,#009D,#00AB,#21,#0000,VersionExt,#0000
0088+  7172 1C0164019D00AB0021000000D95F0000
0089+  7182             	DEFW #0000,#00C0,#0000,#0100,#20,#0000,VersionExt,#0000
0089+  7182 0000C0000000000120000000D95F0000
0090+  7192             	DEFW #01C0,#0280,#0000,#0100,#20,#0000,VersionExt,#0000
0090+  7192 C00180020000000120000000D95F0000
0091+  71A2             	DEFW #0000,#0280,#0000,#0040,#20,#0000,VersionExt,#0000
0091+  71A2 000080020000400020000000D95F0000
0092+  71B2             	DEFW #0000,#0280,#00B0,#0100,#20,#0000,VersionExt,#0000
0092+  71B2 00008002B000000120000000D95F0000
0093+  71C2 00 80       	DEFW #8000
0094+  71C4             ;[]==========================================================[]
0095+  71C4             PathTab
0096+  71C4             	DEFW #00F0,#0138,#007B,#0089,#01,#0000,InpLnExtN,#0000
0096+  71C4 F00038017B008900010000000E920000
0097+  71D4             	DEFW #0148,#0190,#007B,#0089,#01,#0000,InpLnExtC,#0000
0097+  71D4 480190017B0089000100000018920000
0098+  71E4             	DEFW #0000,#0060,#0000,#0100,#00,#0000,InpLnExtC,#0000
0098+  71E4 00006000000000010000000018920000
0099+  71F4             	DEFW #0220,#0280,#0000,#0100,#00,#0000,InpLnExtC,#0000
0099+  71F4 20028002000000010000000018920000
0100+  7204             	DEFW #0000,#0280,#0000,#0051,#00,#0000,InpLnExtC,#0000
0100+  7204 00008002000051000000000018920000
0101+  7214             	DEFW #0000,#0280,#008F,#0100,#00,#0000,InpLnExtC,#0000
0101+  7214 000080028F0000010000000018920000
0102+  7224 00 80       	DEFW #8000
0103+  7226             ;[]==========================================================[]
0104+  7226             OverWrtTab
0105+  7226                  DEFW #00C4,#00FC,#007E,#008C,#0121,#0000,OverWrtFile,#0000
0105+  7226 C400FC007E008C002101000015460000
0106+  7236                  DEFW #0104,#013C,#007E,#008C,#0121,#0000,OverWrtAll,#0000
0106+  7236 04013C017E008C002101000010460000
0107+  7246                  DEFW #0144,#017C,#007E,#008C,#0121,#0000,OverSkip,#0000
0107+  7246 44017C017E008C00210100002F460000
0108+  7256                  DEFW #0184,#01BC,#007E,#008C,#0121,#0000,OverExit,#0000
0108+  7256 8401BC017E008C002101000072460000
0109+  7266                  DEFW #0000,#00B4,#0000,#0100,#0120,#0000,OverExit,#0000
0109+  7266 0000B400000000012001000072460000
0110+  7276                  DEFW #01CC,#0280,#0000,#0100,#0120,#0000,OverExit,#0000
0110+  7276 CC018002000000012001000072460000
0111+  7286                  DEFW #0000,#0280,#0000,#0058,#0120,#0000,OverExit,#0000
0111+  7286 00008002000058002001000072460000
0112+  7296                  DEFW #0000,#0280,#0090,#0100,#0120,#0000,OverExit,#0000
0112+  7296 00008002900000012001000072460000
0113+  72A6 01 80            DEFW #8001
0114+  72A8             
0115+  72A8             ;[]==========================================================[]
0116+  72A8             ReNameTab
0117+  72A8             	DEFW #00F0,#0138,#007B,#0089,#01,#0000,InpLnExtN,#0000
0117+  72A8 F00038017B008900010000000E920000
0118+  72B8             	DEFW #0148,#0190,#007B,#0089,#01,#0000,InpLnExtC,#0000
0118+  72B8 480190017B0089000100000018920000
0119+  72C8             	DEFW #0000,#00D0,#0000,#0100,#00,#0000,InpLnExtC,#0000
0119+  72C8 0000D000000000010000000018920000
0120+  72D8             	DEFW #01B0,#0280,#0000,#0100,#00,#0000,InpLnExtC,#0000
0120+  72D8 B0018002000000010000000018920000
0121+  72E8             	DEFW #0000,#0280,#0000,#0051,#00,#0000,InpLnExtC,#0000
0121+  72E8 00008002000051000000000018920000
0122+  72F8             	DEFW #0000,#0280,#008F,#0100,#00,#0000,InpLnExtC,#0000
0122+  72F8 000080028F0000010000000018920000
0123+  7308 00 80       	DEFW #8000
0124+  730A             
0125+  730A             ;[]==========================================================[]
0126+  730A             MakeDIRTab
0127+  730A             	DEFW #00F0,#0138,#007B,#0089,#01,#0000,InpLnExtN,#0000
0127+  730A F00038017B008900010000000E920000
0128+  731A             	DEFW #0148,#0190,#007B,#0089,#01,#0000,InpLnExtC,#0000
0128+  731A 480190017B0089000100000018920000
0129+  732A             	DEFW #0000,#00C8,#0000,#0100,#00,#0000,InpLnExtC,#0000
0129+  732A 0000C800000000010000000018920000
0130+  733A             	DEFW #01B8,#0280,#0000,#0100,#00,#0000,InpLnExtC,#0000
0130+  733A B8018002000000010000000018920000
0131+  734A             	DEFW #0000,#0280,#0000,#0051,#00,#0000,InpLnExtC,#0000
0131+  734A 00008002000051000000000018920000
0132+  735A             	DEFW #0000,#0280,#008F,#0100,#00,#0000,InpLnExtC,#0000
0132+  735A 000080028F0000010000000018920000
0133+  736A 00 80       	DEFW #8000
0134+  736C             ;[]==========================================================[]
0135+  736C             DeleteTab
0136+  736C                  DEFW #00C4,#00FC,#0076,#0084,#0121,#0000,DelDelete,#0000
0136+  736C C400FC00760084002101000096510000
0137+  737C                  DEFW #0104,#013C,#0076,#0084,#0121,#0000,DelAll,#0000
0137+  737C 04013C01760084002101000003520000
0138+  738C                  DEFW #0144,#017C,#0076,#0084,#0121,#0000,DelSkip,#0000
0138+  738C 44017C0176008400210100003A510000
0139+  739C                  DEFW #0184,#01BC,#0076,#0084,#0121,#0000,DelExit,#0000
0139+  739C 8401BC01760084002101000077530000
0140+  73AC                  DEFW #0000,#00B4,#0000,#0100,#0120,#0000,DelExit,#0000
0140+  73AC 0000B400000000012001000077530000
0141+  73BC                  DEFW #01CC,#0280,#0000,#0100,#0120,#0000,DelExit,#0000
0141+  73BC CC018002000000012001000077530000
0142+  73CC                  DEFW #0000,#0280,#0000,#0050,#0120,#0000,DelExit,#0000
0142+  73CC 00008002000050002001000077530000
0143+  73DC                  DEFW #0000,#0280,#0088,#0100,#0120,#0000,DelExit,#0000
0143+  73DC 00008002880000012001000077530000
0144+  73EC 00 80            DEFW #8000
0145+  73EE             
0146+  73EE             ;[]==========================================================[]
0147+  73EE             QuitTab
0148+  73EE             	DEFW #00F0,#0138,#0078,#0086,#21,#0000,QuitOkey,#0000
0148+  73EE F0003801780086002100000058560000
0149+  73FE             	DEFW #0148,#0190,#0078,#0086,#21,#0000,QuitAbort,#0000
0149+  73FE 48019001780086002100000051560000
0150+  740E             	DEFW #0000,#00D0,#0000,#0100,#20,#0000,QuitAbort,#0000
0150+  740E 0000D000000000012000000051560000
0151+  741E             	DEFW #01B0,#0280,#0000,#0100,#20,#0000,QuitAbort,#0000
0151+  741E B0018002000000012000000051560000
0152+  742E             	DEFW #0000,#0280,#0000,#0058,#20,#0000,QuitAbort,#0000
0152+  742E 00008002000058002000000051560000
0153+  743E             	DEFW #0000,#0280,#008A,#0100,#20,#0000,QuitAbort,#0000
0153+  743E 000080028A0000012000000051560000
0154+  744E 00 80       	DEFW #8000
0155+  7450             EmptyTab
0156+  7450             	DEFW #0000,#0280,#0000,#0100,#00,#0000,InpLnExtC,#0000
0156+  7450 00008002000000010000000018920000
0157+  7460 00 80       	DEFW #8000
0158+  7462             
0159+  7462             
0160+  7462             
0292   7462             FlexDIRECTORY: 
0293   7462 00          	ds	0x100
0294   7562             end2: 
0295   7562             
0296   7562             	savebin	"bin\fnfunc.bin",StartOfFunc,end2-StartOfFunc
0297   7562             ;[]-----------------------------------------------------------------------[]
0298   7562             	org	0x4000
0299   4000             ;	section	.text
0300   4000             StartOfHelp
0301   4000             DOShistory: 
0302   4000 00          	ds	0x200
0303   4200             fn_ext: 
0304   4200 00          	ds	0x400
0305   4600             fnview_ext: 
0306   4600 00          	ds	0x400
0307   4A00             fnedit_ext: 
0308   4A00 00          	ds	0x400
0309   4E00             	include "fnext.z80"
0001+  4E00             
0002+  4E00             ;[]==========================================================[]
0003+  4E00             InitExtention
0004+  4E00 21 1C 4E    	LD	HL,ExtName1
0005+  4E03 11 00 42    	LD	DE,fn_ext
0006+  4E06 CD 39 4E    	CALL	InitExt
0007+  4E09 21 23 4E    	LD	HL,ExtName2
0008+  4E0C 11 00 46    	LD	DE,fnview_ext
0009+  4E0F CD 39 4E    	CALL	InitExt
0010+  4E12 21 2E 4E    	LD	HL,ExtName3
0011+  4E15 11 00 4A    	LD	DE,fnedit_ext
0012+  4E18 CD 39 4E    	CALL	InitExt
0013+  4E1B C9          	RET 
0014+  4E1C             ExtName1
0015+  4E1C             	DEFB	"fn.ext",0
0015+  4E1C 666E2E65787400
0016+  4E23             ExtName2
0017+  4E23             	DEFB	"fnview.ext",0
0017+  4E23 666E766965772E65787400
0018+  4E2E             ExtName3
0019+  4E2E             	DEFB	"fnedit.ext",0
0019+  4E2E 666E656469742E65787400
0020+  4E39             ;[]----------------------------------------------------------[]
0021+  4E39             InitExt
0022+  4E39 ED 53 5E 4E 	LD	(EXTdata+1),DE
0023+  4E3D 0E 11       	LD	C,#11
0024+  4E3F 3E 01       	LD	A,#01
0025+  4E41 D7          	RST	#10
0026+  4E42 D8          	RET	C
0027+  4E43 32 6B 4E    	LD	(ExtHandle),A
0028+  4E46 21 00 80    	LD	HL,WorkBuffer
0029+  4E49 11 00 04    	LD	DE,#0400
0030+  4E4C 0E 13       	LD	C,#13
0031+  4E4E D7          	RST	#10
0032+  4E4F D8          	RET	C
0033+  4E50 B7          	OR	A
0034+  4E51 F0          	RET	P
0035+  4E52 3A 6B 4E    	LD	A,(ExtHandle)
0036+  4E55 0E 12       	LD	C,#12
0037+  4E57 D5          	PUSH	DE
0038+  4E58 D7          	RST	#10
0039+  4E59 C1          	POP	BC
0040+  4E5A 21 00 80    	LD	HL,WorkBuffer
0041+  4E5D 11 00 00    EXTdata	LD	DE,#0000
0042+  4E60 D9          	EXX 
0043+  4E61 01 FE 03    	LD	BC,#03FE
0044+  4E64 D9          	EXX 
0045+  4E65 CD 6C 4E    InExt1	CALL	InitExtLine
0046+  4E68 30 FB       	JR	NC,InExt1
0047+  4E6A C9          	RET 
0048+  4E6B             ExtHandle
0049+  4E6B 00          	DEFB	#00
0050+  4E6C             InitExtLine
0051+  4E6C ED 53 30 4F 	LD	(InExtSv+1),DE
0052+  4E70 97          	SUB	A
0053+  4E71 12          	LD	(DE),A
0054+  4E72 13          	INC	DE
0055+  4E73 D9          	EXX 
0056+  4E74 0B          	DEC	BC
0057+  4E75 78          	LD	A,B
0058+  4E76 B1          	OR	C
0059+  4E77 37          	SCF 
0060+  4E78 D9          	EXX 
0061+  4E79 C8          	RET	Z
0062+  4E7A 97          	SUB	A
0063+  4E7B 12          	LD	(DE),A
0064+  4E7C 13          	INC	DE
0065+  4E7D D9          	EXX 
0066+  4E7E 0B          	DEC	BC
0067+  4E7F 78          	LD	A,B
0068+  4E80 B1          	OR	C
0069+  4E81 37          	SCF 
0070+  4E82 D9          	EXX 
0071+  4E83 C8          	RET	Z
0072+  4E84 2B          	DEC	HL
0073+  4E85 03          	INC	BC
0074+  4E86 DD 2E 04    	LD	LX,#04
0075+  4E89 78          InExtL1	LD	A,B
0076+  4E8A B1          	OR	C
0077+  4E8B 37          	SCF 
0078+  4E8C C8          	RET	Z
0079+  4E8D D9          	EXX 
0080+  4E8E 78          	LD	A,B
0081+  4E8F B1          	OR	C
0082+  4E90 37          	SCF 
0083+  4E91 D9          	EXX 
0084+  4E92 C8          	RET	Z
0085+  4E93 23          	INC	HL
0086+  4E94 0B          	DEC	BC
0087+  4E95 7E          	LD	A,(HL)
0088+  4E96 FE 20       	CP	#20
0089+  4E98 38 29       	JR	C,InExtEnd
0090+  4E9A FE 60       	CP	"`"
0091+  4E9C 28 25       	JR	Z,InExtEnd
0092+  4E9E FE 3A       	CP	":"
0093+  4EA0 28 3B       	JR	Z,InExtL2
0094+  4EA2 FE 2A       	CP	"*"
0095+  4EA4 20 14       	JR	NZ,InExL12
0096+  4EA6 3E 3F       InExL11	LD	A,"?"
0097+  4EA8 12          	LD	(DE),A
0098+  4EA9 13          	INC	DE
0099+  4EAA DD 2D       	DEC	LX
0100+  4EAC DD 7D       	LD	A,LX
0101+  4EAE 3D          	DEC	A
0102+  4EAF 28 D8       	JR	Z,InExtL1
0103+  4EB1 D9          	EXX 
0104+  4EB2 0B          	DEC	BC
0105+  4EB3 78          	LD	A,B
0106+  4EB4 B1          	OR	C
0107+  4EB5 37          	SCF 
0108+  4EB6 D9          	EXX 
0109+  4EB7 C8          	RET	Z
0110+  4EB8 18 EC       	JR	InExL11
0111+  4EBA 12          InExL12	LD	(DE),A
0112+  4EBB 13          	INC	DE
0113+  4EBC D9          	EXX 
0114+  4EBD 0B          	DEC	BC
0115+  4EBE D9          	EXX 
0116+  4EBF DD 2D       	DEC	LX
0117+  4EC1 20 C6       	JR	NZ,InExtL1
0118+  4EC3             InExtEnd
0119+  4EC3 ED 5B 30 4F 	LD	DE,(InExtSv+1)
0120+  4EC7 78          InExtE1	LD	A,B
0121+  4EC8 B1          	OR	C
0122+  4EC9 37          	SCF 
0123+  4ECA C8          	RET	Z
0124+  4ECB 7E          	LD	A,(HL)
0125+  4ECC 23          	INC	HL
0126+  4ECD 0B          	DEC	BC
0127+  4ECE FE 0D       	CP	#0D
0128+  4ED0 20 F5       	JR	NZ,InExtE1
0129+  4ED2 78          	LD	A,B
0130+  4ED3 B1          	OR	C
0131+  4ED4 37          	SCF 
0132+  4ED5 C8          	RET	Z
0133+  4ED6 23          	INC	HL
0134+  4ED7 0B          	DEC	BC
0135+  4ED8 78          	LD	A,B
0136+  4ED9 B1          	OR	C
0137+  4EDA C0          	RET	NZ
0138+  4EDB 37          	SCF 
0139+  4EDC C9          	RET 
0140+  4EDD             InExtL2
0141+  4EDD DD 2D       	DEC	LX
0142+  4EDF 28 0E       	JR	Z,InExtL4
0143+  4EE1 D9          InExtL3	EXX 
0144+  4EE2 78          	LD	A,B
0145+  4EE3 B1          	OR	C
0146+  4EE4 37          	SCF 
0147+  4EE5 D9          	EXX 
0148+  4EE6 C8          	RET	Z
0149+  4EE7 13          	INC	DE
0150+  4EE8 D9          	EXX 
0151+  4EE9 0B          	DEC	BC
0152+  4EEA D9          	EXX 
0153+  4EEB DD 2D       	DEC	LX
0154+  4EED 20 F2       	JR	NZ,InExtL3
0155+  4EEF             InExtL4
0156+  4EEF 78          	LD	A,B
0157+  4EF0 B1          	OR	C
0158+  4EF1 37          	SCF 
0159+  4EF2 C8          	RET	Z
0160+  4EF3 D9          	EXX 
0161+  4EF4 78          	LD	A,B
0162+  4EF5 B1          	OR	C
0163+  4EF6 37          	SCF 
0164+  4EF7 D9          	EXX 
0165+  4EF8 C8          	RET	Z
0166+  4EF9 23          	INC	HL
0167+  4EFA 0B          	DEC	BC
0168+  4EFB 7E          	LD	A,(HL)
0169+  4EFC FE 0D       	CP	#0D
0170+  4EFE 28 C3       	JR	Z,InExtEnd
0171+  4F00 FE 09       	CP	#09
0172+  4F02 28 EB       	JR	Z,InExtL4
0173+  4F04 FE 20       	CP	#20
0174+  4F06 28 E7       	JR	Z,InExtL4
0175+  4F08 38 B9       	JR	C,InExtEnd
0176+  4F0A 12          	LD	(DE),A
0177+  4F0B 13          	INC	DE
0178+  4F0C D9          	EXX 
0179+  4F0D 0B          	DEC	BC
0180+  4F0E D9          	EXX 
0181+  4F0F 78          InExtL5	LD	A,B
0182+  4F10 B1          	OR	C
0183+  4F11 37          	SCF 
0184+  4F12 C8          	RET	Z
0185+  4F13 D9          	EXX 
0186+  4F14 78          	LD	A,B
0187+  4F15 B1          	OR	C
0188+  4F16 37          	SCF 
0189+  4F17 D9          	EXX 
0190+  4F18 C8          	RET	Z
0191+  4F19 23          	INC	HL
0192+  4F1A 0B          	DEC	BC
0193+  4F1B 7E          	LD	A,(HL)
0194+  4F1C FE 0D       	CP	#0D
0195+  4F1E 28 0B       	JR	Z,InExtL6
0196+  4F20 FE 20       	CP	#20
0197+  4F22 38 9F       	JR	C,InExtEnd
0198+  4F24 12          	LD	(DE),A
0199+  4F25 13          	INC	DE
0200+  4F26 D9          	EXX 
0201+  4F27 0B          	DEC	BC
0202+  4F28 D9          	EXX 
0203+  4F29 18 E4       	JR	InExtL5
0204+  4F2B             InExtL6
0205+  4F2B 97          	SUB	A
0206+  4F2C 12          	LD	(DE),A
0207+  4F2D 13          	INC	DE
0208+  4F2E E5          	PUSH	HL
0209+  4F2F 21 00 00    InExtSv	LD	HL,#0000
0210+  4F32 73          	LD	(HL),E
0211+  4F33 23          	INC	HL
0212+  4F34 72          	LD	(HL),D
0213+  4F35 E1          	POP	HL
0214+  4F36 18 8F       	JR	InExtE1
0215+  4F38             
0216+  4F38             
0217+  4F38             
0310   4F38             	include "fnhelp.z80"
0001+  4F38             
0002+  4F38             ;[]==========================================================[]
0003+  4F38             HelpR
0004+  4F38 3E 01       	LD	A,#01
0005+  4F3A 32 11 A0    	LD	(CMOSPrint),A
0006+  4F3D 3E C0       	LD	A,#C0
0007+  4F3F D3 89       	OUT	(YPORT),A
0008+  4F41 CD F0 86    	CALL	MakeWindow
0009+  4F44 01          	DEFB	#01
0010+  4F45 40 00 10 00 	DEFW	#0040,#0010
0011+  4F49 00 02 E0 00 	DEFW	#0200,#00E0
0012+  4F4D 02          	DEFB	#02	;Head place
0013+  4F4E 04 00 02 00 	DEFW	#0004,#0002
0014+  4F52 F8 01 0A 00 	DEFW	#01F8,#000A
0015+  4F56 00          	DEFB	#00
0016+  4F57 01          	DEFB	#01	;Text Line
0017+  4F58 F8 00 03 00 	DEFW	#00F8,#0003
0018+  4F5C 0F          	DEFB	#0F
0019+  4F5D 48656C7000  	DEFB	"Help",0
0020+  4F62 04          	DEFB	#04	;UpRectan
0021+  4F63 DC 00 CE 00 	DEFW	#00DC,#00CE
0022+  4F67 48 00 0E 00 	DEFW	#0048,#000E
0023+  4F6B 01          	DEFB	#01	;Text Line
0024+  4F6C FA 00 D1 00 	DEFW	#00FA,#00D1
0025+  4F70 80          	DEFB	#80
0026+  4F71 4F 6B 00    	DEFB	"Ok",0
0027+  4F74 03          	DEFB	#03
0028+  4F75 08 00 10 00 	DEFW	#0008,#0010
0029+  4F79 F0 01 BB 00 	DEFW	#01F0,#00BB
0030+  4F7D 02          	DEFB	#02
0031+  4F7E 0A 00 11 00 	DEFW	#000A,#0011
0032+  4F82 DC 01 B9 00 	DEFW	#01DC,#00B9
0033+  4F86 0F          	DEFB	#0F
0034+  4F87 0A          	DEFB	#0A		;Кнопка	SB верхняя
0035+  4F88 E6 01 11 00 	DEFW	#01E6,#0011
0036+  4F8C 0B          	DEFB	#0B		;Кнопка	SB нижняя
0037+  4F8D E6 01 C2 00 	DEFW	#01E6,#00C2
0038+  4F91 00          	DEFB	#00
0039+  4F92 CD EE 4F    	CALL	InitHelpTxt
0040+  4F95 CD 2E 50    	CALL	PrnHelpPg
0041+  4F98 CD 0D 9B    	CALL	ResFire
0042+  4F9B             HelpLoop
0043+  4F9B DD 21 2E 52 	LD	IX,HelpTab
0044+  4F9F CD 1C 9B    	CALL	TestCoords
0045+  4FA2 0E 31       	LD	C,#31
0046+  4FA4 D7          	RST	#10
0047+  4FA5 28 F4       	JR	Z,HelpLoop
0048+  4FA7 78          	LD	A,B
0049+  4FA8 B7          	OR	A
0050+  4FA9 20 F0       	JR	NZ,HelpLoop
0051+  4FAB 7B          	LD	A,E		;Е-ASCII код
0052+  4FAC FE 1B       	CP	#1B		;Esc
0053+  4FAE CA E4 4F    	JP	Z,HelpExit
0054+  4FB1 FE 0D       	CP	#0D		;Enter
0055+  4FB3 CA E4 4F    	JP	Z,HelpExit
0056+  4FB6 CB AF       	RES	5,A
0057+  4FB8 FE 4F       	CP	"O"
0058+  4FBA CA E4 4F    	JP	Z,HelpExit
0059+  4FBD B7          	OR	A
0060+  4FBE 20 DB       	JR	NZ,HelpLoop    ;Ждем функцион.клавиши
0061+  4FC0 21 9B 4F    	LD	HL,HelpLoop
0062+  4FC3 E5          	PUSH	HL
0063+  4FC4 7A          	LD	A,D
0064+  4FC5 FE 58       	CP	#58		 ;Стрелка вверх
0065+  4FC7 CA D2 50    	JP	Z,HLineUp
0066+  4FCA FE 52       	CP	#52		 ;Стрелка вниз
0067+  4FCC CA 31 51    	JP	Z,HLineDown
0068+  4FCF FE 59       	CP	#59		 ;PageUp
0069+  4FD1 CA C8 51    	JP	Z,HPageUp
0070+  4FD4 FE 53       	CP	#53		 ;PageDown
0071+  4FD6 CA 15 52    	JP	Z,HPageDown
0072+  4FD9 FE 57       	CP	#57		 ;Home
0073+  4FDB CA 84 50    	JP	Z,HHome
0074+  4FDE FE 51       	CP	#51		 ;End
0075+  4FE0 CA 9C 50    	JP	Z,HEnd
0076+  4FE3 C9          	RET 
0077+  4FE4             HelpExit
0078+  4FE4 CD F0 86    	CALL	MakeWindow
0079+  4FE7 7F          	DEFB	#7F
0080+  4FE8 00          	DEFB	#00
0081+  4FE9 97          	SUB	A
0082+  4FEA 32 11 A0    	LD	(CMOSPrint),A
0083+  4FED C9          	RET 
0084+  4FEE             ;[]----------------------------------------------------------[]
0085+  4FEE             InitHelpTxt
0086+  4FEE 21 C0 52    	LD	HL,HelpText
0087+  4FF1 22 18 50    	LD	(PageShift),HL
0088+  4FF4 21 00 00    	LD	HL,#0000
0089+  4FF7 22 2C 50    	LD	(CHLine),HL
0090+  4FFA 21 C0 52    	LD	HL,HelpText
0091+  4FFD 11 00 00    	LD	DE,#0000
0092+  5000 01 00 10    InHelp1	LD	BC,#1000
0093+  5003 97          	SUB	A
0094+  5004 ED B1       	CPIR 
0095+  5006 13          	INC	DE
0096+  5007 7E          	LD	A,(HL)
0097+  5008 3C          	INC	A
0098+  5009 20 F5       	JR	NZ,InHelp1
0099+  500B 1B          	DEC	DE
0100+  500C ED 53 2A 50 	LD	(EHLines),DE
0101+  5010 DD 21 1C 50 	LD	IX,HelpVBar
0102+  5014 CD F7 96    	CALL	InitScrBar
0103+  5017 C9          	RET 
0104+  5018             PageShift
0105+  5018 00 00       	DEFW	#0000
0106+  501A             NextShift
0107+  501A 00 00       	DEFW	#0000
0108+  501C             HelpVBar
0109+  501C 26 02       	DEFW	#0226	;X позиция скролбара
0110+  501E 29 00       	DEFW	#0029	;Y позиция скролбара
0111+  5020 A9 00       	DEFW	#00A9	;Max длина скролбара
0112+  5022 00 00       	DEFW	#0000	;тек.длина скролбара
0113+  5024 54 52       	DEFW	HBarUp	;Адрес ячейки BarLeft
0114+  5026 62 52       	DEFW	HBarDn	;Адрес ячейки BarRight
0115+  5028 17 00       	DEFW	#0017	;Кол-во	строк на странице
0116+  502A 00 00       EHLines	DEFW	#0000	;Общее кол-во строк
0117+  502C 00 00       CHLine	DEFW	#0000	;Первая	строка на странице
0118+  502E             ;[]----------------------------------------------------------[]
0119+  502E             PrnHelpPg
0120+  502E 2A 18 50    	LD	HL,(PageShift)
0121+  5031 06 22       	LD	B,#22
0122+  5033 C5          PrnHPg1	PUSH	BC
0123+  5034 CD 57 50    	CALL	ClearHRect
0124+  5037 11 50 00    	LD	DE,#0050
0125+  503A 48          	LD	C,B
0126+  503B 42          	LD	B,D
0127+  503C 7E          	LD	A,(HL)
0128+  503D 3C          	INC	A
0129+  503E 3E F0       	LD	A,#F0
0130+  5040 C4 B3 8F    	CALL	NZ,PrnTxtLnIFF
0131+  5043 C1          	POP	BC
0132+  5044 78          	LD	A,B
0133+  5045 C6 08       	ADD	A,#08
0134+  5047 47          	LD	B,A
0135+  5048 FE DA       	CP	#DA
0136+  504A 20 E7       	JR	NZ,PrnHPg1
0137+  504C 22 1A 50    	LD	(NextShift),HL
0138+  504F DD 21 1C 50 	LD	IX,HelpVBar
0139+  5053 CD 8E 98    	CALL	PrnVScrBar
0140+  5056 C9          	RET 
0141+  5057             ClearHRect
0142+  5057 E5          	PUSH	HL
0143+  5058 C5          	PUSH	BC
0144+  5059 DB E2       	IN	A,(PAGE3)
0145+  505B F5          	PUSH	AF
0146+  505C 3E 50       	LD	A,#50
0147+  505E D3 E2       	OUT	(PAGE3),A
0148+  5060 21 28 C0    	LD	HL,#C028
0149+  5063 DD 68       	LD	LX,B
0150+  5065 16 FF       	LD	D,#FF
0151+  5067 F3          	DI 
0152+  5068 52          	LD	D,D
0153+  5069 3E E8       	LD	A,#E8
0154+  506B 40          	LD	B,B
0155+  506C 06 08       	LD	B,#08
0156+  506E DD 7D       ClHRect	LD	A,LX
0157+  5070 D3 89       	OUT	(YPORT),A
0158+  5072 49          	LD	C,C
0159+  5073 72          	LD	(HL),D
0160+  5074 40          	LD	B,B
0161+  5075 DD 2C       	INC	LX
0162+  5077 10 F5       	DJNZ	ClHRect
0163+  5079 FB          	EI 
0164+  507A F1          	POP	AF
0165+  507B D3 E2       	OUT	(PAGE3),A
0166+  507D 3E C0       	LD	A,#C0
0167+  507F D3 89       	OUT	(YPORT),A
0168+  5081 C1          	POP	BC
0169+  5082 E1          	POP	HL
0170+  5083 C9          	RET 
0171+  5084             ;[]----------------------------------------------------------[]
0172+  5084             HHome
0173+  5084 2A 18 50    	LD	HL,(PageShift)
0174+  5087 11 C0 52    	LD	DE,HelpText
0175+  508A B7          	OR	A
0176+  508B ED 52       	SBC	HL,DE
0177+  508D C8          	RET	Z
0178+  508E ED 53 18 50 	LD	(PageShift),DE
0179+  5092 21 00 00    	LD	HL,#0000
0180+  5095 22 2C 50    	LD	(CHLine),HL
0181+  5098 CD 2E 50    	CALL	PrnHelpPg
0182+  509B C9          	RET 
0183+  509C             HEnd
0184+  509C 2A 1A 50    	LD	HL,(NextShift)
0185+  509F 7E          	LD	A,(HL)
0186+  50A0 3C          	INC	A
0187+  50A1 C8          	RET	Z
0188+  50A2 21 2D 68    	LD	HL,HelpTextEnd
0189+  50A5 2B          	DEC	HL
0190+  50A6 2B          	DEC	HL
0191+  50A7 E5          	PUSH	HL
0192+  50A8 11 C0 52    	LD	DE,HelpText
0193+  50AB B7          	OR	A
0194+  50AC ED 52       	SBC	HL,DE
0195+  50AE 4D          	LD	C,L
0196+  50AF 44          	LD	B,H
0197+  50B0 E1          	POP	HL
0198+  50B1 ED 5B 2A 50 	LD	DE,(EHLines)
0199+  50B5 2B          	DEC	HL
0200+  50B6 3E 17       	LD	A,#17
0201+  50B8 08          HEnd1	EX	AF,AF'
0202+  50B9 97          	SUB	A
0203+  50BA 1B          	DEC	DE
0204+  50BB ED B9       	CPDR 
0205+  50BD E2 C5 50    	JP	PO,HEnd2+1
0206+  50C0 08          	EX	AF,AF'
0207+  50C1 3D          	DEC	A
0208+  50C2 20 F4       	JR	NZ,HEnd1
0209+  50C4 23          HEnd2	INC	HL
0210+  50C5 23          	INC	HL
0211+  50C6 22 18 50    	LD	(PageShift),HL
0212+  50C9 13          	INC	DE
0213+  50CA ED 53 2C 50 	LD	(CHLine),DE
0214+  50CE CD 2E 50    	CALL	PrnHelpPg
0215+  50D1 C9          	RET 
0216+  50D2             HLineUp
0217+  50D2 2A 18 50    	LD	HL,(PageShift)
0218+  50D5 11 C0 52    	LD	DE,HelpText
0219+  50D8 B7          	OR	A
0220+  50D9 ED 52       	SBC	HL,DE
0221+  50DB C8          	RET	Z
0222+  50DC 4D          	LD	C,L
0223+  50DD 44          	LD	B,H
0224+  50DE 19          	ADD	HL,DE
0225+  50DF 2B          	DEC	HL
0226+  50E0 97          	SUB	A
0227+  50E1 ED A9       	CPD 
0228+  50E3 E2 E9 50    	JP	PO,HLnUp0
0229+  50E6 ED B9       	CPDR 
0230+  50E8 23          	INC	HL
0231+  50E9 23          HLnUp0	INC	HL
0232+  50EA 22 18 50    	LD	(PageShift),HL
0233+  50ED 11 2D 68    	LD	DE,HelpTextEnd
0234+  50F0 1B          	DEC	DE
0235+  50F1 EB          	EX	DE,HL
0236+  50F2 B7          	OR	A
0237+  50F3 ED 52       	SBC	HL,DE
0238+  50F5 EB          	EX	DE,HL
0239+  50F6 4B          	LD	C,E
0240+  50F7 42          	LD	B,D
0241+  50F8 3E 17       	LD	A,#17
0242+  50FA 08          HLnUp1	EX	AF,AF'
0243+  50FB 97          	SUB	A
0244+  50FC ED B1       	CPIR 
0245+  50FE E2 05 51    	JP	PO,HLnUp2
0246+  5101 08          	EX	AF,AF'
0247+  5102 3D          	DEC	A
0248+  5103 20 F5       	JR	NZ,HLnUp1
0249+  5105 22 1A 50    HLnUp2	LD	(NextShift),HL
0250+  5108 2A 2C 50    	LD	HL,(CHLine)
0251+  510B 2B          	DEC	HL
0252+  510C 22 2C 50    	LD	(CHLine),HL
0253+  510F 11 2A 22    	LD	DE,#222A
0254+  5112 CD 82 51    	CALL	ScrHELPDnUp
0255+  5115 06 22       	LD	B,#22
0256+  5117 CD 57 50    	CALL	ClearHRect
0257+  511A 2A 18 50    	LD	HL,(PageShift)
0258+  511D 11 50 00    	LD	DE,#0050
0259+  5120 48          	LD	C,B
0260+  5121 42          	LD	B,D
0261+  5122 7E          	LD	A,(HL)
0262+  5123 3C          	INC	A
0263+  5124 3E F0       	LD	A,#F0
0264+  5126 C4 B3 8F    	CALL	NZ,PrnTxtLnIFF
0265+  5129 DD 21 1C 50 	LD	IX,HelpVBar
0266+  512D CD 8E 98    	CALL	PrnVScrBar
0267+  5130 C9          	RET 
0268+  5131             HLineDown
0269+  5131 2A 1A 50    	LD	HL,(NextShift)
0270+  5134 7E          	LD	A,(HL)
0271+  5135 3C          	INC	A
0272+  5136 C8          	RET	Z
0273+  5137 E5          	PUSH	HL
0274+  5138 11 2D 68    	LD	DE,HelpTextEnd
0275+  513B EB          	EX	DE,HL
0276+  513C B7          	OR	A
0277+  513D ED 52       	SBC	HL,DE
0278+  513F EB          	EX	DE,HL
0279+  5140 4B          	LD	C,E
0280+  5141 42          	LD	B,D
0281+  5142 97          	SUB	A
0282+  5143 ED B1       	CPIR 
0283+  5145 22 1A 50    	LD	(NextShift),HL
0284+  5148 2A 18 50    	LD	HL,(PageShift)
0285+  514B 11 2D 68    	LD	DE,HelpTextEnd
0286+  514E EB          	EX	DE,HL
0287+  514F B7          	OR	A
0288+  5150 ED 52       	SBC	HL,DE
0289+  5152 EB          	EX	DE,HL
0290+  5153 4B          	LD	C,E
0291+  5154 42          	LD	B,D
0292+  5155 97          	SUB	A
0293+  5156 ED B1       	CPIR 
0294+  5158 22 18 50    	LD	(PageShift),HL
0295+  515B 2A 2C 50    	LD	HL,(CHLine)
0296+  515E 23          	INC	HL
0297+  515F 22 2C 50    	LD	(CHLine),HL
0298+  5162 11 22 2A    	LD	DE,#2A22
0299+  5165 CD 82 51    	CALL	ScrHELPDnUp
0300+  5168 E1          	POP	HL
0301+  5169 06 D2       	LD	B,#D2
0302+  516B CD 57 50    	CALL	ClearHRect
0303+  516E 11 50 00    	LD	DE,#0050
0304+  5171 48          	LD	C,B
0305+  5172 42          	LD	B,D
0306+  5173 7E          	LD	A,(HL)
0307+  5174 3C          	INC	A
0308+  5175 3E F0       	LD	A,#F0
0309+  5177 C4 B3 8F    	CALL	NZ,PrnTxtLnIFF
0310+  517A DD 21 1C 50 	LD	IX,HelpVBar
0311+  517E CD 8E 98    	CALL	PrnVScrBar
0312+  5181 C9          	RET 
0313+  5182             ;На вход:
0314+  5182             ;	 D  - Y	откуда
0315+  5182             ;	 Е  - Y	куда
0316+  5182             ScrHELPDnUp
0317+  5182 DB E2       	IN	A,(PAGE3)
0318+  5184 F5          	PUSH	AF
0319+  5185 3E 50       	LD	A,#50
0320+  5187 D3 E2       	OUT	(PAGE3),A
0321+  5189 21 28 C0    	LD	HL,#C028
0322+  518C 06 E8       	LD	B,#E8
0323+  518E F3          	DI 
0324+  518F 52          	LD	D,D
0325+  5190 3E B0       	LD	A,#B0
0326+  5192 40          	LD	B,B
0327+  5193 7A          ScHelp1	LD	A,D
0328+  5194 D3 89       	OUT	(YPORT),A
0329+  5196 7F          	LD	A,A
0330+  5197 7E          	LD	A,(HL)
0331+  5198 40          	LD	B,B
0332+  5199 7B          	LD	A,E
0333+  519A D3 89       	OUT	(YPORT),A
0334+  519C 7F          	LD	A,A
0335+  519D 77          	LD	(HL),A
0336+  519E 40          	LD	B,B
0337+  519F 23          	INC	HL
0338+  51A0 10 F1       	DJNZ	ScHelp1
0339+  51A2 FB          	EI 
0340+  51A3 F1          	POP	AF
0341+  51A4 D3 E2       	OUT	(PAGE3),A
0342+  51A6 3E C0       	LD	A,#C0
0343+  51A8 D3 89       	OUT	(YPORT),A
0344+  51AA C9          	RET 
0345+  51AB             HPageUpM
0346+  51AB CD C8 51    	CALL	HPageUp
0347+  51AE D8          	RET	C
0348+  51AF 06 0A       	LD	B,#0A
0349+  51B1 C5          HUpM1	PUSH	BC
0350+  51B2 0E 03       	LD	C,#03
0351+  51B4 F7          	RST	#30
0352+  51B5 C1          	POP	BC
0353+  51B6 CB 47       	BIT	0,A
0354+  51B8 C8          	RET	Z
0355+  51B9 76          	HALT 
0356+  51BA 10 F5       	DJNZ	HUpM1
0357+  51BC CD C8 51    HUpM2	CALL	HPageUp
0358+  51BF D8          	RET	C
0359+  51C0 0E 03       	LD	C,#03
0360+  51C2 F7          	RST	#30
0361+  51C3 CB 47       	BIT	0,A
0362+  51C5 C8          	RET	Z
0363+  51C6 18 F4       	JR	HUpM2
0364+  51C8             HPageUp
0365+  51C8 2A 18 50    	LD	HL,(PageShift)
0366+  51CB 11 C0 52    	LD	DE,HelpText
0367+  51CE B7          	OR	A
0368+  51CF ED 52       	SBC	HL,DE
0369+  51D1 37          	SCF 
0370+  51D2 C8          	RET	Z
0371+  51D3 4D          	LD	C,L
0372+  51D4 44          	LD	B,H
0373+  51D5 19          	ADD	HL,DE
0374+  51D6 ED 5B 2C 50 	LD	DE,(CHLine)
0375+  51DA 2B          	DEC	HL
0376+  51DB 3E 18       	LD	A,#18
0377+  51DD 08          HPgUp1	EX	AF,AF'
0378+  51DE 97          	SUB	A
0379+  51DF 1B          	DEC	DE
0380+  51E0 ED B9       	CPDR 
0381+  51E2 E2 EB 51    	JP	PO,HPgUp2+1
0382+  51E5 08          	EX	AF,AF'
0383+  51E6 3D          	DEC	A
0384+  51E7 20 F4       	JR	NZ,HPgUp1
0385+  51E9 13          	INC	DE
0386+  51EA 23          HPgUp2	INC	HL
0387+  51EB 23          	INC	HL
0388+  51EC 22 18 50    	LD	(PageShift),HL
0389+  51EF ED 53 2C 50 	LD	(CHLine),DE
0390+  51F3 CD 2E 50    	CALL	PrnHelpPg
0391+  51F6 B7          	OR	A
0392+  51F7 C9          	RET 
0393+  51F8             HPageDownM
0394+  51F8 CD 15 52    	CALL	HPageDown
0395+  51FB D8          	RET	C
0396+  51FC 06 0A       	LD	B,#0A
0397+  51FE C5          HDnM1	PUSH	BC
0398+  51FF 0E 03       	LD	C,#03
0399+  5201 F7          	RST	#30
0400+  5202 C1          	POP	BC
0401+  5203 CB 47       	BIT	0,A
0402+  5205 C8          	RET	Z
0403+  5206 76          	HALT 
0404+  5207 10 F5       	DJNZ	HDnM1
0405+  5209 CD 15 52    HDnM2	CALL	HPageDown
0406+  520C D8          	RET	C
0407+  520D 0E 03       	LD	C,#03
0408+  520F F7          	RST	#30
0409+  5210 CB 47       	BIT	0,A
0410+  5212 C8          	RET	Z
0411+  5213 18 F4       	JR	HDnM2
0412+  5215             HPageDown
0413+  5215 2A 1A 50    	LD	HL,(NextShift)
0414+  5218 7E          	LD	A,(HL)
0415+  5219 3C          	INC	A
0416+  521A 37          	SCF 
0417+  521B C8          	RET	Z
0418+  521C 22 18 50    	LD	(PageShift),HL
0419+  521F 2A 2C 50    	LD	HL,(CHLine)
0420+  5222 11 17 00    	LD	DE,#0017
0421+  5225 19          	ADD	HL,DE
0422+  5226 22 2C 50    	LD	(CHLine),HL
0423+  5229 CD 2E 50    	CALL	PrnHelpPg
0424+  522C B7          	OR	A
0425+  522D C9          	RET 
0426+  522E             ;[]==========================================================[]
0427+  522E             HelpTab
0428+  522E             	DEFW #0226,#0236,#0021,#0029,#03,#0000,HLineUp,#0000
0428+  522E 260236022100290003000000D2500000
0429+  523E             	DEFW #0226,#0236,#00D2,#00DA,#03,#0000,HLineDown,#0000
0429+  523E 26023602D200DA000300000031510000
0430+  524E             HBarUp	EQU  $+6
0431+  524E             	DEFW #0226,#0236,#0029,#0000,#00,#0000,HPageUpM,#0000
0431+  524E 260236022900000000000000AB510000
0432+  525E             HBarDn	EQU  $+4
0433+  525E             	DEFW #0226,#0236,#0000,#00D2,#00,#0000,HPageDownM,#0000
0433+  525E 260236020000D20000000000F8510000
0434+  526E             
0435+  526E             	DEFW #011C,#0164,#00DE,#00EC,#21,#0000,HelpExit,#0000
0435+  526E 1C016401DE00EC0021000000E44F0000
0436+  527E             	DEFW #0000,#0040,#0000,#0100,#20,#0000,HelpExit,#0000
0436+  527E 000040000000000120000000E44F0000
0437+  528E             	DEFW #0240,#0280,#0000,#0100,#20,#0000,HelpExit,#0000
0437+  528E 400280020000000120000000E44F0000
0438+  529E             	DEFW #0000,#0280,#0000,#0010,#20,#0000,HelpExit,#0000
0438+  529E 000080020000100020000000E44F0000
0439+  52AE             	DEFW #0000,#0280,#00F0,#0100,#20,#0000,HelpExit,#0000
0439+  52AE 00008002F000000120000000E44F0000
0440+  52BE 00 80       	DEFW #8000
0441+  52C0             
0442+  52C0             
0443+  52C0             
0311   52C0             HelpText: 
0312   52C0             	insert "fnhelp_t.bin"
0313   682D             HelpTextEnd: 
0314   682D             
0315   682D             end3: 
0316   682D             	savebin	"bin\fnhelp.bin",StartOfHelp,end3-StartOfHelp
0317   682D             
0318   682D             
0319   682D             ;[]=======================================================================[]
0320   682D             	org	0xC000
0321   C000             ;	section	.data
0322   C000             
0323   C000             IFFFont
0324   C000             	insert	"fnfont.bin"
0325   FD00             Font	equ 0xdb00
0326   FD00             ;	insert	"iff_font.raw"
0327   FD00             ;	ds	0xDB00-$
0328   FD00             ;Font
0329   FD00             ;	insert "font.raw"
0330   FD00             end4: 
0331   FD00             
0332   FD00             	savebin	"bin\fnfont.bin",IFFFont,end4-IFFFont
0333   FD00             	export	FNIndef
0334   FD00             	export	FunctPg
0335   FD00             	export	EntryPoint

Value    Label
------ - -----------------------------------------------------------
0x00FE   BORDER
0x0089   YPORT
0x0082   PAGE0
0x00A2   PAGE1
0x00C2   PAGE2
0x00E2   PAGE3
0x0000 X COUNT
0x0009   PanelCol
0x000A   FileCol
0x000B   SFileCol
0x000C   InvSCol
0x0005   InvPCol
0x0006   InvICol
0x0000   PanelFlg
0x0001   ViewFlg
0x0002   SortFlg
0x0003   PanelXl
0x0004   PanelXh
0x0005   PanBarXl
0x0006   PanBarXh
0x0007   PanBarYl
0x0008   PanBarYh
0x0009   PanBrMLl
0x000A   PanBrMLh
0x000D   PanBrLFl
0x000E   PanBrLFh
0x000F   PanBrRTl
0x0010   PanBrRTh
0x0011   PanelFPl
0x0012   PanelFPh
0x0013   PanelEFl
0x0014   PanelEFh
0x0015   PanelFFl
0x0016   PanelFFh
0x0017   PanelCFl
0x0018   PanelCFh
0x0019   PanelMFl
0x001A   PanelMFh
0x001B   PanelMBl1
0x001C   PanelMBh1
0x001D   PanelMBl2
0x001E   PanelMBh2
0x0005   BegPBar
0x001F   BegMask
0x002C   BegPath
0x0000   BarXl
0x0001   BarXh
0x0002   BarYl
0x0003   BarYh
0x0004   BarMaxLl
0x0005   BarMaxLh
0x0006   BarLENl
0x0007   BarLENh
0x0008   BarLEFTl
0x0009   BarLEFTh
0x000A   BarRGHTl
0x000B   BarRGHTh
0x000C   BarPAGEl
0x000D   BarPAGEh
0x000E   BarMAXl
0x000F   BarMAXh
0x0010   BarFRSTl
0x0011   BarFRSTh
0x0000   ProcXl
0x0001   ProcXh
0x0002   ProcYl
0x0003 X ProcYh
0x0004   ProcMaxLl
0x0005   ProcMaxLh
0x0006   ProcCOEFl
0x0007   ProcCOEFh
0x0008   ProcCORRl
0x0009   ProcCORRh
0x000A   ProcMAXl1
0x000B   ProcMAXh1
0x000C   ProcMAXl2
0x000D   ProcMAXh2
0x000E   ProcCURl1
0x000F   ProcCURh1
0x0010   ProcCURl2
0x0011   ProcCURh2
0x0012   ProcCOLOR
0x8000   WorkBuffer
0x8400   PagesList
0x8500   StartOfFN
0x8500   PALETTE
0x8600 X EntryPoint
0xA4AA   StartPoint
0x86BB   ClearScreen
0x86F0   MakeWindow
0x8DA3   InvertRectan
0x8FB3   PrnTxtLnIFF
0x9029   PrnTxtLnNorm
0x90A2   PrnTxtLnNormC
0x8E4B   PrnRangPathL
0x8EB5   PrnRangPathR
0x8F39   PrnRangPathC
0x9168   InputLine
0x920E   InpLnExtN
0x9218   InpLnExtC
0x96F7   InitScrBar
0x9735   PrnHScrBar
0x988E   PrnVScrBar
0x99E6   InitProcess
0x9A45   PrnProcess
0x9B0D   ResFire
0x9B1C   TestCoords
0x9EB5   SetCMOSPrint
0x9EFF   ResCMOSPrint
0xA09C   SetClock
0xA13C   SetMouse
0xA444   MoveBytes
0xA471   MoveBytesUp
0xA1D3   Mult8
0xA1E5   Mult16X8
0xA1FB   Mult16
0xA20F   Mult16X16
0xA234   Mult32
0xA256   Divis16X16
0xA280   Divis24X16
0xA2A3   Divis32X16
0xA2B8   Divis32
0xA2E2   ConvNumTxt32
0xA34C   ConvNumTxt16
0xA378   ConvNumTxt8
0xA3EB   ConvTxtNum32
0xA423   ConvTxtNum16
0xA49A   Resident
0x86A8   DOSError
0xA7E7   FunctPg
0x6995   DOSErrorR
0x86DE   InScrLp
0x87F1   WinType
0x8718   MakeWin
0x87E6   WinPositX
0x87E8   WinPositY
0x87EA   WinLenX
0x87EC   WinLenY
0x8794   MakeWn1
0x8785   MakeWn0
0x87F2   WinBuffer
0x87F0   EquipWin
0x87EE   WinFree
0x8832   SaveRect
0x894E   PutRectan
0x89AE   PutTxtLine
0x89E0   PutHeadPlc
0x8A4D   PutDRectan
0x8ADA   PutURectan
0x8B67   PutButton
0x8B9D   PutHorizLine
0x8BFF   PutVertLine
0x8C4C   PutSBleft
0x8C51   PutSBright
0x8C56   PutSBup
0x8C5B   PutSBdown
0x88BC   RestRect
0xA7F0   BuffPg1
0x8871   SavLen1
0x8878   SavRect
0x888E   SavRec1
0x891B   RstLen1
0x891E   RstRect
0x8934   RstRec1
0x897E   TmpLen1
0x8988   PtRect1
0x8A38   TmpLen2
0x8A3B   PtHead1
0x8AC7   TmpLen4
0x8A9C   TmpLen3
0x8B54   TmpLen6
0x8B29   TmpLen5
0x8BD7   HorizLn
0x8BEF   HorLn1
0x8BE8 X TmpLen7
0x8BF4   TmpLen8
0x8C3A   TmpLen9
0x8CA3   SBleft
0x8C5E   PutSButton
0x8CE3   SBright
0x8D23   SBup
0x8D63   SBdown
0x8C8E   PutSBlp
0x8E06   PrnInvLp
0x8E23   InvLnLp
0x8E2F   CmpInv2
0x8E39   CmpInv3
0x8E44   SetInv4
0xA7EB   FONTpage
0xC000   IFFFont
0x8E5E   PrRangL
0x8EAB   PrRngLE
0x8E84   PrRngL0
0x8E89   PrRngL1
0x8EC8   PrRangR
0x8F2A   PrRngRE
0x8EEF   PrRngR0
0x8EF4   PrRngR1
0x8F1B   PrRngR2
0x8F45   PrnRangC
0x8F4C   PrRangC
0x8FA0   PrRngCE
0x8F75   PrRngC0
0x8F7A   PrRngC1
0x9115   InsPrintColor
0x9160   PrnPAPp
0x9158   PrnINKp
0x901D   PrnIFFe
0x8FEB   PrnIFFloop
0x8FFC   PrnIFFlp1
0x9096   PrnNORe
0x9061   PrnNORloop
0xDB00   Font
0x9075   PrnNORlp1
0x90DA   PrnNORloopC
0x90EC   PrnNORlp1c
0x9116   PrvCOLp
0x000C   LenInpData
0x000E   CursTimer
0x0008   Step
0x9244   InpLnData
0x91AF   InpMous
0x9497   InsInpLnCol
0x94CF   PrintInpLn
0x91AB   InpLineLp
0x96D2   ChCursor
0x926B   InpTable2
0x91CD   InpKeys
0x9246   InpTable1
0x91FC   InpLineLp1
0x9278   InsertSymbol
0x9699   ResCursor
0x92DC   ILleft
0x92EC   ILright
0x92FE   ILdelet
0x9331   IL_del_
0x935C   ILhome
0x936D   ILend
0x93CA   ILwordL
0x937F   ILwordR
0x9412   ILdelWR
0x92BC   ClearInpLn
0x92A5   NotInsert
0x9326   ILDel1
0x9397   wr0
0x93AE   WRIL1
0x93C3   WRIL2
0x93DE   wl0
0x93F5   WLIL1
0x940B   WLIL2
0x9459   DWIL1
0x9470   DWIL2
0x9442   dw0
0x948B   DWIL21
0x95A1   FillILy
0x95B1   PrnINKl
0x95A7   FillILc
0x95B9   PrnPAPl
0x94E4   PrnInpLn1
0x95C1   TstInpLnLen
0x957D   PrnInpE
0x953E   PInpLnP
0x954F   PrnLoopInp
0x95A9   PrnInE1
0x95A3   FillILl
0x959F   FillILx
0x960C   SetCursor
0x95D2   TstInpLn
0x95D6   TstInpL
0x9604   TstInpE
0x9640   StCurs1
0x962D   StCurs0
0x96EA   CurShiftX
0x96ED   CurCursor
0x96EC   CrTimer
0x964E   SetCr
0x96EE   CursBuffer
0x9768   PrHScr1
0x97AF   PrHBar1
0x979D   FillHl1
0x97AE X FillHle
0x97CA   PrHBar2
0x97E6   PrHBr21
0x9806   HBarLp1
0x984B   PrHBar3
0x9888   HBarExt
0x9877   FillHl2
0x98C1   PrVScr1
0x990B   PrVBar1
0x98F1   VBFill1
0x98F6   FillVl1
0x9926   PrVBar2
0x9942   VBarLen
0x9958   VBarLp1
0x999E   PrVBar3
0x99E0   VBarExt
0x99CC   VBFill2
0x99D1   FillVl2
0x9A3E   InitPrE
0x9A6B   PrProc0
0x9AC6   PrProc1
0x9AB4   FillPr1
0x9B07   PrProcE
0x9AF6   FillPr2
0xA7E5   MouseFlag
0x9B12   RsFire1
0x9F05   TestCMOS
0x9B23   PrvTabl
0x9B30   TCoord0
0x9B41   TCoord1
0x9C72   ResMInvert
0x9BB2   RunFlag
0x9B5F   TCoords
0x9B4B   PrMousX
0x9B56   PrMousY
0x9B66   CoordLp
0x9C4E   NxtCrds
0x9BAB   CoordL1
0x9C90   SetSelect1
0x9D1A   SetSelect2
0x9C64   NxtCrds1
0x9BFE   Execute1
0x9C26   Execute2
0x9DA4   PushButton
0x9CE2   ResSelect1
0x9D54   ResSelect2
0x9C5D   NxtCrds0
0x9C7A   ResCrds
0x9CC8   NxCrds1
0x9CDC   NxCrds2
0x9D5F   NxCrds3
0x9D6F   ResSel22
0x9D9F   ResSel2E
0x9E30   PutPushBut
0x9E0C   PausePh
0x9DCB   PushLp
0x9E23   TestRun
0x9DD2   PushLp1
0x9E18   PushButtEx
0x9E34   PutPopBut
0x9E36   PutButt
0x9E88   ButLen3
0x9E80   ButLen1
0x9EA5   ButLen2
0xA013   CMOSposXT
0xA015   CMOSposYT
0xA017   CMOSColorT
0xA011   CMOSPrint
0xA018   CMOSTime
0xA029   CMOSData
0xA01B   CMOSTimeT
0xA02C   CMOSDataT
0xA012   CMOSOut
0xA024   CMOSposXD
0xA026   CMOSposYD
0xA028   CMOSColorD
0xA7E4   CMOSFlag
0x9F29   PrnCMOSTime
0x9F55   TCMOS1
0xA043   GetCMOS
0xA00E   TCMOSex
0x9F78   PrnCMOSData
0x9FAC   TCMOS2
0xA035   CMOSDataT1
0xA054   Month
0x9FF3   CMOSclX
0x9FF5   CMOSclY
0x9FFB   CMOScol
0xA0BE   ClockBMP
0xA15E   MouseBMP
0xA1DE   Mlt8x8
0xA1F2   Mlt16x8
0xA200   mult16
0xA21B   mul16b1
0xA22A   noadd
0xA23D   mul32b
0xA24C   noadd1
0xA25F   Btrial1
0xA278   Bngv1
0xA269   Bptv1
0xA270   Brestr1
0xA28A   Div2416
0xA29B   Dv2416n
0xA2A5   d32X16l
0xA2B3   dv32X16
0xA2C4   div32_1
0xA2D3   div32_2
0xA3EA   ConvertFlg
0xA395   ConNumb32
0xA3B6   ConNumb16
0xA3CF   ConNumb8
0xA398   ConNm32
0xA3F2   ConvTN1
0xA426   ConvTN2
0xA456   MvByte1
0xA44C   MvByte0
0xA45E   Mvlen1
0xA484   MovUp1
0xA47A   MovUp0
0xA492   LenUp
0xA4A3   ResCall
0xA4AE   BEGCOM
0xE410   InitVMode
0xE4A4   InitDrivers
0xA4BB X BEGCOMv
0xE620   InitScreen
0xEB88   ClrDOSline
0xE7C3   InitPanels
0xA4C8   ComLoop
0xEFF1   MainCoordsL
0xA4D6   ComLoop.next
0xF2A3   MainCoordsR
0xA4E8   TestKeys
0xEAF1   DOSline
0xA4DF X ComNext
0xA7E3   TreeFlag
0xB011   TestTree
0xA53A   KeyExit
0xFE06   SHIFTKeys
0xA512   TstKeys
0xFE0F   CTRLKeys
0xFE58   ALTKeys
0xFDAD   ASCIIKeys
0xA537   KeyCALL
0xA53C   MouseOnOff
0xA54C   ComExit
0xE616   ResDrivers
0xE498   ResVMode
0xA562   ComExit.thanks
0xA7E6   FNIndef
0xA58A   LeftPanel
0xA6B6   RightPanel
0xA7E2   EquipDisks
0xA7E8   ViewPg
0xA7E9   EditPg
0xA7EA   HelpPg
0xA7EC   BuffInd
0xA7ED   WorkPage
0xA7EE   DIRpage1
0xA7EF   DIRpage2
0xA7F1 X BuffPg2
0xA7F2   BuffPg3
0xA7F3 X BuffPg4
0xA7F5   ReadDIR
0xAC40   ReadTree
0xA880   NORMmask
0xA88D   FILEmask
0xA87D   AdrNxtFile
0xA89A   FindFILES
0xAA89   SortDIR
0xA87F   FileAtribut
0xA8D0   FindFILESm
0xA8B8   FndFILE
0xA938   InsFileInfo
0xA8EA   FFILEm1
0xA920   FFILEm2
0xA960   InsF1
0xA95D   InsFext
0xA98A   InsF2
0xAA1B   TestExe
0xAA57   CorrBigChar
0xA9A4   InsF3
0xAA37   TestExe1
0xAA54   TestExeC
0xAA61   CorrCh1
0xAA6F   CorrSmallChar
0xAA79   CorrCh2
0xAA83   CorrCh3
0xAB37   EndSort
0xAB35   BegSort
0xAB39   SortABC
0xAAC8   SortBeg
0xAB59   SortExt
0xAB8E   SortData
0xABD8   SortSize
0xAAE1   Scall1
0xAB03   Scall2
0xAAD8   SortDIRlp1
0xAAED   SortDIRnxt
0xAAFA   SortDIRlp2
0xAB0F   SortDIRext
0xAB3D   Sabc1
0xAC17   SortDIRins
0xAB46   Sabc2
0xAB4E   Sabc3
0xAB5D   Sext1
0xAB6D   Sext2
0xAB83   Sext4
0xAB7B   Sext3
0xAB92   Sdata1
0xABCE   SdataE
0xABC6   Sdata2
0xABDC   Ssize1
0xAC0D   SsizeE
0xAC05   Ssize2
0xAF21   BegDIR
0xAF04   TreeName
0xAE3A   LoadTree
0xAC7D   ScanTree
0xADBE   TreeSP1
0xAF26   CurTree
0xAF7E   CurTAdr
0xAF29   EndTree
0xAF27   TreeDIRS
0xAF2B   LoadDIR
0xAD54   TreeExit
0xAD01   TreeLoop
0xAEE4   AbortTree
0xAD2F   DIRSend
0xAF23   UpDIR
0xAF11   TreeHead
0xADB6   TreeExit1
0xAD78   TreeEndLp
0xADA4   TreeEndLp1
0xAE2D   TreeErr
0xAED7   TreeOkey
0xAEA0   LoadTr1
0xB0F0   FindTreeDIR
0xAF64   FndFLtrE
0xAF4B   FndFLtr
0xAF90   InsFileTree
0xAFB9   PrnMTDIR
0xB00C   CurDNumb
0xAFF3   GetN16
0xB018   TstTree
0xB028   TestTreeBeg
0xB086   TTreeEx
0xB05C   TTreeL1
0xB545   PrintDIR
0xBAEA   SetInvert
0xB08A   MakeTreePath
0xBC3F   NewDIRECTORY
0xB0E9   TTreeL5
0xB0C2   TTreeL2
0xB0E1   TTreeL4
0xB0D7   TTreeL3
0xB10F   NwTree0
0xB114   NwTree1
0xB12E   NwTree3
0xB11F   NwTree2
0xB140   NwTree4
0xB13B   NwTreeE
0xB14F   NwTree5
0xB165   NwTree6
0xB16D   NwTree7
0xB1B8   PrintDisks
0xB1FC   DiskX1
0xB205   DiskX2
0xB20F   NameX
0xB214   DISK
0xB1E5   PutDsLp
0xB20D   ColRect
0xB213   ColName
0xB200   LnDiskX
0xB238   PrintPath
0xB263   HeadCol
0xB2A8   PathCol
0xB25B   PanelHX
0xB297   PrPath1
0xB2AE   PrintDOSPath
0xB2EE   PrnFileInfo
0xB4A4   PrnTreeInfo
0xB4C4   PrnSelInfo
0xB38B   PrntFI
0xB34E   EFI0
0xB358   EFI1
0xB36D   EFI3
0xB367   EFI2
0xB37B   EndFI
0xB375   EFI4
0xB3A1   GetFileLen
0xB467   GetData
0xB482   GetTime
0xB454   PDirectory
0xB414   GetLenN32
0xB438   GetLenN16
0xB417   GetLn32
0xB45D   DirText
0xB494   Get8Bit
0xB52C   CrSizeT
0xB536   CrSelT
0xB503   PrSelI1
0xB514   PrSelI2
0xB582   PrnDIRECT
0xB577   ClrDIR1
0xB57B   ClrDIRx
0xB57D   ClrDIRy
0xB633   PrintDIR1
0xB742   PrintDIR2
0xB8C0   InsPrnColor
0xB9B8   PositTAB1
0xBA51   PositTAB2
0xB5E2   PrnDIR1
0xB933   PrintName
0xB600   PrnDIR2
0xB61A   PrnDIRe
0xB625   EmptyFile
0xB607   PrnDIR3
0xB685   PrnDIRp
0xB6F2   PutDIRTxt
0xB6D1   PrnDIRp2
0xB6E8   PrnDIRpE
0xB71B   EmptyFile1
0xB6D7   PrnDIRp3
0xB707   DIRt1
0xB711   DIRt2
0xB77E   PrDIRb2
0xB76D   PrDIRb1
0xB7AE   PrnDIRt
0xB802   MakeTreeLine
0xB7DF   PrnDIRt2
0xB7FA   PrnDIRtE
0xB89B   EmptyFile2
0xB7E7   PrnDIRt3
0xB84E   MTreeL2
0xB839   MTreeL1
0xB822   MTreeL0
0xB861   MTreeL3
0xB87E   MTreeL5
0xB88C   MTreeL6
0xB913   PrnINKd1
0xB91B   PrnPAPd1
0xB923   PrnINKd2
0xB92B   PrnPAPd2
0xB960   PTxtLnD
0xB971   PTxtLD0
0xB97F   PTxtLD1
0xB98A   PTxtLD2
0xB997   PrnName1
0x00C7   CNT
0xBB06   PrnInvert
0xBAF9   ResInvert
0xBBA2   PrnTreeInv
0xBB7C   PrnInvertP
0xBC1B   PrTreeI
0xBC3C   BegDIRECTORY
0xBC9C   NewDIRECT1
0xE807   InitPanel
0xBC92   NewDIR0
0xBCD8   NewDIRTree
0xBCFD   RefreshDIR
0xBD25   RfDIRn1
0xBD2B   RefrDIR
0xBD6F   RefrDex
0xBD72   FindPrevFile
0xBD99   FndPrFile0
0xBDB8   FndPrFileNxt
0xBE6A   MakeDOSname
0xBDCD   PrevFile
0xBDAD   FndPrFile1
0xBDC7   FndPrFileE
0xBE59   FndTreeExt
0xBE32   FndTree
0xBDDA   FindPrevDIR
0xBE01   FndPrDIR0
0xBE20   FndPrDIRnxt
0xBE5D   PrevDIR
0xBE15   FndPrDIR1
0xBE2E   FndPrDIRe
0xBE6D   MDN0
0xBE76   MDN1
0xBE80 X MDN2
0xBE8E   MDNe
0xBE88   MDN3
0xBE91   CursUp
0xBEAB   CursUp1
0xBECC   ScrlDn1
0xBEBE   ScrollDown
0xBFE6   ScrlDnP
0xC09C   ScrlDnT
0xC404   ScrDIRDnUp
0xC0D9   ScrDdn2
0xC0C8   ScrDdn1
0xC14C   CursDown
0xC1A5   ScrlUp1
0xC187   ScrollUp
0xC29A   ScrlUpP
0xC353   ScrlUpT
0xC380   ScrDup1
0xC411   ScrlLen
0xC414   ScRect1
0xC425   CursLeft
0xC4BB   PageUp
0xC4A9   CursLRex
0xC448   CursRight
0xC4E8   PageDown
0xC482   CursRg1
0xC55D   Home
0xC530   PageUDex
0xC596   End
0xC551   PgUDext
0xC584   Home1
0xC5EC   End1
0xC60B   NewFile
0xC671   NewFile1
0xC6BF   OpenFile
0xC944   RunEXEfile
0xC739   OpenF2
0xC738   OpenF1
0xC7D7   ChPanel
0xC824   ChPan1
0xC86F   ChPan2
0xC887   ChangeDriveL
0xC891   ChangeDrive
0xC88D   ChangeDriveR
0xC8D9   NewDrive
0xC8DD   ReplacePanels
0xC91D   ReplPan
0xC92C   ShowDOSscreen
0xC92F   ShowDSlp
0xC93A   ShowDSexit
0x4200   fn_ext
0xC9AF   RunFLXfile
0xC9D2   RunTRDfile
0xCC69   TestEXT
0xE498   ResVModeE
0xCDB9   RunFLEX
0xCA54   LoadTRD
0xCC68   TRDIndef
0xCA14   TRDResident
0xCA54   TRDResidentE
0x8100   TRDfile
0xCA6A   LoadTR0
0xCAA1   LoadTR1
0xCC50   ProcessTRD
0xCB81   LoadTRn
0xCC0A   LoadTExit
0xCC63   FHandleTR
0xCC64   ReadTLen
0xCBA5   ReadTR1
0xCC17   TRDabort
0xCBEB   ReadTEnd
0xCC2A   NextProcessTR
0xCC03   ReadTExit
0xCBFF   ReadTRe
0xCC4C   NextTR1
0xCC81   TestEXT1
0xCCAE   TestEND
0xCCA6   TestEXTn
0xCCB3   TestEXTok
0xCCB8   TstEXT0
0xCD18   TstEXT2
0xCCFB   TstEXT1
0xCD12   TstEX11
0xCD76   EName
0xCD8F   EDrive
0xCD9C   EPath
0xCD65   RestoreDIR
0xCEA2   FLXHandle
0xCE62   RFlex1
0xCE73   FLXexec
0xCE88   FLXmode
0xCEA3   Help
0x4F38   HelpR
0xCEAF   ViewFileSH
0xCF63   ViewStr
0xFC59   ViewEditTab
0xCF67   ViewLen
0xCF6F   ViewName
0xCF50   ViewSH1
0xCFDF   View
0xCF7C   ViewFile
0xCF7F   StViewFile
0xCFDA   VFlag
0xCFEA   View1
0x4600   fnview_ext
0xD018   EditFileSH
0xD0C5   EditStr
0xD0C9   EditLen
0xD0D1   EditName
0xD0B2   EditSH1
0xD141   Edit
0xD0DE   EditFile
0xD0E1   StEditFile
0xD13C   EFlag
0xD14C   Edit1
0x4A00   fnedit_ext
0xD17A   CopyFiles
0x4000   CopyFilesR
0xD186   ReName
0x4832   ReNameR
0xD192   MakeDIR
0x4C85   MakeDIRR
0xD19E   DeleteFiles
0x4F64   DeleteFilesR
0xD1AA   Quit
0x55BF   QuitR
0xD1C0   Setup
0x62ED   SetupR
0xD1CC   FileInfo
0x565F   FileInfoR
0xD1DF   PrintFile
0x584D   PrintFileR
0xD1F2   DiskInfo
0x5CD0   DiskInfoR
0xD201   SystemInfo
0x5ACC   SystemInfoR
0xD20D   Version
0x5F07   VersionR
0xD219   QSearch
0x5FDF   QSearchR
0x0006   EPullMenu
0xD225   PullDown
0xD2BC   SetPullInvert
0xD22B   PullLoop
0xFAB1   PullTab
0xD25C   PullExit
0xD28A   PullEnter
0xD264   PullLeft
0xD277   PullRight
0xD2B5   ResPullInvert
0xD858   CurMenu
0xD7E6   MKeyFlg
0xD2F7   MFile
0xD2B3   PullRun
0xD2FD   MSelect
0xD303   MOption
0xD309   MView
0xD30F   MConfig
0xD315   MAbout
0xD2B8   SavPull
0xD2C5   PullInvert
0xD31B   MenuFile
0xD3A1   MenuSelect
0xD462   MenuOption
0xD4F6   MenuView
0xD753   MenuConfig
0xD792   MenuAbout
0xD864   SvView1
0xD86C   SvView2
0xF555   FileTab
0xD7D0   MenuWork
0xF627   SelectTab
0xF719   OptionTab
0xD519   MVnxt0
0xD5D8   view1
0xD5F4   view2
0xD610   view3
0xD542   MVnxt1
0xD638   filt1
0xD65E   filt2
0xD683   filt3
0xD589   MVnxt2
0xD6BE   sort1
0xD6DF   sort2
0xD6FB   sort3
0xD717   sort4
0xD737   sort5
0xD670   Tfilter
0xD5BA   MVnxt3
0xF7EB   ViewTab
0xF94D   ConfigTab
0xF9FF   AboutTab
0xD7EC   CurWTab
0xD85A   MaxLines
0xD859   CurMLine
0xD82F   TestInvert
0xD7EC   MenuLoop
0xD915   SetMSelect
0xD85B   MenuKExt
0xD92C   ChangeSet
0xD878   MenuLeft
0xD88C   MenuRight
0xD8A0   MenuUp
0xD8BE   MenuDown
0xD8DE   MenuHome
0xD8F3   MenuEnd
0xD83F   MenuLp0
0xD849   MenuLp1
0xD864   MenuExit
0xD8B3   MenuUp1
0xD910   ResMSelect
0xD8D6   MenuDn1
0xD8EB   MHome1
0xD905   MEnd1
0xD918   MSel
0xD96A   ChView1
0xD975   ChView2
0xD980   ChView3
0xD992   ChFilt1
0xD9A4   ChFilt2
0xD9B6   ChFilt3
0xD9C8   ChSort1
0xD9E2   ChSort2
0xD9FC   ChSort3
0xDA16   ChSort4
0xDA30   ChSort5
0xDA42   Brief
0xDA53   Full
0xDA63   Tree
0xDA78   AllFiles
0xDA8E   ExeFiles
0xDAA3   NameS
0xDAC0   Extention
0xDADD   Data
0xDAFA   Size
0xDB17   UnSort
0xDB2D   RefreshTree
0xDB4F   RfTree1
0xDB71   NewFilter
0xDC59   CurFilt
0xDC51   FiltLen
0xDC4D   FilterStr
0xFB53   FilterTab
0xE20C   SelMask
0xE217   MakeMask
0xDC33   Mfilter
0xDC66   LeftDrive
0xDCA6   LeftTab
0xFCBB   DriveTab
0xDD26   ChangeDrv
0xDDDE   DriveExit
0xDCC6   RightDrive
0xDD06   RightTab
0xFCFB   BegDrive
0xDEAC   Drive
0xDD50   Drive1
0xDEAB   CurDrive
0xDE73   SetDriveInv
0xDDA1   DriveLoop
0xDE38   DriveEnter
0xDDD0   DriveLoop1
0xDDE9   DriveLeft
0xDE04   DriveRight
0xDE6B   ResDriveInv
0xDE1F   DriveMouse
0xDE3B   SetDrive
0xDE79   DriveInvert
0xDEAE   MarkFile
0xDF03   SelectFile
0xDF08   UnSelectFile
0xDEF7   MarkFex
0xDF4F   MrFile1
0xDF9C   MarkFull
0xDFD2   MarkExit1
0xE00B   MarkExit2
0xE046   UnMarkGroup
0xE059   SelectGroup
0xE050   MarkGroup
0xE153   SelMode
0xE1F3   SMaskStr
0xFBB5   SMaskTab
0xE1F7   MaskLen
0xE1FF   CrSMask
0xE0F6   CorMask
0xE11E   MarkGNext
0xE159   Select1
0xE1C0   Select8
0xE169   Select2
0xE171   Select3
0xE184   Select6
0xE178   Select4
0xE180   Select5
0xE1A8   Select7
0xE21A   SMaskLp
0xE257   SMask1
0xE265   SMask2
0xE25E   SMask11
0xE271   SMask21
0xE27C   SelectAll
0xE2B4   SelAll0
0xE2D5   SelAll1
0xE306   UnSelectAll
0xE34E   UnSelA1
0xE360   InvertSelect
0xE3A5   InvSel1
0xE3E7   InvSel3
0xE3CF   InvSel2
0xE532   InitFlg
0xE422   InitVM0
0xE49A   VMode
0xE498   VScrn
0xE44E   InitVM1
0xE464   InitComPorts
0xE458   InitPAL
0x0019   ComA
0x0018 X DataA
0x001D   LPT1C
0x001F   LPT2C
0xE4F0   InitDrv
0xE4CC   NoEnMemory
0xE4F9   InDrv0
0xE52A   InDrv1
0xE547   FirstInit
0x7462   FlexDIRECTORY
0x662E   SetupName
0xE5E4   InDrv3
0x6623   SetupHead
0xE594   InDrv2
0xE5E1   InDrvPL
0xF141   BgDISKl
0xF3F3   BgDISKr
0xE5F3   InDrv4
0x4E00   InitExtention
0xEAF0   InitPanFlg
0xE7E1   InitPanTree
0xE80B   InitPanelE
0xE7F2   InitPanExit
0xE808 X InitPanel1
0xE935   InitPPanel
0xE887   PanelN1
0xE890   PanelN2
0xE8AE   PanelN6
0xE89A   PanelN3
0xE8F5   Nbut1
0xE8E5   Nfile
0xE89F   PanelN4
0xE915   Nbar1
0xE8A9   PanelN5
0xE925   Nbar2
0xE905   Nbut2
0xE8E5   NormMouse
0xF061   PanelPlaceL
0xF313   PanelPlaceR
0xEA46   InitPanEx
0xE998   PanelP1
0xE9A1   PanelP2
0xE9BF   PanelP6
0xE9F6   Pfile
0xE9AB   PanelP3
0xE9B0   PanelP4
0xE9BA   PanelP5
0xEA06   Pbut1
0xEA16   Pbut2
0xEA26   Pbar1
0xEA36   Pbar2
0xE9F6   PodrMouse
0xEA8A   InPan1
0xEA7F   InPan0
0xEAE3   InPan2
0xEFF0   HistCurrent
0xEB25   DOSln0
0xEB55   DOSlnEx
0xEBB4   RunDOSline
0xEB7E   ClrDOSln1
0xEB59   DOSloop
0xEB44   DOSln1
0xEF64   DOSslen
0xEF60   DOSstr
0xFC17   DOSTab
0xED66   DOSInputLine
0xEF6C   DOSinp
0xEF62   DOSposX
0xEF63   DOSaddX
0xECAD   SaveDOSline
0xEBD2   RunDLn0
0xEBD9   RunDLine
0xEC3D   RunDOSexe
0xEC41   RunDE1
0xEC7A   RunDOSexe1
0xEFED   HistSpace
0xECC5   SavDOS0
0xECE1   SavDOS1
0xEFEF   HistCount
0xED59   FindHistory
0x4000   DOShistory
0xED1C   GetDOShistory
0xED90   DOSLineLp
0xEE56   DOSTable2
0xEDB2   DOSKeys
0xEE35   DOSTable1
0xEDF1   DOSLineLp1
0xEDE4   DOSLnNx
0xEE0E   DOSLineLp2
0xEE07   DOSLnE0
0xEE21 X DOSLnExtN
0xEE2B   DOSLnExtC
0xEE73   InsFileName
0xEEE6   InsLeftPath
0xEEEB   InsRightPath
0xEF59   InsHistory
0xEEA9   InsFN1
0xEED8   TempName
0xEEB9   InsFN2
0xEF0A   InsertWord
0xEEEE   InsPath
0xEF34   NotInsWord
0xFE75 X end1
0xFE75   EndOfFN
0x4000   StartOfFunc
0x4076   CopyMark
0x4690   AdrCopyFile
0x4696   ECopyFiles
0x4698   ECopyBytes
0x46AA   ConvLenToBank
0x40E7   CopyNxt
0x40B8   CopyLp0
0x40DC   CopyNx2
0x477F   ProcessAll
0x47B1   CurPath
0x47A9   PathLen
0x47A5   PathStr
0x71C4   PathTab
0x469D   FreeBanks
0x469C   OverWriteFlg
0x4692   CopyFrom
0x4694   CopyTo
0x424A   CopyNextFile
0x46CA   PrnFromTo
0x469F   ReadLen
0x46A3   WriteLen
0x429A   FileBnL
0x4293   FileBnH
0x4792   ProcessOne
0x42A3   CopyLp1
0x46A9   MemIndef
0x44C0   CopyError1
0x46A7   FHandle1
0x44B8   CopyError2
0x4302   CopyLp2
0x4501   OverWrite
0x46A8   FHandle2
0x43ED   CloseFiles
0x4312   ReadFile
0x4319   ReadLp1
0x44CE   CopyBreak
0x435F   ReadEnd
0x4734   NextProcess
0x4379   WriteFile
0x4380   WriteL1
0x43D3   WriteEnd
0x43FF   CloseFile1
0x4450   CopyEnd
0x45CD   OvWrtLp
0x7226   OverWrtTab
0x4672   OverExit
0x460A   OvrJump
0x4615   OverWrtFile
0x4610   OverWrtAll
0x462F   OverSkip
0x4756   NextPr1
0x477B   NextPr2
0x487A   ReNameNr
0x4C5F   CurName
0x4C5E   CurAttrib
0x4896   ReNameN
0x4C78   Name
0x4C70   NameLen
0x492E   RNfile
0x48D4   RNnxt
0x4C6C   NameStr
0x72A8   ReNameTab
0x49A5   ReName0
0x4A4D   ReNameDIR
0x4A00   ReName1
0x4A06   ReName2
0x4A4A   ReNameE
0x4BEC   ReNameExit
0x4AAB   ReNameTree
0x4AEE   ReNameEx
0x4B52   ReNameT
0x4AD0   FRName1
0x4AD6   FRName2
0x4AE9   FRName4
0x4AE1   FRName3
0x4B4C   ReNameC
0x4BA7   ReNameExt1
0x4C17   RNameE1
0x4C5B   RNameE2
0x4F4B   MakeDIRStr
0x730A   MakeDIRTab
0x4F4F   MDIRLen
0x4F57   NewDIR
0x4D25   MkDIRlp
0x4D50   MkDIR0
0x4ED7   MkDIRnxt1
0x4ECF   MkDIRn0
0x4DD4   FnTree1
0x4ECC   MkDIRn
0x4DE9   FnTree2
0x4E27   MkDIRend
0x4E02   MkDIR10
0x4E0D   MkDIR11
0x4E18   MkDIR12
0x4EC6   MkDIR2
0x4EDD   MkDIRn1
0x4F29   MkDIRn2
0x4F18   MkDIRrf
0x4F48   MkDIRex
0x4FC5   DeleteMark
0x4FA9   DelFile
0x5120   AdrDelFile
0x4FB7   DelFil1
0x4FE7   DelNext
0x5122   DeleteFlag
0x5003   DeleteMain
0x50CB   DelLp0
0x5123   MakeDELname
0x50DD   DelLoop
0x736C   DeleteTab
0x5377   DelExit
0x511A   DelJump
0x5196   DelDelete
0x5203   DelAll
0x513A   DelSkip
0x5131   MakeDELn1
0x51CA   DelDel0
0x51E7   DelDel1
0x51F8   DelDel2
0x5285   DelFrom
0x535E   ProcessDel
0x5285   DeleteAllLp
0x5371   DelAllExit
0x52F1   DelA1
0x53A2   DelTreeDIR1
0x539C   DelTreeDIR
0x5387   DelExt1
0x55B2   DelName
0x5435   DelTree1
0x552D   DelDIRn
0x540D   DlTree1
0x542B   DlTr31
0x541A   DlTree2
0x542E   DlTree4
0x5425   DlTree3
0x544A   DelTree2
0x54A4   DelTree3
0x5496   DelTr1
0x54D5   DelTree4
0x5527   DelDIR2
0x557F   DeleteExt1
0x562E   QuitLoop
0x73EE   QuitTab
0x5651   QuitAbort
0x5658   QuitOkey
0x578A   FName
0x56CF   FInfo1
0x5845   FAtributs
0x57AA   FAttrib
0x56DA   FInfo2
0x57BF   FLen
0x5704   FInfo3
0x571F   FInfo4
0x5CB5   Bytes
0x57DD   FData
0x57E8   FTime
0x5804   FClast
0x5820   FileInfoLoop
0x706A   FileInfoTab
0x583F   FileInfoExt
0x5AB9   PrnFileName
0x5AC6   PrnFileLen
0x5ACA   PrnMIndef
0x70BC   PrintFTab
0x5AA6   ProcessFPrn
0x5986   InitPrn
0x5A20   PrnError
0x5ACB   PrnFHandle
0x59B0   ReadPr1
0x59F5   ReadPrnEnd
0x5A30   PrintBlock
0x59F0   PrnEsc
0x5A1A   PrnFileExit
0x5A13   ReadPrE
0x5A79   NxtPrnProc
0x5A33   PrnBlockLp
0x5A42   PrintCHAR
0x5A56   PrnCH1
0x5A5A   PrnCH2
0x5A6C   PrnCHAR
0x5A6A   StopPrint
0x5AA0   NxtProc
0x5C15   DOSvers
0x5BFB   BIOSver
0x5CBA   Present
0x5CC5   NotPresent
0x5C28   CMOS
0x5C49   TotMem
0x5C6D   FreeMem
0x5EDF   CorrBigNum
0x5C90   SysInfoLoop
0x70CE   SysInfoTab
0x5CAF   SysInfoExt
0x5D7A   CrDrive
0x5EB5   NoLabel
0x5D06   DiskI0
0x5D17   DiskI2
0x5D12   DiskI1
0x5EC0   NoLabelT
0x5DC3   Dlabel
0x5DEC   SerialN
0x5ECB   ConvHexTxt
0x5E4A   ClastS2
0x5E47   ClastS1
0x5E90   DiskInfoLoop
0x7120   DiskInfoTab
0x5EAF   DiskInfoExt
0x5ED4   ConvHexT1
0x5EFF   CBigNm2
0x5EF8   CBigNm1
0x5FC0   VersionLoop
0x7172   VersionTab
0x5FD9   VersionExt
0x61C6   SearchN
0x61BE   SrchLen
0x6025   SrchX1
0x61BF   SrchX2
0x6027   SrchY1
0x61C1   SrchY2
0x61BA   SearchStr
0x6067   SearchInpLp
0x62E0   SearchExit
0x60D3   SearchTab
0x60A0   Search1
0x61D3   AltTable
0x60C8   SearchInpLp1
0x60E0   InsSymbolSrch
0x62DF   SrchExit
0x6188   QSdelet
0x6106   NotInsSrch
0x6208   SearchFile
0x611F   FoundSFile
0x61A9   QSDel1
0x627C   SearchFileT
0x622C   SearchFlp
0x623C   SrchF1
0x6262   SearchFnxt
0x6247   SrchF2
0x6270   SearchFexit
0x625E   SearchFnx0
0x6299   SearchTlp
0x62A9   SrchT1
0x62C2   SearchTnxt
0x62AA   SrchT2
0x62D3   SearchTexit
0x62C1   SearchTnx0
0x8534   TempColor
0x6848   TempPALETTE
0x680B   SavePanels
0x663A   SaveSav
0x6443   SaveFlg
0x66DF   SaveFlag
0x680A   CurElement
0x688D   SetSetupInv
0x6812   BarRed
0x6824   BarGreen
0x6836   BarBlue
0x68AF   InitElement
0x64CC   SetupLoop
0x6F48   SetupTab
0x64FC   SetupLoop0
0x67A2   InputRED
0x67AD   InputGREEN
0x67B8   InputBLUE
0x6518   SetupLoop1
0x6742   DecRED
0x6752   DecGREEN
0x6762   DecBLUE
0x6635   SetupCancel
0x6641   SetupOkey
0x656E   SaveSetup
0x674A   IncRED
0x675A   IncGREEN
0x676A   IncBLUE
0x6720   ChSavePan
0x66E0   BoxUp
0x66E7   BoxDown
0x66F0   BoxHome
0x66F8   BoxEnd
0x6615   SetupSaveEx
0x65FB   SvSetup
0x665B   SetupExit
0x666B   SetRef1
0x6678   SetRef2
0x669F   RefreshSetup
0x6683   SetRef3
0x6690   SetRef4
0x66DC   RefrErr
0x6711   BoxKeyExt
0x6702   NewElement
0x6888   ResSetupInv
0x6740   SavePanTxt
0x68DB   PrintRED
0x6772   DecCOLOR
0x6779   IncCOLOR
0x6910   PrintGREEN
0x6945   PrintBLUE
0x677D   DecIncCOLOR
0x697A   PrnPALETTE
0x680C   ElementColor
0x67C1   InputColor
0x6801   ColorY
0x6806   ColText
0x67FE   ColLen
0x67DA   InpAg
0x67FA   ColorStr
0x7450   EmptyTab
0x6822   CRed
0x6834   CGreen
0x6846   CBlue
0x6890   SetupInvert
0x68A2   SetupI1
0x68F9 X InitEl1
0x692E X InitEl2
0x6963 X InitEl3
0x69A9   ErrorWins
0x69E9   InvDrive
0x6C04   FileNFound
0x6B70   InvPath
0x6D3E   FILEexists
0x6C51   ROOToverflow
0x6C9D   NoDiskSpace
0x6CE9   DIRnotEmpty
0x6A50   InvMedia
0x6D88   DIRexists
0x6DD7   InvName
0x6E22   InvEXEfile
0x6E71   InvEXEver
0x6AAF   NotReady
0x6EC5   NoMemory
0x6B0E   InputDrive
0x6B6E   CurDrv
0x6B62   DriveStr
0x6B50   ErrorTab1
0x6BB8   ErrorLp0
0x6BF2   ErrorTab2
0x6BD7   ErrorExt0
0x6F10   ErrorLp
0x6F36   ErrorTab3
0x6F2F   ErrorExt
0x7562   end2
0x4000   StartOfHelp
0x4E1C   ExtName1
0x4E39   InitExt
0x4E23   ExtName2
0x4E2E   ExtName3
0x4E5D   EXTdata
0x4E6B   ExtHandle
0x4E65   InExt1
0x4E6C   InitExtLine
0x4F2F   InExtSv
0x4E89   InExtL1
0x4EC3   InExtEnd
0x4EDD   InExtL2
0x4EBA   InExL12
0x4EA6   InExL11
0x4EC7   InExtE1
0x4EEF   InExtL4
0x4EE1   InExtL3
0x4F0F   InExtL5
0x4F2B   InExtL6
0x4FEE   InitHelpTxt
0x502E   PrnHelpPg
0x4F9B   HelpLoop
0x522E   HelpTab
0x4FE4   HelpExit
0x50D2   HLineUp
0x5131   HLineDown
0x51C8   HPageUp
0x5215   HPageDown
0x5084   HHome
0x509C   HEnd
0x52C0   HelpText
0x5018   PageShift
0x502C   CHLine
0x5000   InHelp1
0x502A   EHLines
0x501C   HelpVBar
0x501A   NextShift
0x5254   HBarUp
0x5262   HBarDn
0x5033   PrnHPg1
0x5057   ClearHRect
0x506E   ClHRect
0x682D   HelpTextEnd
0x50B8   HEnd1
0x50C4   HEnd2
0x50E9   HLnUp0
0x50FA   HLnUp1
0x5105   HLnUp2
0x5182   ScrHELPDnUp
0x5193   ScHelp1
0x51AB   HPageUpM
0x51B1   HUpM1
0x51BC   HUpM2
0x51DD   HPgUp1
0x51EA   HPgUp2
0x51F8   HPageDownM
0x51FE   HDnM1
0x5209   HDnM2
0x682D   end3
0xFD00   end4
